<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="manifest" href="/jayground8/static/favicons/manifest.json"/><link rel="manifest" href="/jayground8/static/favicons/site.webmanifest"/><link rel="shortcut icon" href="/jayground8/static/favicons/favicon.ico"/><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8773084925406986" crossorigin="anonymous"></script><title>오픈소스 Kubernetes External Secrets 살펴보기</title><meta name="robots" content="follow, index"/><meta name="description" content="CRD와 Custom Controller를 사용하는 프로젝트에 대해서 더 알고 싶은 상황에서, External Secrets이라는 프로젝트를 발견하게 되었다. External Secrets는 Vault, AWS secret manager와 같이 secret 관리하는 Tool들과 Kubernetes secret을 CRD을 통해서 sync할 수 있게 해준다. 이 프로젝트는 kubebuilder를 사용하였는데, 소스코드를 보면서 어떻게 구현한 건지 자세히 살펴보았다."/><meta property="og:url" content="https://jayground8.github.io/blog/20230730-k8s-controller-external-secrets"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Jayground8"/><meta property="og:description" content="CRD와 Custom Controller를 사용하는 프로젝트에 대해서 더 알고 싶은 상황에서, External Secrets이라는 프로젝트를 발견하게 되었다. External Secrets는 Vault, AWS secret manager와 같이 secret 관리하는 Tool들과 Kubernetes secret을 CRD을 통해서 sync할 수 있게 해준다. 이 프로젝트는 kubebuilder를 사용하였는데, 소스코드를 보면서 어떻게 구현한 건지 자세히 살펴보았다."/><meta property="og:title" content="오픈소스 Kubernetes External Secrets 살펴보기"/><meta property="og:image" content="https://jayground8.github.iosocial-banner.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site"/><meta name="twitter:title" content="오픈소스 Kubernetes External Secrets 살펴보기"/><meta name="twitter:description" content="CRD와 Custom Controller를 사용하는 프로젝트에 대해서 더 알고 싶은 상황에서, External Secrets이라는 프로젝트를 발견하게 되었다. External Secrets는 Vault, AWS secret manager와 같이 secret 관리하는 Tool들과 Kubernetes secret을 CRD을 통해서 sync할 수 있게 해준다. 이 프로젝트는 kubebuilder를 사용하였는데, 소스코드를 보면서 어떻게 구현한 건지 자세히 살펴보았다."/><meta name="twitter:image" content="https://jayground8.github.iosocial-banner.png"/><link rel="canonical" href="https://jayground8.github.io/blog/20230730-k8s-controller-external-secrets"/><meta property="article:published_time" content="2023-07-30T00:00:00.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jayground8.github.io/blog/20230730-k8s-controller-external-secrets"
  },
  "headline": "오픈소스 Kubernetes External Secrets 살펴보기",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://jayground8.github.iosocial-banner.png"
    }
  ],
  "datePublished": "2023-07-30T00:00:00.000Z",
  "dateModified": "2023-07-30T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jay"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Jay",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jayground8.github.ioplayground.png"
    }
  },
  "description": "CRD와 Custom Controller를 사용하는 프로젝트에 대해서 더 알고 싶은 상황에서, External Secrets이라는 프로젝트를 발견하게 되었다. External Secrets는 Vault, AWS secret manager와 같이 secret 관리하는 Tool들과 Kubernetes secret을 CRD을 통해서 sync할 수 있게 해준다. 이 프로젝트는 kubebuilder를 사용하였는데, 소스코드를 보면서 어떻게 구현한 건지 자세히 살펴보았다."
}</script><meta name="next-head-count" content="24"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preload" href="/_next/static/css/414f98a58444a4f1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/414f98a58444a4f1.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-690364db8bfb1f01.js" defer=""></script><script src="/_next/static/chunks/main-eea1c213342d95c3.js" defer=""></script><script src="/_next/static/chunks/pages/_app-aa4f07b10a06d034.js" defer=""></script><script src="/_next/static/chunks/675-70b09cbf0a5309ea.js" defer=""></script><script src="/_next/static/chunks/410-35c4fb535edd9439.js" defer=""></script><script src="/_next/static/chunks/712-376d32740a4ac813.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-8ab66ff6ebabec4c.js" defer=""></script><script src="/_next/static/IYyAeO79brX1AWpwTtfcO/_buildManifest.js" defer=""></script><script src="/_next/static/IYyAeO79brX1AWpwTtfcO/_ssgManifest.js" defer=""></script><script src="/_next/static/IYyAeO79brX1AWpwTtfcO/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="Jayground8" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" width="53.87" height="43.61" viewBox="0 0 512 512" class="fill-black dark:fill-white"><path d="M368.4 17c-8.8 1.3-18.3 5-25.3 9.9-3.8 2.5-22.6 16.1-41.9 30.1-37.1 26.9-38.6 28.3-36.3 33.9 1.7 4 4.9 5.1 14.6 5.1h8.5v128h-17.9c-18.2 0-22.2.6-27.3 4.2l-2.8 1.9V116.9l2.5-2.4c1.5-1.6 3.6-2.5 5.5-2.5s4 .9 5.5 2.5l2.5 2.4v42c0 29.1.3 42.8 1.1 44.5 2.6 5.7 11.5 5.5 13.9-.3.7-1.9 1-15.6.8-46.2-.3-40.1-.4-43.7-2.2-46.9-4.8-9-11.9-13.4-21.6-13.4-13.8 0-22.8 9.1-23.8 24.1l-.5 7.3h-31.5l-1.2-2.9c-1.6-3.9-6-5.8-9.9-4.1-1.6.6-3.5 2.5-4.1 4.1l-1.2 2.9h-63.6l-1.2-2.9c-2.5-6.2-11.5-6.2-14 0l-1.2 2.9H64.3l-.5-7.3c-1-15-10-24.1-23.8-24.1-9.7 0-16.8 4.4-21.6 13.4-1.8 3.3-1.9 7.5-2.2 75-.2 50 .1 72.3.8 74.1 2.1 5.1 8.6 6.3 12.5 2.4l2.5-2.4V116.9l2.5-2.4c3.2-3.3 7.8-3.3 11 0l2.5 2.4V448H32V284.9l-2.5-2.4c-3.8-3.9-10.2-2.7-12.4 2.2-1.6 3.4-1.6 171.2 0 174.6.6 1.4 2.2 3 3.6 3.6 1.6.7 15.6 1.1 43.7 1.1 38 0 41.5-.1 43.4-1.8 1.2-.9 33.4-50.5 71.7-110.2 38.3-59.7 70.5-109.3 71.7-110.3 1.8-1.5 4.3-1.7 19.4-1.7H288v16h-12.5c-13.1 0-16.6.8-18.3 4.4-2 4.5-138.5 216.2-140.4 217.9-1.9 1.6-5.6 1.7-47.9 1.7-31.9 0-46.6.3-48.3 1.1-5.7 2.6-5.5 11.5.3 13.9 1.9.7 16.7 1 50.1.8 46.4-.3 47.6-.3 51.5-2.5 2.2-1.1 5.1-3.3 6.5-4.7 1.3-1.5 10.1-14.7 19.6-29.4l17.1-26.7 18.4-.5c10.1-.3 19.1-.9 20-1.3.9-.5 2.1-1.9 2.8-3.3 1.5-3.4 1.5-35.4 0-38.8-1.1-2.3-4-4-8-4.8-1.3-.2 1.5-5.2 11.5-20.7l13.1-20.5.5 56.5c.3 31 .9 57.1 1.3 58 1.5 3 5.6 3.9 18.2 3.9H256v14c0 14.9.7 18.1 4.7 19.9 1.7.8 34.7 1.1 115.3 1.1s113.6-.3 115.3-1.1c1.4-.6 3-2.2 3.6-3.6 1.5-3.4 1.5-83.2 0-86.6-2.2-4.9-8.6-6.1-12.4-2.2l-2.5 2.4V480H272V272h208v107.1l2.5 2.4c3.8 3.9 10.2 2.7 12.4-2.2 1.5-3.4 1.5-115.2 0-118.6-1.8-3.9-5-4.7-18.4-4.7H464v-40.5c0-27.9-.3-41.2-1.1-42.9-2.6-5.5-11.2-5.5-13.8 0-.8 1.7-1.1 15-1.1 42.9V256h-24v-34.5c0-21.3-.4-36.4-1.1-39.7-3.6-17.3-19.3-32.9-36.7-36.7-16.2-3.4-31.4 1.1-43.3 12.9-7.4 7.3-11.2 13.9-13.4 23.2-1.8 7.9-2.1 50.3-.4 54.2 1.6 3.5 6.1 5.2 9.8 3.7 4.7-2 5.1-4.2 5.1-29.6 0-21.5.2-23.9 2.2-29.2C350.6 168.4 363 160 376 160s25.4 8.4 29.8 20.3c2.1 5.5 2.2 7.4 2.2 40.7v35H304V96h144v24.5c0 16 .4 25.3 1.1 26.9 2.6 5.5 11.2 5.5 13.8 0 .7-1.6 1.1-10.9 1.1-26.9V96h8.5c9.7 0 12.9-1.1 14.6-5.1 2.1-5.2.1-7.5-17.7-20.4C446.2 53.8 445 53 442.1 53c-4.1.1-7.5 3.5-7.5 7.7 0 4 2.2 6.3 14.8 15.3l4.8 3.5-39.1.3c-21.5.1-56.7.1-78.2 0l-39.1-.3 14.9-10.7c8.2-5.9 20.7-15.1 27.8-20.4 14.5-10.8 20.5-14 29.4-15.5 11.6-2.1 22.4 1.3 36.5 11.4 4.3 3.1 9 5.7 10.3 5.7 3.9 0 7.5-4.4 7.1-8.7-.3-3.3-1.1-4.4-7.8-9.6-15.3-11.8-32.3-17.1-47.6-14.7zM96 152v8H64v-16h32v8zm80 0v8h-64v-16h64v8zm48 0v8h-32v-16h32v8zM96 280v104h-4.5c-5.5 0-9 1.5-10.4 4.7-1.5 3.3-1.5 35.4 0 38.7 1.7 3.6 3.1 4 16.2 4.6l11.9.5-5.1 7.7L99 448H64V176h32v104zm80-27.8v76.3l-17.8 27.7-17.7 27.7-14.2.1H112V176h64v76.2zm48-37.3v38.9l-15.6 24.4c-8.6 13.3-15.8 24.5-16 24.7-.2.2-.4-28.2-.4-63.2V176h32v38.9zM256 369v76h-16V317.1l7.8-12c4.2-6.7 7.8-12.1 8-12.1.1 0 .2 34.2.2 76zm-129.1 34.7c-1.2 2.1-3.6 5.7-5.1 8l-2.9 4.3H96v-16h33.2l-2.3 3.7zM192 408v8h-15.1l3.7-5.8c2-3.1 4.4-6.7 5.2-8 .8-1.2 2.4-2.2 3.8-2.2 2.3 0 2.4.2 2.4 8z"></path><path d="M322.5 114.5c-1.6 1.5-2.5 3.6-2.5 5.5s.9 4 2.5 5.5c1.5 1.6 3.6 2.5 5.5 2.5s4-.9 5.5-2.5c1.6-1.5 2.5-3.6 2.5-5.5s-.9-4-2.5-5.5c-1.5-1.6-3.6-2.5-5.5-2.5s-4 .9-5.5 2.5zM418.5 114.5c-1.6 1.5-2.5 3.6-2.5 5.5s.9 4 2.5 5.5c1.5 1.6 3.6 2.5 5.5 2.5s4-.9 5.5-2.5c1.6-1.5 2.5-3.6 2.5-5.5s-.9-4-2.5-5.5c-1.5-1.6-3.6-2.5-5.5-2.5s-4 .9-5.5 2.5zM290.2 290.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6zM450.5 290.5c-5 4.9-1.5 13.5 5.5 13.5 4.1 0 8-3.9 8-8s-3.9-8-8-8c-1.9 0-4 .9-5.5 2.5zM358.1 322c-8.3 2.2-16.5 5.7-19.8 8.6-3.3 2.8-3.9 7.3-1.4 10.6 3.3 4.1 6.4 4.3 13.8.8 23.3-10.9 47.3-7 64.8 10.5 11.5 11.4 16.5 23.6 16.5 39.7 0 15.9-5.1 28.1-16.4 39.4C404.2 443 392.1 448 376 448s-28.1-5-39.5-16.5c-11-11.1-16.5-24.2-16.5-39.5.1-9.5 1.2-14.5 5.6-24.3 3.8-8.3 3.8-10.4.1-14.5-4.7-5.1-10.8-1.7-15.4 8.6-8.6 19.5-8.4 42.7.6 61.7 9.1 19.3 28.3 34.5 49.5 39 11.9 2.6 28.4 1.7 39.3-2.2 23.9-8.6 41.3-27.9 46.9-51.9 1.9-8.5 1.9-24.4-.1-33.1-5.9-25.5-26.7-46.6-52.5-53.3-10.1-2.6-25.8-2.6-35.9 0zM290.2 450.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6zM450.2 450.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6z"></path></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">Jayground8</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">블로그</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-0 left-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><div class="flex justify-end"><button type="button" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">블로그</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2023-07-30T00:00:00.000Z">2023년 7월 30일 일요일</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">오픈소스 Kubernetes External Secrets 살펴보기</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2738%27%20height=%2738%27/%3e"/></span><img alt="avatar" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="h-10 w-10 rounded-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="avatar" srcSet="https://jayground8.github.io/static/images/profile.png?w=48&amp;q=75 1x, https://jayground8.github.io/static/images/profile.png?w=96&amp;q=75 2x" src="https://jayground8.github.io/static/images/profile.png?w=96&amp;q=75" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="h-10 w-10 rounded-full" loading="lazy"/></noscript></span><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Jay</dd><dt class="sr-only">Twitter</dt><dd></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><p>우연히 <a target="_blank" rel="noopener noreferrer" href="https://github.com/external-secrets/external-secrets">Kubernetes External Secrets</a> 이름의 오픈소스 프로젝트를 알게 되었다. 이 프로젝트는 Valut, AWS Secret Manager 같은 tool을 single source of truth로 다수의 kubernetes cluster가 사용할 수 있도록 해준다. custom controller로 이러한 tool의 secret 정보를 Kubernetes secret과 Sync를 하게 된다. 이제 tool의 secret rotation 기능을 사용한다면 바뀐 secrets이 Kubernetes secrets에 적용되고, Deployment resource에 있는 secret 정보가 바뀌면서 다시 배포가 될 수 있겠다.</p><h2 id="getting-started로-파악해보기"><a href="#getting-started로-파악해보기" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Getting Started로 파악해보기</h2><p><a target="_blank" rel="noopener noreferrer" href="https://external-secrets.io/v0.8.5/introduction/getting-started/">External Secrests 문서의 Getting Started</a>에서 AWS SecretManager를 활용하는 예제를 보여준다. 먼저 <code>SecretStore</code> resource를 생성하게 된다.</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> external<span class="token punctuation">-</span>secrets.io/v1beta1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> SecretStore
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">name</span><span class="token punctuation">:</span> secretstore<span class="token punctuation">-</span>sample
</span><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">provider</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">aws</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">service</span><span class="token punctuation">:</span> SecretsManager
</span><span class="code-line">      <span class="token atrule key">region</span><span class="token punctuation">:</span> us<span class="token punctuation">-</span>east<span class="token punctuation">-</span><span class="token number">1</span>
</span><span class="code-line">      <span class="token atrule key">auth</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">secretRef</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token atrule key">accessKeyIDSecretRef</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token atrule key">name</span><span class="token punctuation">:</span> awssm<span class="token punctuation">-</span>secret
</span><span class="code-line">            <span class="token atrule key">key</span><span class="token punctuation">:</span> access<span class="token punctuation">-</span>key
</span><span class="code-line">          <span class="token atrule key">secretAccessKeySecretRef</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token atrule key">name</span><span class="token punctuation">:</span> awssm<span class="token punctuation">-</span>secret
</span><span class="code-line">            <span class="token atrule key">key</span><span class="token punctuation">:</span> secret<span class="token punctuation">-</span>access<span class="token punctuation">-</span>key
</span></code></pre></div><p>그리고 <code>ExternalSecret</code> 리소스를 만들게 되고, spec에서 <code>secretStoreRef</code>로 위에 만들어진 <code>SecretStore</code> 리소스 오브젝트를 가리키게 된다.</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> external<span class="token punctuation">-</span>secrets.io/v1beta1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> ExternalSecret
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">name</span><span class="token punctuation">:</span> example
</span><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">refreshInterval</span><span class="token punctuation">:</span> 1h
</span><span class="code-line">  <span class="token atrule key">secretStoreRef</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">name</span><span class="token punctuation">:</span> secretstore<span class="token punctuation">-</span>sample
</span><span class="code-line">    <span class="token atrule key">kind</span><span class="token punctuation">:</span> SecretStore
</span><span class="code-line">  <span class="token atrule key">target</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">name</span><span class="token punctuation">:</span> secret<span class="token punctuation">-</span>to<span class="token punctuation">-</span>be<span class="token punctuation">-</span>created
</span><span class="code-line">    <span class="token atrule key">creationPolicy</span><span class="token punctuation">:</span> Owner
</span><span class="code-line">  <span class="token atrule key">data</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token atrule key">secretKey</span><span class="token punctuation">:</span> secret<span class="token punctuation">-</span>key<span class="token punctuation">-</span>to<span class="token punctuation">-</span>be<span class="token punctuation">-</span>managed
</span><span class="code-line">      <span class="token atrule key">remoteRef</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">key</span><span class="token punctuation">:</span> provider<span class="token punctuation">-</span>key
</span><span class="code-line">        <span class="token atrule key">version</span><span class="token punctuation">:</span> provider<span class="token punctuation">-</span>key<span class="token punctuation">-</span>version
</span><span class="code-line">        <span class="token atrule key">property</span><span class="token punctuation">:</span> provider<span class="token punctuation">-</span>key<span class="token punctuation">-</span>property
</span><span class="code-line">  <span class="token atrule key">dataFrom</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token atrule key">extract</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">key</span><span class="token punctuation">:</span> remote<span class="token punctuation">-</span>key<span class="token punctuation">-</span>in<span class="token punctuation">-</span>the<span class="token punctuation">-</span>provider
</span></code></pre></div><p><code>createPolicy: Owner</code>로 설정했는데, <a target="_blank" rel="noopener noreferrer" href="https://external-secrets.io/v0.8.5/guides/ownership-deletion-policy/">External Secrets 문서</a>를 보면 아래와 같이 설명이 되어 있다. <code>Owner</code>로 설정을 하면 Kubernetes secret의 ownerReference를 설정하게 된다. 그리고 ExternalSecret custom resource가 삭제 될때 Kubernetes secret resource도 같이 삭제 된다.</p><blockquote><p>The External Secret Operator creates secret and sets the ownerReference field on the Secret. This secret is subject to garbage collection if the initial ExternalSecret is absent. If a secret with the same name already exists that is not owned by the controller it will result in a conflict. The operator will just error out, not claiming the ownership.</p></blockquote><h2 id="소스-코드로-이해하기"><a href="#소스-코드로-이해하기" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>소스 코드로 이해하기</h2><p>이제 소스코드를 확인해보자. 해당 프로젝트는 kubebuilder를 사용했고, <code>pkg/controllers</code>에서 <code>externalsecret_controller.go</code>를 찾을 수 있었다. 가장 먼저 봐야 할 것은 아래처럼 register package를 import하는 것이다.</p><p><code>externalsecret_controller.go</code></p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">(</span>
</span><span class="code-line">  <span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/register&quot;</span>
</span><span class="code-line"><span class="token punctuation">)</span>
</span></code></pre></div><p><code>register.go</code>를 확인해보면 아래처럼 다양한 provider들에 대해서 등록하는 package들이 import되고 있다.</p><p><code>register.go</code></p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">package</span> register
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">(</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/akeyless&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/alibaba&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/aws&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/azure/keyvault&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/conjur&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/delinea&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/doppler&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/fake&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/gcp/secretmanager&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/gitlab&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/ibm&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/keepersecurity&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/kubernetes&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/onepassword&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/oracle&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/scaleway&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/senhasegura&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/vault&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/webhook&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/yandex/certificatemanager&quot;</span>
</span><span class="code-line">	<span class="token boolean">_</span> <span class="token string">&quot;github.com/external-secrets/external-secrets/pkg/provider/yandex/lockbox&quot;</span>
</span><span class="code-line"><span class="token punctuation">)</span>
</span></code></pre></div><p>예제에서 SecretManager를 사용하고 있기 때문에, <code>aws</code> provider package를 살펴보자. <code>aws.go</code>를 보면 아래처럼 init 함수로 Provider 객체를 등록하고 있다.</p><p><code>pkg/provider/aws.go</code></p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	esv1beta1<span class="token punctuation">.</span><span class="token function">Register</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Provider<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>esv1beta1<span class="token punctuation">.</span>SecretStoreProvider<span class="token punctuation">{</span>
</span><span class="code-line">		AWS<span class="token punctuation">:</span> <span class="token operator">&amp;</span>esv1beta1<span class="token punctuation">.</span>AWSProvider<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">	<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>등록하는 로직은 아래처럼 map type에 Provider를 value로 설정하는 것이다. <code>builder</code>라는 map 데이터 구조에 provider를 저장하게 된다.</p><p><code>provider_scheme.go</code></p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">var</span> builder <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>Provider
</span><span class="code-line"><span class="token keyword">var</span> buildlock sync<span class="token punctuation">.</span>RWMutex
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	builder <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>Provider<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">func</span> <span class="token function">Register</span><span class="token punctuation">(</span>s Provider<span class="token punctuation">,</span> storeSpec <span class="token operator">*</span>SecretStoreProvider<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	storeName<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">getProviderName</span><span class="token punctuation">(</span>storeSpec<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token function">panic</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;store error registering schema: %s&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	buildlock<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">defer</span> buildlock<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token boolean">_</span><span class="token punctuation">,</span> exists <span class="token operator">:=</span> builder<span class="token punctuation">[</span>storeName<span class="token punctuation">]</span>
</span><span class="code-line">	<span class="token keyword">if</span> exists <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token function">panic</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;store %q already registered&quot;</span><span class="token punctuation">,</span> storeName<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	builder<span class="token punctuation">[</span>storeName<span class="token punctuation">]</span> <span class="token operator">=</span> s
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>이제 ExternalSecret Controller의 중요 로직들을 정리해보면 아래와 같다.</p><p><code>externalsecret_controller.go</code></p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Reconciler<span class="token punctuation">)</span> <span class="token function">Reconcile</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> req ctrl<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">(</span>ctrl<span class="token punctuation">.</span>Result<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token comment">// go-client로 Event로 전달된 ExternalSecret의 값을 가져온다.</span>
</span><span class="code-line">  <span class="token keyword">var</span> externalSecret esv1beta1<span class="token punctuation">.</span>ExternalSecret
</span><span class="code-line">	err <span class="token operator">:=</span> r<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> req<span class="token punctuation">.</span>NamespacedName<span class="token punctuation">,</span> <span class="token operator">&amp;</span>externalSecret<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// spec:</span>
</span><span class="code-line">  <span class="token comment">//  refreshInterval: 1h</span>
</span><span class="code-line">  refreshInt <span class="token operator">:=</span> r<span class="token punctuation">.</span>RequeueInterval
</span><span class="code-line">	<span class="token keyword">if</span> externalSecret<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>RefreshInterval <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		refreshInt <span class="token operator">=</span> externalSecret<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>RefreshInterval<span class="token punctuation">.</span>Duration
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// spec:</span>
</span><span class="code-line">  <span class="token comment">//  target:</span>
</span><span class="code-line">  <span class="token comment">//    name: secret-to-be-created</span>
</span><span class="code-line">  secretName <span class="token operator">:=</span> externalSecret<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>Target<span class="token punctuation">.</span>Name
</span><span class="code-line">	<span class="token keyword">if</span> secretName <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-line">		secretName <span class="token operator">=</span> externalSecret<span class="token punctuation">.</span>ObjectMeta<span class="token punctuation">.</span>Name
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// ExternalSecret의 spec에서 가져온 name과 namespace로</span>
</span><span class="code-line">  <span class="token comment">// Kubernetest Secret resource를 가져옴</span>
</span><span class="code-line">  <span class="token keyword">var</span> existingSecret v1<span class="token punctuation">.</span>Secret
</span><span class="code-line">	err <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> types<span class="token punctuation">.</span>NamespacedName<span class="token punctuation">{</span>
</span><span class="code-line">		Name<span class="token punctuation">:</span>      secretName<span class="token punctuation">,</span>
</span><span class="code-line">		Namespace<span class="token punctuation">:</span> externalSecret<span class="token punctuation">.</span>Namespace<span class="token punctuation">,</span>
</span><span class="code-line">	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>existingSecret<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>apierrors<span class="token punctuation">.</span><span class="token function">IsNotFound</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">		log<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> errGetExistingSecret<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// defer로 마지막에 ExternalSecret Status 정보를 마지막에 업데이트 한다.</span>
</span><span class="code-line">  p <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">MergeFrom</span><span class="token punctuation">(</span>externalSecret<span class="token punctuation">.</span><span class="token function">DeepCopy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">		err <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">Status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Patch</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>externalSecret<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">			log<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> errPatchStatus<span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token punctuation">}</span>
</span><span class="code-line">	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// Secret Manger로부터 secret data를 가져온다.</span>
</span><span class="code-line">  dataMap<span class="token punctuation">,</span> err <span class="token operator">:=</span> r<span class="token punctuation">.</span><span class="token function">getProviderSecretData</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>externalSecret<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// 예제에서는 deletionPolicy를 정의하지 않았지만</span>
</span><span class="code-line">  <span class="token comment">// default는 Retain으로 Secret manager에 해당 데이터가 없더라도</span>
</span><span class="code-line">  <span class="token comment">// Kubernetes secret은 그냥 유지한다.</span>
</span><span class="code-line">  <span class="token comment">// Delete로 설정하면 Secret manager에는 없는데, Kubernetes secret은 존재하면</span>
</span><span class="code-line">  <span class="token comment">// 이 resource를 삭제 할수 있다.</span>
</span><span class="code-line">  <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>dataMap<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">switch</span> externalSecret<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>Target<span class="token punctuation">.</span>DeletionPolicy <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token comment">// delete secret and return early.</span>
</span><span class="code-line">		<span class="token keyword">case</span> esv1beta1<span class="token punctuation">.</span>DeletionPolicyDelete<span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">case</span> esv1beta1<span class="token punctuation">.</span>DeletionPolicyMerge<span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">case</span> esv1beta1<span class="token punctuation">.</span>DeletionPolicyRetain<span class="token punctuation">:</span>
</span><span class="code-line">			<span class="token keyword">return</span> ctrl<span class="token punctuation">.</span>Result<span class="token punctuation">{</span>RequeueAfter<span class="token punctuation">:</span> refreshInt<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line">		<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// spec:</span>
</span><span class="code-line">  <span class="token comment">// target:</span>
</span><span class="code-line">  <span class="token comment">//   creationPolicy: Owner</span>
</span><span class="code-line">  <span class="token comment">// default로 createOrUpdate 함수가 호출된다.</span>
</span><span class="code-line">  <span class="token comment">// Kubernetes secret이 없으면 생성하고, 있으면 업데이트 하게 된다.</span>
</span><span class="code-line">  <span class="token keyword">switch</span> externalSecret<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>Target<span class="token punctuation">.</span>CreationPolicy <span class="token punctuation">{</span> <span class="token comment">//nolint</span>
</span><span class="code-line">	<span class="token keyword">case</span> esv1beta1<span class="token punctuation">.</span>CreatePolicyMerge<span class="token punctuation">:</span>
</span><span class="code-line">		err <span class="token operator">=</span> <span class="token function">patchSecret</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> r<span class="token punctuation">.</span>Client<span class="token punctuation">,</span> r<span class="token punctuation">.</span>Scheme<span class="token punctuation">,</span> secret<span class="token punctuation">,</span> mutationFunc<span class="token punctuation">,</span> externalSecret<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">			externalSecret<span class="token punctuation">.</span>Status<span class="token punctuation">.</span>Binding <span class="token operator">=</span> v1<span class="token punctuation">.</span>LocalObjectReference<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> secret<span class="token punctuation">.</span>Name<span class="token punctuation">}</span>
</span><span class="code-line">		<span class="token punctuation">}</span>
</span><span class="code-line">	<span class="token keyword">case</span> esv1beta1<span class="token punctuation">.</span>CreatePolicyNone<span class="token punctuation">:</span>
</span><span class="code-line">		log<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;secret creation skipped due to creationPolicy=None&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">		err <span class="token operator">=</span> <span class="token boolean">nil</span>
</span><span class="code-line">	<span class="token keyword">default</span><span class="token punctuation">:</span>
</span><span class="code-line">		err <span class="token operator">=</span> <span class="token function">createOrUpdate</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> r<span class="token punctuation">.</span>Client<span class="token punctuation">,</span> secret<span class="token punctuation">,</span> mutationFunc<span class="token punctuation">,</span> externalSecret<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">			externalSecret<span class="token punctuation">.</span>Status<span class="token punctuation">.</span>Binding <span class="token operator">=</span> v1<span class="token punctuation">.</span>LocalObjectReference<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> secret<span class="token punctuation">.</span>Name<span class="token punctuation">}</span>
</span><span class="code-line">		<span class="token punctuation">}</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// 마지막으로 이제 CRD에서 정의된 refreshInterval(1h) 뒤에</span>
</span><span class="code-line">  <span class="token comment">// 다시 reconcilation이 된다.</span>
</span><span class="code-line">  <span class="token keyword">return</span> ctrl<span class="token punctuation">.</span>Result<span class="token punctuation">{</span>
</span><span class="code-line">		RequeueAfter<span class="token punctuation">:</span> refreshInt<span class="token punctuation">,</span>
</span><span class="code-line">	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>Secret manager로부터 데이터를 가져오는 <code>getProviderSecretData</code> 함수는 이제 Provider specific한 로직을 수행하게 된다. External Secret에서는 Secret Manager로 말고도 다른 Secret management tool 연동을 제공하기 때문에 이부분에서 SecretStore에 정의된 provider에 따라서 다른 로직을 수행하게 된다.</p><p>예제에서는 아래처럼 dataForm의 Array에 extract로 정의가 되어 있었다.</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> external<span class="token punctuation">-</span>secrets.io/v1beta1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> ExternalSecret
</span><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">dataFrom</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token atrule key">extract</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">key</span><span class="token punctuation">:</span> remote<span class="token punctuation">-</span>key<span class="token punctuation">-</span>in<span class="token punctuation">-</span>the<span class="token punctuation">-</span>provider
</span></code></pre></div><p>이 설정에 따라서 다른 로직을 수행하는데, switch문에 의해서 extract로 설정된 경우에는 <code>handleExtractSecrets</code>이 호출된다.</p><p><code>externalsecret_controller_secret.go</code></p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Reconciler<span class="token punctuation">)</span> <span class="token function">getProviderSecretData</span><span class="token punctuation">(</span><span class="token operator">...</span>생략<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">for</span> i<span class="token punctuation">,</span> remoteRef <span class="token operator">:=</span> <span class="token keyword">range</span> externalSecret<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>DataFrom <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">var</span> secretMap <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span>
</span><span class="code-line">		<span class="token keyword">var</span> err <span class="token builtin">error</span>
</span><span class="code-line">
</span><span class="code-line">		<span class="token keyword">if</span> remoteRef<span class="token punctuation">.</span>Find <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">			secretMap<span class="token punctuation">,</span> err <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">handleFindAllSecrets</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> externalSecret<span class="token punctuation">,</span> remoteRef<span class="token punctuation">,</span> mgr<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> remoteRef<span class="token punctuation">.</span>Extract <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">			secretMap<span class="token punctuation">,</span> err <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">handleExtractSecrets</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> externalSecret<span class="token punctuation">,</span> remoteRef<span class="token punctuation">,</span> mgr<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> remoteRef<span class="token punctuation">.</span>SourceRef <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token operator">&amp;&amp;</span> remoteRef<span class="token punctuation">.</span>SourceRef<span class="token punctuation">.</span>GeneratorRef <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">			secretMap<span class="token punctuation">,</span> err <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">handleGenerateSecrets</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> externalSecret<span class="token punctuation">.</span>Namespace<span class="token punctuation">,</span> remoteRef<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>함수의 로직을 확인하면 <code>cmgr *secretstore.Manager</code>을 통해서 provider의 client를 가져온다. 이제 SecretsClient의 interface로 제공하는 <code>GetSecretMap</code>을 호출하고, 이 함수에는 SecretStore에서 설정된 provider에 대한 로직이 구현되어 있다. 우리는 예제에서 Secret Manager를 사용하고 있기 때문에, Secret manager로부터 데이터를 가져오는 로직이 구현되어 있다.</p><p><code>externalsecret_controller_secret.go</code></p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Reconciler<span class="token punctuation">)</span> <span class="token function">handleExtractSecrets</span><span class="token punctuation">(</span><span class="token operator">...</span>생략<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  client<span class="token punctuation">,</span> err <span class="token operator">:=</span> cmgr<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> externalSecret<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>SecretStoreRef<span class="token punctuation">,</span> externalSecret<span class="token punctuation">.</span>Namespace<span class="token punctuation">,</span> remoteRef<span class="token punctuation">.</span>SourceRef<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  secretMap<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">GetSecretMap</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">*</span>remoteRef<span class="token punctuation">.</span>Extract<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span></code></pre></div><p><code>SecretStore</code>에서 정의한 provider에 맞게 SecretClient 객체를 생성하기 위해서는 아래와 같이 진행이 된다. ExternalSecret 리소스에서 secretStore에 대한 정보를 가지고 있다. 이 정보를 가지고 go-client로 <code>SecretStore</code> 리소스 정보를 가져온다.</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">refreshInterval</span><span class="token punctuation">:</span> 1h
</span><span class="code-line">  <span class="token atrule key">secretStoreRef</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">name</span><span class="token punctuation">:</span> secretstore<span class="token punctuation">-</span>sample
</span><span class="code-line">    <span class="token atrule key">kind</span><span class="token punctuation">:</span> SecretStore
</span></code></pre></div><p><code>client_manager.go</code></p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Manager<span class="token punctuation">)</span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token operator">...</span>생략<span class="token punctuation">)</span> <span class="token punctuation">(</span>esv1beta1<span class="token punctuation">.</span>SecretsClient<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  store<span class="token punctuation">,</span> err <span class="token operator">:=</span> m<span class="token punctuation">.</span><span class="token function">getStore</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>storeRef<span class="token punctuation">,</span> namespace<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token keyword">return</span> m<span class="token punctuation">.</span><span class="token function">GetFromStore</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> store<span class="token punctuation">,</span> namespace<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Manager<span class="token punctuation">)</span> <span class="token function">getStore</span><span class="token punctuation">(</span><span class="token operator">...</span>생략<span class="token punctuation">)</span> <span class="token punctuation">(</span>esv1beta1<span class="token punctuation">.</span>GenericStore<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  ref <span class="token operator">:=</span> types<span class="token punctuation">.</span>NamespacedName<span class="token punctuation">{</span>
</span><span class="code-line">		Name<span class="token punctuation">:</span> storeRef<span class="token punctuation">.</span>Name<span class="token punctuation">,</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  ref<span class="token punctuation">.</span>Namespace <span class="token operator">=</span> namespace
</span><span class="code-line">	<span class="token keyword">var</span> store esv1beta1<span class="token punctuation">.</span>SecretStore
</span><span class="code-line">	err <span class="token operator">:=</span> m<span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> ref<span class="token punctuation">,</span> <span class="token operator">&amp;</span>store<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token operator">&amp;</span>store<span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>그 다음에는 <code>SecretStore</code> 리소스 정보를 바탕으로 적합한 provider를 선택하게 된다. 그리고 이미 해당 provider client가 호출되어 map에 저장되어 있으면 다시 사용하고, 아니면 <code>NewClient</code>로 새로 생성하여 map에 다시 저장하게 된다.</p><p><code>client_manager.go</code></p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Manager<span class="token punctuation">)</span> <span class="token function">GetFromStore</span><span class="token punctuation">(</span><span class="token operator">...</span>생략<span class="token punctuation">)</span> <span class="token punctuation">(</span>esv1beta1<span class="token punctuation">.</span>SecretsClient<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  storeProvider<span class="token punctuation">,</span> err <span class="token operator">:=</span> esv1beta1<span class="token punctuation">.</span><span class="token function">GetProvider</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">	secretClient <span class="token operator">:=</span> m<span class="token punctuation">.</span><span class="token function">getStoredClient</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> storeProvider<span class="token punctuation">,</span> store<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> secretClient <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> secretClient<span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  secretClient<span class="token punctuation">,</span> err <span class="token operator">=</span> storeProvider<span class="token punctuation">.</span><span class="token function">NewClient</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> store<span class="token punctuation">,</span> m<span class="token punctuation">.</span>client<span class="token punctuation">,</span> namespace<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">	idx <span class="token operator">:=</span> <span class="token function">storeKey</span><span class="token punctuation">(</span>storeProvider<span class="token punctuation">)</span>
</span><span class="code-line">	m<span class="token punctuation">.</span>clientMap<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>clientVal<span class="token punctuation">{</span>
</span><span class="code-line">		client<span class="token punctuation">:</span> secretClient<span class="token punctuation">,</span>
</span><span class="code-line">		store<span class="token punctuation">:</span>  store<span class="token punctuation">,</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">return</span> secretClient<span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p><code>SecretStore</code>에 저장된 provider 이름으로 적합한 provider를 가져오는 것은 아래처럼 builder라는 map에서 이름으로 찾아오는 것이다. 우리는 맨 위에서 import한 package의 init 함수를 통해서 <code>builder</code>에 지원되는 provider 객체를 다 등록하였다. 여기서는 이렇게 정의된 map에서 이름으로 가져오는 작업을 하게 된다.</p><p><code>provider_schema.go</code></p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">func</span> <span class="token function">GetProvider</span><span class="token punctuation">(</span>s GenericStore<span class="token punctuation">)</span> <span class="token punctuation">(</span>Provider<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  buildlock<span class="token punctuation">.</span><span class="token function">RLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	f<span class="token punctuation">,</span> ok <span class="token operator">:=</span> builder<span class="token punctuation">[</span>storeName<span class="token punctuation">]</span>
</span><span class="code-line">	buildlock<span class="token punctuation">.</span><span class="token function">RUnlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">return</span> f<span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p><code>pkg/provider</code>경로에는 지원되는 다양한 provider에 관한 로직들이 구현되어 있다. 최종적으로 <code>GetSecretMap</code>이 호출되면 <code>Secret Manager</code>의 구현 로직에 의해서 데이터를 가져오게 된다.</p><p><code>secretmanager.go</code></p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>sm <span class="token operator">*</span>SecretsManager<span class="token punctuation">)</span> <span class="token function">GetSecretMap</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> ref esv1beta1<span class="token punctuation">.</span>ExternalSecretDataRemoteRef<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	log<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;fetching secret map&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;key&quot;</span><span class="token punctuation">,</span> ref<span class="token punctuation">.</span>Key<span class="token punctuation">)</span>
</span><span class="code-line">	data<span class="token punctuation">,</span> err <span class="token operator">:=</span> sm<span class="token punctuation">.</span><span class="token function">GetSecret</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> ref<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">	kv <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>json<span class="token punctuation">.</span>RawMessage<span class="token punctuation">)</span>
</span><span class="code-line">	err <span class="token operator">=</span> json<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token operator">&amp;</span>kv<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;unable to unmarshal secret %s: %w&quot;</span><span class="token punctuation">,</span> ref<span class="token punctuation">.</span>Key<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">	secretData <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> kv <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">var</span> strVal <span class="token builtin">string</span>
</span><span class="code-line">		err <span class="token operator">=</span> json<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token operator">&amp;</span>strVal<span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">			secretData<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>strVal<span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
</span><span class="code-line">			secretData<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> v
</span><span class="code-line">		<span class="token punctuation">}</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">	<span class="token keyword">return</span> secretData<span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h3 id="secretstore에-요청을-최소화"><a href="#secretstore에-요청을-최소화" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>SecretStore에 요청을 최소화</h3><p>이렇게 Valut, AWS Secret Manager에서 secret을 관리하고, 그것이 변경되었을 때 kubernetes의 secret를 External Secret의 CRD로 업데이트해줄 수 있다. 이제 ExternalSecret kind에 대해서 Event가 생기면 그것에 대해서 Reconciler를 호출하게 된다. 그리고 기본적으로 <code>refreshInterval</code>에 설정된 시간뒤에 다시 work queue에 추가하여 다시 reconcile이 호출되도록 한다. 그러면 ExeternalSecret 생성을 할 때 <code>refreshInterval</code>마다 queue에 넣는 loop가 생기고, ExeternalSecret을 수정하면 다른 loop가 생기는 것이 아닌가? 🤔</p><p>(created event A) -&gt; (event A after refreshInterval) -&gt; (updated event B) -&gt; (event A after refreshInterval) -&gt; (event B after refreshInterval)</p><p>그래서 <code>shouldRefresh</code> 함수를 통해서 불필요하게 SecretStore에서 데이터를 가지고 오지 않는 것 같다.</p><p><code>externalsecret_controller.go</code></p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Reconciler<span class="token punctuation">)</span> <span class="token function">Reconcile</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> req ctrl<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">(</span>ctrl<span class="token punctuation">.</span>Result<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token comment">// refresh should be skipped if</span>
</span><span class="code-line">	<span class="token comment">// 1. resource generation hasn&#x27;t changed</span>
</span><span class="code-line">	<span class="token comment">// 2. refresh interval is 0</span>
</span><span class="code-line">	<span class="token comment">// 3. if we&#x27;re still within refresh-interval</span>
</span><span class="code-line">	<span class="token keyword">if</span> <span class="token operator">!</span><span class="token function">shouldRefresh</span><span class="token punctuation">(</span>externalSecret<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isSecretValid</span><span class="token punctuation">(</span>existingSecret<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">		log<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;skipping refresh&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;rv&quot;</span><span class="token punctuation">,</span> <span class="token function">getResourceVersion</span><span class="token punctuation">(</span>externalSecret<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token keyword">return</span> ctrl<span class="token punctuation">.</span>Result<span class="token punctuation">{</span>RequeueAfter<span class="token punctuation">:</span> refreshInt<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p><code>shouldRefresh</code> 함수를 통해서 아래와 같이 작동한다.</p><ol><li>이전 refresh를 해서 SecretStore에서 data를 가져오고 status에 저장된 resource version이 현재 resource version과 다르면 refresh를 해야 한다. (ExternalSecret resource를 업데이트했을 때)</li><li>이전에 Synced가 되었고, refreshInterval이 0으로 설정되어 있으면 refresh를 안 한다.</li><li>Resource의 status.RefreshTime이 0이면 refresh를 해야 한다.</li><li>마지막으로 status.RefreshTime이 아직 refreshInterval만큼 경과하지 않았으면 refresh를 안 한다.</li></ol><p>마지막 4번째가 work queue에 enqueue를 계속 하는 loop가 두 개 이상 생길 수 있기 때문에, status.RefreshTime을 체크해서 다시 SecretStore에서 가져오지 않는 것으로 해결한 것인가?</p><p><code>externalsecret_controller.go</code></p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">func</span> <span class="token function">shouldRefresh</span><span class="token punctuation">(</span>es esv1beta1<span class="token punctuation">.</span>ExternalSecret<span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token comment">// refresh if resource version changed</span>
</span><span class="code-line">	<span class="token keyword">if</span> es<span class="token punctuation">.</span>Status<span class="token punctuation">.</span>SyncedResourceVersion <span class="token operator">!=</span> <span class="token function">getResourceVersion</span><span class="token punctuation">(</span>es<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">true</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">// skip refresh if refresh interval is 0</span>
</span><span class="code-line">	<span class="token keyword">if</span> es<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>RefreshInterval<span class="token punctuation">.</span>Duration <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> es<span class="token punctuation">.</span>Status<span class="token punctuation">.</span>SyncedResourceVersion <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">false</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">	<span class="token keyword">if</span> es<span class="token punctuation">.</span>Status<span class="token punctuation">.</span>RefreshTime<span class="token punctuation">.</span><span class="token function">IsZero</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">true</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">	<span class="token keyword">return</span> es<span class="token punctuation">.</span>Status<span class="token punctuation">.</span>RefreshTime<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>es<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>RefreshInterval<span class="token punctuation">.</span>Duration<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Before</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h3 id="immutable-secret"><a href="#immutable-secret" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Immutable Secret</h3><p>코드를 보다 보니 ExternalSecret의 spec에서 Immutable 설정을 하면, Kubernetes secret resource를 immutable true로 생성한다. 그리고 다음 reconcile에서 이미 한번 sync한 secret에 대해서는 더 이상 reconcile을 하지 않는 것으로 Immutable을 적용하고 있다.</p><p><code>externalsecret_controller.go</code></p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">if</span> <span class="token operator">!</span><span class="token function">shouldReconcile</span><span class="token punctuation">(</span>externalSecret<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  log<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;stopping reconciling&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;rv&quot;</span><span class="token punctuation">,</span> <span class="token function">getResourceVersion</span><span class="token punctuation">(</span>externalSecret<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token keyword">return</span> ctrl<span class="token punctuation">.</span>Result<span class="token punctuation">{</span>
</span><span class="code-line">    RequeueAfter<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
</span><span class="code-line">    Requeue<span class="token punctuation">:</span>      <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">secret <span class="token operator">:=</span> <span class="token operator">&amp;</span>v1<span class="token punctuation">.</span>Secret<span class="token punctuation">{</span>
</span><span class="code-line">		ObjectMeta<span class="token punctuation">:</span> metav1<span class="token punctuation">.</span>ObjectMeta<span class="token punctuation">{</span>
</span><span class="code-line">			Name<span class="token punctuation">:</span>      secretName<span class="token punctuation">,</span>
</span><span class="code-line">			Namespace<span class="token punctuation">:</span> externalSecret<span class="token punctuation">.</span>Namespace<span class="token punctuation">,</span>
</span><span class="code-line">		<span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">		Immutable<span class="token punctuation">:</span> <span class="token operator">&amp;</span>externalSecret<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>Target<span class="token punctuation">.</span>Immutable<span class="token punctuation">,</span>
</span><span class="code-line">		Data<span class="token punctuation">:</span>      <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span></code></pre></div><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">func</span> <span class="token function">shouldReconcile</span><span class="token punctuation">(</span>es esv1beta1<span class="token punctuation">.</span>ExternalSecret<span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token keyword">if</span> es<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>Target<span class="token punctuation">.</span>Immutable <span class="token operator">&amp;&amp;</span> <span class="token function">hasSyncedCondition</span><span class="token punctuation">(</span>es<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">false</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token boolean">true</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> v1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> Secret
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span> <span class="token punctuation">...</span>
</span><span class="code-line"><span class="token atrule key">data</span><span class="token punctuation">:</span> <span class="token punctuation">...</span>
</span><span class="code-line"><span class="token atrule key">immutable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span></code></pre></div><h3 id="ownerreferces"><a href="#ownerreferces" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>OwnerReferces</h3><p>소스코드를 보기 전에 CRD에서 <code>CreationPolicy</code>의 Owner 설정이 어떤 역할을 하는지 살펴보았다. 이부분은 아래처럼 CreationPolicy가 <code>Owner</code>이면, Metadata의 OwnerReferce를 설정하게 됩니다.</p><p><code>externalsecret_controller.go</code></p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line">mutationFunc <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">if</span> externalSecret<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>Target<span class="token punctuation">.</span>CreationPolicy <span class="token operator">==</span> esv1beta1<span class="token punctuation">.</span>CreatePolicyOwner <span class="token punctuation">{</span>
</span><span class="code-line">			err <span class="token operator">=</span> controllerutil<span class="token punctuation">.</span><span class="token function">SetControllerReference</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>externalSecret<span class="token punctuation">,</span> <span class="token operator">&amp;</span>secret<span class="token punctuation">.</span>ObjectMeta<span class="token punctuation">,</span> r<span class="token punctuation">.</span>Scheme<span class="token punctuation">)</span>
</span><span class="code-line">			<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">				<span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span>errSetCtrlReference<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
</span><span class="code-line">			<span class="token punctuation">}</span>
</span><span class="code-line">		<span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p><code>controllerutil.go</code></p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">func</span> <span class="token function">SetControllerReference</span><span class="token punctuation">(</span>owner<span class="token punctuation">,</span> controlled metav1<span class="token punctuation">.</span>Object<span class="token punctuation">,</span> scheme <span class="token operator">*</span>runtime<span class="token punctuation">.</span>Scheme<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
</span><span class="code-line">	ref <span class="token operator">:=</span> metav1<span class="token punctuation">.</span>OwnerReference<span class="token punctuation">{</span>
</span><span class="code-line">		APIVersion<span class="token punctuation">:</span>         gvk<span class="token punctuation">.</span><span class="token function">GroupVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">		Kind<span class="token punctuation">:</span>               gvk<span class="token punctuation">.</span>Kind<span class="token punctuation">,</span>
</span><span class="code-line">		Name<span class="token punctuation">:</span>               owner<span class="token punctuation">.</span><span class="token function">GetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">		UID<span class="token punctuation">:</span>                owner<span class="token punctuation">.</span><span class="token function">GetUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">		BlockOwnerDeletion<span class="token punctuation">:</span> pointer<span class="token punctuation">.</span><span class="token function">Bool</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">		Controller<span class="token punctuation">:</span>         pointer<span class="token punctuation">.</span><span class="token function">Bool</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h3 id="validator"><a href="#validator" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Validator</h3><p>calico에서는 calico apiserver를 통해서 kubectl로 resource를 생성할 때, defaulting과 validation을 할 수가 있다. 아니면 calicoctl command tool을 통해서 calico apiserver 없이 resource를 생성할 때 동일한 defaulting과 validation을 할수가 있다. <a target="_blank" rel="noopener noreferrer" href="https://book.kubebuilder.io/cronjob-tutorial/webhook-implementation.html">kubebuilder에서 defaulting/validating webhook을 적용</a>하는 것을 살펴보면, External Secret에서는 <code>apis/externalsecrets</code>안에 <code>externalsecret_validator.go</code>로 정의되어 있을 것을 볼 수 있다. <code>CREATE</code>, <code>UPDATE</code> 하는 경우에는 <code>validateExternalSecret</code> 함수를 호출하여 validating을 하고 있다.</p><p><code>externalsecret_validator.go</code></p><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>esv <span class="token operator">*</span>ExternalSecretValidator<span class="token punctuation">)</span> <span class="token function">ValidateCreate</span><span class="token punctuation">(</span><span class="token boolean">_</span> context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> obj runtime<span class="token punctuation">.</span>Object<span class="token punctuation">)</span> <span class="token punctuation">(</span>admission<span class="token punctuation">.</span>Warnings<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token function">validateExternalSecret</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>esv <span class="token operator">*</span>ExternalSecretValidator<span class="token punctuation">)</span> <span class="token function">ValidateUpdate</span><span class="token punctuation">(</span><span class="token boolean">_</span> context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> <span class="token boolean">_</span><span class="token punctuation">,</span> newObj runtime<span class="token punctuation">.</span>Object<span class="token punctuation">)</span> <span class="token punctuation">(</span>admission<span class="token punctuation">.</span>Warnings<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token function">validateExternalSecret</span><span class="token punctuation">(</span>newObj<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>esv <span class="token operator">*</span>ExternalSecretValidator<span class="token punctuation">)</span> <span class="token function">ValidateDelete</span><span class="token punctuation">(</span><span class="token boolean">_</span> context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> <span class="token boolean">_</span> runtime<span class="token punctuation">.</span>Object<span class="token punctuation">)</span> <span class="token punctuation">(</span>admission<span class="token punctuation">.</span>Warnings<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">func</span> <span class="token function">validateExternalSecret</span><span class="token punctuation">(</span>obj runtime<span class="token punctuation">.</span>Object<span class="token punctuation">)</span> <span class="token punctuation">(</span>admission<span class="token punctuation">.</span>Warnings<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	es<span class="token punctuation">,</span> ok <span class="token operator">:=</span> obj<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>ExternalSecret<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> <span class="token operator">!</span>ok <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;unexpected type&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">if</span> <span class="token punctuation">(</span>es<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>Target<span class="token punctuation">.</span>DeletionPolicy <span class="token operator">==</span> DeletionPolicyDelete <span class="token operator">&amp;&amp;</span> es<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>Target<span class="token punctuation">.</span>CreationPolicy <span class="token operator">==</span> CreatePolicyMerge<span class="token punctuation">)</span> <span class="token operator">||</span>
</span><span class="code-line">		<span class="token punctuation">(</span>es<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>Target<span class="token punctuation">.</span>DeletionPolicy <span class="token operator">==</span> DeletionPolicyDelete <span class="token operator">&amp;&amp;</span> es<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>Target<span class="token punctuation">.</span>CreationPolicy <span class="token operator">==</span> CreatePolicyNone<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;deletionPolicy=Delete must not be used when the controller doesn&#x27;t own the secret. Please set creationPolcy=Owner&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">if</span> es<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>Target<span class="token punctuation">.</span>DeletionPolicy <span class="token operator">==</span> DeletionPolicyMerge <span class="token operator">&amp;&amp;</span> es<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>Target<span class="token punctuation">.</span>CreationPolicy <span class="token operator">==</span> CreatePolicyNone <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;deletionPolicy=Merge must not be used with creationPolcy=None. There is no Secret to merge with&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> ref <span class="token operator">:=</span> <span class="token keyword">range</span> es<span class="token punctuation">.</span>Spec<span class="token punctuation">.</span>DataFrom <span class="token punctuation">{</span>
</span><span class="code-line">		findOrExtract <span class="token operator">:=</span> ref<span class="token punctuation">.</span>Find <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token operator">||</span> ref<span class="token punctuation">.</span>Extract <span class="token operator">!=</span> <span class="token boolean">nil</span>
</span><span class="code-line">		<span class="token keyword">if</span> findOrExtract <span class="token operator">&amp;&amp;</span> ref<span class="token punctuation">.</span>SourceRef <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token operator">&amp;&amp;</span> ref<span class="token punctuation">.</span>SourceRef<span class="token punctuation">.</span>GeneratorRef <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">			<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;generator can not be used with find or extract&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token punctuation">}</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>이제 이렇게 validating을 추가하여 DeletionPolicy가 Delete로 CreatePolicy가 Merge로 동시에 설정되지 못하도록 하였다. ExternalSecret Kind에서 SecretStore를 ref값으로 가리키도록 하고 있다. 하지만 ExternalSecret의 <code>secretStoreRef</code>가 유효한 값인지는 validating에서 체크하지 않는다. 이부분에 대해서 추가하면 좋지 않을까?</p><h2 id="다른-기능"><a href="#다른-기능" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>다른 기능</h2><h3 id="pushsecret"><a href="#pushsecret" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>PushSecret</h3><p>이렇게 Valut, AWS Secret Manager에서 secret을 관리하고, 그것이 변경되었을 때 kubernetes의 secret를 External Secret의 CRD로 업데이트해줄 수 있다. <code>PushSecret</code>라는 kind는 이제 반대로 Kubernetes secret을 SecretStore에 업데이트하는 것을 할 수 있다.</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> external<span class="token punctuation">-</span>secrets.io/v1alpha1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> PushSecret
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">name</span><span class="token punctuation">:</span> pushsecret<span class="token punctuation">-</span>example <span class="token comment"># Customisable</span>
</span><span class="code-line">  <span class="token atrule key">namespace</span><span class="token punctuation">:</span> default <span class="token comment"># Same of the SecretStores</span>
</span><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">refreshInterval</span><span class="token punctuation">:</span> 10s
</span></code></pre></div><h3 id="generator"><a href="#generator" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Generator</h3><p>몇가지 secret value들을 생성할 수 있는 CRD를 제공한다. 예를 들어서 Vault Dynamic Secret를 이용해서 값을 생성하려면 아래처럼 별도의 Custom Resource를 만들고, External Secret에 <code>generatorRef</code>로 정의해준다.</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> generators.external<span class="token punctuation">-</span>secrets.io/v1alpha1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> VaultDynamicSecret
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">name</span><span class="token punctuation">:</span> <span class="token string">&#x27;pki-example&#x27;</span>
</span><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">path</span><span class="token punctuation">:</span> <span class="token string">&#x27;/pki/issue/example-dot-com&#x27;</span>
</span><span class="code-line">  <span class="token atrule key">method</span><span class="token punctuation">:</span> <span class="token string">&#x27;POST&#x27;</span>
</span><span class="code-line">  <span class="token atrule key">parameters</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">common_name</span><span class="token punctuation">:</span> <span class="token string">&#x27;localhost&#x27;</span>
</span><span class="code-line">    <span class="token atrule key">ip_sans</span><span class="token punctuation">:</span> <span class="token string">&#x27;127.0.0.1,127.0.0.11&#x27;</span>
</span><span class="code-line">  <span class="token atrule key">provider</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">server</span><span class="token punctuation">:</span> <span class="token string">&#x27;http://vault.default.svc.cluster.local:8200&#x27;</span>
</span><span class="code-line">    <span class="token atrule key">auth</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">kubernetes</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">mountPath</span><span class="token punctuation">:</span> <span class="token string">&#x27;kubernetes&#x27;</span>
</span><span class="code-line">        <span class="token atrule key">role</span><span class="token punctuation">:</span> <span class="token string">&#x27;external-secrets-operator&#x27;</span>
</span><span class="code-line">        <span class="token atrule key">serviceAccountRef</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token atrule key">name</span><span class="token punctuation">:</span> <span class="token string">&#x27;default&#x27;</span>
</span></code></pre></div><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> external<span class="token punctuation">-</span>secrets.io/v1beta1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> ExternalSecret
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">name</span><span class="token punctuation">:</span> <span class="token string">&#x27;pki-example-com&#x27;</span>
</span><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">refreshInterval</span><span class="token punctuation">:</span> <span class="token string">&#x27;768h&#x27;</span>
</span><span class="code-line">  <span class="token atrule key">target</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">name</span><span class="token punctuation">:</span> pki<span class="token punctuation">-</span>example<span class="token punctuation">-</span>com
</span><span class="code-line">  <span class="token atrule key">dataFrom</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token atrule key">sourceRef</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">generatorRef</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> generators.external<span class="token punctuation">-</span>secrets.io/v1alpha1
</span><span class="code-line">          <span class="token atrule key">kind</span><span class="token punctuation">:</span> VaultDynamicSecret
</span><span class="code-line">          <span class="token atrule key">name</span><span class="token punctuation">:</span> <span class="token string">&#x27;pki-example&#x27;</span>
</span></code></pre></div><h2 id="결론"><a href="#결론" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>결론</h2><p>외부 Secret management tool과 Kubernetes Secret의 Sync 맞추기 위해서 CRD와 Custom controller로 해결한 External Secrets 프로젝트의 코드를 살펴보게 되었다. CRD에 정의된 <code>refreshInterval</code> 시간마다 Polling 방식으로 외부 secret management tool의 값을 가져오고, Kubernetes secret 리소스와 sync를 하게 된다. 반복되는 loop을 만들기 위해서 로직이 정상적으로 수행하고 나면, work queue에 <code>refreshInterval</code>이 경과한 뒤 enqueue하도록 Result를 반환한다. 그리고 Custom Resource Status의 RefreshTime을 보고 아직 <code>refreshInterval</code>이 경과하지 않았으면 Secret management tool에 요청하지 않는다. 하지만 외부 Secret management tool와 sync가 빨리 되도록 <code>refreshInterval</code>을 짧게 설정하면 네트워크 요청이 더 빈번하게 발생하게 되고, ExternalSecret custom resource가 많아 질수록 이러한 네트워크 요청은 더 많아지게 될 것이다. 쿠버네티스에서 Informer를 통해서 처음에 List를 해오고 캐시와 Watch를 통해서 변화되는 Event에만 로직을 수행할 수 있는데, 이렇게 Polling 방식은 확장성에서 문제가 있다는 생각이 들었다.</p></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"></div><div id="comment"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/kubernetes">kubernetes</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/20230723-book-review-tiny-habit">행동 설계 7단계를 내 실생활에 적용해보자</a></div></div><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/20230731-what-have-you-solved">내가 해결한 문제 중 가장 어려운 문제는 무엇이었나?</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:jayground8@gmail.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/jayground8"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Jay</div><div> • </div><div>© 2024</div><div> • </div><a href="/">Jayground8</a></div><div class="mb-8 text-sm text-gray-500 dark:text-gray-400"><a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var r=Object.create;var t=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty;var l=a=\u003et(a,\"__esModule\",{value:!0});var m=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=\u003e{l(a);for(var c in s)t(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let n of d(s))!h.call(a,n)\u0026\u0026n!==\"default\"\u0026\u0026t(a,n,{get:()=\u003es[n],enumerable:!(c=p(s,n))||c.enumerable});return a},g=a=\u003ek(l(t(a!=null?r(u(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=m((v,i)=\u003e{i.exports=_jsx_runtime});var S={};N(S,{default:()=\u003eb,frontmatter:()=\u003ef});var e=g(o()),f={title:\"\\uC624\\uD508\\uC18C\\uC2A4 Kubernetes External Secrets \\uC0B4\\uD3B4\\uBCF4\\uAE30\",date:\"2023-07-30\",tags:[\"kubernetes\"],summary:\"CRD\\uC640 Custom Controller\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 \\uD504\\uB85C\\uC81D\\uD2B8\\uC5D0 \\uB300\\uD574\\uC11C \\uB354 \\uC54C\\uACE0 \\uC2F6\\uC740 \\uC0C1\\uD669\\uC5D0\\uC11C, External Secrets\\uC774\\uB77C\\uB294 \\uD504\\uB85C\\uC81D\\uD2B8\\uB97C \\uBC1C\\uACAC\\uD558\\uAC8C \\uB418\\uC5C8\\uB2E4. External Secrets\\uB294 Vault, AWS secret manager\\uC640 \\uAC19\\uC774 secret \\uAD00\\uB9AC\\uD558\\uB294 Tool\\uB4E4\\uACFC Kubernetes secret\\uC744 CRD\\uC744 \\uD1B5\\uD574\\uC11C sync\\uD560 \\uC218 \\uC788\\uAC8C \\uD574\\uC900\\uB2E4. \\uC774 \\uD504\\uB85C\\uC81D\\uD2B8\\uB294 kubebuilder\\uB97C \\uC0AC\\uC6A9\\uD558\\uC600\\uB294\\uB370, \\uC18C\\uC2A4\\uCF54\\uB4DC\\uB97C \\uBCF4\\uBA74\\uC11C \\uC5B4\\uB5BB\\uAC8C \\uAD6C\\uD604\\uD55C \\uAC74\\uC9C0 \\uC790\\uC138\\uD788 \\uC0B4\\uD3B4\\uBCF4\\uC558\\uB2E4.\"};function y(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({p:\"p\",a:\"a\",h2:\"h2\",span:\"span\",code:\"code\",pre:\"pre\",blockquote:\"blockquote\",h3:\"h3\",ol:\"ol\",li:\"li\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.p,{children:[\"\\uC6B0\\uC5F0\\uD788 \",(0,e.jsx)(n.a,{href:\"https://github.com/external-secrets/external-secrets\",children:\"Kubernetes External Secrets\"}),\" \\uC774\\uB984\\uC758 \\uC624\\uD508\\uC18C\\uC2A4 \\uD504\\uB85C\\uC81D\\uD2B8\\uB97C \\uC54C\\uAC8C \\uB418\\uC5C8\\uB2E4. \\uC774 \\uD504\\uB85C\\uC81D\\uD2B8\\uB294 Valut, AWS Secret Manager \\uAC19\\uC740 tool\\uC744 single source of truth\\uB85C \\uB2E4\\uC218\\uC758 kubernetes cluster\\uAC00 \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D \\uD574\\uC900\\uB2E4. custom controller\\uB85C \\uC774\\uB7EC\\uD55C tool\\uC758 secret \\uC815\\uBCF4\\uB97C Kubernetes secret\\uACFC Sync\\uB97C \\uD558\\uAC8C \\uB41C\\uB2E4. \\uC774\\uC81C tool\\uC758 secret rotation \\uAE30\\uB2A5\\uC744 \\uC0AC\\uC6A9\\uD55C\\uB2E4\\uBA74 \\uBC14\\uB010 secrets\\uC774 Kubernetes secrets\\uC5D0 \\uC801\\uC6A9\\uB418\\uACE0, Deployment resource\\uC5D0 \\uC788\\uB294 secret \\uC815\\uBCF4\\uAC00 \\uBC14\\uB00C\\uBA74\\uC11C \\uB2E4\\uC2DC \\uBC30\\uD3EC\\uAC00 \\uB420 \\uC218 \\uC788\\uACA0\\uB2E4.\"]}),(0,e.jsxs)(n.h2,{id:\"getting-started\\uB85C-\\uD30C\\uC545\\uD574\\uBCF4\\uAE30\",children:[(0,e.jsx)(n.a,{href:\"#getting-started\\uB85C-\\uD30C\\uC545\\uD574\\uBCF4\\uAE30\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Getting Started\\uB85C \\uD30C\\uC545\\uD574\\uBCF4\\uAE30\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://external-secrets.io/v0.8.5/introduction/getting-started/\",children:\"External Secrests \\uBB38\\uC11C\\uC758 Getting Started\"}),\"\\uC5D0\\uC11C AWS SecretManager\\uB97C \\uD65C\\uC6A9\\uD558\\uB294 \\uC608\\uC81C\\uB97C \\uBCF4\\uC5EC\\uC900\\uB2E4. \\uBA3C\\uC800 \",(0,e.jsx)(n.code,{children:\"SecretStore\"}),\" resource\\uB97C \\uC0DD\\uC131\\uD558\\uAC8C \\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" external\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`secrets.io/v1beta1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` SecretStore\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" secretstore\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`sample\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"provider\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"aws\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"service\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` SecretsManager\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"region\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" us\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"east\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"auth\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"secretRef\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"accessKeyIDSecretRef\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" awssm\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`secret\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" access\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`key\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"secretAccessKeySecretRef\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" awssm\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`secret\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" secret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"access\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`key\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB9AC\\uACE0 \",(0,e.jsx)(n.code,{children:\"ExternalSecret\"}),\" \\uB9AC\\uC18C\\uC2A4\\uB97C \\uB9CC\\uB4E4\\uAC8C \\uB418\\uACE0, spec\\uC5D0\\uC11C \",(0,e.jsx)(n.code,{children:\"secretStoreRef\"}),\"\\uB85C \\uC704\\uC5D0 \\uB9CC\\uB4E4\\uC5B4\\uC9C4 \",(0,e.jsx)(n.code,{children:\"SecretStore\"}),\" \\uB9AC\\uC18C\\uC2A4 \\uC624\\uBE0C\\uC81D\\uD2B8\\uB97C \\uAC00\\uB9AC\\uD0A4\\uAC8C \\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" external\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`secrets.io/v1beta1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` ExternalSecret\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` example\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"refreshInterval\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` 1h\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"secretStoreRef\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" secretstore\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`sample\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` SecretStore\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"target\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" secret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"to\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"be\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`created\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"creationPolicy\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Owner\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"data\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"secretKey\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" secret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"key\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"to\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"be\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`managed\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"remoteRef\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" provider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`key\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"version\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" provider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"key\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`version\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"property\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" provider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"key\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`property\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"dataFrom\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"extract\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" remote\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"key\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"in\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"the\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`provider\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"createPolicy: Owner\"}),\"\\uB85C \\uC124\\uC815\\uD588\\uB294\\uB370, \",(0,e.jsx)(n.a,{href:\"https://external-secrets.io/v0.8.5/guides/ownership-deletion-policy/\",children:\"External Secrets \\uBB38\\uC11C\"}),\"\\uB97C \\uBCF4\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC124\\uBA85\\uC774 \\uB418\\uC5B4 \\uC788\\uB2E4. \",(0,e.jsx)(n.code,{children:\"Owner\"}),\"\\uB85C \\uC124\\uC815\\uC744 \\uD558\\uBA74 Kubernetes secret\\uC758 ownerReference\\uB97C \\uC124\\uC815\\uD558\\uAC8C \\uB41C\\uB2E4. \\uADF8\\uB9AC\\uACE0 ExternalSecret custom resource\\uAC00 \\uC0AD\\uC81C \\uB420\\uB54C Kubernetes secret resource\\uB3C4 \\uAC19\\uC774 \\uC0AD\\uC81C \\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"The External Secret Operator creates secret and sets the ownerReference field on the Secret. This secret is subject to garbage collection if the initial ExternalSecret is absent. If a secret with the same name already exists that is not owned by the controller it will result in a conflict. The operator will just error out, not claiming the ownership.\"})}),(0,e.jsxs)(n.h2,{id:\"\\uC18C\\uC2A4-\\uCF54\\uB4DC\\uB85C-\\uC774\\uD574\\uD558\\uAE30\",children:[(0,e.jsx)(n.a,{href:\"#\\uC18C\\uC2A4-\\uCF54\\uB4DC\\uB85C-\\uC774\\uD574\\uD558\\uAE30\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uC18C\\uC2A4 \\uCF54\\uB4DC\\uB85C \\uC774\\uD574\\uD558\\uAE30\"]}),(0,e.jsxs)(n.p,{children:[\"\\uC774\\uC81C \\uC18C\\uC2A4\\uCF54\\uB4DC\\uB97C \\uD655\\uC778\\uD574\\uBCF4\\uC790. \\uD574\\uB2F9 \\uD504\\uB85C\\uC81D\\uD2B8\\uB294 kubebuilder\\uB97C \\uC0AC\\uC6A9\\uD588\\uACE0, \",(0,e.jsx)(n.code,{children:\"pkg/controllers\"}),\"\\uC5D0\\uC11C \",(0,e.jsx)(n.code,{children:\"externalsecret_controller.go\"}),\"\\uB97C \\uCC3E\\uC744 \\uC218 \\uC788\\uC5C8\\uB2E4. \\uAC00\\uC7A5 \\uBA3C\\uC800 \\uBD10\\uC57C \\uD560 \\uAC83\\uC740 \\uC544\\uB798\\uCC98\\uB7FC register package\\uB97C import\\uD558\\uB294 \\uAC83\\uC774\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"externalsecret_controller.go\"})}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"language-go code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/register\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"register.go\"}),\"\\uB97C \\uD655\\uC778\\uD574\\uBCF4\\uBA74 \\uC544\\uB798\\uCC98\\uB7FC \\uB2E4\\uC591\\uD55C provider\\uB4E4\\uC5D0 \\uB300\\uD574\\uC11C \\uB4F1\\uB85D\\uD558\\uB294 package\\uB4E4\\uC774 import\\uB418\\uACE0 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"register.go\"})}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"language-go code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"package\"}),` register\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/akeyless\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/alibaba\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/aws\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/azure/keyvault\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/conjur\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/delinea\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/doppler\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/fake\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/gcp/secretmanager\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/gitlab\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/ibm\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/keepersecurity\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/kubernetes\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/onepassword\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/oracle\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/scaleway\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/senhasegura\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/vault\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/webhook\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/yandex/certificatemanager\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"github.com/external-secrets/external-secrets/pkg/provider/yandex/lockbox\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uC608\\uC81C\\uC5D0\\uC11C SecretManager\\uB97C \\uC0AC\\uC6A9\\uD558\\uACE0 \\uC788\\uAE30 \\uB54C\\uBB38\\uC5D0, \",(0,e.jsx)(n.code,{children:\"aws\"}),\" provider package\\uB97C \\uC0B4\\uD3B4\\uBCF4\\uC790. \",(0,e.jsx)(n.code,{children:\"aws.go\"}),\"\\uB97C \\uBCF4\\uBA74 \\uC544\\uB798\\uCC98\\uB7FC init \\uD568\\uC218\\uB85C Provider \\uAC1D\\uCCB4\\uB97C \\uB4F1\\uB85D\\uD558\\uACE0 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"pkg/provider/aws.go\"})}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"language-go code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"init\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tesv1beta1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Register\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\"}),\"Provider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\"}),\"esv1beta1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"SecretStoreProvider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tAWS\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\"}),\"esv1beta1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"AWSProvider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uB4F1\\uB85D\\uD558\\uB294 \\uB85C\\uC9C1\\uC740 \\uC544\\uB798\\uCC98\\uB7FC map type\\uC5D0 Provider\\uB97C value\\uB85C \\uC124\\uC815\\uD558\\uB294 \\uAC83\\uC774\\uB2E4. \",(0,e.jsx)(n.code,{children:\"builder\"}),\"\\uB77C\\uB294 map \\uB370\\uC774\\uD130 \\uAD6C\\uC870\\uC5D0 provider\\uB97C \\uC800\\uC7A5\\uD558\\uAC8C \\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"provider_scheme.go\"})}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"language-go code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"var\"}),\" builder \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"map\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"string\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`Provider\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"var\"}),\" buildlock sync\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`RWMutex\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"init\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tbuilder \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"make\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"map\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"string\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\"Provider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"Register\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"s Provider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" storeSpec \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"SecretStoreProvider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tstoreName\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getProviderName\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"storeSpec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token function\",children:\"panic\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"fmt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Sprintf\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"store error registering schema: %s\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tbuildlock\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Lock\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"defer\"}),\" buildlock\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Unlock\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" exists \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" builder\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"storeName\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" exists \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token function\",children:\"panic\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"fmt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Sprintf\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"store %q already registered\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" storeName\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tbuilder\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"storeName\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),` s\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uC774\\uC81C ExternalSecret Controller\\uC758 \\uC911\\uC694 \\uB85C\\uC9C1\\uB4E4\\uC744 \\uC815\\uB9AC\\uD574\\uBCF4\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uB2E4.\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"externalsecret_controller.go\"})}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"language-go code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"r \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"Reconciler\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"Reconcile\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" req ctrl\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Request\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctrl\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// go-client\\uB85C Event\\uB85C \\uC804\\uB2EC\\uB41C ExternalSecret\\uC758 \\uAC12\\uC744 \\uAC00\\uC838\\uC628\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"var\"}),\" externalSecret esv1beta1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`ExternalSecret\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\terr \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" r\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Get\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" req\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"NamespacedName\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\"}),\"externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// spec:\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"//  refreshInterval: 1h\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  refreshInt \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" r\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`RequeueInterval\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"RefreshInterval \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\trefreshInt \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"RefreshInterval\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`Duration\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// spec:\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"//  target:\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"//    name: secret-to-be-created\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  secretName \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Target\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`Name\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" secretName \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tsecretName \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"ObjectMeta\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`Name\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// ExternalSecret\\uC758 spec\\uC5D0\\uC11C \\uAC00\\uC838\\uC628 name\\uACFC namespace\\uB85C\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Kubernetest Secret resource\\uB97C \\uAC00\\uC838\\uC634\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"var\"}),\" existingSecret v1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`Secret\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\terr \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" r\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Get\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" types\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"NamespacedName\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tName\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"      secretName\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tNamespace\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Namespace\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\"}),\"existingSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),\"apierrors\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"IsNotFound\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"err\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tlog\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"err\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" errGetExistingSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// defer\\uB85C \\uB9C8\\uC9C0\\uB9C9\\uC5D0 ExternalSecret Status \\uC815\\uBCF4\\uB97C \\uB9C8\\uC9C0\\uB9C9\\uC5D0 \\uC5C5\\uB370\\uC774\\uD2B8 \\uD55C\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  p \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" client\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"MergeFrom\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"DeepCopy\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"defer\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\terr \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" r\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Status\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Patch\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\"}),\"externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" p\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\tlog\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"err\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" errPatchStatus\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Secret Manger\\uB85C\\uBD80\\uD130 secret data\\uB97C \\uAC00\\uC838\\uC628\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  dataMap\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" r\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"getProviderSecretData\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\"}),\"externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\uC608\\uC81C\\uC5D0\\uC11C\\uB294 deletionPolicy\\uB97C \\uC815\\uC758\\uD558\\uC9C0 \\uC54A\\uC558\\uC9C0\\uB9CC\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// default\\uB294 Retain\\uC73C\\uB85C Secret manager\\uC5D0 \\uD574\\uB2F9 \\uB370\\uC774\\uD130\\uAC00 \\uC5C6\\uB354\\uB77C\\uB3C4\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Kubernetes secret\\uC740 \\uADF8\\uB0E5 \\uC720\\uC9C0\\uD55C\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Delete\\uB85C \\uC124\\uC815\\uD558\\uBA74 Secret manager\\uC5D0\\uB294 \\uC5C6\\uB294\\uB370, Kubernetes secret\\uC740 \\uC874\\uC7AC\\uD558\\uBA74\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\uC774 resource\\uB97C \\uC0AD\\uC81C \\uD560\\uC218 \\uC788\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"dataMap\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"switch\"}),\" externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Target\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"DeletionPolicy \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// delete secret and return early.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" esv1beta1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"DeletionPolicyDelete\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" esv1beta1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"DeletionPolicyMerge\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" esv1beta1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"DeletionPolicyRetain\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" ctrl\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"RequeueAfter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" refreshInt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// spec:\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// target:\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"//   creationPolicy: Owner\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// default\\uB85C createOrUpdate \\uD568\\uC218\\uAC00 \\uD638\\uCD9C\\uB41C\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Kubernetes secret\\uC774 \\uC5C6\\uC73C\\uBA74 \\uC0DD\\uC131\\uD558\\uACE0, \\uC788\\uC73C\\uBA74 \\uC5C5\\uB370\\uC774\\uD2B8 \\uD558\\uAC8C \\uB41C\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"switch\"}),\" externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Target\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"CreationPolicy \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"//nolint\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" esv1beta1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"CreatePolicyMerge\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\terr \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"patchSecret\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" r\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Client\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" r\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Scheme\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" secret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" mutationFunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Name\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\texternalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Status\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Binding \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" v1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"LocalObjectReference\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"Name\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" secret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Name\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" esv1beta1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"CreatePolicyNone\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tlog\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"V\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Info\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"secret creation skipped due to creationPolicy=None\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\terr \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"default\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\terr \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"createOrUpdate\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" r\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Client\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" secret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" mutationFunc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Name\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\texternalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Status\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Binding \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" v1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"LocalObjectReference\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"Name\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" secret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Name\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\uB9C8\\uC9C0\\uB9C9\\uC73C\\uB85C \\uC774\\uC81C CRD\\uC5D0\\uC11C \\uC815\\uC758\\uB41C refreshInterval(1h) \\uB4A4\\uC5D0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\uB2E4\\uC2DC reconcilation\\uC774 \\uB41C\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" ctrl\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tRequeueAfter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" refreshInt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"Secret manager\\uB85C\\uBD80\\uD130 \\uB370\\uC774\\uD130\\uB97C \\uAC00\\uC838\\uC624\\uB294 \",(0,e.jsx)(n.code,{children:\"getProviderSecretData\"}),\" \\uD568\\uC218\\uB294 \\uC774\\uC81C Provider specific\\uD55C \\uB85C\\uC9C1\\uC744 \\uC218\\uD589\\uD558\\uAC8C \\uB41C\\uB2E4. External Secret\\uC5D0\\uC11C\\uB294 Secret Manager\\uB85C \\uB9D0\\uACE0\\uB3C4 \\uB2E4\\uB978 Secret management tool \\uC5F0\\uB3D9\\uC744 \\uC81C\\uACF5\\uD558\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uC774\\uBD80\\uBD84\\uC5D0\\uC11C SecretStore\\uC5D0 \\uC815\\uC758\\uB41C provider\\uC5D0 \\uB530\\uB77C\\uC11C \\uB2E4\\uB978 \\uB85C\\uC9C1\\uC744 \\uC218\\uD589\\uD558\\uAC8C \\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:\"\\uC608\\uC81C\\uC5D0\\uC11C\\uB294 \\uC544\\uB798\\uCC98\\uB7FC dataForm\\uC758 Array\\uC5D0 extract\\uB85C \\uC815\\uC758\\uAC00 \\uB418\\uC5B4 \\uC788\\uC5C8\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" external\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`secrets.io/v1beta1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` ExternalSecret\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"dataFrom\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"extract\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" remote\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"key\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"in\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"the\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`provider\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uC774 \\uC124\\uC815\\uC5D0 \\uB530\\uB77C\\uC11C \\uB2E4\\uB978 \\uB85C\\uC9C1\\uC744 \\uC218\\uD589\\uD558\\uB294\\uB370, switch\\uBB38\\uC5D0 \\uC758\\uD574\\uC11C extract\\uB85C \\uC124\\uC815\\uB41C \\uACBD\\uC6B0\\uC5D0\\uB294 \",(0,e.jsx)(n.code,{children:\"handleExtractSecrets\"}),\"\\uC774 \\uD638\\uCD9C\\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"externalsecret_controller_secret.go\"})}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"language-go code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"r \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"Reconciler\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getProviderSecretData\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"...\"}),\"\\uC0DD\\uB7B5\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"map\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"string\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"byte\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" remoteRef \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"range\"}),\" externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"DataFrom \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"var\"}),\" secretMap \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"map\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"string\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"byte\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"var\"}),\" err \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"error\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" remoteRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Find \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\tsecretMap\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" r\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"handleFindAllSecrets\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" remoteRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" mgr\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" remoteRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Extract \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\tsecretMap\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" r\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"handleExtractSecrets\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" remoteRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" mgr\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" remoteRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"SourceRef \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" remoteRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"SourceRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"GeneratorRef \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\tsecretMap\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" r\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"handleGenerateSecrets\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Namespace\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" remoteRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" i\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uD568\\uC218\\uC758 \\uB85C\\uC9C1\\uC744 \\uD655\\uC778\\uD558\\uBA74 \",(0,e.jsx)(n.code,{children:\"cmgr *secretstore.Manager\"}),\"\\uC744 \\uD1B5\\uD574\\uC11C provider\\uC758 client\\uB97C \\uAC00\\uC838\\uC628\\uB2E4. \\uC774\\uC81C SecretsClient\\uC758 interface\\uB85C \\uC81C\\uACF5\\uD558\\uB294 \",(0,e.jsx)(n.code,{children:\"GetSecretMap\"}),\"\\uC744 \\uD638\\uCD9C\\uD558\\uACE0, \\uC774 \\uD568\\uC218\\uC5D0\\uB294 SecretStore\\uC5D0\\uC11C \\uC124\\uC815\\uB41C provider\\uC5D0 \\uB300\\uD55C \\uB85C\\uC9C1\\uC774 \\uAD6C\\uD604\\uB418\\uC5B4 \\uC788\\uB2E4. \\uC6B0\\uB9AC\\uB294 \\uC608\\uC81C\\uC5D0\\uC11C Secret Manager\\uB97C \\uC0AC\\uC6A9\\uD558\\uACE0 \\uC788\\uAE30 \\uB54C\\uBB38\\uC5D0, Secret manager\\uB85C\\uBD80\\uD130 \\uB370\\uC774\\uD130\\uB97C \\uAC00\\uC838\\uC624\\uB294 \\uB85C\\uC9C1\\uC774 \\uAD6C\\uD604\\uB418\\uC5B4 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"externalsecret_controller_secret.go\"})}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"language-go code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"r \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"Reconciler\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"handleExtractSecrets\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"...\"}),\"\\uC0DD\\uB7B5\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"map\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"string\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"byte\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  client\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" cmgr\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Get\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"SecretStoreRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Namespace\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" remoteRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"SourceRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  secretMap\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" client\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"GetSecretMap\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"remoteRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Extract\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"SecretStore\"}),\"\\uC5D0\\uC11C \\uC815\\uC758\\uD55C provider\\uC5D0 \\uB9DE\\uAC8C SecretClient \\uAC1D\\uCCB4\\uB97C \\uC0DD\\uC131\\uD558\\uAE30 \\uC704\\uD574\\uC11C\\uB294 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC9C4\\uD589\\uC774 \\uB41C\\uB2E4. ExternalSecret \\uB9AC\\uC18C\\uC2A4\\uC5D0\\uC11C secretStore\\uC5D0 \\uB300\\uD55C \\uC815\\uBCF4\\uB97C \\uAC00\\uC9C0\\uACE0 \\uC788\\uB2E4. \\uC774 \\uC815\\uBCF4\\uB97C \\uAC00\\uC9C0\\uACE0 go-client\\uB85C \",(0,e.jsx)(n.code,{children:\"SecretStore\"}),\" \\uB9AC\\uC18C\\uC2A4 \\uC815\\uBCF4\\uB97C \\uAC00\\uC838\\uC628\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"refreshInterval\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` 1h\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"secretStoreRef\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" secretstore\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`sample\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` SecretStore\n`]})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"client_manager.go\"})}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"language-go code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"m \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"Manager\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"Get\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"...\"}),\"\\uC0DD\\uB7B5\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"esv1beta1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"SecretsClient\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  store\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" m\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"getStore\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\"}),\"storeRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" namespace\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" m\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"GetFromStore\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" store\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" namespace\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"m \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"Manager\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getStore\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"...\"}),\"\\uC0DD\\uB7B5\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"esv1beta1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"GenericStore\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  ref \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" types\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"NamespacedName\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tName\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" storeRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Name\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  ref\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Namespace \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),` namespace\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"var\"}),\" store esv1beta1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),`SecretStore\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\terr \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" m\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"client\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Get\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" ref\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\"}),\"store\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\"}),\"store\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8 \\uB2E4\\uC74C\\uC5D0\\uB294 \",(0,e.jsx)(n.code,{children:\"SecretStore\"}),\" \\uB9AC\\uC18C\\uC2A4 \\uC815\\uBCF4\\uB97C \\uBC14\\uD0D5\\uC73C\\uB85C \\uC801\\uD569\\uD55C provider\\uB97C \\uC120\\uD0DD\\uD558\\uAC8C \\uB41C\\uB2E4. \\uADF8\\uB9AC\\uACE0 \\uC774\\uBBF8 \\uD574\\uB2F9 provider client\\uAC00 \\uD638\\uCD9C\\uB418\\uC5B4 map\\uC5D0 \\uC800\\uC7A5\\uB418\\uC5B4 \\uC788\\uC73C\\uBA74 \\uB2E4\\uC2DC \\uC0AC\\uC6A9\\uD558\\uACE0, \\uC544\\uB2C8\\uBA74 \",(0,e.jsx)(n.code,{children:\"NewClient\"}),\"\\uB85C \\uC0C8\\uB85C \\uC0DD\\uC131\\uD558\\uC5EC map\\uC5D0 \\uB2E4\\uC2DC \\uC800\\uC7A5\\uD558\\uAC8C \\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"client_manager.go\"})}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"language-go code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"m \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"Manager\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"GetFromStore\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"...\"}),\"\\uC0DD\\uB7B5\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"esv1beta1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"SecretsClient\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  storeProvider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" esv1beta1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"GetProvider\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"store\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` err\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tsecretClient \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" m\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"getStoredClient\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" storeProvider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" store\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" secretClient \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" secretClient\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  secretClient\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" storeProvider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"NewClient\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" store\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" m\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"client\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" namespace\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` err\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tidx \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"storeKey\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"storeProvider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tm\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"clientMap\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"idx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\"}),\"clientVal\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tclient\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" secretClient\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tstore\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"  store\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" secretClient\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"SecretStore\"}),\"\\uC5D0 \\uC800\\uC7A5\\uB41C provider \\uC774\\uB984\\uC73C\\uB85C \\uC801\\uD569\\uD55C provider\\uB97C \\uAC00\\uC838\\uC624\\uB294 \\uAC83\\uC740 \\uC544\\uB798\\uCC98\\uB7FC builder\\uB77C\\uB294 map\\uC5D0\\uC11C \\uC774\\uB984\\uC73C\\uB85C \\uCC3E\\uC544\\uC624\\uB294 \\uAC83\\uC774\\uB2E4. \\uC6B0\\uB9AC\\uB294 \\uB9E8 \\uC704\\uC5D0\\uC11C import\\uD55C package\\uC758 init \\uD568\\uC218\\uB97C \\uD1B5\\uD574\\uC11C \",(0,e.jsx)(n.code,{children:\"builder\"}),\"\\uC5D0 \\uC9C0\\uC6D0\\uB418\\uB294 provider \\uAC1D\\uCCB4\\uB97C \\uB2E4 \\uB4F1\\uB85D\\uD558\\uC600\\uB2E4. \\uC5EC\\uAE30\\uC11C\\uB294 \\uC774\\uB807\\uAC8C \\uC815\\uC758\\uB41C map\\uC5D0\\uC11C \\uC774\\uB984\\uC73C\\uB85C \\uAC00\\uC838\\uC624\\uB294 \\uC791\\uC5C5\\uC744 \\uD558\\uAC8C \\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"provider_schema.go\"})}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"language-go code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"GetProvider\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"s GenericStore\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"Provider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  buildlock\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"RLock\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tf\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" ok \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" builder\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"storeName\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tbuildlock\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"RUnlock\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" f\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"pkg/provider\"}),\"\\uACBD\\uB85C\\uC5D0\\uB294 \\uC9C0\\uC6D0\\uB418\\uB294 \\uB2E4\\uC591\\uD55C provider\\uC5D0 \\uAD00\\uD55C \\uB85C\\uC9C1\\uB4E4\\uC774 \\uAD6C\\uD604\\uB418\\uC5B4 \\uC788\\uB2E4. \\uCD5C\\uC885\\uC801\\uC73C\\uB85C \",(0,e.jsx)(n.code,{children:\"GetSecretMap\"}),\"\\uC774 \\uD638\\uCD9C\\uB418\\uBA74 \",(0,e.jsx)(n.code,{children:\"Secret Manager\"}),\"\\uC758 \\uAD6C\\uD604 \\uB85C\\uC9C1\\uC5D0 \\uC758\\uD574\\uC11C \\uB370\\uC774\\uD130\\uB97C \\uAC00\\uC838\\uC624\\uAC8C \\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"secretmanager.go\"})}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"language-go code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"sm \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"SecretsManager\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"GetSecretMap\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" ref esv1beta1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"ExternalSecretDataRemoteRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"map\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"string\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"byte\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tlog\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Info\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"fetching secret map\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"key\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" ref\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Key\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tdata\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" sm\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"GetSecret\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" ref\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` err\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tkv \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"make\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"map\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"string\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\"json\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"RawMessage\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\terr \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" json\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Unmarshal\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\"}),\"kv\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" fmt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Errorf\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"unable to unmarshal secret %s: %w\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" ref\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Key\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tsecretData \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"make\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"map\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"string\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"byte\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" k\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" v \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"range\"}),\" kv \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"var\"}),\" strVal \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"string\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\terr \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" json\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Unmarshal\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"v\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\"}),\"strVal\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\tsecretData\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"k\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"byte\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"strVal\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\tsecretData\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"k\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),` v\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" secretData\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"secretstore\\uC5D0-\\uC694\\uCCAD\\uC744-\\uCD5C\\uC18C\\uD654\",children:[(0,e.jsx)(n.a,{href:\"#secretstore\\uC5D0-\\uC694\\uCCAD\\uC744-\\uCD5C\\uC18C\\uD654\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"SecretStore\\uC5D0 \\uC694\\uCCAD\\uC744 \\uCD5C\\uC18C\\uD654\"]}),(0,e.jsxs)(n.p,{children:[\"\\uC774\\uB807\\uAC8C Valut, AWS Secret Manager\\uC5D0\\uC11C secret\\uC744 \\uAD00\\uB9AC\\uD558\\uACE0, \\uADF8\\uAC83\\uC774 \\uBCC0\\uACBD\\uB418\\uC5C8\\uC744 \\uB54C kubernetes\\uC758 secret\\uB97C External Secret\\uC758 CRD\\uB85C \\uC5C5\\uB370\\uC774\\uD2B8\\uD574\\uC904 \\uC218 \\uC788\\uB2E4. \\uC774\\uC81C ExternalSecret kind\\uC5D0 \\uB300\\uD574\\uC11C Event\\uAC00 \\uC0DD\\uAE30\\uBA74 \\uADF8\\uAC83\\uC5D0 \\uB300\\uD574\\uC11C Reconciler\\uB97C \\uD638\\uCD9C\\uD558\\uAC8C \\uB41C\\uB2E4. \\uADF8\\uB9AC\\uACE0 \\uAE30\\uBCF8\\uC801\\uC73C\\uB85C \",(0,e.jsx)(n.code,{children:\"refreshInterval\"}),\"\\uC5D0 \\uC124\\uC815\\uB41C \\uC2DC\\uAC04\\uB4A4\\uC5D0 \\uB2E4\\uC2DC work queue\\uC5D0 \\uCD94\\uAC00\\uD558\\uC5EC \\uB2E4\\uC2DC reconcile\\uC774 \\uD638\\uCD9C\\uB418\\uB3C4\\uB85D \\uD55C\\uB2E4. \\uADF8\\uB7EC\\uBA74 ExeternalSecret \\uC0DD\\uC131\\uC744 \\uD560 \\uB54C \",(0,e.jsx)(n.code,{children:\"refreshInterval\"}),\"\\uB9C8\\uB2E4 queue\\uC5D0 \\uB123\\uB294 loop\\uAC00 \\uC0DD\\uAE30\\uACE0, ExeternalSecret\\uC744 \\uC218\\uC815\\uD558\\uBA74 \\uB2E4\\uB978 loop\\uAC00 \\uC0DD\\uAE30\\uB294 \\uAC83\\uC774 \\uC544\\uB2CC\\uAC00? \\u{1F914}\"]}),(0,e.jsx)(n.p,{children:\"(created event A) -\u003e (event A after refreshInterval) -\u003e (updated event B) -\u003e (event A after refreshInterval) -\u003e (event B after refreshInterval)\"}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB798\\uC11C \",(0,e.jsx)(n.code,{children:\"shouldRefresh\"}),\" \\uD568\\uC218\\uB97C \\uD1B5\\uD574\\uC11C \\uBD88\\uD544\\uC694\\uD558\\uAC8C SecretStore\\uC5D0\\uC11C \\uB370\\uC774\\uD130\\uB97C \\uAC00\\uC9C0\\uACE0 \\uC624\\uC9C0 \\uC54A\\uB294 \\uAC83 \\uAC19\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"externalsecret_controller.go\"})}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"language-go code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"r \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"Reconciler\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"Reconcile\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctx context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" req ctrl\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Request\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ctrl\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// refresh should be skipped if\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// 1. resource generation hasn't changed\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// 2. refresh interval is 0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// 3. if we're still within refresh-interval\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"shouldRefresh\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"isSecretValid\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"existingSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tlog\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"V\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Info\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"skipping refresh\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"rv\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getResourceVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" ctrl\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"RequeueAfter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" refreshInt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"shouldRefresh\"}),\" \\uD568\\uC218\\uB97C \\uD1B5\\uD574\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC791\\uB3D9\\uD55C\\uB2E4.\"]}),(0,e.jsxs)(n.ol,{children:[(0,e.jsx)(n.li,{children:\"\\uC774\\uC804 refresh\\uB97C \\uD574\\uC11C SecretStore\\uC5D0\\uC11C data\\uB97C \\uAC00\\uC838\\uC624\\uACE0 status\\uC5D0 \\uC800\\uC7A5\\uB41C resource version\\uC774 \\uD604\\uC7AC resource version\\uACFC \\uB2E4\\uB974\\uBA74 refresh\\uB97C \\uD574\\uC57C \\uD55C\\uB2E4. (ExternalSecret resource\\uB97C \\uC5C5\\uB370\\uC774\\uD2B8\\uD588\\uC744 \\uB54C)\"}),(0,e.jsx)(n.li,{children:\"\\uC774\\uC804\\uC5D0 Synced\\uAC00 \\uB418\\uC5C8\\uACE0, refreshInterval\\uC774 0\\uC73C\\uB85C \\uC124\\uC815\\uB418\\uC5B4 \\uC788\\uC73C\\uBA74 refresh\\uB97C \\uC548 \\uD55C\\uB2E4.\"}),(0,e.jsx)(n.li,{children:\"Resource\\uC758 status.RefreshTime\\uC774 0\\uC774\\uBA74 refresh\\uB97C \\uD574\\uC57C \\uD55C\\uB2E4.\"}),(0,e.jsx)(n.li,{children:\"\\uB9C8\\uC9C0\\uB9C9\\uC73C\\uB85C status.RefreshTime\\uC774 \\uC544\\uC9C1 refreshInterval\\uB9CC\\uD07C \\uACBD\\uACFC\\uD558\\uC9C0 \\uC54A\\uC558\\uC73C\\uBA74 refresh\\uB97C \\uC548 \\uD55C\\uB2E4.\"})]}),(0,e.jsx)(n.p,{children:\"\\uB9C8\\uC9C0\\uB9C9 4\\uBC88\\uC9F8\\uAC00 work queue\\uC5D0 enqueue\\uB97C \\uACC4\\uC18D \\uD558\\uB294 loop\\uAC00 \\uB450 \\uAC1C \\uC774\\uC0C1 \\uC0DD\\uAE38 \\uC218 \\uC788\\uAE30 \\uB54C\\uBB38\\uC5D0, status.RefreshTime\\uC744 \\uCCB4\\uD06C\\uD574\\uC11C \\uB2E4\\uC2DC SecretStore\\uC5D0\\uC11C \\uAC00\\uC838\\uC624\\uC9C0 \\uC54A\\uB294 \\uAC83\\uC73C\\uB85C \\uD574\\uACB0\\uD55C \\uAC83\\uC778\\uAC00?\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"externalsecret_controller.go\"})}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"language-go code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"shouldRefresh\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"es esv1beta1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"ExternalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"bool\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// refresh if resource version changed\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" es\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Status\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"SyncedResourceVersion \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getResourceVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"es\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// skip refresh if refresh interval is 0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" es\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"RefreshInterval\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Duration \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" es\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Status\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"SyncedResourceVersion \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"false\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" es\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Status\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"RefreshTime\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"IsZero\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" es\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Status\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"RefreshTime\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Add\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"es\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"RefreshInterval\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Duration\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Before\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"time\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Now\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"immutable-secret\",children:[(0,e.jsx)(n.a,{href:\"#immutable-secret\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Immutable Secret\"]}),(0,e.jsx)(n.p,{children:\"\\uCF54\\uB4DC\\uB97C \\uBCF4\\uB2E4 \\uBCF4\\uB2C8 ExternalSecret\\uC758 spec\\uC5D0\\uC11C Immutable \\uC124\\uC815\\uC744 \\uD558\\uBA74, Kubernetes secret resource\\uB97C immutable true\\uB85C \\uC0DD\\uC131\\uD55C\\uB2E4. \\uADF8\\uB9AC\\uACE0 \\uB2E4\\uC74C reconcile\\uC5D0\\uC11C \\uC774\\uBBF8 \\uD55C\\uBC88 sync\\uD55C secret\\uC5D0 \\uB300\\uD574\\uC11C\\uB294 \\uB354 \\uC774\\uC0C1 reconcile\\uC744 \\uD558\\uC9C0 \\uC54A\\uB294 \\uAC83\\uC73C\\uB85C Immutable\\uC744 \\uC801\\uC6A9\\uD558\\uACE0 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"externalsecret_controller.go\"})}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"language-go code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"shouldReconcile\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  log\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"V\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Info\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"stopping reconciling\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"rv\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getResourceVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" ctrl\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    RequeueAfter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    Requeue\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"      \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"false\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"secret \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\"}),\"v1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Secret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tObjectMeta\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" metav1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"ObjectMeta\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\tName\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"      secretName\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\tNamespace\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Namespace\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tImmutable\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\"}),\"externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Target\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Immutable\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tData\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"      \",(0,e.jsx)(n.span,{className:\"token function\",children:\"make\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"map\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"string\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"byte\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"language-go code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"shouldReconcile\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"es esv1beta1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"ExternalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"bool\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" es\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Target\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Immutable \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"hasSyncedCondition\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"es\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"false\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Secret\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"...\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"data\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"...\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"immutable\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"ownerreferces\",children:[(0,e.jsx)(n.a,{href:\"#ownerreferces\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"OwnerReferces\"]}),(0,e.jsxs)(n.p,{children:[\"\\uC18C\\uC2A4\\uCF54\\uB4DC\\uB97C \\uBCF4\\uAE30 \\uC804\\uC5D0 CRD\\uC5D0\\uC11C \",(0,e.jsx)(n.code,{children:\"CreationPolicy\"}),\"\\uC758 Owner \\uC124\\uC815\\uC774 \\uC5B4\\uB5A4 \\uC5ED\\uD560\\uC744 \\uD558\\uB294\\uC9C0 \\uC0B4\\uD3B4\\uBCF4\\uC558\\uB2E4. \\uC774\\uBD80\\uBD84\\uC740 \\uC544\\uB798\\uCC98\\uB7FC CreationPolicy\\uAC00 \",(0,e.jsx)(n.code,{children:\"Owner\"}),\"\\uC774\\uBA74, Metadata\\uC758 OwnerReferce\\uB97C \\uC124\\uC815\\uD558\\uAC8C \\uB429\\uB2C8\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"externalsecret_controller.go\"})}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"language-go code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"mutationFunc \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"error\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Target\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"CreationPolicy \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" esv1beta1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"CreatePolicyOwner \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\terr \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" controllerutil\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"SetControllerReference\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\"}),\"externalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\"}),\"secret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"ObjectMeta\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" r\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Scheme\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" fmt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Errorf\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"errSetCtrlReference\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"controllerutil.go\"})}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"language-go code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"SetControllerReference\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"owner\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" controlled metav1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Object\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" scheme \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"runtime\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Scheme\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"error\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tref \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" metav1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"OwnerReference\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tAPIVersion\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"         gvk\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"GroupVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"String\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tKind\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"               gvk\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Kind\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tName\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"               owner\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"GetName\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tUID\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"                owner\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"GetUID\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tBlockOwnerDeletion\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" pointer\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Bool\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tController\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"         pointer\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Bool\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"validator\",children:[(0,e.jsx)(n.a,{href:\"#validator\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Validator\"]}),(0,e.jsxs)(n.p,{children:[\"calico\\uC5D0\\uC11C\\uB294 calico apiserver\\uB97C \\uD1B5\\uD574\\uC11C kubectl\\uB85C resource\\uB97C \\uC0DD\\uC131\\uD560 \\uB54C, defaulting\\uACFC validation\\uC744 \\uD560 \\uC218\\uAC00 \\uC788\\uB2E4. \\uC544\\uB2C8\\uBA74 calicoctl command tool\\uC744 \\uD1B5\\uD574\\uC11C calico apiserver \\uC5C6\\uC774 resource\\uB97C \\uC0DD\\uC131\\uD560 \\uB54C \\uB3D9\\uC77C\\uD55C defaulting\\uACFC validation\\uC744 \\uD560\\uC218\\uAC00 \\uC788\\uB2E4. \",(0,e.jsx)(n.a,{href:\"https://book.kubebuilder.io/cronjob-tutorial/webhook-implementation.html\",children:\"kubebuilder\\uC5D0\\uC11C defaulting/validating webhook\\uC744 \\uC801\\uC6A9\"}),\"\\uD558\\uB294 \\uAC83\\uC744 \\uC0B4\\uD3B4\\uBCF4\\uBA74, External Secret\\uC5D0\\uC11C\\uB294 \",(0,e.jsx)(n.code,{children:\"apis/externalsecrets\"}),\"\\uC548\\uC5D0 \",(0,e.jsx)(n.code,{children:\"externalsecret_validator.go\"}),\"\\uB85C \\uC815\\uC758\\uB418\\uC5B4 \\uC788\\uC744 \\uAC83\\uC744 \\uBCFC \\uC218 \\uC788\\uB2E4. \",(0,e.jsx)(n.code,{children:\"CREATE\"}),\", \",(0,e.jsx)(n.code,{children:\"UPDATE\"}),\" \\uD558\\uB294 \\uACBD\\uC6B0\\uC5D0\\uB294 \",(0,e.jsx)(n.code,{children:\"validateExternalSecret\"}),\" \\uD568\\uC218\\uB97C \\uD638\\uCD9C\\uD558\\uC5EC validating\\uC744 \\uD558\\uACE0 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"externalsecret_validator.go\"})}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"language-go code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"esv \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"ExternalSecretValidator\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"ValidateCreate\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" obj runtime\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Object\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"admission\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Warnings\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"validateExternalSecret\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"obj\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"esv \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"ExternalSecretValidator\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"ValidateUpdate\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" newObj runtime\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Object\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"admission\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Warnings\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"validateExternalSecret\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"newObj\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"esv \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"ExternalSecretValidator\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"ValidateDelete\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),\" runtime\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Object\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"admission\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Warnings\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"validateExternalSecret\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"obj runtime\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Object\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"admission\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Warnings\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" ok \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" obj\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\"ExternalSecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),\"ok \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" fmt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Errorf\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"unexpected type\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"es\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Target\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"DeletionPolicy \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" DeletionPolicyDelete \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" es\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Target\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"CreationPolicy \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" CreatePolicyMerge\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"||\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"es\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Target\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"DeletionPolicy \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" DeletionPolicyDelete \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" es\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Target\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"CreationPolicy \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" CreatePolicyNone\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" fmt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Errorf\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:`\"deletionPolicy=Delete must not be used when the controller doesn't own the secret. Please set creationPolcy=Owner\"`}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" es\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Target\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"DeletionPolicy \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" DeletionPolicyMerge \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" es\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Target\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"CreationPolicy \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" CreatePolicyNone \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" fmt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Errorf\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"deletionPolicy=Merge must not be used with creationPolcy=None. There is no Secret to merge with\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" ref \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"range\"}),\" es\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"DataFrom \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tfindOrExtract \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" ref\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Find \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"||\"}),\" ref\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Extract \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" findOrExtract \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" ref\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"SourceRef \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" ref\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"SourceRef\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"GeneratorRef \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" fmt\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Errorf\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"generator can not be used with find or extract\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uC774\\uC81C \\uC774\\uB807\\uAC8C validating\\uC744 \\uCD94\\uAC00\\uD558\\uC5EC DeletionPolicy\\uAC00 Delete\\uB85C CreatePolicy\\uAC00 Merge\\uB85C \\uB3D9\\uC2DC\\uC5D0 \\uC124\\uC815\\uB418\\uC9C0 \\uBABB\\uD558\\uB3C4\\uB85D \\uD558\\uC600\\uB2E4. ExternalSecret Kind\\uC5D0\\uC11C SecretStore\\uB97C ref\\uAC12\\uC73C\\uB85C \\uAC00\\uB9AC\\uD0A4\\uB3C4\\uB85D \\uD558\\uACE0 \\uC788\\uB2E4. \\uD558\\uC9C0\\uB9CC ExternalSecret\\uC758 \",(0,e.jsx)(n.code,{children:\"secretStoreRef\"}),\"\\uAC00 \\uC720\\uD6A8\\uD55C \\uAC12\\uC778\\uC9C0\\uB294 validating\\uC5D0\\uC11C \\uCCB4\\uD06C\\uD558\\uC9C0 \\uC54A\\uB294\\uB2E4. \\uC774\\uBD80\\uBD84\\uC5D0 \\uB300\\uD574\\uC11C \\uCD94\\uAC00\\uD558\\uBA74 \\uC88B\\uC9C0 \\uC54A\\uC744\\uAE4C?\"]}),(0,e.jsxs)(n.h2,{id:\"\\uB2E4\\uB978-\\uAE30\\uB2A5\",children:[(0,e.jsx)(n.a,{href:\"#\\uB2E4\\uB978-\\uAE30\\uB2A5\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uB2E4\\uB978 \\uAE30\\uB2A5\"]}),(0,e.jsxs)(n.h3,{id:\"pushsecret\",children:[(0,e.jsx)(n.a,{href:\"#pushsecret\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"PushSecret\"]}),(0,e.jsxs)(n.p,{children:[\"\\uC774\\uB807\\uAC8C Valut, AWS Secret Manager\\uC5D0\\uC11C secret\\uC744 \\uAD00\\uB9AC\\uD558\\uACE0, \\uADF8\\uAC83\\uC774 \\uBCC0\\uACBD\\uB418\\uC5C8\\uC744 \\uB54C kubernetes\\uC758 secret\\uB97C External Secret\\uC758 CRD\\uB85C \\uC5C5\\uB370\\uC774\\uD2B8\\uD574\\uC904 \\uC218 \\uC788\\uB2E4. \",(0,e.jsx)(n.code,{children:\"PushSecret\"}),\"\\uB77C\\uB294 kind\\uB294 \\uC774\\uC81C \\uBC18\\uB300\\uB85C Kubernetes secret\\uC744 SecretStore\\uC5D0 \\uC5C5\\uB370\\uC774\\uD2B8\\uD558\\uB294 \\uAC83\\uC744 \\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" external\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`secrets.io/v1alpha1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` PushSecret\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" pushsecret\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"example \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Customisable\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"namespace\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" default \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Same of the SecretStores\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"refreshInterval\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` 10s\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"generator\",children:[(0,e.jsx)(n.a,{href:\"#generator\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Generator\"]}),(0,e.jsxs)(n.p,{children:[\"\\uBA87\\uAC00\\uC9C0 secret value\\uB4E4\\uC744 \\uC0DD\\uC131\\uD560 \\uC218 \\uC788\\uB294 CRD\\uB97C \\uC81C\\uACF5\\uD55C\\uB2E4. \\uC608\\uB97C \\uB4E4\\uC5B4\\uC11C Vault Dynamic Secret\\uB97C \\uC774\\uC6A9\\uD574\\uC11C \\uAC12\\uC744 \\uC0DD\\uC131\\uD558\\uB824\\uBA74 \\uC544\\uB798\\uCC98\\uB7FC \\uBCC4\\uB3C4\\uC758 Custom Resource\\uB97C \\uB9CC\\uB4E4\\uACE0, External Secret\\uC5D0 \",(0,e.jsx)(n.code,{children:\"generatorRef\"}),\"\\uB85C \\uC815\\uC758\\uD574\\uC900\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" generators.external\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`secrets.io/v1alpha1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` VaultDynamicSecret\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'pki-example'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"path\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'/pki/issue/example-dot-com'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"method\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'POST'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"parameters\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"common_name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'localhost'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"ip_sans\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'127.0.0.1,127.0.0.11'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"provider\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"server\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'http://vault.default.svc.cluster.local:8200'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"auth\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kubernetes\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"mountPath\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'kubernetes'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"role\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'external-secrets-operator'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"serviceAccountRef\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'default'\"}),`\n`]})]})}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" external\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`secrets.io/v1beta1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` ExternalSecret\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'pki-example-com'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"refreshInterval\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'768h'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"target\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" pki\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"example\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`com\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"dataFrom\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"sourceRef\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"generatorRef\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" generators.external\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`secrets.io/v1alpha1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` VaultDynamicSecret\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'pki-example'\"}),`\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"\\uACB0\\uB860\",children:[(0,e.jsx)(n.a,{href:\"#\\uACB0\\uB860\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uACB0\\uB860\"]}),(0,e.jsxs)(n.p,{children:[\"\\uC678\\uBD80 Secret management tool\\uACFC Kubernetes Secret\\uC758 Sync \\uB9DE\\uCD94\\uAE30 \\uC704\\uD574\\uC11C CRD\\uC640 Custom controller\\uB85C \\uD574\\uACB0\\uD55C External Secrets \\uD504\\uB85C\\uC81D\\uD2B8\\uC758 \\uCF54\\uB4DC\\uB97C \\uC0B4\\uD3B4\\uBCF4\\uAC8C \\uB418\\uC5C8\\uB2E4. CRD\\uC5D0 \\uC815\\uC758\\uB41C \",(0,e.jsx)(n.code,{children:\"refreshInterval\"}),\" \\uC2DC\\uAC04\\uB9C8\\uB2E4 Polling \\uBC29\\uC2DD\\uC73C\\uB85C \\uC678\\uBD80 secret management tool\\uC758 \\uAC12\\uC744 \\uAC00\\uC838\\uC624\\uACE0, Kubernetes secret \\uB9AC\\uC18C\\uC2A4\\uC640 sync\\uB97C \\uD558\\uAC8C \\uB41C\\uB2E4. \\uBC18\\uBCF5\\uB418\\uB294 loop\\uC744 \\uB9CC\\uB4E4\\uAE30 \\uC704\\uD574\\uC11C \\uB85C\\uC9C1\\uC774 \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uC218\\uD589\\uD558\\uACE0 \\uB098\\uBA74, work queue\\uC5D0 \",(0,e.jsx)(n.code,{children:\"refreshInterval\"}),\"\\uC774 \\uACBD\\uACFC\\uD55C \\uB4A4 enqueue\\uD558\\uB3C4\\uB85D Result\\uB97C \\uBC18\\uD658\\uD55C\\uB2E4. \\uADF8\\uB9AC\\uACE0 Custom Resource Status\\uC758 RefreshTime\\uC744 \\uBCF4\\uACE0 \\uC544\\uC9C1 \",(0,e.jsx)(n.code,{children:\"refreshInterval\"}),\"\\uC774 \\uACBD\\uACFC\\uD558\\uC9C0 \\uC54A\\uC558\\uC73C\\uBA74 Secret management tool\\uC5D0 \\uC694\\uCCAD\\uD558\\uC9C0 \\uC54A\\uB294\\uB2E4. \\uD558\\uC9C0\\uB9CC \\uC678\\uBD80 Secret management tool\\uC640 sync\\uAC00 \\uBE68\\uB9AC \\uB418\\uB3C4\\uB85D \",(0,e.jsx)(n.code,{children:\"refreshInterval\"}),\"\\uC744 \\uC9E7\\uAC8C \\uC124\\uC815\\uD558\\uBA74 \\uB124\\uD2B8\\uC6CC\\uD06C \\uC694\\uCCAD\\uC774 \\uB354 \\uBE48\\uBC88\\uD558\\uAC8C \\uBC1C\\uC0DD\\uD558\\uAC8C \\uB418\\uACE0, ExternalSecret custom resource\\uAC00 \\uB9CE\\uC544 \\uC9C8\\uC218\\uB85D \\uC774\\uB7EC\\uD55C \\uB124\\uD2B8\\uC6CC\\uD06C \\uC694\\uCCAD\\uC740 \\uB354 \\uB9CE\\uC544\\uC9C0\\uAC8C \\uB420 \\uAC83\\uC774\\uB2E4. \\uCFE0\\uBC84\\uB124\\uD2F0\\uC2A4\\uC5D0\\uC11C Informer\\uB97C \\uD1B5\\uD574\\uC11C \\uCC98\\uC74C\\uC5D0 List\\uB97C \\uD574\\uC624\\uACE0 \\uCE90\\uC2DC\\uC640 Watch\\uB97C \\uD1B5\\uD574\\uC11C \\uBCC0\\uD654\\uB418\\uB294 Event\\uC5D0\\uB9CC \\uB85C\\uC9C1\\uC744 \\uC218\\uD589\\uD560 \\uC218 \\uC788\\uB294\\uB370, \\uC774\\uB807\\uAC8C Polling \\uBC29\\uC2DD\\uC740 \\uD655\\uC7A5\\uC131\\uC5D0\\uC11C \\uBB38\\uC81C\\uAC00 \\uC788\\uB2E4\\uB294 \\uC0DD\\uAC01\\uC774 \\uB4E4\\uC5C8\\uB2E4.\"]})]})}}var b=y;return S;})();\n;return Component;","toc":[{"value":"Getting Started로 파악해보기","url":"#getting-started로-파악해보기","depth":2},{"value":"소스 코드로 이해하기","url":"#소스-코드로-이해하기","depth":2},{"value":"SecretStore에 요청을 최소화","url":"#secretstore에-요청을-최소화","depth":3},{"value":"Immutable Secret","url":"#immutable-secret","depth":3},{"value":"OwnerReferces","url":"#ownerreferces","depth":3},{"value":"Validator","url":"#validator","depth":3},{"value":"다른 기능","url":"#다른-기능","depth":2},{"value":"PushSecret","url":"#pushsecret","depth":3},{"value":"Generator","url":"#generator","depth":3},{"value":"결론","url":"#결론","depth":2}],"frontMatter":{"readingTime":{"text":"22 min read","minutes":21.485,"time":1289100,"words":4297},"slug":"20230730-k8s-controller-external-secrets","fileName":"20230730-k8s-controller-external-secrets.md","title":"오픈소스 Kubernetes External Secrets 살펴보기","date":"2023-07-30T00:00:00.000Z","tags":["kubernetes"],"summary":"CRD와 Custom Controller를 사용하는 프로젝트에 대해서 더 알고 싶은 상황에서, External Secrets이라는 프로젝트를 발견하게 되었다. External Secrets는 Vault, AWS secret manager와 같이 secret 관리하는 Tool들과 Kubernetes secret을 CRD을 통해서 sync할 수 있게 해준다. 이 프로젝트는 kubebuilder를 사용하였는데, 소스코드를 보면서 어떻게 구현한 건지 자세히 살펴보았다."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.15,"time":9000,"words":30},"slug":["default"],"fileName":"default.md","name":"Jay","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"행동 설계 7단계를 내 실생활에 적용해보자","date":"2023-07-23T00:00:00.000Z","tags":["book"],"summary":"책 \"훅(Hooked)\"에서 포그 행동모델을 알게 되었다. 이번에는 포그가 쓴 책 \"습관의 디테일(Tiny Habits)\"을 읽어 보게 되었다. 내가 과거에 습관으로 잘 형성했던 행동들을 행동 모델 7단계 관점에서 생각을 해보았다. 그리고 내가 습관화 하지 못했던 행동들에 대해서도 생각해보면서 다시 한번 어떻게 꾸준히 할 수 있을까 고민해보았다. 알고리즘 꾸준히 공부하기는 내가 습관화 하고 싶었던 것 중에 하나였는데 매번 실패하는 행동이었다. 이번에 행동 모델 7단계에 내용들을 적용하여 다시 시도해본다.","slug":"20230723-book-review-tiny-habit"},"next":{"title":"내가 해결한 문제 중 가장 어려운 문제는 무엇이었나?","date":"2023-07-31T00:00:00.000Z","tags":["self-evalutaion"],"summary":"오늘 나를 돌이켜보면서 난해만 문제들을 정의하고 그것들을 해결해나가는 실질적인 경험이 너무 부족하다는 것을 느꼈다. \"나는 진짜 어려운 문제를 해결한 적이 없었는데... 이걸 어려운 문제라고 할 수 있을까...?\" 이러한 고민에 주저하지 않고 당당히 말할 수 있는 경험들을 앞으로라도 만들어 나가야겠다.","slug":"20230731-what-have-you-solved"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["20230730-k8s-controller-external-secrets"]},"buildId":"IYyAeO79brX1AWpwTtfcO","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>