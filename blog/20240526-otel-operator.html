<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="manifest" href="/jayground8/static/favicons/manifest.json"/><link rel="manifest" href="/jayground8/static/favicons/site.webmanifest"/><link rel="shortcut icon" href="/jayground8/static/favicons/favicon.ico"/><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8773084925406986" crossorigin="anonymous"></script><title>opentelemetry-operator 사용해보기</title><meta name="robots" content="follow, index"/><meta name="description" content="소스코드를 변경하지 않고 opentelemetry-operator의 Instrumentation CRD를 통해서 Python Application을 자동으로 Instrumentation을 해봤다. 이 과정에서 OpenTelemetry Logging의 경우에는 기존 Logging Libarary에 Bridge API로 연동하는 구조로 설계된 것을 알게 되었고, Python opentelemetry sdk가 logger에 handler를 추가하는 것을 알게 되었다. 또한 sitecustomize.py을 통해서 Python Application이 실행되기 전에 Instrumentation library를 셋팅하는 것을 이해하게 되었다. Gunicorn으로 Flask를 실행할 때와 Uvicorn으로 FastAPI를 실행할 때, Auto Instrumentation이 잘 되는 것을 확인하였다."/><meta property="og:url" content="https://jayground8.github.io/blog/20240526-otel-operator"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Jayground8"/><meta property="og:description" content="소스코드를 변경하지 않고 opentelemetry-operator의 Instrumentation CRD를 통해서 Python Application을 자동으로 Instrumentation을 해봤다. 이 과정에서 OpenTelemetry Logging의 경우에는 기존 Logging Libarary에 Bridge API로 연동하는 구조로 설계된 것을 알게 되었고, Python opentelemetry sdk가 logger에 handler를 추가하는 것을 알게 되었다. 또한 sitecustomize.py을 통해서 Python Application이 실행되기 전에 Instrumentation library를 셋팅하는 것을 이해하게 되었다. Gunicorn으로 Flask를 실행할 때와 Uvicorn으로 FastAPI를 실행할 때, Auto Instrumentation이 잘 되는 것을 확인하였다."/><meta property="og:title" content="opentelemetry-operator 사용해보기"/><meta property="og:image" content="https://jayground8.github.io/static/images/social-banner.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site"/><meta name="twitter:title" content="opentelemetry-operator 사용해보기"/><meta name="twitter:description" content="소스코드를 변경하지 않고 opentelemetry-operator의 Instrumentation CRD를 통해서 Python Application을 자동으로 Instrumentation을 해봤다. 이 과정에서 OpenTelemetry Logging의 경우에는 기존 Logging Libarary에 Bridge API로 연동하는 구조로 설계된 것을 알게 되었고, Python opentelemetry sdk가 logger에 handler를 추가하는 것을 알게 되었다. 또한 sitecustomize.py을 통해서 Python Application이 실행되기 전에 Instrumentation library를 셋팅하는 것을 이해하게 되었다. Gunicorn으로 Flask를 실행할 때와 Uvicorn으로 FastAPI를 실행할 때, Auto Instrumentation이 잘 되는 것을 확인하였다."/><meta name="twitter:image" content="https://jayground8.github.io/static/images/social-banner.png"/><link rel="canonical" href="https://jayground8.github.io/blog/20240526-otel-operator"/><meta property="article:published_time" content="2024-05-26T00:00:00.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jayground8.github.io/blog/20240526-otel-operator"
  },
  "headline": "opentelemetry-operator 사용해보기",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://jayground8.github.io/static/images/social-banner.png"
    }
  ],
  "datePublished": "2024-05-26T00:00:00.000Z",
  "dateModified": "2024-05-26T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jay"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Jay",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jayground8.github.ioplayground.png"
    }
  },
  "description": "소스코드를 변경하지 않고 opentelemetry-operator의 Instrumentation CRD를 통해서 Python Application을 자동으로 Instrumentation을 해봤다. 이 과정에서 OpenTelemetry Logging의 경우에는 기존 Logging Libarary에 Bridge API로 연동하는 구조로 설계된 것을 알게 되었고, Python opentelemetry sdk가 logger에 handler를 추가하는 것을 알게 되었다. 또한 sitecustomize.py을 통해서 Python Application이 실행되기 전에 Instrumentation library를 셋팅하는 것을 이해하게 되었다. Gunicorn으로 Flask를 실행할 때와 Uvicorn으로 FastAPI를 실행할 때, Auto Instrumentation이 잘 되는 것을 확인하였다."
}</script><meta name="next-head-count" content="24"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preload" href="/_next/static/css/414f98a58444a4f1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/414f98a58444a4f1.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-690364db8bfb1f01.js" defer=""></script><script src="/_next/static/chunks/main-eea1c213342d95c3.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9300e10e25f7ec71.js" defer=""></script><script src="/_next/static/chunks/675-70b09cbf0a5309ea.js" defer=""></script><script src="/_next/static/chunks/410-35c4fb535edd9439.js" defer=""></script><script src="/_next/static/chunks/712-376d32740a4ac813.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-8ab66ff6ebabec4c.js" defer=""></script><script src="/_next/static/GvPe-ulFw1_hwse8Itj5C/_buildManifest.js" defer=""></script><script src="/_next/static/GvPe-ulFw1_hwse8Itj5C/_ssgManifest.js" defer=""></script><script src="/_next/static/GvPe-ulFw1_hwse8Itj5C/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="Jayground8" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" width="53.87" height="43.61" viewBox="0 0 512 512" class="fill-black dark:fill-white"><path d="M368.4 17c-8.8 1.3-18.3 5-25.3 9.9-3.8 2.5-22.6 16.1-41.9 30.1-37.1 26.9-38.6 28.3-36.3 33.9 1.7 4 4.9 5.1 14.6 5.1h8.5v128h-17.9c-18.2 0-22.2.6-27.3 4.2l-2.8 1.9V116.9l2.5-2.4c1.5-1.6 3.6-2.5 5.5-2.5s4 .9 5.5 2.5l2.5 2.4v42c0 29.1.3 42.8 1.1 44.5 2.6 5.7 11.5 5.5 13.9-.3.7-1.9 1-15.6.8-46.2-.3-40.1-.4-43.7-2.2-46.9-4.8-9-11.9-13.4-21.6-13.4-13.8 0-22.8 9.1-23.8 24.1l-.5 7.3h-31.5l-1.2-2.9c-1.6-3.9-6-5.8-9.9-4.1-1.6.6-3.5 2.5-4.1 4.1l-1.2 2.9h-63.6l-1.2-2.9c-2.5-6.2-11.5-6.2-14 0l-1.2 2.9H64.3l-.5-7.3c-1-15-10-24.1-23.8-24.1-9.7 0-16.8 4.4-21.6 13.4-1.8 3.3-1.9 7.5-2.2 75-.2 50 .1 72.3.8 74.1 2.1 5.1 8.6 6.3 12.5 2.4l2.5-2.4V116.9l2.5-2.4c3.2-3.3 7.8-3.3 11 0l2.5 2.4V448H32V284.9l-2.5-2.4c-3.8-3.9-10.2-2.7-12.4 2.2-1.6 3.4-1.6 171.2 0 174.6.6 1.4 2.2 3 3.6 3.6 1.6.7 15.6 1.1 43.7 1.1 38 0 41.5-.1 43.4-1.8 1.2-.9 33.4-50.5 71.7-110.2 38.3-59.7 70.5-109.3 71.7-110.3 1.8-1.5 4.3-1.7 19.4-1.7H288v16h-12.5c-13.1 0-16.6.8-18.3 4.4-2 4.5-138.5 216.2-140.4 217.9-1.9 1.6-5.6 1.7-47.9 1.7-31.9 0-46.6.3-48.3 1.1-5.7 2.6-5.5 11.5.3 13.9 1.9.7 16.7 1 50.1.8 46.4-.3 47.6-.3 51.5-2.5 2.2-1.1 5.1-3.3 6.5-4.7 1.3-1.5 10.1-14.7 19.6-29.4l17.1-26.7 18.4-.5c10.1-.3 19.1-.9 20-1.3.9-.5 2.1-1.9 2.8-3.3 1.5-3.4 1.5-35.4 0-38.8-1.1-2.3-4-4-8-4.8-1.3-.2 1.5-5.2 11.5-20.7l13.1-20.5.5 56.5c.3 31 .9 57.1 1.3 58 1.5 3 5.6 3.9 18.2 3.9H256v14c0 14.9.7 18.1 4.7 19.9 1.7.8 34.7 1.1 115.3 1.1s113.6-.3 115.3-1.1c1.4-.6 3-2.2 3.6-3.6 1.5-3.4 1.5-83.2 0-86.6-2.2-4.9-8.6-6.1-12.4-2.2l-2.5 2.4V480H272V272h208v107.1l2.5 2.4c3.8 3.9 10.2 2.7 12.4-2.2 1.5-3.4 1.5-115.2 0-118.6-1.8-3.9-5-4.7-18.4-4.7H464v-40.5c0-27.9-.3-41.2-1.1-42.9-2.6-5.5-11.2-5.5-13.8 0-.8 1.7-1.1 15-1.1 42.9V256h-24v-34.5c0-21.3-.4-36.4-1.1-39.7-3.6-17.3-19.3-32.9-36.7-36.7-16.2-3.4-31.4 1.1-43.3 12.9-7.4 7.3-11.2 13.9-13.4 23.2-1.8 7.9-2.1 50.3-.4 54.2 1.6 3.5 6.1 5.2 9.8 3.7 4.7-2 5.1-4.2 5.1-29.6 0-21.5.2-23.9 2.2-29.2C350.6 168.4 363 160 376 160s25.4 8.4 29.8 20.3c2.1 5.5 2.2 7.4 2.2 40.7v35H304V96h144v24.5c0 16 .4 25.3 1.1 26.9 2.6 5.5 11.2 5.5 13.8 0 .7-1.6 1.1-10.9 1.1-26.9V96h8.5c9.7 0 12.9-1.1 14.6-5.1 2.1-5.2.1-7.5-17.7-20.4C446.2 53.8 445 53 442.1 53c-4.1.1-7.5 3.5-7.5 7.7 0 4 2.2 6.3 14.8 15.3l4.8 3.5-39.1.3c-21.5.1-56.7.1-78.2 0l-39.1-.3 14.9-10.7c8.2-5.9 20.7-15.1 27.8-20.4 14.5-10.8 20.5-14 29.4-15.5 11.6-2.1 22.4 1.3 36.5 11.4 4.3 3.1 9 5.7 10.3 5.7 3.9 0 7.5-4.4 7.1-8.7-.3-3.3-1.1-4.4-7.8-9.6-15.3-11.8-32.3-17.1-47.6-14.7zM96 152v8H64v-16h32v8zm80 0v8h-64v-16h64v8zm48 0v8h-32v-16h32v8zM96 280v104h-4.5c-5.5 0-9 1.5-10.4 4.7-1.5 3.3-1.5 35.4 0 38.7 1.7 3.6 3.1 4 16.2 4.6l11.9.5-5.1 7.7L99 448H64V176h32v104zm80-27.8v76.3l-17.8 27.7-17.7 27.7-14.2.1H112V176h64v76.2zm48-37.3v38.9l-15.6 24.4c-8.6 13.3-15.8 24.5-16 24.7-.2.2-.4-28.2-.4-63.2V176h32v38.9zM256 369v76h-16V317.1l7.8-12c4.2-6.7 7.8-12.1 8-12.1.1 0 .2 34.2.2 76zm-129.1 34.7c-1.2 2.1-3.6 5.7-5.1 8l-2.9 4.3H96v-16h33.2l-2.3 3.7zM192 408v8h-15.1l3.7-5.8c2-3.1 4.4-6.7 5.2-8 .8-1.2 2.4-2.2 3.8-2.2 2.3 0 2.4.2 2.4 8z"></path><path d="M322.5 114.5c-1.6 1.5-2.5 3.6-2.5 5.5s.9 4 2.5 5.5c1.5 1.6 3.6 2.5 5.5 2.5s4-.9 5.5-2.5c1.6-1.5 2.5-3.6 2.5-5.5s-.9-4-2.5-5.5c-1.5-1.6-3.6-2.5-5.5-2.5s-4 .9-5.5 2.5zM418.5 114.5c-1.6 1.5-2.5 3.6-2.5 5.5s.9 4 2.5 5.5c1.5 1.6 3.6 2.5 5.5 2.5s4-.9 5.5-2.5c1.6-1.5 2.5-3.6 2.5-5.5s-.9-4-2.5-5.5c-1.5-1.6-3.6-2.5-5.5-2.5s-4 .9-5.5 2.5zM290.2 290.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6zM450.5 290.5c-5 4.9-1.5 13.5 5.5 13.5 4.1 0 8-3.9 8-8s-3.9-8-8-8c-1.9 0-4 .9-5.5 2.5zM358.1 322c-8.3 2.2-16.5 5.7-19.8 8.6-3.3 2.8-3.9 7.3-1.4 10.6 3.3 4.1 6.4 4.3 13.8.8 23.3-10.9 47.3-7 64.8 10.5 11.5 11.4 16.5 23.6 16.5 39.7 0 15.9-5.1 28.1-16.4 39.4C404.2 443 392.1 448 376 448s-28.1-5-39.5-16.5c-11-11.1-16.5-24.2-16.5-39.5.1-9.5 1.2-14.5 5.6-24.3 3.8-8.3 3.8-10.4.1-14.5-4.7-5.1-10.8-1.7-15.4 8.6-8.6 19.5-8.4 42.7.6 61.7 9.1 19.3 28.3 34.5 49.5 39 11.9 2.6 28.4 1.7 39.3-2.2 23.9-8.6 41.3-27.9 46.9-51.9 1.9-8.5 1.9-24.4-.1-33.1-5.9-25.5-26.7-46.6-52.5-53.3-10.1-2.6-25.8-2.6-35.9 0zM290.2 450.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6zM450.2 450.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6z"></path></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">Jayground8</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">블로그</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-0 left-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><div class="flex justify-end"><button type="button" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">블로그</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2024-05-26T00:00:00.000Z">2024년 5월 26일 일요일</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">opentelemetry-operator 사용해보기</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2738%27%20height=%2738%27/%3e"/></span><img alt="avatar" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="h-10 w-10 rounded-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="avatar" srcSet="https://jayground8.github.io/static/images/profile.png?w=48&amp;q=75 1x, https://jayground8.github.io/static/images/profile.png?w=96&amp;q=75 2x" src="https://jayground8.github.io/static/images/profile.png?w=96&amp;q=75" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="h-10 w-10 rounded-full" loading="lazy"/></noscript></span><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Jay</dd><dt class="sr-only">Twitter</dt><dd></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><p>다양한 런타임(Java, Python, Nodejs)로 어플리케이션이 쿠버네티스에서 실행 중일 때, Log, Trace, Metric을 어떻게 수집하면 좋을까? <a target="_blank" rel="noopener noreferrer" href="https://opentelemetry.io/docs/kubernetes/operator/">OpenTelmetry Operator</a>를 사용하는 것을 생각해볼 수 있다. 어플리케이션 코드를 수정하지 않고 <code>Instrumentation CRD</code>를 통해서 자동으로 instrumentation을 할 수 있다. 이번 블로그에서는 Python에서 OpenTelemetry를 통해서 로그를 수집하는 것에 대해서 집중적으로 살펴 본다.</p><h2 id="helm-chart로-설치"><a href="#helm-chart로-설치" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Helm Chart로 설치</h2><p><a target="_blank" rel="noopener noreferrer" href="https://cert-manager.io/">cert-manager</a>를 먼저 설치하고, Helm Chart로 open-telemetry/opentelemetry-operator <code>0.58.2</code>를 설치한다.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">kubecl create namespace opentelemetry-operator-system
</span><span class="code-line">helm repo <span class="token function">add</span> open-telemetry https://open-telemetry.github.io/opentelemetry-helm-charts
</span><span class="code-line">helm repo update
</span><span class="code-line">helm <span class="token function">install</span> opentelemetry-operator open-telemetry/opentelemetry-operator <span class="token punctuation">\</span>
</span><span class="code-line">--namespace opentelemetry-operator-system
</span></code></pre></div><h2 id="opentelemetry-collector-설치"><a href="#opentelemetry-collector-설치" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>OpenTelemetry Collector 설치</h2><p><code>OpenTelemetry Operator</code>로 Collector를 설정할 수 있지만, Helm Chart로 별도로 실행하면 아래와 같이 values를 정의할 수 있다. 추가적으로 <code>Loki</code>를 통해서 Log를 수집하도록 설정하였다. <a target="_blank" rel="noopener noreferrer" href="https://grafana.com/docs/loki/latest/send-data/otel/">Loki의 문서를 보면 OTLP 프로토콜로 Log를 수집하는 방법</a>도 설명하고 있는데, 여기서는 <a target="_blank" rel="noopener noreferrer" href="https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/exporter/lokiexporter/README.md">Loki Exporter</a>를 사용했다. Loki Exporter의 <code>default_labels_enabled</code> 설정을 통해서 기본적인 Loki Label(Index)를 추가하도록 했다. 그리고 <code>Instrumentation CRD</code>를 통해서 OpenTelemetry Instrumentation을 자동으로 할 때 생성되는 resources 값들을 Loki label로 추가하도록 <a target="_blank" rel="noopener noreferrer" href="https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/processor/resourceprocessor/README.md">Resource Processor</a>를 사용하였다.</p><p><code>values.yml</code></p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">config</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">receivers</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">jaeger</span><span class="token punctuation">:</span> <span class="token important null">null</span>
</span><span class="code-line">    <span class="token atrule key">prometheus</span><span class="token punctuation">:</span> <span class="token important null">null</span>
</span><span class="code-line">    <span class="token atrule key">zipkin</span><span class="token punctuation">:</span> <span class="token important null">null</span>
</span><span class="code-line">  <span class="token atrule key">service</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">telemetry</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">logs</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">level</span><span class="token punctuation">:</span> info
</span><span class="code-line">    <span class="token atrule key">pipelines</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">traces</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">receivers</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> otlp
</span><span class="code-line">      <span class="token atrule key">metrics</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">receivers</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> otlp
</span><span class="code-line">      <span class="token atrule key">logs</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">receivers</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> otlp
</span><span class="code-line">        <span class="token atrule key">processors</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> resource
</span><span class="code-line">        <span class="token atrule key">exporters</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token punctuation">-</span> loki
</span><span class="code-line">  <span class="token atrule key">processors</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">resource</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">attributes</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token punctuation">-</span> <span class="token atrule key">action</span><span class="token punctuation">:</span> insert
</span><span class="code-line">          <span class="token atrule key">key</span><span class="token punctuation">:</span> pod
</span><span class="code-line">          <span class="token atrule key">from_attribute</span><span class="token punctuation">:</span> k8s.pod.name
</span><span class="code-line">        <span class="token punctuation">-</span> <span class="token atrule key">action</span><span class="token punctuation">:</span> insert
</span><span class="code-line">          <span class="token atrule key">key</span><span class="token punctuation">:</span> container
</span><span class="code-line">          <span class="token atrule key">from_attribute</span><span class="token punctuation">:</span> k8s.container.name
</span><span class="code-line">        <span class="token punctuation">-</span> <span class="token atrule key">action</span><span class="token punctuation">:</span> insert
</span><span class="code-line">          <span class="token atrule key">key</span><span class="token punctuation">:</span> namespace
</span><span class="code-line">          <span class="token atrule key">from_attribute</span><span class="token punctuation">:</span> k8s.namespace.name
</span><span class="code-line">        <span class="token punctuation">-</span> <span class="token atrule key">action</span><span class="token punctuation">:</span> insert
</span><span class="code-line">          <span class="token atrule key">key</span><span class="token punctuation">:</span> loki.resource.labels
</span><span class="code-line">          <span class="token atrule key">value</span><span class="token punctuation">:</span> pod<span class="token punctuation">,</span> namespace<span class="token punctuation">,</span> container
</span><span class="code-line">  <span class="token atrule key">exporters</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">loki</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">endpoint</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//loki<span class="token punctuation">-</span>gateway/loki/api/v1/push
</span><span class="code-line">      <span class="token atrule key">default_labels_enabled</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">exporter</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">        <span class="token atrule key">job</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line"><span class="token atrule key">ports</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">jaeger-compact</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</span><span class="code-line">  <span class="token atrule key">jaeger-thrift</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</span><span class="code-line">  <span class="token atrule key">jaeger-grpc</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</span><span class="code-line">  <span class="token atrule key">zipkin</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</span><span class="code-line"><span class="token atrule key">mode</span><span class="token punctuation">:</span> daemonset
</span><span class="code-line"><span class="token atrule key">presets</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">logsCollection</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</span><span class="code-line">    <span class="token atrule key">includeCollectorLogs</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</span></code></pre></div><p>위에서 OpenTelemetry Collector를 DaemonSet으로 실행하도록 설정하였다. Service는 <a target="_blank" rel="noopener noreferrer" href="https://kubernetes.io/docs/concepts/services-networking/service-traffic-policy/#using-service-internal-traffic-policy">internalTrafficPolicy</a>를 통해서 같은 Node에 있는 OpenTelmetry Colletor endpoint에 접근하도록 설정했다. 그리고 다른 Namespace에 있는 Service에 접근하기 위해서 <code>ExternalName</code>으로 서비스를 추가하였다.</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> v1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> Service
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">name</span><span class="token punctuation">:</span> otel<span class="token punctuation">-</span>collector
</span><span class="code-line">  <span class="token atrule key">namespace</span><span class="token punctuation">:</span> opentelemetry
</span><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">type</span><span class="token punctuation">:</span> ClusterIP
</span><span class="code-line">  <span class="token atrule key">selector</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">app.kubernetes.io/name</span><span class="token punctuation">:</span> opentelemetry<span class="token punctuation">-</span>collector
</span><span class="code-line">  <span class="token atrule key">ports</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> http
</span><span class="code-line">      <span class="token atrule key">port</span><span class="token punctuation">:</span> <span class="token number">4318</span>
</span><span class="code-line">      <span class="token atrule key">targetPort</span><span class="token punctuation">:</span> <span class="token number">4318</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> grpc
</span><span class="code-line">      <span class="token atrule key">port</span><span class="token punctuation">:</span> <span class="token number">4317</span>
</span><span class="code-line">      <span class="token atrule key">targetPort</span><span class="token punctuation">:</span> <span class="token number">4317</span>
</span><span class="code-line">  <span class="token atrule key">internalTrafficPolicy</span><span class="token punctuation">:</span> Local
</span><span class="code-line"><span class="token punctuation">---</span>
</span><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> v1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> Service
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">name</span><span class="token punctuation">:</span> otel<span class="token punctuation">-</span>collector
</span><span class="code-line">  <span class="token atrule key">namespace</span><span class="token punctuation">:</span> example
</span><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">type</span><span class="token punctuation">:</span> ExternalName
</span><span class="code-line">  <span class="token atrule key">externalName</span><span class="token punctuation">:</span> otel<span class="token punctuation">-</span>collector.opentelemetry.svc.cluster.local
</span></code></pre></div><h2 id="instrumentation-crd-생성"><a href="#instrumentation-crd-생성" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Instrumentation CRD 생성</h2><p><a target="_blank" rel="noopener noreferrer" href="https://opentelemetry.io/docs/kubernetes/operator/automatic/#python">공식 문서에서 Python의 경우 어떻게 Instrumentation CRD를 생성해야할지 잘 설명하고 있다.</a> 아래와 같이 Python에 대해서 설정을 하여 Instrumentation를 생성한다.</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> opentelemetry.io/v1alpha1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> Instrumentation
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">name</span><span class="token punctuation">:</span> python<span class="token punctuation">-</span>instrumentation
</span><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">exporter</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">endpoint</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//otel<span class="token punctuation">-</span>collector<span class="token punctuation">:</span><span class="token number">4318</span>
</span><span class="code-line">  <span class="token atrule key">env</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">propagators</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> tracecontext
</span><span class="code-line">    <span class="token punctuation">-</span> baggage
</span><span class="code-line">  <span class="token atrule key">python</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">env</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> OTEL_LOGS_EXPORTER
</span><span class="code-line">        <span class="token atrule key">value</span><span class="token punctuation">:</span> console
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> OTEL_PYTHON_LOGGING_AUTO_INSTRUMENTATION_ENABLED
</span><span class="code-line">        <span class="token atrule key">value</span><span class="token punctuation">:</span> <span class="token string">&#x27;true&#x27;</span>
</span></code></pre></div><p><a target="_blank" rel="noopener noreferrer" href="https://opentelemetry.io/docs/languages/python/">이 글을 쓰는 시점에서 Python Otel SDK libary중에 Logs는 Experimental 상태이다.</a>.</p><img src="/static/images/otel-python-logs-status.png" alt="OpenTelemetry Python Logs Status"/><p>따라서 logs는 기본적으로 사용하지 않게 되어 있는데, 사용하려면 아래와 같이 <code>환경변수를 꼭 설정해줘야 한다</code>. <code>OTEL_LOGS_EXPORTER</code>를 <code>console</code>로 설정하여 OpenTelemetry Collector에 보내기 전에 로그가 잘 남고 있는지 확인하고자 한다.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">By default, Python logs auto-instrumentation is disabled.
</span><span class="code-line">If you would like to <span class="token builtin class-name">enable</span> this feature, you must to <span class="token builtin class-name">set</span> the OTEL_LOGS_EXPORTER and OTEL_PYTHON_LOGGING_AUTO_INSTRUMENTATION_ENABLED environment variables as follows
</span></code></pre></div><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">python</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">env</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> OTEL_LOGS_EXPORTER
</span><span class="code-line">      <span class="token atrule key">value</span><span class="token punctuation">:</span> console
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> OTEL_PYTHON_LOGGING_AUTO_INSTRUMENTATION_ENABLED
</span><span class="code-line">      <span class="token atrule key">value</span><span class="token punctuation">:</span> <span class="token string">&#x27;true&#x27;</span>
</span></code></pre></div><h2 id="flask-app에-적용"><a href="#flask-app에-적용" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Flask App에 적용</h2><p>Flask Application을 실행해서 확인해보자. 아주 단순하게 <code>GET /hello</code>로 요청하면 응답하는 코드이다.</p><p><code>app.py</code></p><div class="relative"><pre><code class="code-highlight language-py"><span class="code-line"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request
</span><span class="code-line">
</span><span class="code-line">app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token punctuation annotation decorator">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">server_request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;hello world!&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token string">&quot;world!&quot;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
</span><span class="code-line">    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span>
</span></code></pre></div><p>Python package는 <code>flask</code>만 설치하도록 한다.</p><p><code>requirements.txt</code></p><div class="relative"><pre><code class="code-highlight language-txt"><span class="code-line">flask
</span></code></pre></div><p>쿠버네티스에서 실행하기 위해서 Container Image를 생성한다.</p><p><code>Dockerfile</code></p><div class="relative"><pre><code class="code-highlight language-Dockerfile"><span class="code-line"><span class="token instruction"><span class="token keyword">FROM</span> <span class="token options"><span class="token property">--platform</span><span class="token punctuation">=</span><span class="token string">linux/amd64</span></span> python:3.11</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">WORKDIR</span> /usr/src/app</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">COPY</span> requirements.txt requirements.txt</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">RUN</span> pip3 install --no-cache-dir -r requirements.txt</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">COPY</span> . .</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;python&quot;</span>, <span class="token string">&quot;-m&quot;</span>, <span class="token string">&quot;flask&quot;</span>, <span class="token string">&quot;--app&quot;</span>, <span class="token string">&quot;app&quot;</span>, <span class="token string">&quot;run&quot;</span>]</span>
</span></code></pre></div><p>Dockerfile로 빌드한 컨테이너 이미지를 쿠버네티스에 배포한다. 이때 Annotation을 통해서 auto instrumentation이 될 수 있도록 설정한다.</p><p><code>deployment.yml</code></p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> apps/v1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> Deployment
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">name</span><span class="token punctuation">:</span> sample
</span><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">selector</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">matchLabels</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">app</span><span class="token punctuation">:</span> sample
</span><span class="code-line">  <span class="token atrule key">template</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">annotations</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">instrumentation.opentelemetry.io/inject-python</span><span class="token punctuation">:</span> <span class="token string">&#x27;true&#x27;</span>
</span><span class="code-line">      <span class="token atrule key">labels</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">app</span><span class="token punctuation">:</span> sample
</span><span class="code-line">    <span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">containers</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token punctuation">-</span> <span class="token atrule key">image</span><span class="token punctuation">:</span> sample
</span><span class="code-line">          <span class="token atrule key">name</span><span class="token punctuation">:</span> sample
</span><span class="code-line">          <span class="token atrule key">imagePullPolicy</span><span class="token punctuation">:</span> Always
</span></code></pre></div><p>그럼 이제 해당 Conatiner에 터미널 접속해서 curl로 요청을 해본다.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line"><span class="token function">curl</span> localhost:5000/hello
</span></code></pre></div><p>이제 <code>kubectl logs</code>로 해당 컨테이너의 log를 확인해보면 아래와 같이 남는 것을 확인할 수 있다. 위세서 <code>Instrumentation CRD</code>를 생성할 때 <code>OTEL_LOGS_EXPORTER</code>를 <code>console</code>로 설정했기 때문에 이렇게 log를 확인할 수 있는 것이다.</p><div class="relative"><pre><code class="code-highlight language-json"><span class="code-line"><span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token property">&quot;body&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1 - - [25/May/2024 23:02:38] \&quot;GET /hello HTTP/1.1\&quot; 200 -&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;severity_number&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;SeverityNumber.INFO: 9&gt;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;severity_text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;INFO&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;attributes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token property">&quot;otelSpanID&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;otelTraceID&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;otelTraceSampled&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;otelServiceName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sample&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;code.filepath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/usr/local/lib/python3.11/site-packages/werkzeug/_internal.py&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;code.function&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_log&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;code.lineno&quot;</span><span class="token operator">:</span> <span class="token number">97</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;dropped_attributes&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2024-05-25T23:02:38.152708Z&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;observed_timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2024-05-25T23:02:38.152765Z&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;trace_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x00000000000000000000000000000000&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;span_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x0000000000000000&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;trace_flags&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{&#x27;telemetry.sdk.language&#x27;: &#x27;python&#x27;, &#x27;telemetry.sdk.name&#x27;: &#x27;opentelemetry&#x27;, &#x27;telemetry.sdk.version&#x27;: &#x27;1.23.0&#x27;, &#x27;k8s.container.name&#x27;: &#x27;sample&#x27;, &#x27;k8s.deployment.name&#x27;: &#x27;sample&#x27;, &#x27;k8s.namespace.name&#x27;: &#x27;example&#x27;, &#x27;k8s.node.name&#x27;: &#x27;example-node&#x27;, &#x27;k8s.pod.name&#x27;: &#x27;sample-656f58b97c-swk2p&#x27;, &#x27;k8s.replicaset.name&#x27;: &#x27;sample-656f58b97c&#x27;, &#x27;service.instance.id&#x27;: &#x27;example.sample-656f58b97c-swk2p.sample&#x27;, &#x27;service.version&#x27;: &#x27;amd64&#x27;, &#x27;service.name&#x27;: &#x27;sample&#x27;, &#x27;telemetry.auto.version&#x27;: &#x27;0.44b0&#x27;}&quot;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h2 id="init-container-확인"><a href="#init-container-확인" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Init Container 확인</h2><p>배포된 Pod의 상세 정보를 보면 아래와 같이 <code>Init Conatiner</code>가 실행된 것을 확인할 수 있다.</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">Init Containers</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">opentelemetry-auto-instrumentation-python</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">Container ID</span><span class="token punctuation">:</span> containerd<span class="token punctuation">:</span>//2e5230382ee3a5819d349baeb65871dd368d0eaffa7b589b9c874a8b7ff5fc81
</span><span class="code-line">    <span class="token atrule key">Image</span><span class="token punctuation">:</span> ghcr.io/open<span class="token punctuation">-</span>telemetry/opentelemetry<span class="token punctuation">-</span>operator/autoinstrumentation<span class="token punctuation">-</span>python<span class="token punctuation">:</span>0.44b0
</span><span class="code-line">    <span class="token atrule key">Image ID</span><span class="token punctuation">:</span> ghcr.io/open<span class="token punctuation">-</span>telemetry/opentelemetry<span class="token punctuation">-</span>operator/autoinstrumentation<span class="token punctuation">-</span>python@sha256<span class="token punctuation">:</span>a463e65ed49d6dee2ec79b40339f802341291a4e62655d2caeded5aa1e15e8d2
</span><span class="code-line">    <span class="token atrule key">Port</span><span class="token punctuation">:</span> &lt;none<span class="token punctuation">&gt;</span>
</span><span class="code-line">    <span class="token atrule key">Host Port</span><span class="token punctuation">:</span> &lt;none<span class="token punctuation">&gt;</span>
</span><span class="code-line">    <span class="token atrule key">Command</span><span class="token punctuation">:</span> cp
</span><span class="code-line">      <span class="token punctuation">-</span>r
</span><span class="code-line">      /autoinstrumentation/.
</span><span class="code-line">      /otel<span class="token punctuation">-</span>auto<span class="token punctuation">-</span>instrumentation<span class="token punctuation">-</span>python
</span></code></pre></div><p>Flask Application이 실행되는 Container에 자동으로 아래와 같이 환경변수가 설정되어 있다. Python OpenTelemetry SDK가 환경변수들을 통해서 설정된다.</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">Containers</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">sample</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">Environment</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">OTEL_NODE_IP</span><span class="token punctuation">:</span> (v1<span class="token punctuation">:</span>status.hostIP)
</span><span class="code-line">      <span class="token atrule key">OTEL_POD_IP</span><span class="token punctuation">:</span> (v1<span class="token punctuation">:</span>status.podIP)
</span><span class="code-line">      <span class="token atrule key">OTEL_EXPORTER_OTLP_PROTOCOL</span><span class="token punctuation">:</span> http/protobuf
</span><span class="code-line">      <span class="token atrule key">OTEL_LOGS_EXPORTER</span><span class="token punctuation">:</span> console
</span><span class="code-line">      <span class="token atrule key">OTEL_PYTHON_LOGGING_AUTO_INSTRUMENTATION_ENABLED</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">      <span class="token atrule key">PYTHONPATH</span><span class="token punctuation">:</span> /otel<span class="token punctuation">-</span>auto<span class="token punctuation">-</span>instrumentation<span class="token punctuation">-</span>python/opentelemetry/instrumentation/auto_instrumentation<span class="token punctuation">:</span>/otel<span class="token punctuation">-</span>auto<span class="token punctuation">-</span>instrumentation<span class="token punctuation">-</span>python
</span><span class="code-line">      <span class="token atrule key">OTEL_TRACES_EXPORTER</span><span class="token punctuation">:</span> otlp
</span><span class="code-line">      <span class="token atrule key">OTEL_EXPORTER_OTLP_TRACES_PROTOCOL</span><span class="token punctuation">:</span> http/protobuf
</span><span class="code-line">      <span class="token atrule key">OTEL_METRICS_EXPORTER</span><span class="token punctuation">:</span> otlp
</span><span class="code-line">      <span class="token atrule key">OTEL_EXPORTER_OTLP_METRICS_PROTOCOL</span><span class="token punctuation">:</span> http/protobuf
</span><span class="code-line">      <span class="token atrule key">OTEL_SERVICE_NAME</span><span class="token punctuation">:</span> sample
</span><span class="code-line">      <span class="token atrule key">OTEL_EXPORTER_OTLP_ENDPOINT</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//otel<span class="token punctuation">-</span>collector<span class="token punctuation">:</span><span class="token number">4318</span>
</span><span class="code-line">      <span class="token atrule key">OTEL_RESOURCE_ATTRIBUTES_POD_NAME</span><span class="token punctuation">:</span> sample<span class="token punctuation">-</span>656f58b97c<span class="token punctuation">-</span>9spzq (v1<span class="token punctuation">:</span>metadata.name)
</span><span class="code-line">      <span class="token atrule key">OTEL_RESOURCE_ATTRIBUTES_NODE_NAME</span><span class="token punctuation">:</span> (v1<span class="token punctuation">:</span>spec.nodeName)
</span><span class="code-line">      <span class="token atrule key">OTEL_PROPAGATORS</span><span class="token punctuation">:</span> tracecontext<span class="token punctuation">,</span>baggage
</span><span class="code-line">      <span class="token atrule key">OTEL_TRACES_SAMPLER</span><span class="token punctuation">:</span> parentbased_traceidratio
</span><span class="code-line">      <span class="token atrule key">OTEL_TRACES_SAMPLER_ARG</span><span class="token punctuation">:</span> <span class="token number">1</span>
</span><span class="code-line">      <span class="token atrule key">OTEL_RESOURCE_ATTRIBUTES</span><span class="token punctuation">:</span> k8s.container.name=sample<span class="token punctuation">,</span>k8s.deployment.name=sample<span class="token punctuation">,</span>k8s.namespace.name=example<span class="token punctuation">,</span>k8s.node.name=$(OTEL_RESOURCE_ATTRIBUTES_NODE_NAME)<span class="token punctuation">,</span>k8s.pod.name=$(OTEL_RESOURCE_ATTRIBUTES_POD_NAME)<span class="token punctuation">,</span>k8s.replicaset.name=sample<span class="token punctuation">-</span>656f58b97c<span class="token punctuation">,</span>service.instance.id=example.$(OTEL_RESOURCE_ATTRIBUTES_POD_NAME).sample<span class="token punctuation">,</span>service.version=amd64
</span><span class="code-line">    <span class="token atrule key">Mounts</span><span class="token punctuation">:</span> /otel<span class="token punctuation">-</span>auto<span class="token punctuation">-</span>instrumentation<span class="token punctuation">-</span>python from opentelemetry<span class="token punctuation">-</span>auto<span class="token punctuation">-</span>instrumentation<span class="token punctuation">-</span>python (rw)
</span><span class="code-line">      /var/run/secrets/kubernetes.io/serviceaccount from kube<span class="token punctuation">-</span>api<span class="token punctuation">-</span>access<span class="token punctuation">-</span>49jw9 (ro)
</span></code></pre></div><p>그리고 Init Container를 통해서 설정된 데이터가 Mount된 것을 확인할 수 있다.</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">Containers</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">sample</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">Mounts</span><span class="token punctuation">:</span> /otel<span class="token punctuation">-</span>auto<span class="token punctuation">-</span>instrumentation<span class="token punctuation">-</span>python from opentelemetry<span class="token punctuation">-</span>auto<span class="token punctuation">-</span>instrumentation<span class="token punctuation">-</span>python (rw)
</span><span class="code-line">      /var/run/secrets/kubernetes.io/serviceaccount from kube<span class="token punctuation">-</span>api<span class="token punctuation">-</span>access<span class="token punctuation">-</span>49jw9 (ro)
</span></code></pre></div><p><a target="_blank" rel="noopener noreferrer" href="https://github.com/open-telemetry/opentelemetry-operator/blob/main/autoinstrumentation/python/Dockerfile">opentelemetry-operator에서 autoinstrumentation 소스코드</a>를 확인해보면 다양한 OpenTelemetry Instrumentation package들을 설치하는 것을 알 수 있다. Init Container에서 해당 package들을 설치하고, 설치된 package 파일들이 Mount된 경로에 저장되어 있다.</p><div class="relative"><pre><code class="code-highlight language-Dockerfile"><span class="code-line"><span class="token instruction"><span class="token keyword">FROM</span> python:3.11 <span class="token keyword">AS</span> build</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token instruction"><span class="token keyword">WORKDIR</span> /operator-build</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token instruction"><span class="token keyword">ADD</span> requirements.txt .</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token instruction"><span class="token keyword">RUN</span> mkdir workspace &amp;&amp; pip install --target workspace -r requirements.txt</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token instruction"><span class="token keyword">FROM</span> busybox</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">build</span></span> /operator-build/workspace /autoinstrumentation</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token instruction"><span class="token keyword">RUN</span> chmod -R go+r /autoinstrumentation</span>
</span></code></pre></div><p>그리고 Flask Application이 실행중인 Container에 Terminal로 연결해서 확인하면 PYTHONPATH를 확인해보면, 해당 경로가 포함되어 있는 것을 확인할 수 있다. 그래서 나의 Flask 어플리케이션이 실행하는 컨테이너에서도 init Container에서 설치한 경로의 package들을 사용할 수 있다.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line"><span class="token comment"># export</span>
</span><span class="code-line"><span class="token builtin class-name">declare</span> -x <span class="token assign-left variable">PYTHONPATH</span><span class="token operator">=</span><span class="token string">&quot;/otel-auto-instrumentation-python/opentelemetry/instrumentation/auto_instrumentation:/otel-auto-instrumentation-python&quot;</span>
</span></code></pre></div><p>그런데 PYTHONPATH 환경변수를 보면, Init Container에 의해서 설치되는 패키지들이 있는 <code>otel-auto-instrumentation-python</code> 경로 말고 아래의 경로가 보인다.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">/otel-auto-instrumentation-python/opentelemetry/instrumentation/auto_instrumentation
</span></code></pre></div><p>해당 경로는 <a target="_blank" rel="noopener noreferrer" href="https://github.com/open-telemetry/opentelemetry-python-contrib/tree/main/opentelemetry-instrumentation/src/opentelemetry/instrumentation/auto_instrumentation">소스코드처럼</a> <code>sitecustomize.py</code>이 있다. <a target="_blank" rel="noopener noreferrer" href="https://docs.python.org/3/library/site.html#module-sitecustomize">Python에서 PYTHONPATH의 root 경로에 sitecustomize.py를 추가하면 자동으로 import를 할 수 있다.</a> <a target="_blank" rel="noopener noreferrer" href="https://medium.com/alan/simplifying-python-workflows-with-the-sitecustomize-py-e1b1ad5c6fbe">이 블로그에서는 아래처럼 잘 설명해주고 있다.</a></p><blockquote><p>If you configure the PYTHONPATH=. environment variable, any sitecustomize.py at the root of your repository will be evaluated before any application code runs.</p></blockquote><p>이제 <code>opentelemetry-operator</code>가 init container를 통해서 instrumentation library들을 설치하고, Python의 <code>sitecustomize.py</code>로 자동으로 instrumentation을 하게 된다. <code>requirements.txt</code>에는 <code>flask</code>만 추가하고, 소스코드에 OpenTelemetry관련 설정 코드를 추가하지 않아도 자동으로 OpenTelemetry를 통해서 Metric, Trace, Log를 수집할 수 있다.</p><h2 id="logs-bridge-api"><a href="#logs-bridge-api" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Logs Bridge API</h2><p>위에서 우리는 Flask 어플리케이션으로 테스트를 해봤다. 그런데 <code>print(&quot;hello world!&quot;)</code>라고 standard output으로 로그를 남기도록 작성했었다.</p><p><code>app.py</code></p><div class="relative"><pre><code class="code-highlight language-py"><span class="code-line"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
</span><span class="code-line">
</span><span class="code-line">app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token punctuation annotation decorator">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">server_request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    app<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">&#x27;hello from logger!&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;hello world!&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token string">&quot;world!&quot;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
</span><span class="code-line">    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span>
</span></code></pre></div><p>그런데 <code>kubectl logs</code>로 확인을 해보면 해당 로그는 OpenTelmetry Spec에 맞춰서 남고 있지 않는 것을 확인할 수 있다. 왜 이렇게 남을까? 🤔</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">hello world<span class="token operator">!</span>
</span><span class="code-line">hello world<span class="token operator">!</span>
</span><span class="code-line">hello world<span class="token operator">!</span>
</span><span class="code-line"><span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token string">&quot;body&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;127.0.0.1 - - [25/May/2024 23:02:36] <span class="token entity" title="\&quot;">\&quot;</span>GET /hello HTTP/1.1<span class="token entity" title="\&quot;">\&quot;</span> 200 -&quot;</span>,
</span><span class="code-line">    <span class="token string">&quot;severity_number&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&lt;SeverityNumber.INFO: 9&gt;&quot;</span>,
</span><span class="code-line">    <span class="token string">&quot;severity_text&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;INFO&quot;</span>,
</span><span class="code-line">    <span class="token string">&quot;attributes&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token string">&quot;otelSpanID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0&quot;</span>,
</span><span class="code-line">        <span class="token string">&quot;otelTraceID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0&quot;</span>,
</span><span class="code-line">        <span class="token string">&quot;otelTraceSampled&quot;</span><span class="token builtin class-name">:</span> false,
</span><span class="code-line">        <span class="token string">&quot;otelServiceName&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;sample&quot;</span>,
</span><span class="code-line">        <span class="token string">&quot;code.filepath&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/usr/local/lib/python3.11/site-packages/werkzeug/_internal.py&quot;</span>,
</span><span class="code-line">        <span class="token string">&quot;code.function&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;_log&quot;</span>,
</span><span class="code-line">        <span class="token string">&quot;code.lineno&quot;</span><span class="token builtin class-name">:</span> <span class="token number">97</span>
</span><span class="code-line">    <span class="token punctuation">}</span>,
</span><span class="code-line">    <span class="token string">&quot;dropped_attributes&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
</span><span class="code-line">    <span class="token string">&quot;timestamp&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2024-05-23T25:02:36.856645Z&quot;</span>,
</span><span class="code-line">    <span class="token string">&quot;observed_timestamp&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2024-05-25T23:02:36.856694Z&quot;</span>,
</span><span class="code-line">    <span class="token string">&quot;trace_id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0x00000000000000000000000000000000&quot;</span>,
</span><span class="code-line">    <span class="token string">&quot;span_id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0x0000000000000000&quot;</span>,
</span><span class="code-line">    <span class="token string">&quot;trace_flags&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
</span><span class="code-line">    <span class="token string">&quot;resource&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;{&#x27;telemetry.sdk.language&#x27;: &#x27;python&#x27;, &#x27;telemetry.sdk.name&#x27;: &#x27;opentelemetry&#x27;, &#x27;telemetry.sdk.version&#x27;: &#x27;1.23.0&#x27;, &#x27;k8s.container.name&#x27;: &#x27;sample&#x27;, &#x27;k8s.deployment.name&#x27;: &#x27;sample&#x27;, &#x27;k8s.namespace.name&#x27;: &#x27;example&#x27;, &#x27;k8s.node.name&#x27;: &#x27;example-node&#x27;, &#x27;k8s.pod.name&#x27;: &#x27;sample-656f58b97c-swk2p&#x27;, &#x27;k8s.replicaset.name&#x27;: &#x27;sample-656f58b97c&#x27;, &#x27;service.instance.id&#x27;: &#x27;example.sample-656f58b97c-swk2p.sample&#x27;, &#x27;service.version&#x27;: &#x27;amd64&#x27;, &#x27;service.name&#x27;: &#x27;sample&#x27;, &#x27;telemetry.auto.version&#x27;: &#x27;0.44b0&#x27;}&quot;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p><a target="_blank" rel="noopener noreferrer" href="https://opentelemetry.io/docs/specs/otel/logs/">OpenTelemetry 공식문서에서 Logging은 어떤식으로 설계했는지 친절하게 설명</a>이 되어 있다. 이미 Logging 관련한 다양한 라이브러리가 존재하는데, 기존 Logging 라이브러리를 사용해서 OpenTelemetry 로그를 남길 수 있도록 아래와 같은 구조로 되어 있다.</p><img src="/static/images/otel-logs-bridge-api.png" alt="OpenTelemetry logs bridge API"/><blockquote><p>Instead of modifying each logging statement, log appenders use the API to bridge logs from existing logging libraries to the OpenTelemetry data model, where the SDK controls how the logs are processed and exported.</p></blockquote><p>Flask에서는 Python standard library인 <code>logging</code>을 사용하고, 아래와 같이 로그를 남긴다. 그런데 해당 logging 라이브러리가 OpenTelemetry Bridge API를 통해서 OpenTelemetry 규격에 많은 로그가 남게 되는 것이다. 하지만 <code>print</code>를 사용했을 때는 이러한 구조로 연결되어 있지 않기 때문에 단순 stdout으로 남는다.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line"><span class="token number">127.0</span>.0.1 - - <span class="token punctuation">[</span><span class="token number">25</span>/May/2024 <span class="token number">23</span>:02:36<span class="token punctuation">]</span> <span class="token punctuation">\</span>&quot;GET /hello HTTP/1.1<span class="token punctuation">\</span>&quot; <span class="token number">200</span> -
</span></code></pre></div><p><a target="_blank" rel="noopener noreferrer" href="https://github.com/open-telemetry/opentelemetry-python/blob/187048a35ee93194a70a45720fa68b78d57b6a97/opentelemetry-sdk/src/opentelemetry/sdk/_configuration/__init__.py#L388">opentelemetry-sdk 소스코드를 보면</a> 아래와 같이 handler가 추가되는 것을 확인할 수 있다. 환경변수를 <code>true</code>로 설정하지 않으면 해당 <code>_init_logging</code>가 실행되지 않는다.</p><div class="relative"><pre><code class="code-highlight language-py"><span class="code-line">logging_enabled <span class="token operator">=</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span>
</span><span class="code-line">    _OTEL_PYTHON_LOGGING_AUTO_INSTRUMENTATION_ENABLED<span class="token punctuation">,</span> <span class="token string">&quot;false&quot;</span>
</span><span class="code-line"><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">if</span> logging_enabled<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">:</span>
</span><span class="code-line">    _init_logging<span class="token punctuation">(</span>log_exporters<span class="token punctuation">,</span> resource<span class="token punctuation">)</span>
</span></code></pre></div><div class="relative"><pre><code class="code-highlight language-py"><span class="code-line"><span class="token keyword">def</span> <span class="token function">_init_logging</span><span class="token punctuation">(</span>
</span><span class="code-line">    exporters<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Type<span class="token punctuation">[</span>LogExporter<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">    resource<span class="token punctuation">:</span> Resource <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    provider <span class="token operator">=</span> LoggerProvider<span class="token punctuation">(</span>resource<span class="token operator">=</span>resource<span class="token punctuation">)</span>
</span><span class="code-line">    set_logger_provider<span class="token punctuation">(</span>provider<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">for</span> _<span class="token punctuation">,</span> exporter_class <span class="token keyword">in</span> exporters<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        exporter_args <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">        provider<span class="token punctuation">.</span>add_log_record_processor<span class="token punctuation">(</span>
</span><span class="code-line">            BatchLogRecordProcessor<span class="token punctuation">(</span>exporter_class<span class="token punctuation">(</span><span class="token operator">**</span>exporter_args<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    handler <span class="token operator">=</span> LoggingHandler<span class="token punctuation">(</span>level<span class="token operator">=</span>logging<span class="token punctuation">.</span>NOTSET<span class="token punctuation">,</span> logger_provider<span class="token operator">=</span>provider<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>addHandler<span class="token punctuation">(</span>handler<span class="token punctuation">)</span>
</span></code></pre></div><h2 id="manual하게-logging-설정"><a href="#manual하게-logging-설정" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Manual하게 Logging 설정</h2><p>위의 코드를 이해하기 위해서 메뉴얼하게 Python Logger 라이브러리에 OpenTelemetry sdk로 log를 보내도록 handler를 추가하면 아래 코드와 같다.</p><p><code>app.py</code></p><div class="relative"><pre><code class="code-highlight language-py"><span class="code-line"><span class="token keyword">import</span> logging<span class="token punctuation">,</span> os
</span><span class="code-line"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request
</span><span class="code-line"><span class="token keyword">from</span> opentelemetry<span class="token punctuation">.</span>_logs <span class="token keyword">import</span> set_logger_provider
</span><span class="code-line"><span class="token keyword">from</span> opentelemetry<span class="token punctuation">.</span>exporter<span class="token punctuation">.</span>otlp<span class="token punctuation">.</span>proto<span class="token punctuation">.</span>http<span class="token punctuation">.</span>_log_exporter <span class="token keyword">import</span> OTLPLogExporter
</span><span class="code-line"><span class="token keyword">from</span> opentelemetry<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>_logs <span class="token keyword">import</span> LoggerProvider<span class="token punctuation">,</span> LoggingHandler
</span><span class="code-line"><span class="token keyword">from</span> opentelemetry<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>_logs<span class="token punctuation">.</span>export <span class="token keyword">import</span> BatchLogRecordProcessor
</span><span class="code-line"><span class="token keyword">from</span> opentelemetry<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>resources <span class="token keyword">import</span> Resource
</span><span class="code-line">
</span><span class="code-line">logger_provider <span class="token operator">=</span> LoggerProvider<span class="token punctuation">(</span>
</span><span class="code-line">    resource<span class="token operator">=</span>Resource<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
</span><span class="code-line">        <span class="token punctuation">{</span>
</span><span class="code-line">            <span class="token string">&quot;service.name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;example&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">            <span class="token string">&quot;service.instance.id&quot;</span><span class="token punctuation">:</span> os<span class="token punctuation">.</span>uname<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>nodename<span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">)</span>
</span><span class="code-line">set_logger_provider<span class="token punctuation">(</span>logger_provider<span class="token punctuation">)</span>
</span><span class="code-line">otlp_exporter <span class="token operator">=</span> OTLPLogExporter<span class="token punctuation">(</span>endpoint<span class="token operator">=</span><span class="token string">&quot;http://otel-collector:4318/v1/logs&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">logger_provider<span class="token punctuation">.</span>add_log_record_processor<span class="token punctuation">(</span>BatchLogRecordProcessor<span class="token punctuation">(</span>otlp_exporter<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">handler <span class="token operator">=</span> LoggingHandler<span class="token punctuation">(</span>level<span class="token operator">=</span>logging<span class="token punctuation">.</span>DEBUG<span class="token punctuation">,</span> logger_provider<span class="token operator">=</span>logger_provider<span class="token punctuation">)</span>
</span><span class="code-line">logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>addHandler<span class="token punctuation">(</span>handler<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
</span><span class="code-line">app<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>setLevel<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token punctuation annotation decorator">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">server_request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    app<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">&#x27;hello from logger!&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;hello world!&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token string">&quot;world!&quot;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
</span><span class="code-line">    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span>
</span></code></pre></div><p><code>requirements.txt</code></p><div class="relative"><pre><code class="code-highlight"><span class="code-line">flask
</span><span class="code-line">opentelemetry-distro
</span><span class="code-line">opentelemetry-instrumentation-fastapi
</span><span class="code-line">opentelemetry-instrumentation-logging
</span><span class="code-line">opentelemetry-exporter-otlp-proto-http
</span></code></pre></div><p><code>Dockerfile</code></p><div class="relative"><pre><code class="code-highlight language-Dockerfile"><span class="code-line"><span class="token instruction"><span class="token keyword">FROM</span> <span class="token options"><span class="token property">--platform</span><span class="token punctuation">=</span><span class="token string">linux/amd64</span></span> python:3.11</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">WORKDIR</span> /usr/src/app</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">COPY</span> requirements.txt requirements.txt</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">RUN</span> pip3 install --no-cache-dir -r requirements.txt</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">COPY</span> . .</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;python&quot;</span>, <span class="token string">&quot;-m&quot;</span>, <span class="token string">&quot;flask&quot;</span>, <span class="token string">&quot;--app&quot;</span>, <span class="token string">&quot;app&quot;</span>, <span class="token string">&quot;run&quot;</span>]</span>
</span></code></pre></div><p>그리고 이제 auto instrumentation이 되지 않도록 annotation을 제거하고, Container Image를 배포한다. <code>opentelemetry-operator</code>에 의해서 자동으로 주입된 환경변수도 수동으로 넣어주었다.</p><p><code>deployment.yml</code></p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> apps/v1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> Deployment
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">name</span><span class="token punctuation">:</span> sample
</span><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">revisionHistoryLimit</span><span class="token punctuation">:</span> <span class="token number">3</span>
</span><span class="code-line">  <span class="token atrule key">selector</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">matchLabels</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">app</span><span class="token punctuation">:</span> sample
</span><span class="code-line">  <span class="token atrule key">template</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">labels</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">app</span><span class="token punctuation">:</span> sample
</span><span class="code-line">    <span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">containers</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token punctuation">-</span> <span class="token atrule key">image</span><span class="token punctuation">:</span> sample
</span><span class="code-line">          <span class="token atrule key">name</span><span class="token punctuation">:</span> sample
</span><span class="code-line">          <span class="token atrule key">imagePullPolicy</span><span class="token punctuation">:</span> Always
</span><span class="code-line">          <span class="token atrule key">env</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> OTEL_SERVICE_NAME
</span><span class="code-line">              <span class="token atrule key">value</span><span class="token punctuation">:</span> example
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> OTEL_EXPORTER_OTLP_PROTOCOL
</span><span class="code-line">              <span class="token atrule key">value</span><span class="token punctuation">:</span> http/protobuf
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> OTEL_LOGS_EXPORTER
</span><span class="code-line">              <span class="token atrule key">value</span><span class="token punctuation">:</span> otlp_proto_http
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> OTEL_TRACES_EXPORTER
</span><span class="code-line">              <span class="token atrule key">value</span><span class="token punctuation">:</span> otlp
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> OTEL_METRICS_EXPORTER
</span><span class="code-line">              <span class="token atrule key">value</span><span class="token punctuation">:</span> otlp
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> OTEL_PYTHON_LOGGING_AUTO_INSTRUMENTATION_ENABLED
</span><span class="code-line">              <span class="token atrule key">value</span><span class="token punctuation">:</span> <span class="token string">&#x27;true&#x27;</span>
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> OTEL_RESOURCE_ATTRIBUTES_POD_NAME
</span><span class="code-line">              <span class="token atrule key">valueFrom</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token atrule key">fieldRef</span><span class="token punctuation">:</span>
</span><span class="code-line">                  <span class="token atrule key">fieldPath</span><span class="token punctuation">:</span> metadata.name
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> OTEL_RESOURCE_ATTRIBUTES_NODE_NAME
</span><span class="code-line">              <span class="token atrule key">valueFrom</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token atrule key">fieldRef</span><span class="token punctuation">:</span>
</span><span class="code-line">                  <span class="token atrule key">fieldPath</span><span class="token punctuation">:</span> spec.nodeName
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> OTEL_RESOURCE_ATTRIBUTES
</span><span class="code-line">              <span class="token atrule key">value</span><span class="token punctuation">:</span> <span class="token string">&#x27;k8s.container.name=sample,k8s.deployment.name=sample,k8s.namespace.name=example,k8s.node.name=$(OTEL_RESOURCE_ATTRIBUTES_NODE_NAME),k8s.pod.name=$(OTEL_RESOURCE_ATTRIBUTES_POD_NAME),k8s.replicaset.name=sample-55c69d6957,service.instance.id=example.$(OTEL_RESOURCE_ATTRIBUTES_POD_NAME).sample,service.version=latest&#x27;</span>
</span></code></pre></div><p>이렇게 배포하고 동일하게 Flask Application에 요청을 하면 동일한 로그가 남는 것을 확인할 수 있다. (하지만 Trace에 대해서는 설정을 하지 않았기 때문에 해당 Log에 TraceID와 SpanID는 추가되지 않는다.)</p><p><a target="_blank" rel="noopener noreferrer" href="https://github.com/open-telemetry/opentelemetry-operator/blob/main/autoinstrumentation/python/requirements.txt">그리고 위에서 Exporter를 grpc대신에 http를 사용했는데, opentelemetry operater에서는 grpc가 OS와 Python version에 의존성이 있기 때문에 범용적으로 사용할 수 있는 http를 사용한다.</a></p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line"><span class="token comment"># We don&#x27;t use the distro[otlp] option which automatically includes exporters since gRPC is not appropriate for</span>
</span><span class="code-line"><span class="token comment"># injected auto-instrumentation, where it has a strict dependency on the OS / Python version the artifact is built for.</span>
</span><span class="code-line">opentelemetry-exporter-otlp-proto-http<span class="token operator">==</span><span class="token number">1.23</span>.0
</span></code></pre></div><h2 id="loki로-확인"><a href="#loki로-확인" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Loki로 확인</h2><p>이번에는 <code>OTEL_LOGS_EXPORTER</code>를 <code>otlp_proto_http</code>로 설정하여 OpenTelemetry Collector가 로그를 수집하도록 한다. 그리고 위에서 OpenTelemetry Collector에서 Loki Exporter를 설정하였기 때문에, 정상적으로 Loki에 로그가 쌓이는지 확인해본다.</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> opentelemetry.io/v1alpha1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> Instrumentation
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">name</span><span class="token punctuation">:</span> python<span class="token punctuation">-</span>instrumentation
</span><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">exporter</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">endpoint</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//otel<span class="token punctuation">-</span>collector<span class="token punctuation">:</span><span class="token number">4318</span>
</span><span class="code-line">  <span class="token atrule key">env</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">propagators</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> tracecontext
</span><span class="code-line">    <span class="token punctuation">-</span> baggage
</span><span class="code-line">  <span class="token atrule key">python</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">env</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> OTEL_LOGS_EXPORTER
</span><span class="code-line">        <span class="token atrule key">value</span><span class="token punctuation">:</span> otlp_proto_http
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> OTEL_PYTHON_LOGGING_AUTO_INSTRUMENTATION_ENABLED
</span><span class="code-line">        <span class="token atrule key">value</span><span class="token punctuation">:</span> <span class="token string">&#x27;true&#x27;</span>
</span></code></pre></div><p>수정한 <code>Instrumentation CRD</code>를 배포하고, 다시 Flask 어플리케이션 Container가 있는 Pod를 재시작하면 아래와 같이 Loki에 로그가 쌓이는 것을 확인할 수 있다.</p><div class="relative"><pre><code class="code-highlight language-json"><span class="code-line"><span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token property">&quot;body&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1 - - [25/May/2024 01:49:05] \&quot;GET /hello HTTP/1.1\&quot; 200 -&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;severity&quot;</span><span class="token operator">:</span> <span class="token string">&quot;INFO&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;attributes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token property">&quot;code.filepath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/usr/local/lib/python3.11/site-packages/werkzeug/_internal.py&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;code.function&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_log&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;code.lineno&quot;</span><span class="token operator">:</span> <span class="token number">97</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;otelServiceName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sample&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;otelSpanID&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;otelTraceID&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;otelTraceSampled&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;resources&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token property">&quot;k8s.container.name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sample&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;k8s.deployment.name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sample&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;k8s.namespace.name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;example&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;k8s.node.name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;example-node&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;k8s.pod.name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sample-656f58b97c-9mr6d&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;k8s.replicaset.name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sample-656f58b97c&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;service.instance.id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;example.sample-656f58b97c-9mr6d.sample&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;service.name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sample&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;service.version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amd64&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;telemetry.auto.version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.44b0&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;telemetry.sdk.language&quot;</span><span class="token operator">:</span> <span class="token string">&quot;python&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;telemetry.sdk.name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;opentelemetry&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;telemetry.sdk.version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.23.0&quot;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;instrumentation_scope&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;opentelemetry.sdk._logs._internal&quot;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>resources에 저렇게 남기 때문에, opentelemetry collector 설정에 resource processors를 아래와 같이 정의해서 Loki label를 추가하였다.</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">processors</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">resource</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">attributes</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token atrule key">action</span><span class="token punctuation">:</span> insert
</span><span class="code-line">        <span class="token atrule key">key</span><span class="token punctuation">:</span> pod
</span><span class="code-line">        <span class="token atrule key">from_attribute</span><span class="token punctuation">:</span> k8s.pod.name
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token atrule key">action</span><span class="token punctuation">:</span> insert
</span><span class="code-line">        <span class="token atrule key">key</span><span class="token punctuation">:</span> container
</span><span class="code-line">        <span class="token atrule key">from_attribute</span><span class="token punctuation">:</span> k8s.container.name
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token atrule key">action</span><span class="token punctuation">:</span> insert
</span><span class="code-line">        <span class="token atrule key">key</span><span class="token punctuation">:</span> namespace
</span><span class="code-line">        <span class="token atrule key">from_attribute</span><span class="token punctuation">:</span> k8s.namespace.name
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token atrule key">action</span><span class="token punctuation">:</span> insert
</span><span class="code-line">        <span class="token atrule key">key</span><span class="token punctuation">:</span> loki.resource.labels
</span><span class="code-line">        <span class="token atrule key">value</span><span class="token punctuation">:</span> pod<span class="token punctuation">,</span> namespace<span class="token punctuation">,</span> container
</span></code></pre></div><h2 id="gunicorn으로-실행"><a href="#gunicorn으로-실행" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Gunicorn으로 실행</h2><p>Flask Production에서 실행할 때는 Flask의 개발용 WSGI server를 사용하지 않고 별도의 WSGI server를 사용한다. Gunicorn을 사용하면 아래와 같이 설정이 된다.</p><p><code>app.py</code></p><div class="relative"><pre><code class="code-highlight language-py"><span class="code-line"><span class="token keyword">import</span> logging
</span><span class="code-line"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request
</span><span class="code-line">
</span><span class="code-line">app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
</span><span class="code-line">app<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>setLevel<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token punctuation annotation decorator">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    app<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">&quot;hello world!&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token string">&quot;world!&quot;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token punctuation annotation decorator">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&quot;/error&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    app<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">&quot;error test!&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">&quot;test exception&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token string">&quot;world!&quot;</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
</span><span class="code-line">    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span>
</span></code></pre></div><p><code>requirements.txt</code></p><div class="relative"><pre><code class="code-highlight language-txt"><span class="code-line">flask
</span><span class="code-line">gunicorn
</span></code></pre></div><p><code>Dockerfile</code></p><div class="relative"><pre><code class="code-highlight language-Dockerfile"><span class="code-line"><span class="token instruction"><span class="token keyword">FROM</span> <span class="token options"><span class="token property">--platform</span><span class="token punctuation">=</span><span class="token string">linux/amd64</span></span> python:3.11</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">WORKDIR</span> /usr/src/app</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">COPY</span> requirements.txt requirements.txt</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">RUN</span> pip3 install --no-cache-dir -r requirements.txt</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">COPY</span> . .</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">CMD</span> [ <span class="token string">&quot;python3&quot;</span>, <span class="token string">&quot;-m&quot;</span> , <span class="token string">&quot;gunicorn&quot;</span>, <span class="token string">&quot;app:app&quot;</span>]</span>
</span></code></pre></div><p>정상적으로 로그들이 수집되는 것을 확인했다.</p><h2 id="fastapi-uvicorn-실행"><a href="#fastapi-uvicorn-실행" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>FastAPI Uvicorn 실행</h2><p>Python에서 Web Application을 만들 때, FastAPI도 많이 쓴다. 따라서 FastAPI를 ASGI Server인 Uvicorn으로 실행하여 Log 수집을 확인해봤다. 아래와 같이 Sample 코드를 동일하게 작성하여 Info 로그와 Error 로그가 잘 수집되는 것을 확인하였다.</p><p><code>app.py</code></p><div class="relative"><pre><code class="code-highlight language-py"><span class="code-line"><span class="token keyword">import</span> logging
</span><span class="code-line"><span class="token keyword">from</span> typing <span class="token keyword">import</span> Union
</span><span class="code-line"><span class="token keyword">from</span> fastapi <span class="token keyword">import</span> FastAPI
</span><span class="code-line">
</span><span class="code-line">app <span class="token operator">=</span> FastAPI<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">logger <span class="token operator">=</span> logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">logger<span class="token punctuation">.</span>setLevel<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token punctuation annotation decorator">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">&#x27;hello uvicorn!&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;World&quot;</span><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token punctuation annotation decorator">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/error&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">&#x27;error test&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">&quot;test exception&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;World&quot;</span><span class="token punctuation">}</span>
</span></code></pre></div><p><code>requirements.txt</code></p><div class="relative"><pre><code class="code-highlight"><span class="code-line">fastapi
</span><span class="code-line">pydantic
</span></code></pre></div><p><code>Dockerfile</code></p><div class="relative"><pre><code class="code-highlight language-Dockerfile"><span class="code-line"><span class="token instruction"><span class="token keyword">FROM</span> <span class="token options"><span class="token property">--platform</span><span class="token punctuation">=</span><span class="token string">linux/amd64</span></span> python:3.11</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">WORKDIR</span> /usr/src/app</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">COPY</span> requirements.txt requirements.txt</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">RUN</span> pip3 install --no-cache-dir -r requirements.txt</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">COPY</span> . .</span>
</span><span class="code-line"><span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;uvicorn&quot;</span>, <span class="token string">&quot;app:app&quot;</span>, <span class="token string">&quot;--host=0.0.0.0&quot;</span>]</span>
</span></code></pre></div><h2 id="multi-process"><a href="#multi-process" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Multi Process</h2><p>Python은 GIL때문에 CPU Core가 여러 개일때 Process를 늘리는 방식을 사용한다. Kuberentes에서 CPU는 하나만 할당하고 Scale out을 하는 경우에는 괜찮겠지만, 멀티 코어에 멀티 프로세스로 운영할 때는 Auto Instrumentation을 사용할 수 없는 것으로 보인다.</p><p><a target="_blank" rel="noopener noreferrer" href="https://opentelemetry-python.readthedocs.io/en/latest/examples/fork-process-model/README.html">그리고 default으로 설정되는 BatchSpanProcessor의 경우에는 Gunicorn처럼 pre-fork를 해서 사용할 문제가 발생할수 있다고 문서에 설명하고 있다.</a> 그래서 Gunicorn의 <code>post_fork</code> Hook을 사용하여 설정하는 것을 고려해야 한다.</p><p>gunicorn.conf.py</p><div class="relative"><pre><code class="code-highlight language-py"><span class="code-line"><span class="token keyword">def</span> <span class="token function">post_fork</span><span class="token punctuation">(</span>server<span class="token punctuation">,</span> worker<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span></code></pre></div><h2 id="결론"><a href="#결론" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>결론</h2><p>OpenTelemetry Operator의 Instrumentation CRD를 통해서 나의 어플리케이션의 소스코드 변경없이 자동으로 Instrumentation 할 수가 있다. 다양한 Instrumentation Library를 통해서 Trace, Metric, Logging등을 자동으로 수집할 수 있다. 이번에는 특히 Python Runtime 경우에 OpenTelemetry Operator로 어떻게 Logging이 자동으로 될 수 있는지 확인해보았다. Init Container로 다양한 instrumentation library와 sdk/api library를 설치하고, mount한 해당 volume 경로를 PYTHONPATH에 추가한다. 그리고 PYTHONPATH에 opentelemetry-instrumentation 라이브러리의 sitecustomize.py가 나의 Python 어플리케이션이 실행되기 전에 import되도록 설정한다. 그래서 instrumentation library이 자동으로 설정될 수 있다. 주입된 환경변수와 함께 opentelemetry sdk가 Metric, Trace, Logging 설정을 하고, 최종적으로 OpenTelemetry Collector로 해당 데이터를 보내게 된다.</p></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"></div><div id="comment"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/kubernetes">kubernetes</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/opentelemetry">opentelemetry</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/20240519-zap">ZAP을 사용하여 동적 검사 해보기</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:jayground8@gmail.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/jayground8"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Jay</div><div> • </div><div>© 2024</div><div> • </div><a href="/">Jayground8</a></div><div class="mb-8 text-sm text-gray-500 dark:text-gray-400"><a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var r=Object.create;var l=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty;var t=a=\u003el(a,\"__esModule\",{value:!0});var u=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=\u003e{t(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let n of d(s))!h.call(a,n)\u0026\u0026n!==\"default\"\u0026\u0026l(a,n,{get:()=\u003es[n],enumerable:!(c=p(s,n))||c.enumerable});return a},g=a=\u003ek(t(l(a!=null?r(m(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=u((f,i)=\u003e{i.exports=_jsx_runtime});var T={};N(T,{default:()=\u003eb,frontmatter:()=\u003ey});var e=g(o()),y={title:\"opentelemetry-operator \\uC0AC\\uC6A9\\uD574\\uBCF4\\uAE30\",date:\"2024-05-26\",tags:[\"kubernetes\",\"opentelemetry\"],images:[\"/static/images/social-banner.png\"],summary:\"\\uC18C\\uC2A4\\uCF54\\uB4DC\\uB97C \\uBCC0\\uACBD\\uD558\\uC9C0 \\uC54A\\uACE0 opentelemetry-operator\\uC758 Instrumentation CRD\\uB97C \\uD1B5\\uD574\\uC11C Python Application\\uC744 \\uC790\\uB3D9\\uC73C\\uB85C Instrumentation\\uC744 \\uD574\\uBD24\\uB2E4. \\uC774 \\uACFC\\uC815\\uC5D0\\uC11C OpenTelemetry Logging\\uC758 \\uACBD\\uC6B0\\uC5D0\\uB294 \\uAE30\\uC874 Logging Libarary\\uC5D0 Bridge API\\uB85C \\uC5F0\\uB3D9\\uD558\\uB294 \\uAD6C\\uC870\\uB85C \\uC124\\uACC4\\uB41C \\uAC83\\uC744 \\uC54C\\uAC8C \\uB418\\uC5C8\\uACE0, Python opentelemetry sdk\\uAC00 logger\\uC5D0 handler\\uB97C \\uCD94\\uAC00\\uD558\\uB294 \\uAC83\\uC744 \\uC54C\\uAC8C \\uB418\\uC5C8\\uB2E4. \\uB610\\uD55C sitecustomize.py\\uC744 \\uD1B5\\uD574\\uC11C Python Application\\uC774 \\uC2E4\\uD589\\uB418\\uAE30 \\uC804\\uC5D0 Instrumentation library\\uB97C \\uC14B\\uD305\\uD558\\uB294 \\uAC83\\uC744 \\uC774\\uD574\\uD558\\uAC8C \\uB418\\uC5C8\\uB2E4. Gunicorn\\uC73C\\uB85C Flask\\uB97C \\uC2E4\\uD589\\uD560 \\uB54C\\uC640 Uvicorn\\uC73C\\uB85C FastAPI\\uB97C \\uC2E4\\uD589\\uD560 \\uB54C, Auto Instrumentation\\uC774 \\uC798 \\uB418\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD558\\uC600\\uB2E4.\"};function _(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({p:\"p\",a:\"a\",code:\"code\",h2:\"h2\",span:\"span\",pre:\"pre\",blockquote:\"blockquote\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.p,{children:[\"\\uB2E4\\uC591\\uD55C \\uB7F0\\uD0C0\\uC784(Java, Python, Nodejs)\\uB85C \\uC5B4\\uD50C\\uB9AC\\uCF00\\uC774\\uC158\\uC774 \\uCFE0\\uBC84\\uB124\\uD2F0\\uC2A4\\uC5D0\\uC11C \\uC2E4\\uD589 \\uC911\\uC77C \\uB54C, Log, Trace, Metric\\uC744 \\uC5B4\\uB5BB\\uAC8C \\uC218\\uC9D1\\uD558\\uBA74 \\uC88B\\uC744\\uAE4C? \",(0,e.jsx)(n.a,{href:\"https://opentelemetry.io/docs/kubernetes/operator/\",children:\"OpenTelmetry Operator\"}),\"\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 \\uAC83\\uC744 \\uC0DD\\uAC01\\uD574\\uBCFC \\uC218 \\uC788\\uB2E4. \\uC5B4\\uD50C\\uB9AC\\uCF00\\uC774\\uC158 \\uCF54\\uB4DC\\uB97C \\uC218\\uC815\\uD558\\uC9C0 \\uC54A\\uACE0 \",(0,e.jsx)(n.code,{children:\"Instrumentation CRD\"}),\"\\uB97C \\uD1B5\\uD574\\uC11C \\uC790\\uB3D9\\uC73C\\uB85C instrumentation\\uC744 \\uD560 \\uC218 \\uC788\\uB2E4. \\uC774\\uBC88 \\uBE14\\uB85C\\uADF8\\uC5D0\\uC11C\\uB294 Python\\uC5D0\\uC11C OpenTelemetry\\uB97C \\uD1B5\\uD574\\uC11C \\uB85C\\uADF8\\uB97C \\uC218\\uC9D1\\uD558\\uB294 \\uAC83\\uC5D0 \\uB300\\uD574\\uC11C \\uC9D1\\uC911\\uC801\\uC73C\\uB85C \\uC0B4\\uD3B4 \\uBCF8\\uB2E4.\"]}),(0,e.jsxs)(n.h2,{id:\"helm-chart\\uB85C-\\uC124\\uCE58\",children:[(0,e.jsx)(n.a,{href:\"#helm-chart\\uB85C-\\uC124\\uCE58\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Helm Chart\\uB85C \\uC124\\uCE58\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://cert-manager.io/\",children:\"cert-manager\"}),\"\\uB97C \\uBA3C\\uC800 \\uC124\\uCE58\\uD558\\uACE0, Helm Chart\\uB85C open-telemetry/opentelemetry-operator \",(0,e.jsx)(n.code,{children:\"0.58.2\"}),\"\\uB97C \\uC124\\uCE58\\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`kubecl create namespace opentelemetry-operator-system\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"helm repo \",(0,e.jsx)(n.span,{className:\"token function\",children:\"add\"}),` open-telemetry https://open-telemetry.github.io/opentelemetry-helm-charts\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`helm repo update\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"helm \",(0,e.jsx)(n.span,{className:\"token function\",children:\"install\"}),\" opentelemetry-operator open-telemetry/opentelemetry-operator \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`--namespace opentelemetry-operator-system\n`})]})}),(0,e.jsxs)(n.h2,{id:\"opentelemetry-collector-\\uC124\\uCE58\",children:[(0,e.jsx)(n.a,{href:\"#opentelemetry-collector-\\uC124\\uCE58\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"OpenTelemetry Collector \\uC124\\uCE58\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"OpenTelemetry Operator\"}),\"\\uB85C Collector\\uB97C \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uC9C0\\uB9CC, Helm Chart\\uB85C \\uBCC4\\uB3C4\\uB85C \\uC2E4\\uD589\\uD558\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 values\\uB97C \\uC815\\uC758\\uD560 \\uC218 \\uC788\\uB2E4. \\uCD94\\uAC00\\uC801\\uC73C\\uB85C \",(0,e.jsx)(n.code,{children:\"Loki\"}),\"\\uB97C \\uD1B5\\uD574\\uC11C Log\\uB97C \\uC218\\uC9D1\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uD558\\uC600\\uB2E4. \",(0,e.jsx)(n.a,{href:\"https://grafana.com/docs/loki/latest/send-data/otel/\",children:\"Loki\\uC758 \\uBB38\\uC11C\\uB97C \\uBCF4\\uBA74 OTLP \\uD504\\uB85C\\uD1A0\\uCF5C\\uB85C Log\\uB97C \\uC218\\uC9D1\\uD558\\uB294 \\uBC29\\uBC95\"}),\"\\uB3C4 \\uC124\\uBA85\\uD558\\uACE0 \\uC788\\uB294\\uB370, \\uC5EC\\uAE30\\uC11C\\uB294 \",(0,e.jsx)(n.a,{href:\"https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/exporter/lokiexporter/README.md\",children:\"Loki Exporter\"}),\"\\uB97C \\uC0AC\\uC6A9\\uD588\\uB2E4. Loki Exporter\\uC758 \",(0,e.jsx)(n.code,{children:\"default_labels_enabled\"}),\" \\uC124\\uC815\\uC744 \\uD1B5\\uD574\\uC11C \\uAE30\\uBCF8\\uC801\\uC778 Loki Label(Index)\\uB97C \\uCD94\\uAC00\\uD558\\uB3C4\\uB85D \\uD588\\uB2E4. \\uADF8\\uB9AC\\uACE0 \",(0,e.jsx)(n.code,{children:\"Instrumentation CRD\"}),\"\\uB97C \\uD1B5\\uD574\\uC11C OpenTelemetry Instrumentation\\uC744 \\uC790\\uB3D9\\uC73C\\uB85C \\uD560 \\uB54C \\uC0DD\\uC131\\uB418\\uB294 resources \\uAC12\\uB4E4\\uC744 Loki label\\uB85C \\uCD94\\uAC00\\uD558\\uB3C4\\uB85D \",(0,e.jsx)(n.a,{href:\"https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/processor/resourceprocessor/README.md\",children:\"Resource Processor\"}),\"\\uB97C \\uC0AC\\uC6A9\\uD558\\uC600\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"values.yml\"})}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"config\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"receivers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"jaeger\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token important null\",children:\"null\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"prometheus\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token important null\",children:\"null\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"zipkin\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token important null\",children:\"null\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"service\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"telemetry\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"logs\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"level\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` info\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"pipelines\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"traces\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"receivers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` otlp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metrics\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"receivers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` otlp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"logs\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"receivers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` otlp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"processors\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` resource\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"exporters\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` loki\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"processors\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"resource\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"attributes\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"action\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` insert\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` pod\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"from_attribute\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` k8s.pod.name\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"action\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` insert\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` container\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"from_attribute\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` k8s.container.name\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"action\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` insert\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` namespace\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"from_attribute\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` k8s.namespace.name\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"action\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` insert\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` loki.resource.labels\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" pod\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" namespace\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` container\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"exporters\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"loki\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"endpoint\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" http\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"//loki\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`gateway/loki/api/v1/push\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"default_labels_enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"exporter\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"job\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"ports\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"jaeger-compact\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"jaeger-thrift\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"jaeger-grpc\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"zipkin\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"mode\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` daemonset\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"presets\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"logsCollection\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"includeCollectorLogs\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"false\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uC704\\uC5D0\\uC11C OpenTelemetry Collector\\uB97C DaemonSet\\uC73C\\uB85C \\uC2E4\\uD589\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uD558\\uC600\\uB2E4. Service\\uB294 \",(0,e.jsx)(n.a,{href:\"https://kubernetes.io/docs/concepts/services-networking/service-traffic-policy/#using-service-internal-traffic-policy\",children:\"internalTrafficPolicy\"}),\"\\uB97C \\uD1B5\\uD574\\uC11C \\uAC19\\uC740 Node\\uC5D0 \\uC788\\uB294 OpenTelmetry Colletor endpoint\\uC5D0 \\uC811\\uADFC\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uD588\\uB2E4. \\uADF8\\uB9AC\\uACE0 \\uB2E4\\uB978 Namespace\\uC5D0 \\uC788\\uB294 Service\\uC5D0 \\uC811\\uADFC\\uD558\\uAE30 \\uC704\\uD574\\uC11C \",(0,e.jsx)(n.code,{children:\"ExternalName\"}),\"\\uC73C\\uB85C \\uC11C\\uBE44\\uC2A4\\uB97C \\uCD94\\uAC00\\uD558\\uC600\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Service\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" otel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`collector\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"namespace\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` opentelemetry\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"type\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` ClusterIP\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"selector\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"app.kubernetes.io/name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" opentelemetry\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`collector\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"ports\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` http\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"port\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"4318\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"targetPort\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"4318\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` grpc\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"port\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"4317\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"targetPort\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"4317\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"internalTrafficPolicy\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Local\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"---\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Service\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" otel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`collector\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"namespace\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` example\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"type\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` ExternalName\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"externalName\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" otel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`collector.opentelemetry.svc.cluster.local\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"instrumentation-crd-\\uC0DD\\uC131\",children:[(0,e.jsx)(n.a,{href:\"#instrumentation-crd-\\uC0DD\\uC131\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Instrumentation CRD \\uC0DD\\uC131\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://opentelemetry.io/docs/kubernetes/operator/automatic/#python\",children:\"\\uACF5\\uC2DD \\uBB38\\uC11C\\uC5D0\\uC11C Python\\uC758 \\uACBD\\uC6B0 \\uC5B4\\uB5BB\\uAC8C Instrumentation CRD\\uB97C \\uC0DD\\uC131\\uD574\\uC57C\\uD560\\uC9C0 \\uC798 \\uC124\\uBA85\\uD558\\uACE0 \\uC788\\uB2E4.\"}),\" \\uC544\\uB798\\uC640 \\uAC19\\uC774 Python\\uC5D0 \\uB300\\uD574\\uC11C \\uC124\\uC815\\uC744 \\uD558\\uC5EC Instrumentation\\uB97C \\uC0DD\\uC131\\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` opentelemetry.io/v1alpha1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Instrumentation\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" python\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`instrumentation\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"exporter\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"endpoint\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" http\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"//otel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"collector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"4318\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"propagators\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` tracecontext\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` baggage\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"python\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` OTEL_LOGS_EXPORTER\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` console\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` OTEL_PYTHON_LOGGING_AUTO_INSTRUMENTATION_ENABLED\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'true'\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://opentelemetry.io/docs/languages/python/\",children:\"\\uC774 \\uAE00\\uC744 \\uC4F0\\uB294 \\uC2DC\\uC810\\uC5D0\\uC11C Python Otel SDK libary\\uC911\\uC5D0 Logs\\uB294 Experimental \\uC0C1\\uD0DC\\uC774\\uB2E4.\"}),\".\"]}),(0,e.jsx)(\"img\",{src:\"/static/images/otel-python-logs-status.png\",alt:\"OpenTelemetry Python Logs Status\"}),(0,e.jsxs)(n.p,{children:[\"\\uB530\\uB77C\\uC11C logs\\uB294 \\uAE30\\uBCF8\\uC801\\uC73C\\uB85C \\uC0AC\\uC6A9\\uD558\\uC9C0 \\uC54A\\uAC8C \\uB418\\uC5B4 \\uC788\\uB294\\uB370, \\uC0AC\\uC6A9\\uD558\\uB824\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \",(0,e.jsx)(n.code,{children:\"\\uD658\\uACBD\\uBCC0\\uC218\\uB97C \\uAF2D \\uC124\\uC815\\uD574\\uC918\\uC57C \\uD55C\\uB2E4\"}),\". \",(0,e.jsx)(n.code,{children:\"OTEL_LOGS_EXPORTER\"}),\"\\uB97C \",(0,e.jsx)(n.code,{children:\"console\"}),\"\\uB85C \\uC124\\uC815\\uD558\\uC5EC OpenTelemetry Collector\\uC5D0 \\uBCF4\\uB0B4\\uAE30 \\uC804\\uC5D0 \\uB85C\\uADF8\\uAC00 \\uC798 \\uB0A8\\uACE0 \\uC788\\uB294\\uC9C0 \\uD655\\uC778\\uD558\\uACE0\\uC790 \\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`By default, Python logs auto-instrumentation is disabled.\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"If you would like to \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"enable\"}),\" this feature, you must to \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"set\"}),` the OTEL_LOGS_EXPORTER and OTEL_PYTHON_LOGGING_AUTO_INSTRUMENTATION_ENABLED environment variables as follows\n`]})]})}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"python\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` OTEL_LOGS_EXPORTER\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` console\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` OTEL_PYTHON_LOGGING_AUTO_INSTRUMENTATION_ENABLED\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'true'\"}),`\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"flask-app\\uC5D0-\\uC801\\uC6A9\",children:[(0,e.jsx)(n.a,{href:\"#flask-app\\uC5D0-\\uC801\\uC6A9\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Flask App\\uC5D0 \\uC801\\uC6A9\"]}),(0,e.jsxs)(n.p,{children:[\"Flask Application\\uC744 \\uC2E4\\uD589\\uD574\\uC11C \\uD655\\uC778\\uD574\\uBCF4\\uC790. \\uC544\\uC8FC \\uB2E8\\uC21C\\uD558\\uAC8C \",(0,e.jsx)(n.code,{children:\"GET /hello\"}),\"\\uB85C \\uC694\\uCCAD\\uD558\\uBA74 \\uC751\\uB2F5\\uD558\\uB294 \\uCF54\\uB4DC\\uC774\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"app.py\"})}),(0,e.jsx)(n.pre,{className:\"language-py\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-py\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" flask \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),\" Flask\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` request\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"app \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" Flask\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"__name__\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token punctuation annotation decorator\",children:[\"@app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"route\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"/hello\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"server_request\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"hello world!\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"world!\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" __name__ \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"__main__\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"run\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"port\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"5000\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"Python package\\uB294 \",(0,e.jsx)(n.code,{children:\"flask\"}),\"\\uB9CC \\uC124\\uCE58\\uD558\\uB3C4\\uB85D \\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"requirements.txt\"})}),(0,e.jsx)(n.pre,{className:\"language-txt\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-txt\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`flask\n`})})}),(0,e.jsx)(n.p,{children:\"\\uCFE0\\uBC84\\uB124\\uD2F0\\uC2A4\\uC5D0\\uC11C \\uC2E4\\uD589\\uD558\\uAE30 \\uC704\\uD574\\uC11C Container Image\\uB97C \\uC0DD\\uC131\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"Dockerfile\"})}),(0,e.jsx)(n.pre,{className:\"language-dockerfile\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-Dockerfile\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"FROM\"}),\" \",(0,e.jsxs)(n.span,{className:\"token options\",children:[(0,e.jsx)(n.span,{className:\"token property\",children:\"--platform\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"linux/amd64\"})]}),\" python:3.11\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"WORKDIR\"}),\" /usr/src/app\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"COPY\"}),\" requirements.txt requirements.txt\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"RUN\"}),\" pip3 install --no-cache-dir -r requirements.txt\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"COPY\"}),\" . .\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"CMD\"}),\" [\",(0,e.jsx)(n.span,{className:\"token string\",children:'\"python\"'}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"-m\"'}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"flask\"'}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"--app\"'}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"app\"'}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"run\"'}),\"]\"]}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"Dockerfile\\uB85C \\uBE4C\\uB4DC\\uD55C \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uB97C \\uCFE0\\uBC84\\uB124\\uD2F0\\uC2A4\\uC5D0 \\uBC30\\uD3EC\\uD55C\\uB2E4. \\uC774\\uB54C Annotation\\uC744 \\uD1B5\\uD574\\uC11C auto instrumentation\\uC774 \\uB420 \\uC218 \\uC788\\uB3C4\\uB85D \\uC124\\uC815\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"deployment.yml\"})}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` apps/v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Deployment\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` sample\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"selector\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"matchLabels\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"app\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` sample\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"template\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"annotations\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"instrumentation.opentelemetry.io/inject-python\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'true'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"labels\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"app\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` sample\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"containers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"image\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` sample\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` sample\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"imagePullPolicy\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Always\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uADF8\\uB7FC \\uC774\\uC81C \\uD574\\uB2F9 Conatiner\\uC5D0 \\uD130\\uBBF8\\uB110 \\uC811\\uC18D\\uD574\\uC11C curl\\uB85C \\uC694\\uCCAD\\uC744 \\uD574\\uBCF8\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-bash\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"curl\"}),` localhost:5000/hello\n`]})})}),(0,e.jsxs)(n.p,{children:[\"\\uC774\\uC81C \",(0,e.jsx)(n.code,{children:\"kubectl logs\"}),\"\\uB85C \\uD574\\uB2F9 \\uCEE8\\uD14C\\uC774\\uB108\\uC758 log\\uB97C \\uD655\\uC778\\uD574\\uBCF4\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uB0A8\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. \\uC704\\uC138\\uC11C \",(0,e.jsx)(n.code,{children:\"Instrumentation CRD\"}),\"\\uB97C \\uC0DD\\uC131\\uD560 \\uB54C \",(0,e.jsx)(n.code,{children:\"OTEL_LOGS_EXPORTER\"}),\"\\uB97C \",(0,e.jsx)(n.code,{children:\"console\"}),\"\\uB85C \\uC124\\uC815\\uD588\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uC774\\uB807\\uAC8C log\\uB97C \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB294 \\uAC83\\uC774\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-json\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-json\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"body\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"127.0.0.1 - - [25/May/2024 23:02:38] \\\\\"GET /hello HTTP/1.1\\\\\" 200 -\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"severity_number\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\u003cSeverityNumber.INFO: 9\u003e\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"severity_text\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"INFO\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"attributes\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"otelSpanID\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"0\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"otelTraceID\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"0\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"otelTraceSampled\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"false\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"otelServiceName\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"sample\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"code.filepath\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"/usr/local/lib/python3.11/site-packages/werkzeug/_internal.py\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"code.function\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"_log\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"code.lineno\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"97\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"dropped_attributes\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"timestamp\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"2024-05-25T23:02:38.152708Z\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"observed_timestamp\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"2024-05-25T23:02:38.152765Z\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"trace_id\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"0x00000000000000000000000000000000\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"span_id\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"0x0000000000000000\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"trace_flags\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"resource\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:`\"{'telemetry.sdk.language': 'python', 'telemetry.sdk.name': 'opentelemetry', 'telemetry.sdk.version': '1.23.0', 'k8s.container.name': 'sample', 'k8s.deployment.name': 'sample', 'k8s.namespace.name': 'example', 'k8s.node.name': 'example-node', 'k8s.pod.name': 'sample-656f58b97c-swk2p', 'k8s.replicaset.name': 'sample-656f58b97c', 'service.instance.id': 'example.sample-656f58b97c-swk2p.sample', 'service.version': 'amd64', 'service.name': 'sample', 'telemetry.auto.version': '0.44b0'}\"`}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"init-container-\\uD655\\uC778\",children:[(0,e.jsx)(n.a,{href:\"#init-container-\\uD655\\uC778\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Init Container \\uD655\\uC778\"]}),(0,e.jsxs)(n.p,{children:[\"\\uBC30\\uD3EC\\uB41C Pod\\uC758 \\uC0C1\\uC138 \\uC815\\uBCF4\\uB97C \\uBCF4\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \",(0,e.jsx)(n.code,{children:\"Init Conatiner\"}),\"\\uAC00 \\uC2E4\\uD589\\uB41C \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Init Containers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"opentelemetry-auto-instrumentation-python\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Container ID\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" containerd\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`//2e5230382ee3a5819d349baeb65871dd368d0eaffa7b589b9c874a8b7ff5fc81\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Image\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" ghcr.io/open\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"telemetry/opentelemetry\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"operator/autoinstrumentation\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"python\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`0.44b0\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Image ID\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" ghcr.io/open\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"telemetry/opentelemetry\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"operator/autoinstrumentation\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"python@sha256\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`a463e65ed49d6dee2ec79b40339f802341291a4e62655d2caeded5aa1e15e8d2\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Port\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \u003cnone\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Host Port\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \u003cnone\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\u003e\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Command\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` cp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`r\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`      /autoinstrumentation/.\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      /otel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"auto\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"instrumentation\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`python\n`]})]})}),(0,e.jsx)(n.p,{children:\"Flask Application\\uC774 \\uC2E4\\uD589\\uB418\\uB294 Container\\uC5D0 \\uC790\\uB3D9\\uC73C\\uB85C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uD658\\uACBD\\uBCC0\\uC218\\uAC00 \\uC124\\uC815\\uB418\\uC5B4 \\uC788\\uB2E4. Python OpenTelemetry SDK\\uAC00 \\uD658\\uACBD\\uBCC0\\uC218\\uB4E4\\uC744 \\uD1B5\\uD574\\uC11C \\uC124\\uC815\\uB41C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Containers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"sample\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Environment\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"OTEL_NODE_IP\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" (v1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`status.hostIP)\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"OTEL_POD_IP\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" (v1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`status.podIP)\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"OTEL_EXPORTER_OTLP_PROTOCOL\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` http/protobuf\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"OTEL_LOGS_EXPORTER\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` console\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"OTEL_PYTHON_LOGGING_AUTO_INSTRUMENTATION_ENABLED\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"PYTHONPATH\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" /otel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"auto\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"instrumentation\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"python/opentelemetry/instrumentation/auto_instrumentation\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"/otel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"auto\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"instrumentation\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`python\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"OTEL_TRACES_EXPORTER\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` otlp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"OTEL_EXPORTER_OTLP_TRACES_PROTOCOL\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` http/protobuf\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"OTEL_METRICS_EXPORTER\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` otlp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"OTEL_EXPORTER_OTLP_METRICS_PROTOCOL\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` http/protobuf\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"OTEL_SERVICE_NAME\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` sample\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"OTEL_EXPORTER_OTLP_ENDPOINT\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" http\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"//otel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"collector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"4318\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"OTEL_RESOURCE_ATTRIBUTES_POD_NAME\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" sample\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"656f58b97c\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"9spzq (v1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`metadata.name)\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"OTEL_RESOURCE_ATTRIBUTES_NODE_NAME\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" (v1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`spec.nodeName)\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"OTEL_PROPAGATORS\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" tracecontext\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`baggage\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"OTEL_TRACES_SAMPLER\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` parentbased_traceidratio\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"OTEL_TRACES_SAMPLER_ARG\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"OTEL_RESOURCE_ATTRIBUTES\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" k8s.container.name=sample\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\"k8s.deployment.name=sample\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\"k8s.namespace.name=example\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\"k8s.node.name=$(OTEL_RESOURCE_ATTRIBUTES_NODE_NAME)\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\"k8s.pod.name=$(OTEL_RESOURCE_ATTRIBUTES_POD_NAME)\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\"k8s.replicaset.name=sample\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"656f58b97c\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\"service.instance.id=example.$(OTEL_RESOURCE_ATTRIBUTES_POD_NAME).sample\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`service.version=amd64\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Mounts\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" /otel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"auto\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"instrumentation\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"python from opentelemetry\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"auto\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"instrumentation\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`python (rw)\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      /var/run/secrets/kubernetes.io/serviceaccount from kube\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"api\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"access\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`49jw9 (ro)\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uADF8\\uB9AC\\uACE0 Init Container\\uB97C \\uD1B5\\uD574\\uC11C \\uC124\\uC815\\uB41C \\uB370\\uC774\\uD130\\uAC00 Mount\\uB41C \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Containers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"sample\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Mounts\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" /otel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"auto\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"instrumentation\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"python from opentelemetry\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"auto\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"instrumentation\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`python (rw)\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      /var/run/secrets/kubernetes.io/serviceaccount from kube\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"api\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"access\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`49jw9 (ro)\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://github.com/open-telemetry/opentelemetry-operator/blob/main/autoinstrumentation/python/Dockerfile\",children:\"opentelemetry-operator\\uC5D0\\uC11C autoinstrumentation \\uC18C\\uC2A4\\uCF54\\uB4DC\"}),\"\\uB97C \\uD655\\uC778\\uD574\\uBCF4\\uBA74 \\uB2E4\\uC591\\uD55C OpenTelemetry Instrumentation package\\uB4E4\\uC744 \\uC124\\uCE58\\uD558\\uB294 \\uAC83\\uC744 \\uC54C \\uC218 \\uC788\\uB2E4. Init Container\\uC5D0\\uC11C \\uD574\\uB2F9 package\\uB4E4\\uC744 \\uC124\\uCE58\\uD558\\uACE0, \\uC124\\uCE58\\uB41C package \\uD30C\\uC77C\\uB4E4\\uC774 Mount\\uB41C \\uACBD\\uB85C\\uC5D0 \\uC800\\uC7A5\\uB418\\uC5B4 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-dockerfile\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-Dockerfile\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"FROM\"}),\" python:3.11 \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"AS\"}),\" build\"]}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"WORKDIR\"}),\" /operator-build\"]}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"ADD\"}),\" requirements.txt .\"]}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"RUN\"}),\" mkdir workspace \u0026\u0026 pip install --target workspace -r requirements.txt\"]}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"FROM\"}),\" busybox\"]}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"COPY\"}),\" \",(0,e.jsxs)(n.span,{className:\"token options\",children:[(0,e.jsx)(n.span,{className:\"token property\",children:\"--from\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"build\"})]}),\" /operator-build/workspace /autoinstrumentation\"]}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"RUN\"}),\" chmod -R go+r /autoinstrumentation\"]}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uADF8\\uB9AC\\uACE0 Flask Application\\uC774 \\uC2E4\\uD589\\uC911\\uC778 Container\\uC5D0 Terminal\\uB85C \\uC5F0\\uACB0\\uD574\\uC11C \\uD655\\uC778\\uD558\\uBA74 PYTHONPATH\\uB97C \\uD655\\uC778\\uD574\\uBCF4\\uBA74, \\uD574\\uB2F9 \\uACBD\\uB85C\\uAC00 \\uD3EC\\uD568\\uB418\\uC5B4 \\uC788\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. \\uADF8\\uB798\\uC11C \\uB098\\uC758 Flask \\uC5B4\\uD50C\\uB9AC\\uCF00\\uC774\\uC158\\uC774 \\uC2E4\\uD589\\uD558\\uB294 \\uCEE8\\uD14C\\uC774\\uB108\\uC5D0\\uC11C\\uB3C4 init Container\\uC5D0\\uC11C \\uC124\\uCE58\\uD55C \\uACBD\\uB85C\\uC758 package\\uB4E4\\uC744 \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# export\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"declare\"}),\" -x \",(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"PYTHONPATH\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"/otel-auto-instrumentation-python/opentelemetry/instrumentation/auto_instrumentation:/otel-auto-instrumentation-python\"'}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB7F0\\uB370 PYTHONPATH \\uD658\\uACBD\\uBCC0\\uC218\\uB97C \\uBCF4\\uBA74, Init Container\\uC5D0 \\uC758\\uD574\\uC11C \\uC124\\uCE58\\uB418\\uB294 \\uD328\\uD0A4\\uC9C0\\uB4E4\\uC774 \\uC788\\uB294 \",(0,e.jsx)(n.code,{children:\"otel-auto-instrumentation-python\"}),\" \\uACBD\\uB85C \\uB9D0\\uACE0 \\uC544\\uB798\\uC758 \\uACBD\\uB85C\\uAC00 \\uBCF4\\uC778\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-bash\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`/otel-auto-instrumentation-python/opentelemetry/instrumentation/auto_instrumentation\n`})})}),(0,e.jsxs)(n.p,{children:[\"\\uD574\\uB2F9 \\uACBD\\uB85C\\uB294 \",(0,e.jsx)(n.a,{href:\"https://github.com/open-telemetry/opentelemetry-python-contrib/tree/main/opentelemetry-instrumentation/src/opentelemetry/instrumentation/auto_instrumentation\",children:\"\\uC18C\\uC2A4\\uCF54\\uB4DC\\uCC98\\uB7FC\"}),\" \",(0,e.jsx)(n.code,{children:\"sitecustomize.py\"}),\"\\uC774 \\uC788\\uB2E4. \",(0,e.jsx)(n.a,{href:\"https://docs.python.org/3/library/site.html#module-sitecustomize\",children:\"Python\\uC5D0\\uC11C PYTHONPATH\\uC758 root \\uACBD\\uB85C\\uC5D0 sitecustomize.py\\uB97C \\uCD94\\uAC00\\uD558\\uBA74 \\uC790\\uB3D9\\uC73C\\uB85C import\\uB97C \\uD560 \\uC218 \\uC788\\uB2E4.\"}),\" \",(0,e.jsx)(n.a,{href:\"https://medium.com/alan/simplifying-python-workflows-with-the-sitecustomize-py-e1b1ad5c6fbe\",children:\"\\uC774 \\uBE14\\uB85C\\uADF8\\uC5D0\\uC11C\\uB294 \\uC544\\uB798\\uCC98\\uB7FC \\uC798 \\uC124\\uBA85\\uD574\\uC8FC\\uACE0 \\uC788\\uB2E4.\"})]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"If you configure the PYTHONPATH=. environment variable, any sitecustomize.py at the root of your repository will be evaluated before any application code runs.\"})}),(0,e.jsxs)(n.p,{children:[\"\\uC774\\uC81C \",(0,e.jsx)(n.code,{children:\"opentelemetry-operator\"}),\"\\uAC00 init container\\uB97C \\uD1B5\\uD574\\uC11C instrumentation library\\uB4E4\\uC744 \\uC124\\uCE58\\uD558\\uACE0, Python\\uC758 \",(0,e.jsx)(n.code,{children:\"sitecustomize.py\"}),\"\\uB85C \\uC790\\uB3D9\\uC73C\\uB85C instrumentation\\uC744 \\uD558\\uAC8C \\uB41C\\uB2E4. \",(0,e.jsx)(n.code,{children:\"requirements.txt\"}),\"\\uC5D0\\uB294 \",(0,e.jsx)(n.code,{children:\"flask\"}),\"\\uB9CC \\uCD94\\uAC00\\uD558\\uACE0, \\uC18C\\uC2A4\\uCF54\\uB4DC\\uC5D0 OpenTelemetry\\uAD00\\uB828 \\uC124\\uC815 \\uCF54\\uB4DC\\uB97C \\uCD94\\uAC00\\uD558\\uC9C0 \\uC54A\\uC544\\uB3C4 \\uC790\\uB3D9\\uC73C\\uB85C OpenTelemetry\\uB97C \\uD1B5\\uD574\\uC11C Metric, Trace, Log\\uB97C \\uC218\\uC9D1\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsxs)(n.h2,{id:\"logs-bridge-api\",children:[(0,e.jsx)(n.a,{href:\"#logs-bridge-api\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Logs Bridge API\"]}),(0,e.jsxs)(n.p,{children:[\"\\uC704\\uC5D0\\uC11C \\uC6B0\\uB9AC\\uB294 Flask \\uC5B4\\uD50C\\uB9AC\\uCF00\\uC774\\uC158\\uC73C\\uB85C \\uD14C\\uC2A4\\uD2B8\\uB97C \\uD574\\uBD24\\uB2E4. \\uADF8\\uB7F0\\uB370 \",(0,e.jsx)(n.code,{children:'print(\"hello world!\")'}),\"\\uB77C\\uACE0 standard output\\uC73C\\uB85C \\uB85C\\uADF8\\uB97C \\uB0A8\\uAE30\\uB3C4\\uB85D \\uC791\\uC131\\uD588\\uC5C8\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"app.py\"})}),(0,e.jsx)(n.pre,{className:\"language-py\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-py\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" flask \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` Flask\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"app \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" Flask\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"__name__\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token punctuation annotation decorator\",children:[\"@app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"route\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"/hello\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"server_request\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"logger\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"info\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'hello from logger!'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"hello world!\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"world!\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" __name__ \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"__main__\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"run\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"port\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"5000\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB7F0\\uB370 \",(0,e.jsx)(n.code,{children:\"kubectl logs\"}),\"\\uB85C \\uD655\\uC778\\uC744 \\uD574\\uBCF4\\uBA74 \\uD574\\uB2F9 \\uB85C\\uADF8\\uB294 OpenTelmetry Spec\\uC5D0 \\uB9DE\\uCDB0\\uC11C \\uB0A8\\uACE0 \\uC788\\uC9C0 \\uC54A\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. \\uC65C \\uC774\\uB807\\uAC8C \\uB0A8\\uC744\\uAE4C? \\u{1F914}\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"hello world\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"hello world\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"hello world\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"body\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsxs)(n.span,{className:\"token string\",children:['\"127.0.0.1 - - [25/May/2024 23:02:36] ',(0,e.jsx)(n.span,{className:\"token entity\",title:'\\\\\"',children:'\\\\\"'}),\"GET /hello HTTP/1.1\",(0,e.jsx)(n.span,{className:\"token entity\",title:'\\\\\"',children:'\\\\\"'}),' 200 -\"']}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"severity_number\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\u003cSeverityNumber.INFO: 9\u003e\"'}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"severity_text\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"INFO\"'}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"attributes\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"otelSpanID\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"0\"'}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"otelTraceID\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"0\"'}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"otelTraceSampled\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),` false,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"otelServiceName\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"sample\"'}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"code.filepath\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"/usr/local/lib/python3.11/site-packages/werkzeug/_internal.py\"'}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"code.function\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"_log\"'}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"code.lineno\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"97\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"dropped_attributes\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"timestamp\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"2024-05-23T25:02:36.856645Z\"'}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"observed_timestamp\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"2024-05-25T23:02:36.856694Z\"'}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"trace_id\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"0x00000000000000000000000000000000\"'}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"span_id\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"0x0000000000000000\"'}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"trace_flags\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"resource\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:`\"{'telemetry.sdk.language': 'python', 'telemetry.sdk.name': 'opentelemetry', 'telemetry.sdk.version': '1.23.0', 'k8s.container.name': 'sample', 'k8s.deployment.name': 'sample', 'k8s.namespace.name': 'example', 'k8s.node.name': 'example-node', 'k8s.pod.name': 'sample-656f58b97c-swk2p', 'k8s.replicaset.name': 'sample-656f58b97c', 'service.instance.id': 'example.sample-656f58b97c-swk2p.sample', 'service.version': 'amd64', 'service.name': 'sample', 'telemetry.auto.version': '0.44b0'}\"`}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://opentelemetry.io/docs/specs/otel/logs/\",children:\"OpenTelemetry \\uACF5\\uC2DD\\uBB38\\uC11C\\uC5D0\\uC11C Logging\\uC740 \\uC5B4\\uB5A4\\uC2DD\\uC73C\\uB85C \\uC124\\uACC4\\uD588\\uB294\\uC9C0 \\uCE5C\\uC808\\uD558\\uAC8C \\uC124\\uBA85\"}),\"\\uC774 \\uB418\\uC5B4 \\uC788\\uB2E4. \\uC774\\uBBF8 Logging \\uAD00\\uB828\\uD55C \\uB2E4\\uC591\\uD55C \\uB77C\\uC774\\uBE0C\\uB7EC\\uB9AC\\uAC00 \\uC874\\uC7AC\\uD558\\uB294\\uB370, \\uAE30\\uC874 Logging \\uB77C\\uC774\\uBE0C\\uB7EC\\uB9AC\\uB97C \\uC0AC\\uC6A9\\uD574\\uC11C OpenTelemetry \\uB85C\\uADF8\\uB97C \\uB0A8\\uAE38 \\uC218 \\uC788\\uB3C4\\uB85D \\uC544\\uB798\\uC640 \\uAC19\\uC740 \\uAD6C\\uC870\\uB85C \\uB418\\uC5B4 \\uC788\\uB2E4.\"]}),(0,e.jsx)(\"img\",{src:\"/static/images/otel-logs-bridge-api.png\",alt:\"OpenTelemetry logs bridge API\"}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"Instead of modifying each logging statement, log appenders use the API to bridge logs from existing logging libraries to the OpenTelemetry data model, where the SDK controls how the logs are processed and exported.\"})}),(0,e.jsxs)(n.p,{children:[\"Flask\\uC5D0\\uC11C\\uB294 Python standard library\\uC778 \",(0,e.jsx)(n.code,{children:\"logging\"}),\"\\uC744 \\uC0AC\\uC6A9\\uD558\\uACE0, \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uB85C\\uADF8\\uB97C \\uB0A8\\uAE34\\uB2E4. \\uADF8\\uB7F0\\uB370 \\uD574\\uB2F9 logging \\uB77C\\uC774\\uBE0C\\uB7EC\\uB9AC\\uAC00 OpenTelemetry Bridge API\\uB97C \\uD1B5\\uD574\\uC11C OpenTelemetry \\uADDC\\uACA9\\uC5D0 \\uB9CE\\uC740 \\uB85C\\uADF8\\uAC00 \\uB0A8\\uAC8C \\uB418\\uB294 \\uAC83\\uC774\\uB2E4. \\uD558\\uC9C0\\uB9CC \",(0,e.jsx)(n.code,{children:\"print\"}),\"\\uB97C \\uC0AC\\uC6A9\\uD588\\uC744 \\uB54C\\uB294 \\uC774\\uB7EC\\uD55C \\uAD6C\\uC870\\uB85C \\uC5F0\\uACB0\\uB418\\uC5B4 \\uC788\\uC9C0 \\uC54A\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uB2E8\\uC21C stdout\\uC73C\\uB85C \\uB0A8\\uB294\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-bash\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"127.0\"}),\".0.1 - - \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"25\"}),\"/May/2024 \",(0,e.jsx)(n.span,{className:\"token number\",children:\"23\"}),\":02:36\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),'\"GET /hello HTTP/1.1',(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),'\" ',(0,e.jsx)(n.span,{className:\"token number\",children:\"200\"}),` -\n`]})})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://github.com/open-telemetry/opentelemetry-python/blob/187048a35ee93194a70a45720fa68b78d57b6a97/opentelemetry-sdk/src/opentelemetry/sdk/_configuration/__init__.py#L388\",children:\"opentelemetry-sdk \\uC18C\\uC2A4\\uCF54\\uB4DC\\uB97C \\uBCF4\\uBA74\"}),\" \\uC544\\uB798\\uC640 \\uAC19\\uC774 handler\\uAC00 \\uCD94\\uAC00\\uB418\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. \\uD658\\uACBD\\uBCC0\\uC218\\uB97C \",(0,e.jsx)(n.code,{children:\"true\"}),\"\\uB85C \\uC124\\uC815\\uD558\\uC9C0 \\uC54A\\uC73C\\uBA74 \\uD574\\uB2F9 \",(0,e.jsx)(n.code,{children:\"_init_logging\"}),\"\\uAC00 \\uC2E4\\uD589\\uB418\\uC9C0 \\uC54A\\uB294\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-py\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-py\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"logging_enabled \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" os\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"getenv\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    _OTEL_PYTHON_LOGGING_AUTO_INSTRUMENTATION_ENABLED\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"false\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" logging_enabled\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"strip\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"lower\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"true\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    _init_logging\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"log_exporters\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" resource\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsx)(n.pre,{className:\"language-py\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-py\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"_init_logging\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    exporters\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" Dict\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"str\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" Type\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"LogExporter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    resource\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" Resource \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"None\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    provider \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" LoggerProvider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"resource\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"resource\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    set_logger_provider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"provider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" _\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" exporter_class \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),\" exporters\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"items\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        exporter_args \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        provider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"add_log_record_processor\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            BatchLogRecordProcessor\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"exporter_class\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"**\"}),\"exporter_args\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    handler \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" LoggingHandler\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"level\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"logging\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"NOTSET\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" logger_provider\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"provider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    logging\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"getLogger\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"addHandler\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"handler\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"manual\\uD558\\uAC8C-logging-\\uC124\\uC815\",children:[(0,e.jsx)(n.a,{href:\"#manual\\uD558\\uAC8C-logging-\\uC124\\uC815\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Manual\\uD558\\uAC8C Logging \\uC124\\uC815\"]}),(0,e.jsx)(n.p,{children:\"\\uC704\\uC758 \\uCF54\\uB4DC\\uB97C \\uC774\\uD574\\uD558\\uAE30 \\uC704\\uD574\\uC11C \\uBA54\\uB274\\uC5BC\\uD558\\uAC8C Python Logger \\uB77C\\uC774\\uBE0C\\uB7EC\\uB9AC\\uC5D0 OpenTelemetry sdk\\uB85C log\\uB97C \\uBCF4\\uB0B4\\uB3C4\\uB85D handler\\uB97C \\uCD94\\uAC00\\uD558\\uBA74 \\uC544\\uB798 \\uCF54\\uB4DC\\uC640 \\uAC19\\uB2E4.\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"app.py\"})}),(0,e.jsx)(n.pre,{className:\"language-py\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-py\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),\" logging\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` os\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" flask \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),\" Flask\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` request\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" opentelemetry\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"_logs \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` set_logger_provider\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" opentelemetry\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"exporter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"otlp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"proto\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"http\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"_log_exporter \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` OTLPLogExporter\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" opentelemetry\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sdk\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"_logs \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),\" LoggerProvider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` LoggingHandler\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" opentelemetry\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sdk\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"_logs\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"export \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` BatchLogRecordProcessor\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" opentelemetry\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sdk\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"resources \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` Resource\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"logger_provider \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" LoggerProvider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    resource\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"Resource\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"create\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"service.name\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"example\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"service.instance.id\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" os\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"uname\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"nodename\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"set_logger_provider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"logger_provider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"otlp_exporter \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" OTLPLogExporter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"endpoint\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"http://otel-collector:4318/v1/logs\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"logger_provider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"add_log_record_processor\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"BatchLogRecordProcessor\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"otlp_exporter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"handler \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" LoggingHandler\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"level\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"logging\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"DEBUG\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" logger_provider\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"logger_provider\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"logging\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"getLogger\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"addHandler\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"handler\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"app \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" Flask\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"__name__\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"logger\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"setLevel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"logging\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"INFO\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token punctuation annotation decorator\",children:[\"@app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"route\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"/hello\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"server_request\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"logger\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"info\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'hello from logger!'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"print\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"hello world!\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"world!\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" __name__ \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"__main__\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"run\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"port\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"5000\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"requirements.txt\"})}),(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`flask\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`opentelemetry-distro\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`opentelemetry-instrumentation-fastapi\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`opentelemetry-instrumentation-logging\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`opentelemetry-exporter-otlp-proto-http\n`})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"Dockerfile\"})}),(0,e.jsx)(n.pre,{className:\"language-dockerfile\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-Dockerfile\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"FROM\"}),\" \",(0,e.jsxs)(n.span,{className:\"token options\",children:[(0,e.jsx)(n.span,{className:\"token property\",children:\"--platform\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"linux/amd64\"})]}),\" python:3.11\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"WORKDIR\"}),\" /usr/src/app\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"COPY\"}),\" requirements.txt requirements.txt\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"RUN\"}),\" pip3 install --no-cache-dir -r requirements.txt\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"COPY\"}),\" . .\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"CMD\"}),\" [\",(0,e.jsx)(n.span,{className:\"token string\",children:'\"python\"'}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"-m\"'}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"flask\"'}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"--app\"'}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"app\"'}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"run\"'}),\"]\"]}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB9AC\\uACE0 \\uC774\\uC81C auto instrumentation\\uC774 \\uB418\\uC9C0 \\uC54A\\uB3C4\\uB85D annotation\\uC744 \\uC81C\\uAC70\\uD558\\uACE0, Container Image\\uB97C \\uBC30\\uD3EC\\uD55C\\uB2E4. \",(0,e.jsx)(n.code,{children:\"opentelemetry-operator\"}),\"\\uC5D0 \\uC758\\uD574\\uC11C \\uC790\\uB3D9\\uC73C\\uB85C \\uC8FC\\uC785\\uB41C \\uD658\\uACBD\\uBCC0\\uC218\\uB3C4 \\uC218\\uB3D9\\uC73C\\uB85C \\uB123\\uC5B4\\uC8FC\\uC5C8\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"deployment.yml\"})}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` apps/v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Deployment\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` sample\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"revisionHistoryLimit\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"selector\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"matchLabels\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"app\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` sample\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"template\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"labels\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"app\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` sample\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"containers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"image\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` sample\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` sample\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"imagePullPolicy\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Always\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` OTEL_SERVICE_NAME\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` example\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` OTEL_EXPORTER_OTLP_PROTOCOL\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` http/protobuf\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` OTEL_LOGS_EXPORTER\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` otlp_proto_http\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` OTEL_TRACES_EXPORTER\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` otlp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` OTEL_METRICS_EXPORTER\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` otlp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` OTEL_PYTHON_LOGGING_AUTO_INSTRUMENTATION_ENABLED\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'true'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` OTEL_RESOURCE_ATTRIBUTES_POD_NAME\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"valueFrom\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"fieldRef\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"fieldPath\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` metadata.name\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` OTEL_RESOURCE_ATTRIBUTES_NODE_NAME\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"valueFrom\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"fieldRef\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"fieldPath\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` spec.nodeName\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` OTEL_RESOURCE_ATTRIBUTES\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.container.name=sample,k8s.deployment.name=sample,k8s.namespace.name=example,k8s.node.name=$(OTEL_RESOURCE_ATTRIBUTES_NODE_NAME),k8s.pod.name=$(OTEL_RESOURCE_ATTRIBUTES_POD_NAME),k8s.replicaset.name=sample-55c69d6957,service.instance.id=example.$(OTEL_RESOURCE_ATTRIBUTES_POD_NAME).sample,service.version=latest'\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uC774\\uB807\\uAC8C \\uBC30\\uD3EC\\uD558\\uACE0 \\uB3D9\\uC77C\\uD558\\uAC8C Flask Application\\uC5D0 \\uC694\\uCCAD\\uC744 \\uD558\\uBA74 \\uB3D9\\uC77C\\uD55C \\uB85C\\uADF8\\uAC00 \\uB0A8\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. (\\uD558\\uC9C0\\uB9CC Trace\\uC5D0 \\uB300\\uD574\\uC11C\\uB294 \\uC124\\uC815\\uC744 \\uD558\\uC9C0 \\uC54A\\uC558\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uD574\\uB2F9 Log\\uC5D0 TraceID\\uC640 SpanID\\uB294 \\uCD94\\uAC00\\uB418\\uC9C0 \\uC54A\\uB294\\uB2E4.)\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.a,{href:\"https://github.com/open-telemetry/opentelemetry-operator/blob/main/autoinstrumentation/python/requirements.txt\",children:\"\\uADF8\\uB9AC\\uACE0 \\uC704\\uC5D0\\uC11C Exporter\\uB97C grpc\\uB300\\uC2E0\\uC5D0 http\\uB97C \\uC0AC\\uC6A9\\uD588\\uB294\\uB370, opentelemetry operater\\uC5D0\\uC11C\\uB294 grpc\\uAC00 OS\\uC640 Python version\\uC5D0 \\uC758\\uC874\\uC131\\uC774 \\uC788\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uBC94\\uC6A9\\uC801\\uC73C\\uB85C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB294 http\\uB97C \\uC0AC\\uC6A9\\uD55C\\uB2E4.\"})}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# We don't use the distro[otlp] option which automatically includes exporters since gRPC is not appropriate for\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# injected auto-instrumentation, where it has a strict dependency on the OS / Python version the artifact is built for.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"opentelemetry-exporter-otlp-proto-http\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1.23\"}),`.0\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"loki\\uB85C-\\uD655\\uC778\",children:[(0,e.jsx)(n.a,{href:\"#loki\\uB85C-\\uD655\\uC778\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Loki\\uB85C \\uD655\\uC778\"]}),(0,e.jsxs)(n.p,{children:[\"\\uC774\\uBC88\\uC5D0\\uB294 \",(0,e.jsx)(n.code,{children:\"OTEL_LOGS_EXPORTER\"}),\"\\uB97C \",(0,e.jsx)(n.code,{children:\"otlp_proto_http\"}),\"\\uB85C \\uC124\\uC815\\uD558\\uC5EC OpenTelemetry Collector\\uAC00 \\uB85C\\uADF8\\uB97C \\uC218\\uC9D1\\uD558\\uB3C4\\uB85D \\uD55C\\uB2E4. \\uADF8\\uB9AC\\uACE0 \\uC704\\uC5D0\\uC11C OpenTelemetry Collector\\uC5D0\\uC11C Loki Exporter\\uB97C \\uC124\\uC815\\uD558\\uC600\\uAE30 \\uB54C\\uBB38\\uC5D0, \\uC815\\uC0C1\\uC801\\uC73C\\uB85C Loki\\uC5D0 \\uB85C\\uADF8\\uAC00 \\uC313\\uC774\\uB294\\uC9C0 \\uD655\\uC778\\uD574\\uBCF8\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` opentelemetry.io/v1alpha1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Instrumentation\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" python\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`instrumentation\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"exporter\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"endpoint\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" http\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"//otel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"collector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"4318\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"propagators\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` tracecontext\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` baggage\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"python\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` OTEL_LOGS_EXPORTER\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` otlp_proto_http\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` OTEL_PYTHON_LOGGING_AUTO_INSTRUMENTATION_ENABLED\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'true'\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uC218\\uC815\\uD55C \",(0,e.jsx)(n.code,{children:\"Instrumentation CRD\"}),\"\\uB97C \\uBC30\\uD3EC\\uD558\\uACE0, \\uB2E4\\uC2DC Flask \\uC5B4\\uD50C\\uB9AC\\uCF00\\uC774\\uC158 Container\\uAC00 \\uC788\\uB294 Pod\\uB97C \\uC7AC\\uC2DC\\uC791\\uD558\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 Loki\\uC5D0 \\uB85C\\uADF8\\uAC00 \\uC313\\uC774\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-json\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-json\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"body\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"127.0.0.1 - - [25/May/2024 01:49:05] \\\\\"GET /hello HTTP/1.1\\\\\" 200 -\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"severity\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"INFO\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"attributes\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"code.filepath\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"/usr/local/lib/python3.11/site-packages/werkzeug/_internal.py\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"code.function\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"_log\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"code.lineno\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"97\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"otelServiceName\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"sample\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"otelSpanID\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"0\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"otelTraceID\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"0\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"otelTraceSampled\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"false\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"resources\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"k8s.container.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"sample\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"k8s.deployment.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"sample\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"k8s.namespace.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"example\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"k8s.node.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"example-node\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"k8s.pod.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"sample-656f58b97c-9mr6d\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"k8s.replicaset.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"sample-656f58b97c\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"service.instance.id\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"example.sample-656f58b97c-9mr6d.sample\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"service.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"sample\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"service.version\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"amd64\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"telemetry.auto.version\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"0.44b0\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"telemetry.sdk.language\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"python\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"telemetry.sdk.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"opentelemetry\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"telemetry.sdk.version\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"1.23.0\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"instrumentation_scope\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"opentelemetry.sdk._logs._internal\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"resources\\uC5D0 \\uC800\\uB807\\uAC8C \\uB0A8\\uAE30 \\uB54C\\uBB38\\uC5D0, opentelemetry collector \\uC124\\uC815\\uC5D0 resource processors\\uB97C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC815\\uC758\\uD574\\uC11C Loki label\\uB97C \\uCD94\\uAC00\\uD558\\uC600\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"processors\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"resource\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"attributes\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"action\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` insert\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` pod\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"from_attribute\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` k8s.pod.name\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"action\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` insert\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` container\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"from_attribute\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` k8s.container.name\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"action\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` insert\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` namespace\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"from_attribute\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` k8s.namespace.name\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"action\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` insert\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` loki.resource.labels\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" pod\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" namespace\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` container\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"gunicorn\\uC73C\\uB85C-\\uC2E4\\uD589\",children:[(0,e.jsx)(n.a,{href:\"#gunicorn\\uC73C\\uB85C-\\uC2E4\\uD589\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Gunicorn\\uC73C\\uB85C \\uC2E4\\uD589\"]}),(0,e.jsx)(n.p,{children:\"Flask Production\\uC5D0\\uC11C \\uC2E4\\uD589\\uD560 \\uB54C\\uB294 Flask\\uC758 \\uAC1C\\uBC1C\\uC6A9 WSGI server\\uB97C \\uC0AC\\uC6A9\\uD558\\uC9C0 \\uC54A\\uACE0 \\uBCC4\\uB3C4\\uC758 WSGI server\\uB97C \\uC0AC\\uC6A9\\uD55C\\uB2E4. Gunicorn\\uC744 \\uC0AC\\uC6A9\\uD558\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC124\\uC815\\uC774 \\uB41C\\uB2E4.\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"app.py\"})}),(0,e.jsx)(n.pre,{className:\"language-py\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-py\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` logging\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" flask \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),\" Flask\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` request\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"app \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" Flask\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"__name__\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"logger\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"setLevel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"logging\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"INFO\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token punctuation annotation decorator\",children:[\"@app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"route\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"/hello\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"hello\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"logger\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"info\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"hello world!\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"world!\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token punctuation annotation decorator\",children:[\"@app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"route\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"/error\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"logger\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"info\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"error test!\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"raise\"}),\" Exception\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"test exception\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"world!\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" __name__ \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"__main__\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"run\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"port\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"5000\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"requirements.txt\"})}),(0,e.jsx)(n.pre,{className:\"language-txt\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-txt\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`flask\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`gunicorn\n`})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"Dockerfile\"})}),(0,e.jsx)(n.pre,{className:\"language-dockerfile\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-Dockerfile\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"FROM\"}),\" \",(0,e.jsxs)(n.span,{className:\"token options\",children:[(0,e.jsx)(n.span,{className:\"token property\",children:\"--platform\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"linux/amd64\"})]}),\" python:3.11\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"WORKDIR\"}),\" /usr/src/app\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"COPY\"}),\" requirements.txt requirements.txt\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"RUN\"}),\" pip3 install --no-cache-dir -r requirements.txt\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"COPY\"}),\" . .\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"CMD\"}),\" [ \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"python3\"'}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"-m\"'}),\" , \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"gunicorn\"'}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"app:app\"'}),\"]\"]}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uB85C\\uADF8\\uB4E4\\uC774 \\uC218\\uC9D1\\uB418\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD588\\uB2E4.\"}),(0,e.jsxs)(n.h2,{id:\"fastapi-uvicorn-\\uC2E4\\uD589\",children:[(0,e.jsx)(n.a,{href:\"#fastapi-uvicorn-\\uC2E4\\uD589\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"FastAPI Uvicorn \\uC2E4\\uD589\"]}),(0,e.jsx)(n.p,{children:\"Python\\uC5D0\\uC11C Web Application\\uC744 \\uB9CC\\uB4E4 \\uB54C, FastAPI\\uB3C4 \\uB9CE\\uC774 \\uC4F4\\uB2E4. \\uB530\\uB77C\\uC11C FastAPI\\uB97C ASGI Server\\uC778 Uvicorn\\uC73C\\uB85C \\uC2E4\\uD589\\uD558\\uC5EC Log \\uC218\\uC9D1\\uC744 \\uD655\\uC778\\uD574\\uBD24\\uB2E4. \\uC544\\uB798\\uC640 \\uAC19\\uC774 Sample \\uCF54\\uB4DC\\uB97C \\uB3D9\\uC77C\\uD558\\uAC8C \\uC791\\uC131\\uD558\\uC5EC Info \\uB85C\\uADF8\\uC640 Error \\uB85C\\uADF8\\uAC00 \\uC798 \\uC218\\uC9D1\\uB418\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD558\\uC600\\uB2E4.\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"app.py\"})}),(0,e.jsx)(n.pre,{className:\"language-py\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-py\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` logging\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" typing \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` Union\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" fastapi \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` FastAPI\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"app \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" FastAPI\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"logger \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" logging\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"getLogger\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"logger\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"setLevel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"logging\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"INFO\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token punctuation annotation decorator\",children:[\"@app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"get\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"/hello\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"hello\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    logger\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"info\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'hello uvicorn!'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"Hello\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"World\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token punctuation annotation decorator\",children:[\"@app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"get\"]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"/error\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    logger\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"info\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'error test'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"raise\"}),\" Exception\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"test exception\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"Hello\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"World\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"requirements.txt\"})}),(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`fastapi\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`pydantic\n`})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"Dockerfile\"})}),(0,e.jsx)(n.pre,{className:\"language-dockerfile\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-Dockerfile\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"FROM\"}),\" \",(0,e.jsxs)(n.span,{className:\"token options\",children:[(0,e.jsx)(n.span,{className:\"token property\",children:\"--platform\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"linux/amd64\"})]}),\" python:3.11\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"WORKDIR\"}),\" /usr/src/app\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"COPY\"}),\" requirements.txt requirements.txt\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"RUN\"}),\" pip3 install --no-cache-dir -r requirements.txt\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"COPY\"}),\" . .\"]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsxs)(n.span,{className:\"token instruction\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"CMD\"}),\" [\",(0,e.jsx)(n.span,{className:\"token string\",children:'\"uvicorn\"'}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"app:app\"'}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"--host=0.0.0.0\"'}),\"]\"]}),`\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"multi-process\",children:[(0,e.jsx)(n.a,{href:\"#multi-process\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Multi Process\"]}),(0,e.jsx)(n.p,{children:\"Python\\uC740 GIL\\uB54C\\uBB38\\uC5D0 CPU Core\\uAC00 \\uC5EC\\uB7EC \\uAC1C\\uC77C\\uB54C Process\\uB97C \\uB298\\uB9AC\\uB294 \\uBC29\\uC2DD\\uC744 \\uC0AC\\uC6A9\\uD55C\\uB2E4. Kuberentes\\uC5D0\\uC11C CPU\\uB294 \\uD558\\uB098\\uB9CC \\uD560\\uB2F9\\uD558\\uACE0 Scale out\\uC744 \\uD558\\uB294 \\uACBD\\uC6B0\\uC5D0\\uB294 \\uAD1C\\uCC2E\\uACA0\\uC9C0\\uB9CC, \\uBA40\\uD2F0 \\uCF54\\uC5B4\\uC5D0 \\uBA40\\uD2F0 \\uD504\\uB85C\\uC138\\uC2A4\\uB85C \\uC6B4\\uC601\\uD560 \\uB54C\\uB294 Auto Instrumentation\\uC744 \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC5C6\\uB294 \\uAC83\\uC73C\\uB85C \\uBCF4\\uC778\\uB2E4.\"}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://opentelemetry-python.readthedocs.io/en/latest/examples/fork-process-model/README.html\",children:\"\\uADF8\\uB9AC\\uACE0 default\\uC73C\\uB85C \\uC124\\uC815\\uB418\\uB294 BatchSpanProcessor\\uC758 \\uACBD\\uC6B0\\uC5D0\\uB294 Gunicorn\\uCC98\\uB7FC pre-fork\\uB97C \\uD574\\uC11C \\uC0AC\\uC6A9\\uD560 \\uBB38\\uC81C\\uAC00 \\uBC1C\\uC0DD\\uD560\\uC218 \\uC788\\uB2E4\\uACE0 \\uBB38\\uC11C\\uC5D0 \\uC124\\uBA85\\uD558\\uACE0 \\uC788\\uB2E4.\"}),\" \\uADF8\\uB798\\uC11C Gunicorn\\uC758 \",(0,e.jsx)(n.code,{children:\"post_fork\"}),\" Hook\\uC744 \\uC0AC\\uC6A9\\uD558\\uC5EC \\uC124\\uC815\\uD558\\uB294 \\uAC83\\uC744 \\uACE0\\uB824\\uD574\\uC57C \\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:\"gunicorn.conf.py\"}),(0,e.jsx)(n.pre,{className:\"language-py\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-py\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"post_fork\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"server\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" worker\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]})})}),(0,e.jsxs)(n.h2,{id:\"\\uACB0\\uB860\",children:[(0,e.jsx)(n.a,{href:\"#\\uACB0\\uB860\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uACB0\\uB860\"]}),(0,e.jsx)(n.p,{children:\"OpenTelemetry Operator\\uC758 Instrumentation CRD\\uB97C \\uD1B5\\uD574\\uC11C \\uB098\\uC758 \\uC5B4\\uD50C\\uB9AC\\uCF00\\uC774\\uC158\\uC758 \\uC18C\\uC2A4\\uCF54\\uB4DC \\uBCC0\\uACBD\\uC5C6\\uC774 \\uC790\\uB3D9\\uC73C\\uB85C Instrumentation \\uD560 \\uC218\\uAC00 \\uC788\\uB2E4. \\uB2E4\\uC591\\uD55C Instrumentation Library\\uB97C \\uD1B5\\uD574\\uC11C Trace, Metric, Logging\\uB4F1\\uC744 \\uC790\\uB3D9\\uC73C\\uB85C \\uC218\\uC9D1\\uD560 \\uC218 \\uC788\\uB2E4. \\uC774\\uBC88\\uC5D0\\uB294 \\uD2B9\\uD788 Python Runtime \\uACBD\\uC6B0\\uC5D0 OpenTelemetry Operator\\uB85C \\uC5B4\\uB5BB\\uAC8C Logging\\uC774 \\uC790\\uB3D9\\uC73C\\uB85C \\uB420 \\uC218 \\uC788\\uB294\\uC9C0 \\uD655\\uC778\\uD574\\uBCF4\\uC558\\uB2E4. Init Container\\uB85C \\uB2E4\\uC591\\uD55C instrumentation library\\uC640 sdk/api library\\uB97C \\uC124\\uCE58\\uD558\\uACE0, mount\\uD55C \\uD574\\uB2F9 volume \\uACBD\\uB85C\\uB97C PYTHONPATH\\uC5D0 \\uCD94\\uAC00\\uD55C\\uB2E4. \\uADF8\\uB9AC\\uACE0 PYTHONPATH\\uC5D0 opentelemetry-instrumentation \\uB77C\\uC774\\uBE0C\\uB7EC\\uB9AC\\uC758 sitecustomize.py\\uAC00 \\uB098\\uC758 Python \\uC5B4\\uD50C\\uB9AC\\uCF00\\uC774\\uC158\\uC774 \\uC2E4\\uD589\\uB418\\uAE30 \\uC804\\uC5D0 import\\uB418\\uB3C4\\uB85D \\uC124\\uC815\\uD55C\\uB2E4. \\uADF8\\uB798\\uC11C instrumentation library\\uC774 \\uC790\\uB3D9\\uC73C\\uB85C \\uC124\\uC815\\uB420 \\uC218 \\uC788\\uB2E4. \\uC8FC\\uC785\\uB41C \\uD658\\uACBD\\uBCC0\\uC218\\uC640 \\uD568\\uAED8 opentelemetry sdk\\uAC00 Metric, Trace, Logging \\uC124\\uC815\\uC744 \\uD558\\uACE0, \\uCD5C\\uC885\\uC801\\uC73C\\uB85C OpenTelemetry Collector\\uB85C \\uD574\\uB2F9 \\uB370\\uC774\\uD130\\uB97C \\uBCF4\\uB0B4\\uAC8C \\uB41C\\uB2E4.\"})]})}}var b=_;return T;})();\n;return Component;","toc":[{"value":"Helm Chart로 설치","url":"#helm-chart로-설치","depth":2},{"value":"OpenTelemetry Collector 설치","url":"#opentelemetry-collector-설치","depth":2},{"value":"Instrumentation CRD 생성","url":"#instrumentation-crd-생성","depth":2},{"value":"Flask App에 적용","url":"#flask-app에-적용","depth":2},{"value":"Init Container 확인","url":"#init-container-확인","depth":2},{"value":"Logs Bridge API","url":"#logs-bridge-api","depth":2},{"value":"Manual하게 Logging 설정","url":"#manual하게-logging-설정","depth":2},{"value":"Loki로 확인","url":"#loki로-확인","depth":2},{"value":"Gunicorn으로 실행","url":"#gunicorn으로-실행","depth":2},{"value":"FastAPI Uvicorn 실행","url":"#fastapi-uvicorn-실행","depth":2},{"value":"Multi Process","url":"#multi-process","depth":2},{"value":"결론","url":"#결론","depth":2}],"frontMatter":{"readingTime":{"text":"21 min read","minutes":20.685,"time":1241100,"words":4137},"slug":"20240526-otel-operator","fileName":"20240526-otel-operator.md","title":"opentelemetry-operator 사용해보기","date":"2024-05-26T00:00:00.000Z","tags":["kubernetes","opentelemetry"],"images":["/static/images/social-banner.png"],"summary":"소스코드를 변경하지 않고 opentelemetry-operator의 Instrumentation CRD를 통해서 Python Application을 자동으로 Instrumentation을 해봤다. 이 과정에서 OpenTelemetry Logging의 경우에는 기존 Logging Libarary에 Bridge API로 연동하는 구조로 설계된 것을 알게 되었고, Python opentelemetry sdk가 logger에 handler를 추가하는 것을 알게 되었다. 또한 sitecustomize.py을 통해서 Python Application이 실행되기 전에 Instrumentation library를 셋팅하는 것을 이해하게 되었다. Gunicorn으로 Flask를 실행할 때와 Uvicorn으로 FastAPI를 실행할 때, Auto Instrumentation이 잘 되는 것을 확인하였다."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.15,"time":9000,"words":30},"slug":["default"],"fileName":"default.md","name":"Jay","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"ZAP을 사용하여 동적 검사 해보기","date":"2024-05-19T00:00:00.000Z","tags":["devsecops","zap"],"images":["/static/images/social-banner.png"],"summary":"Google Oauth2를 프로덕션 단계로 사용할 때, Gmail 권한을 사용하려면 CASA(클라우드 어플리케이션 보안 평가)를 수행해야 한다. 관련 문서에서 동적 검사를 할 때,ZAP을 활용하는 방법을 설명하고 있다. 따라서 기본적인 ZAP 사용법을 확인하였다. Docker Container로 Sciprt를 실행하여 API 스캐닝을 해봤고, Automation Framework와 ZAP Desktop Application을 활용하여 React Router에 의해서 이동되는 페이지들을 크롤링하는 것을 테스트해봤다.","slug":"20240519-zap"},"next":null},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["20240526-otel-operator"]},"buildId":"GvPe-ulFw1_hwse8Itj5C","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>