<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="manifest" href="/jayground8/static/favicons/manifest.json"/><link rel="manifest" href="/jayground8/static/favicons/site.webmanifest"/><link rel="shortcut icon" href="/jayground8/static/favicons/favicon.ico"/><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8773084925406986" crossorigin="anonymous"></script><title>secrets-store-csi-driver-provider-gcp 사용해보기</title><meta name="robots" content="follow, index"/><meta name="description" content="GKE에서 add-on 기능으로 관리형 서비스인 Google Secret Manager을 Kubernetes Secrets Store CSI Driver로 쉽게 사용할 수 있다. 하지만 add-on 버전에서는 Sync as Kubernetes Secret 기능을 제공하지 않기 때문에, Kubernetes Secret을 환경변수로 설정하는데 제약사항이 있다. 직접 Kubernetes Secrets Store CSI driver와 GCP provider driver를 설치하여 Sync as Kubernetes Secret 기능을 사용할 수 있다. 이렇게 Sync된 Kubernetes Secret을 환경변수로 주입하도록 설정할 수 있다. Google Secret Manager는 아쉽게도 하나의 Secret에 복수의 key value를 제공하지 않는다. 이번 글에서는 Google Secret Manager를 Kubernetes Secret Object와 Sync해서 사용하는 것이 바람직할지 고민해본다."/><meta property="og:url" content="https://jayground8.github.io/blog/20250105-secrets-store-csi-driver-provider-gcp"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Jayground8"/><meta property="og:description" content="GKE에서 add-on 기능으로 관리형 서비스인 Google Secret Manager을 Kubernetes Secrets Store CSI Driver로 쉽게 사용할 수 있다. 하지만 add-on 버전에서는 Sync as Kubernetes Secret 기능을 제공하지 않기 때문에, Kubernetes Secret을 환경변수로 설정하는데 제약사항이 있다. 직접 Kubernetes Secrets Store CSI driver와 GCP provider driver를 설치하여 Sync as Kubernetes Secret 기능을 사용할 수 있다. 이렇게 Sync된 Kubernetes Secret을 환경변수로 주입하도록 설정할 수 있다. Google Secret Manager는 아쉽게도 하나의 Secret에 복수의 key value를 제공하지 않는다. 이번 글에서는 Google Secret Manager를 Kubernetes Secret Object와 Sync해서 사용하는 것이 바람직할지 고민해본다."/><meta property="og:title" content="secrets-store-csi-driver-provider-gcp 사용해보기"/><meta property="og:image" content="https://jayground8.github.io/static/images/social-banner.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site"/><meta name="twitter:title" content="secrets-store-csi-driver-provider-gcp 사용해보기"/><meta name="twitter:description" content="GKE에서 add-on 기능으로 관리형 서비스인 Google Secret Manager을 Kubernetes Secrets Store CSI Driver로 쉽게 사용할 수 있다. 하지만 add-on 버전에서는 Sync as Kubernetes Secret 기능을 제공하지 않기 때문에, Kubernetes Secret을 환경변수로 설정하는데 제약사항이 있다. 직접 Kubernetes Secrets Store CSI driver와 GCP provider driver를 설치하여 Sync as Kubernetes Secret 기능을 사용할 수 있다. 이렇게 Sync된 Kubernetes Secret을 환경변수로 주입하도록 설정할 수 있다. Google Secret Manager는 아쉽게도 하나의 Secret에 복수의 key value를 제공하지 않는다. 이번 글에서는 Google Secret Manager를 Kubernetes Secret Object와 Sync해서 사용하는 것이 바람직할지 고민해본다."/><meta name="twitter:image" content="https://jayground8.github.io/static/images/social-banner.png"/><link rel="canonical" href="https://jayground8.github.io/blog/20250105-secrets-store-csi-driver-provider-gcp"/><meta property="article:published_time" content="2025-01-05T00:00:00.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jayground8.github.io/blog/20250105-secrets-store-csi-driver-provider-gcp"
  },
  "headline": "secrets-store-csi-driver-provider-gcp 사용해보기",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://jayground8.github.io/static/images/social-banner.png"
    }
  ],
  "datePublished": "2025-01-05T00:00:00.000Z",
  "dateModified": "2025-01-05T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jay"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Jay",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jayground8.github.ioplayground.png"
    }
  },
  "description": "GKE에서 add-on 기능으로 관리형 서비스인 Google Secret Manager을 Kubernetes Secrets Store CSI Driver로 쉽게 사용할 수 있다. 하지만 add-on 버전에서는 Sync as Kubernetes Secret 기능을 제공하지 않기 때문에, Kubernetes Secret을 환경변수로 설정하는데 제약사항이 있다. 직접 Kubernetes Secrets Store CSI driver와 GCP provider driver를 설치하여 Sync as Kubernetes Secret 기능을 사용할 수 있다. 이렇게 Sync된 Kubernetes Secret을 환경변수로 주입하도록 설정할 수 있다. Google Secret Manager는 아쉽게도 하나의 Secret에 복수의 key value를 제공하지 않는다. 이번 글에서는 Google Secret Manager를 Kubernetes Secret Object와 Sync해서 사용하는 것이 바람직할지 고민해본다."
}</script><meta name="next-head-count" content="24"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preload" href="/_next/static/css/414f98a58444a4f1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/414f98a58444a4f1.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-690364db8bfb1f01.js" defer=""></script><script src="/_next/static/chunks/main-eea1c213342d95c3.js" defer=""></script><script src="/_next/static/chunks/pages/_app-144e4849f13c0054.js" defer=""></script><script src="/_next/static/chunks/675-70b09cbf0a5309ea.js" defer=""></script><script src="/_next/static/chunks/410-35c4fb535edd9439.js" defer=""></script><script src="/_next/static/chunks/712-376d32740a4ac813.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-8ab66ff6ebabec4c.js" defer=""></script><script src="/_next/static/oxVbhW_Td-KP5uFz7GpY-/_buildManifest.js" defer=""></script><script src="/_next/static/oxVbhW_Td-KP5uFz7GpY-/_ssgManifest.js" defer=""></script><script src="/_next/static/oxVbhW_Td-KP5uFz7GpY-/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="Jayground8" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" width="53.87" height="43.61" viewBox="0 0 512 512" class="fill-black dark:fill-white"><path d="M368.4 17c-8.8 1.3-18.3 5-25.3 9.9-3.8 2.5-22.6 16.1-41.9 30.1-37.1 26.9-38.6 28.3-36.3 33.9 1.7 4 4.9 5.1 14.6 5.1h8.5v128h-17.9c-18.2 0-22.2.6-27.3 4.2l-2.8 1.9V116.9l2.5-2.4c1.5-1.6 3.6-2.5 5.5-2.5s4 .9 5.5 2.5l2.5 2.4v42c0 29.1.3 42.8 1.1 44.5 2.6 5.7 11.5 5.5 13.9-.3.7-1.9 1-15.6.8-46.2-.3-40.1-.4-43.7-2.2-46.9-4.8-9-11.9-13.4-21.6-13.4-13.8 0-22.8 9.1-23.8 24.1l-.5 7.3h-31.5l-1.2-2.9c-1.6-3.9-6-5.8-9.9-4.1-1.6.6-3.5 2.5-4.1 4.1l-1.2 2.9h-63.6l-1.2-2.9c-2.5-6.2-11.5-6.2-14 0l-1.2 2.9H64.3l-.5-7.3c-1-15-10-24.1-23.8-24.1-9.7 0-16.8 4.4-21.6 13.4-1.8 3.3-1.9 7.5-2.2 75-.2 50 .1 72.3.8 74.1 2.1 5.1 8.6 6.3 12.5 2.4l2.5-2.4V116.9l2.5-2.4c3.2-3.3 7.8-3.3 11 0l2.5 2.4V448H32V284.9l-2.5-2.4c-3.8-3.9-10.2-2.7-12.4 2.2-1.6 3.4-1.6 171.2 0 174.6.6 1.4 2.2 3 3.6 3.6 1.6.7 15.6 1.1 43.7 1.1 38 0 41.5-.1 43.4-1.8 1.2-.9 33.4-50.5 71.7-110.2 38.3-59.7 70.5-109.3 71.7-110.3 1.8-1.5 4.3-1.7 19.4-1.7H288v16h-12.5c-13.1 0-16.6.8-18.3 4.4-2 4.5-138.5 216.2-140.4 217.9-1.9 1.6-5.6 1.7-47.9 1.7-31.9 0-46.6.3-48.3 1.1-5.7 2.6-5.5 11.5.3 13.9 1.9.7 16.7 1 50.1.8 46.4-.3 47.6-.3 51.5-2.5 2.2-1.1 5.1-3.3 6.5-4.7 1.3-1.5 10.1-14.7 19.6-29.4l17.1-26.7 18.4-.5c10.1-.3 19.1-.9 20-1.3.9-.5 2.1-1.9 2.8-3.3 1.5-3.4 1.5-35.4 0-38.8-1.1-2.3-4-4-8-4.8-1.3-.2 1.5-5.2 11.5-20.7l13.1-20.5.5 56.5c.3 31 .9 57.1 1.3 58 1.5 3 5.6 3.9 18.2 3.9H256v14c0 14.9.7 18.1 4.7 19.9 1.7.8 34.7 1.1 115.3 1.1s113.6-.3 115.3-1.1c1.4-.6 3-2.2 3.6-3.6 1.5-3.4 1.5-83.2 0-86.6-2.2-4.9-8.6-6.1-12.4-2.2l-2.5 2.4V480H272V272h208v107.1l2.5 2.4c3.8 3.9 10.2 2.7 12.4-2.2 1.5-3.4 1.5-115.2 0-118.6-1.8-3.9-5-4.7-18.4-4.7H464v-40.5c0-27.9-.3-41.2-1.1-42.9-2.6-5.5-11.2-5.5-13.8 0-.8 1.7-1.1 15-1.1 42.9V256h-24v-34.5c0-21.3-.4-36.4-1.1-39.7-3.6-17.3-19.3-32.9-36.7-36.7-16.2-3.4-31.4 1.1-43.3 12.9-7.4 7.3-11.2 13.9-13.4 23.2-1.8 7.9-2.1 50.3-.4 54.2 1.6 3.5 6.1 5.2 9.8 3.7 4.7-2 5.1-4.2 5.1-29.6 0-21.5.2-23.9 2.2-29.2C350.6 168.4 363 160 376 160s25.4 8.4 29.8 20.3c2.1 5.5 2.2 7.4 2.2 40.7v35H304V96h144v24.5c0 16 .4 25.3 1.1 26.9 2.6 5.5 11.2 5.5 13.8 0 .7-1.6 1.1-10.9 1.1-26.9V96h8.5c9.7 0 12.9-1.1 14.6-5.1 2.1-5.2.1-7.5-17.7-20.4C446.2 53.8 445 53 442.1 53c-4.1.1-7.5 3.5-7.5 7.7 0 4 2.2 6.3 14.8 15.3l4.8 3.5-39.1.3c-21.5.1-56.7.1-78.2 0l-39.1-.3 14.9-10.7c8.2-5.9 20.7-15.1 27.8-20.4 14.5-10.8 20.5-14 29.4-15.5 11.6-2.1 22.4 1.3 36.5 11.4 4.3 3.1 9 5.7 10.3 5.7 3.9 0 7.5-4.4 7.1-8.7-.3-3.3-1.1-4.4-7.8-9.6-15.3-11.8-32.3-17.1-47.6-14.7zM96 152v8H64v-16h32v8zm80 0v8h-64v-16h64v8zm48 0v8h-32v-16h32v8zM96 280v104h-4.5c-5.5 0-9 1.5-10.4 4.7-1.5 3.3-1.5 35.4 0 38.7 1.7 3.6 3.1 4 16.2 4.6l11.9.5-5.1 7.7L99 448H64V176h32v104zm80-27.8v76.3l-17.8 27.7-17.7 27.7-14.2.1H112V176h64v76.2zm48-37.3v38.9l-15.6 24.4c-8.6 13.3-15.8 24.5-16 24.7-.2.2-.4-28.2-.4-63.2V176h32v38.9zM256 369v76h-16V317.1l7.8-12c4.2-6.7 7.8-12.1 8-12.1.1 0 .2 34.2.2 76zm-129.1 34.7c-1.2 2.1-3.6 5.7-5.1 8l-2.9 4.3H96v-16h33.2l-2.3 3.7zM192 408v8h-15.1l3.7-5.8c2-3.1 4.4-6.7 5.2-8 .8-1.2 2.4-2.2 3.8-2.2 2.3 0 2.4.2 2.4 8z"></path><path d="M322.5 114.5c-1.6 1.5-2.5 3.6-2.5 5.5s.9 4 2.5 5.5c1.5 1.6 3.6 2.5 5.5 2.5s4-.9 5.5-2.5c1.6-1.5 2.5-3.6 2.5-5.5s-.9-4-2.5-5.5c-1.5-1.6-3.6-2.5-5.5-2.5s-4 .9-5.5 2.5zM418.5 114.5c-1.6 1.5-2.5 3.6-2.5 5.5s.9 4 2.5 5.5c1.5 1.6 3.6 2.5 5.5 2.5s4-.9 5.5-2.5c1.6-1.5 2.5-3.6 2.5-5.5s-.9-4-2.5-5.5c-1.5-1.6-3.6-2.5-5.5-2.5s-4 .9-5.5 2.5zM290.2 290.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6zM450.5 290.5c-5 4.9-1.5 13.5 5.5 13.5 4.1 0 8-3.9 8-8s-3.9-8-8-8c-1.9 0-4 .9-5.5 2.5zM358.1 322c-8.3 2.2-16.5 5.7-19.8 8.6-3.3 2.8-3.9 7.3-1.4 10.6 3.3 4.1 6.4 4.3 13.8.8 23.3-10.9 47.3-7 64.8 10.5 11.5 11.4 16.5 23.6 16.5 39.7 0 15.9-5.1 28.1-16.4 39.4C404.2 443 392.1 448 376 448s-28.1-5-39.5-16.5c-11-11.1-16.5-24.2-16.5-39.5.1-9.5 1.2-14.5 5.6-24.3 3.8-8.3 3.8-10.4.1-14.5-4.7-5.1-10.8-1.7-15.4 8.6-8.6 19.5-8.4 42.7.6 61.7 9.1 19.3 28.3 34.5 49.5 39 11.9 2.6 28.4 1.7 39.3-2.2 23.9-8.6 41.3-27.9 46.9-51.9 1.9-8.5 1.9-24.4-.1-33.1-5.9-25.5-26.7-46.6-52.5-53.3-10.1-2.6-25.8-2.6-35.9 0zM290.2 450.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6zM450.2 450.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6z"></path></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">Jayground8</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">블로그</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-0 left-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><div class="flex justify-end"><button type="button" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">블로그</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2025-01-05T00:00:00.000Z">2025년 1월 5일 일요일</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">secrets-store-csi-driver-provider-gcp 사용해보기</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2738%27%20height=%2738%27/%3e"/></span><img alt="avatar" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="h-10 w-10 rounded-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="avatar" srcSet="https://jayground8.github.io/static/images/profile.png?w=48&amp;q=75 1x, https://jayground8.github.io/static/images/profile.png?w=96&amp;q=75 2x" src="https://jayground8.github.io/static/images/profile.png?w=96&amp;q=75" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="h-10 w-10 rounded-full" loading="lazy"/></noscript></span><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Jay</dd><dt class="sr-only">Twitter</dt><dd></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><p>GKE(Google Kubernetes Engine)을 사용하는 경우에 Container에 비밀값을 환경변수로 어떻게 주입할 수 있을까?</p><h2 id="gke-add-on"><a href="#gke-add-on" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>GKE Add-on</h2><p>Public Cloud Provider를 이용할 때, 운영에 대한 부담을 줄일 수 있는 managed service를 확인하게 된다. GCP에는 Secret Manager Service가 있고, GKE에서 add-on으로 간단하게 설정할 수 있다. 아래처럼 GKE Cluster에서 Secret Manager를 Enable하면 Kubernetes Secrets Store CSI Driver처럼 사용할 수 있다.</p><img src="/static/images/gke-secret-manager-add-on.png" alt="gke add-on option for secret manager"/><p>하지만 <a target="_blank" rel="noopener noreferrer" href="https://cloud.google.com/secret-manager/docs/secret-manager-managed-csi-component#limitations">공식 문서</a>에 나온 것처럼, 비밀값이 변경되었을 때 반영해주는 Secret auto rotation 기능과 Kubernetes Secret Object를 생성하여 Sync을 맞추는 기능은 제공하지 않는 제약사항이 있다. 따라서 아래처럼 Secret Object을 통해서 환경변수를 Container에 주입하는 경우에는 해당 Add-on 옵션을 사용할 수 없다.</p><div class="relative"><pre><code class="language-yaml code-highlight"><span class="code-line"><span class="token atrule key">envFrom</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token atrule key">secretRef</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">name</span><span class="token punctuation">:</span> app<span class="token punctuation">-</span>secrets
</span></code></pre></div><h2 id="secrets-store-csi-driver-직접-설치"><a href="#secrets-store-csi-driver-직접-설치" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>secrets-store-csi-driver 직접 설치</h2><p><a target="_blank" rel="noopener noreferrer" href="https://github.com/kubernetes-sigs/secrets-store-csi-driver">secrets-store-csi-driver</a>를 직접 설치하여 해당 기능들을 사용하는 방법이 있다. 이 글을 작성하는 시점에는 <code>syncSecret</code>과 <code>enableSecretRotation</code> 기능은 Alpha 기능으로 제공되고 있어서 아래와 같이 ArgoCD Helm으로 배포할 경우에 values에 사용하도록 설정을 해줘야 한다.</p><div class="relative"><pre><code class="language-yaml code-highlight"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> argoproj.io/v1alpha1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> Application
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">name</span><span class="token punctuation">:</span> secrets<span class="token punctuation">-</span>store<span class="token punctuation">-</span>csi<span class="token punctuation">-</span>driver
</span><span class="code-line">  <span class="token atrule key">namespace</span><span class="token punctuation">:</span> argocd
</span><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">project</span><span class="token punctuation">:</span> default
</span><span class="code-line">  <span class="token atrule key">syncPolicy</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">syncOptions</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> CreateNamespace=true
</span><span class="code-line">  <span class="token atrule key">destination</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">server</span><span class="token punctuation">:</span> <span class="token string">&#x27;https://kubernetes.default.svc&#x27;</span>
</span><span class="code-line">    <span class="token atrule key">namespace</span><span class="token punctuation">:</span> kube<span class="token punctuation">-</span>system
</span><span class="code-line">  <span class="token atrule key">source</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">chart</span><span class="token punctuation">:</span> secrets<span class="token punctuation">-</span>store<span class="token punctuation">-</span>csi<span class="token punctuation">-</span>driver
</span><span class="code-line">    <span class="token atrule key">repoURL</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//kubernetes<span class="token punctuation">-</span>sigs.github.io/secrets<span class="token punctuation">-</span>store<span class="token punctuation">-</span>csi<span class="token punctuation">-</span>driver/charts
</span><span class="code-line">    <span class="token atrule key">targetRevision</span><span class="token punctuation">:</span> 1.4.7
</span><span class="code-line">    <span class="token atrule key">helm</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">releaseName</span><span class="token punctuation">:</span> secrets<span class="token punctuation">-</span>store<span class="token punctuation">-</span>csi<span class="token punctuation">-</span>driver
</span><span class="code-line">      <span class="token atrule key">values</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token string scalar">
</span></span><span class="code-line"><span class="token string scalar">        syncSecret:
</span></span><span class="code-line"><span class="token string scalar">          enabled: true
</span></span><span class="code-line"><span class="token string scalar">        enableSecretRotation: true</span>
</span></code></pre></div><p>Google Secret Manager를 Secrets Store CSI driver에서 사용할 수 있도록 GCP용 provider를 설치한다. 아직 해당 Helm Chart는 public하게 publish하지 않아서 <a target="_blank" rel="noopener noreferrer" href="https://github.com/GoogleCloudPlatform/secrets-store-csi-driver-provider-gcp">secrets-store-csi-driver-provider-gcp</a> Github Repo를 Clone하여 아래와 같이 Helm으로 설치할 수 있다.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">helm upgrade <span class="token punctuation">\</span>
</span><span class="code-line">--install secrets-store-csi-driver-provider-gcp <span class="token punctuation">\</span>
</span><span class="code-line">charts/secrets-store-csi-driver-provider-gcp
</span></code></pre></div><h2 id="test"><a href="#test" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Test</h2><p><code>gcloud cli</code>를 통해서 예제 Secret 값을 생성한다.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line"><span class="token builtin class-name">echo</span> <span class="token string">&quot;helloworld&quot;</span> <span class="token operator">&gt;</span> secret.data
</span><span class="code-line">gcloud secrets create testsecret <span class="token punctuation">\</span>
</span><span class="code-line">--replication-policy<span class="token operator">=</span>automatic <span class="token punctuation">\</span>
</span><span class="code-line">--data-file<span class="token operator">=</span>secret.data
</span></code></pre></div><p>그리고 해당 Secret에 접근 권한을 준 service account를 생성한다.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">gcloud iam service-accounts create tutorial-workload
</span><span class="code-line">
</span><span class="code-line">gcloud iam service-accounts add-iam-policy-binding <span class="token punctuation">\</span>
</span><span class="code-line">--role roles/iam.workloadIdentityUser <span class="token punctuation">\</span>
</span><span class="code-line">--member <span class="token string">&quot;serviceAccount:tutorial-prj.svc.id.goog[default/example]&quot;</span> <span class="token punctuation">\</span>
</span><span class="code-line">tutorial-workload@tutorial-prj.iam.gserviceaccount.com
</span><span class="code-line">
</span><span class="code-line">gcloud secrets add-iam-policy-binding testsecret <span class="token punctuation">\</span>
</span><span class="code-line">--member<span class="token operator">=</span>serviceAccount:tutorial-workload@tutorial-prj.iam.gserviceaccount.com <span class="token punctuation">\</span>
</span><span class="code-line">--role<span class="token operator">=</span>roles/secretmanager.secretAccessor
</span></code></pre></div><p>Secrets Store CSI Driver가 설치되었기 때문에 아래와 같이 <code>SecretProviderClass</code> Ojbect를 생성한다. 그리고 secrets-store-csi-driver-provider-gcp가 설치되었기 때문에 spec.provider가 gcp로 설정할 수가 있다.</p><div class="relative"><pre><code class="language-yaml code-highlight"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> secrets<span class="token punctuation">-</span>store.csi.x<span class="token punctuation">-</span>k8s.io/v1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> SecretProviderClass
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">name</span><span class="token punctuation">:</span> app<span class="token punctuation">-</span>secrets
</span><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">provider</span><span class="token punctuation">:</span> gcp
</span><span class="code-line">  <span class="token atrule key">parameters</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">secrets</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token string scalar">
</span></span><span class="code-line"><span class="token string scalar">      - resourceName: &quot;projects/tutorial-prj/secrets/testsecret/versions/latest&quot;
</span></span><span class="code-line"><span class="token string scalar">        fileName: &quot;secret.data&quot;</span>
</span><span class="code-line">  <span class="token atrule key">secretObjects</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token atrule key">secretName</span><span class="token punctuation">:</span> app<span class="token punctuation">-</span>secrets
</span><span class="code-line">      <span class="token atrule key">type</span><span class="token punctuation">:</span> Opaque
</span><span class="code-line">      <span class="token atrule key">data</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token punctuation">-</span> <span class="token atrule key">objectName</span><span class="token punctuation">:</span> secret.data
</span><span class="code-line">          <span class="token atrule key">key</span><span class="token punctuation">:</span> example
</span></code></pre></div><p>Pod에서 Secret에 접근할 수 있도록 Kubernetes에 Service Account를 아래와 같이 생성한다.</p><div class="relative"><pre><code class="language-yaml code-highlight"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> v1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> ServiceAccount
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">name</span><span class="token punctuation">:</span> example
</span><span class="code-line">  <span class="token atrule key">namespace</span><span class="token punctuation">:</span> default
</span><span class="code-line">  <span class="token atrule key">annotations</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">iam.gke.io/gcp-service-account</span><span class="token punctuation">:</span> tutorial<span class="token punctuation">-</span>workload@tutorial<span class="token punctuation">-</span>prj.iam.gserviceaccount.com
</span></code></pre></div><p>마지막으로 Secret을 driver를 통해서 VolumeMount를 하고, Sync as Kubernetes Secret 기능으로 생성된 Secret Object으로 환경변수를 주입하도록 한다.</p><div class="relative"><pre><code class="language-yaml code-highlight"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> v1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> Pod
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">name</span><span class="token punctuation">:</span> mypod
</span><span class="code-line">  <span class="token atrule key">namespace</span><span class="token punctuation">:</span> default
</span><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">serviceAccountName</span><span class="token punctuation">:</span> example
</span><span class="code-line">  <span class="token atrule key">containers</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token atrule key">image</span><span class="token punctuation">:</span> gcr.io/google.com/cloudsdktool/cloud<span class="token punctuation">-</span>sdk<span class="token punctuation">:</span>slim
</span><span class="code-line">      <span class="token atrule key">imagePullPolicy</span><span class="token punctuation">:</span> IfNotPresent
</span><span class="code-line">      <span class="token atrule key">name</span><span class="token punctuation">:</span> mypod
</span><span class="code-line">      <span class="token atrule key">envFrom</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token punctuation">-</span> <span class="token atrule key">secretRef</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token atrule key">name</span><span class="token punctuation">:</span> app<span class="token punctuation">-</span>secrets
</span><span class="code-line">      <span class="token atrule key">volumeMounts</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token punctuation">-</span> <span class="token atrule key">mountPath</span><span class="token punctuation">:</span> <span class="token string">&#x27;/var/secrets&#x27;</span>
</span><span class="code-line">          <span class="token atrule key">name</span><span class="token punctuation">:</span> mysecret
</span><span class="code-line">          <span class="token atrule key">readOnly</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">  <span class="token atrule key">volumes</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> mysecret
</span><span class="code-line">      <span class="token atrule key">csi</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">driver</span><span class="token punctuation">:</span> secrets<span class="token punctuation">-</span>store.csi.k8s.io
</span><span class="code-line">        <span class="token atrule key">readOnly</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">        <span class="token atrule key">volumeAttributes</span><span class="token punctuation">:</span>
</span><span class="code-line">          <span class="token atrule key">secretProviderClass</span><span class="token punctuation">:</span> <span class="token string">&#x27;app-secrets&#x27;</span>
</span></code></pre></div><p>정상적으로 설정이 되었다면 app-secrets Kubernetes Secret Object가 생성되고, Container에 정상적으로 환경변수로 주입되게 된다.</p><h2 id="한계"><a href="#한계" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>한계</h2><p>오픈소스로 직접 운영할 수 있는 Hashicorp Vault와 비교할 때, GCP Secret Manager는 Secret 하나에 복수의 key value로 저장할 수 없다는 것이 아쉽다. Vault를 사용할 때 <a target="_blank" rel="noopener noreferrer" href="https://developer.hashicorp.com/vault/docs/platform/k8s/vso">Vault Secrets Operator</a>를 통해서 Vault의 Secret을 Kubernetes의 Secret Object와 Sync를 할 수 있다. 아래처럼 Vault Secret은 하나의 Secret에 복수의 key value로 설정할 수 있기 때문에, Container에게 필요한 모든 비밀값을 하나의 Secret으로 묶어서 관리할 수 있다.</p><img src="/static/images/gke-vault-create-secret.png" alt="create new secret on vault ui"/><p>GCP Secret Manager의 Secret에는 하나의 key value만 설정할 수 있다. 복수의 key value로 구성된 JSON같은 파일로 저장해서 Secret에 저장할 수 있지만, 그것을 하나의 Kubernetes Secret으로 Sync하는 방법이 제공되지 않는다.</p><img src="/static/images/gke-google-create-secret.png" alt="create new secret on gcp console"/><p>GCP Secret Manager에서 한쌍의 Key Value로만 관리한다면, Label을 통해서 Secret을 Group으로 묶는 방법을 고려할 수 있다. 그리고 SecretProviderClass에서 복수의 Secret들을 하나의 Kubernetes Secret Object로 묶어주는 작업을 해줘야 한다.</p><div class="relative"><pre><code class="language-yaml code-highlight"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> secrets<span class="token punctuation">-</span>store.csi.x<span class="token punctuation">-</span>k8s.io/v1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> SecretProviderClass
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">name</span><span class="token punctuation">:</span> app<span class="token punctuation">-</span>secrets
</span><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">provider</span><span class="token punctuation">:</span> gcp
</span><span class="code-line">  <span class="token atrule key">parameters</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">secrets</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token string scalar">
</span></span><span class="code-line"><span class="token string scalar">      - resourceName: &quot;projects/tutorial-prj/secrets/soemthing/versions/latest&quot;
</span></span><span class="code-line"><span class="token string scalar">        fileName: &quot;something&quot;
</span></span><span class="code-line"><span class="token string scalar">      - resourceName: &quot;projects/tutorial-prj/secrets/else/versions/latest&quot;
</span></span><span class="code-line"><span class="token string scalar">        fileName: &quot;else&quot;</span>
</span><span class="code-line">  <span class="token atrule key">secretObjects</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> <span class="token atrule key">secretName</span><span class="token punctuation">:</span> app<span class="token punctuation">-</span>secrets
</span><span class="code-line">      <span class="token atrule key">type</span><span class="token punctuation">:</span> Opaque
</span><span class="code-line">      <span class="token atrule key">data</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token punctuation">-</span> <span class="token atrule key">objectName</span><span class="token punctuation">:</span> something
</span><span class="code-line">          <span class="token atrule key">key</span><span class="token punctuation">:</span> SOMETHING
</span><span class="code-line">        <span class="token punctuation">-</span> <span class="token atrule key">objectName</span><span class="token punctuation">:</span> else
</span><span class="code-line">          <span class="token atrule key">key</span><span class="token punctuation">:</span> ELSE
</span></code></pre></div><p>또한 Secret의 key이름이 고유해야 하기 때문에, 환경별로 어플리케이션이 Secret을 지정하려면 명명 규칙이 필요하다.</p><h2 id="비용"><a href="#비용" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>비용</h2><p>Secret 버전당 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.06</mn><mtext>와엑세스작업</mtext><mn>10</mn><mo separator="true">,</mo><mn>000</mn><mtext>번당</mtext></mrow><annotation encoding="application/x-tex">0.06와 엑세스 작업 10,000번당 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8778em;vertical-align:-.1944em"></span><span class="mord">0.06</span><span class="mord hangul_fallback">와엑세스작업</span><span class="mord">10</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">000</span><span class="mord hangul_fallback">번당</span></span></span></span></span>0.03의 비용이 청구된다. Secret Auto Rotation을 위해서 Pub/Sub으로 Topic을 발행하면 추가로 알림당 $0.05의 비용이 발생한다. 이번 계산에서는 알림에 의한 비용은 무시한다.</p><p>그러면 Secret의 버전을 최신 하나만 유지한다고 했을 때, Secret 갯수 * $0.06 금액이 발생한다. Secret이 100개라고 하면 6달러 금액이 발생할 수 있다. 그리고 액새스 작업은 Secret Auto Rotation 기능의 활성화로 Polling하는 주기에 따라서 요금이 측정될 수 있다. Secrets Store CSI Driver에서 해당 기능의 기본 polling 주기는 2분으로 설정되어 있기 때문에, 하나 Secret당 Polling에 따라서 발생하는 금액은 월 0.12달러 정도가 된다. 이것도 Secret이 100개라고 하면 12달러 정도 금액이 발생한다.</p><p>100~200개의 Secret을 관리하는 것은 Vault를 HA Mode로 3개 Node를 CPU resource request 1로 운영하면서 발생하는 VM 비용보다 상당이 유리하다.</p><h2 id="결론"><a href="#결론" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>결론</h2><p>GKE에서 Secret Manager를 사용하여 Application에 비밀값을 주입한다면 아래와 같은 우선순위로 고려해볼 수 있겠다.</p><ol><li>Google Secret Manager API로 직접 비밀값을 바로 가져와서 사용<ul><li>보안적으로 가장 유리</li><li>Secret Manager에 장애가 있을 때 바로 영향을 받음. Google Secret Manager는 99.95% Uptime SLA를 제공하기 때문에, 한달에 약 22분 이상은 downtime이 발생하지 않도록 하고 있다.</li></ul></li><li><code>.env</code> 파일과 같이 파일 형식으로 불러와서 사용<ul><li>Secrets Store CSI Driver로 Volume Mount된 파일을 그대로 사용할 수 있다.</li><li>Vault UI를 통해서 Secret의 key-pair를 N개 관리하는 것과 비교하면 불편하다. 관리해야 되는 Secret이 많다면, Secrets Store CSI Driver를 사용하더라도 Vault provider를 사용하는 것이 더 바람직하다고 판단된다.</li></ul></li><li>Kubernetes Secret Object로 주입할 때는 Secret 갯수가 적고 변경이 적다면 <a target="_blank" rel="noopener noreferrer" href="https://external-secrets.io/latest/provider/google-secrets-manager/">External Secrets Operator</a>나 Secrets Store CIS Driver를 사용하고, Secret 갯수가 많고 변경이 잦으면 Vault를 사용<ul><li>Secret 갯수가 많아지면 Secret Manager를 사용하는 비용도 올라가고, 그것들을 관리하는 것도 어려워진다.</li><li>Vault UI Console에서 Vault Role을 통해서 개발자에게 권한을 위임하는 것이 편리하다. 비밀값의 변경이 잦고 개발자에게 관리를 위임해야 한다면 Vault가 유리하다.</li></ul></li></ol><p>Kubernetes에서 Application에 환경변수로 비밀값을 주입해야되는 제약사항이 있다라고 하면, Application이 여러 개가 존재하고 다양한 비밀값이 관리된다고 하면 Vault를 직접 운영하여 사용하는 것이 바람직하다고 판단된다. 아주 간단하게만 사용될 때만 Secrets Store CSI driver를 사용하는 것이 좋겠다.</p></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"></div><div id="comment"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/gcp">gcp</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/kubernetes">kubernetes</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/20241026-thanos-prometheus-remote-write">Thanos Receiver의 empty attribute value 문제</a></div></div><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/20250105-opentofu">GCP Secret Manager에서 비밀값을 OpenTofu로 관리하기</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:jayground8@gmail.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/jayground8"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Jay</div><div> • </div><div>© 2025</div><div> • </div><a href="/">Jayground8</a></div><div class="mb-8 text-sm text-gray-500 dark:text-gray-400"><a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var o=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty;var t=a=\u003el(a,\"__esModule\",{value:!0});var u=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=\u003e{t(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let n of p(s))!h.call(a,n)\u0026\u0026n!==\"default\"\u0026\u0026l(a,n,{get:()=\u003es[n],enumerable:!(c=d(s,n))||c.enumerable});return a},g=a=\u003ek(t(l(a!=null?o(m(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var i=u((j,r)=\u003e{r.exports=_jsx_runtime});var b={};N(b,{default:()=\u003ev,frontmatter:()=\u003ey});var e=g(i()),y={title:\"secrets-store-csi-driver-provider-gcp \\uC0AC\\uC6A9\\uD574\\uBCF4\\uAE30\",date:\"2025-01-05\",tags:[\"gcp\",\"kubernetes\"],images:[\"/static/images/social-banner.png\"],summary:\"GKE\\uC5D0\\uC11C add-on \\uAE30\\uB2A5\\uC73C\\uB85C \\uAD00\\uB9AC\\uD615 \\uC11C\\uBE44\\uC2A4\\uC778 Google Secret Manager\\uC744 Kubernetes Secrets Store CSI Driver\\uB85C \\uC27D\\uAC8C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB2E4. \\uD558\\uC9C0\\uB9CC add-on \\uBC84\\uC804\\uC5D0\\uC11C\\uB294 Sync as Kubernetes Secret \\uAE30\\uB2A5\\uC744 \\uC81C\\uACF5\\uD558\\uC9C0 \\uC54A\\uAE30 \\uB54C\\uBB38\\uC5D0, Kubernetes Secret\\uC744 \\uD658\\uACBD\\uBCC0\\uC218\\uB85C \\uC124\\uC815\\uD558\\uB294\\uB370 \\uC81C\\uC57D\\uC0AC\\uD56D\\uC774 \\uC788\\uB2E4. \\uC9C1\\uC811 Kubernetes Secrets Store CSI driver\\uC640 GCP provider driver\\uB97C \\uC124\\uCE58\\uD558\\uC5EC Sync as Kubernetes Secret \\uAE30\\uB2A5\\uC744 \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB2E4. \\uC774\\uB807\\uAC8C Sync\\uB41C Kubernetes Secret\\uC744 \\uD658\\uACBD\\uBCC0\\uC218\\uB85C \\uC8FC\\uC785\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB2E4. Google Secret Manager\\uB294 \\uC544\\uC27D\\uAC8C\\uB3C4 \\uD558\\uB098\\uC758 Secret\\uC5D0 \\uBCF5\\uC218\\uC758 key value\\uB97C \\uC81C\\uACF5\\uD558\\uC9C0 \\uC54A\\uB294\\uB2E4. \\uC774\\uBC88 \\uAE00\\uC5D0\\uC11C\\uB294 Google Secret Manager\\uB97C Kubernetes Secret Object\\uC640 Sync\\uD574\\uC11C \\uC0AC\\uC6A9\\uD558\\uB294 \\uAC83\\uC774 \\uBC14\\uB78C\\uC9C1\\uD560\\uC9C0 \\uACE0\\uBBFC\\uD574\\uBCF8\\uB2E4.\"};function S(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({p:\"p\",h2:\"h2\",a:\"a\",span:\"span\",pre:\"pre\",code:\"code\",math:\"math\",semantics:\"semantics\",mrow:\"mrow\",mn:\"mn\",mtext:\"mtext\",mo:\"mo\",annotation:\"annotation\",ol:\"ol\",li:\"li\",ul:\"ul\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.p,{children:\"GKE(Google Kubernetes Engine)\\uC744 \\uC0AC\\uC6A9\\uD558\\uB294 \\uACBD\\uC6B0\\uC5D0 Container\\uC5D0 \\uBE44\\uBC00\\uAC12\\uC744 \\uD658\\uACBD\\uBCC0\\uC218\\uB85C \\uC5B4\\uB5BB\\uAC8C \\uC8FC\\uC785\\uD560 \\uC218 \\uC788\\uC744\\uAE4C?\"}),(0,e.jsxs)(n.h2,{id:\"gke-add-on\",children:[(0,e.jsx)(n.a,{href:\"#gke-add-on\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"GKE Add-on\"]}),(0,e.jsx)(n.p,{children:\"Public Cloud Provider\\uB97C \\uC774\\uC6A9\\uD560 \\uB54C, \\uC6B4\\uC601\\uC5D0 \\uB300\\uD55C \\uBD80\\uB2F4\\uC744 \\uC904\\uC77C \\uC218 \\uC788\\uB294 managed service\\uB97C \\uD655\\uC778\\uD558\\uAC8C \\uB41C\\uB2E4. GCP\\uC5D0\\uB294 Secret Manager Service\\uAC00 \\uC788\\uACE0, GKE\\uC5D0\\uC11C add-on\\uC73C\\uB85C \\uAC04\\uB2E8\\uD558\\uAC8C \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB2E4. \\uC544\\uB798\\uCC98\\uB7FC GKE Cluster\\uC5D0\\uC11C Secret Manager\\uB97C Enable\\uD558\\uBA74 Kubernetes Secrets Store CSI Driver\\uCC98\\uB7FC \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(\"img\",{src:\"/static/images/gke-secret-manager-add-on.png\",alt:\"gke add-on option for secret manager\"}),(0,e.jsxs)(n.p,{children:[\"\\uD558\\uC9C0\\uB9CC \",(0,e.jsx)(n.a,{href:\"https://cloud.google.com/secret-manager/docs/secret-manager-managed-csi-component#limitations\",children:\"\\uACF5\\uC2DD \\uBB38\\uC11C\"}),\"\\uC5D0 \\uB098\\uC628 \\uAC83\\uCC98\\uB7FC, \\uBE44\\uBC00\\uAC12\\uC774 \\uBCC0\\uACBD\\uB418\\uC5C8\\uC744 \\uB54C \\uBC18\\uC601\\uD574\\uC8FC\\uB294 Secret auto rotation \\uAE30\\uB2A5\\uACFC Kubernetes Secret Object\\uB97C \\uC0DD\\uC131\\uD558\\uC5EC Sync\\uC744 \\uB9DE\\uCD94\\uB294 \\uAE30\\uB2A5\\uC740 \\uC81C\\uACF5\\uD558\\uC9C0 \\uC54A\\uB294 \\uC81C\\uC57D\\uC0AC\\uD56D\\uC774 \\uC788\\uB2E4. \\uB530\\uB77C\\uC11C \\uC544\\uB798\\uCC98\\uB7FC Secret Object\\uC744 \\uD1B5\\uD574\\uC11C \\uD658\\uACBD\\uBCC0\\uC218\\uB97C Container\\uC5D0 \\uC8FC\\uC785\\uD558\\uB294 \\uACBD\\uC6B0\\uC5D0\\uB294 \\uD574\\uB2F9 Add-on \\uC635\\uC158\\uC744 \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC5C6\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"envFrom\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"secretRef\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`secrets\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"secrets-store-csi-driver-\\uC9C1\\uC811-\\uC124\\uCE58\",children:[(0,e.jsx)(n.a,{href:\"#secrets-store-csi-driver-\\uC9C1\\uC811-\\uC124\\uCE58\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"secrets-store-csi-driver \\uC9C1\\uC811 \\uC124\\uCE58\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://github.com/kubernetes-sigs/secrets-store-csi-driver\",children:\"secrets-store-csi-driver\"}),\"\\uB97C \\uC9C1\\uC811 \\uC124\\uCE58\\uD558\\uC5EC \\uD574\\uB2F9 \\uAE30\\uB2A5\\uB4E4\\uC744 \\uC0AC\\uC6A9\\uD558\\uB294 \\uBC29\\uBC95\\uC774 \\uC788\\uB2E4. \\uC774 \\uAE00\\uC744 \\uC791\\uC131\\uD558\\uB294 \\uC2DC\\uC810\\uC5D0\\uB294 \",(0,e.jsx)(n.code,{children:\"syncSecret\"}),\"\\uACFC \",(0,e.jsx)(n.code,{children:\"enableSecretRotation\"}),\" \\uAE30\\uB2A5\\uC740 Alpha \\uAE30\\uB2A5\\uC73C\\uB85C \\uC81C\\uACF5\\uB418\\uACE0 \\uC788\\uC5B4\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC774 ArgoCD Helm\\uC73C\\uB85C \\uBC30\\uD3EC\\uD560 \\uACBD\\uC6B0\\uC5D0 values\\uC5D0 \\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uC744 \\uD574\\uC918\\uC57C \\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` argoproj.io/v1alpha1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Application\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" secrets\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"store\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"csi\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`driver\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"namespace\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` argocd\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"project\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` default\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"syncPolicy\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"syncOptions\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` CreateNamespace=true\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"destination\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"server\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'https://kubernetes.default.svc'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"namespace\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" kube\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`system\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"source\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"chart\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" secrets\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"store\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"csi\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`driver\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"repoURL\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"//kubernetes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"sigs.github.io/secrets\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"store\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"csi\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`driver/charts\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"targetRevision\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` 1.4.7\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"helm\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"releaseName\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" secrets\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"store\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"csi\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`driver\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"values\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"|\"}),(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`        syncSecret:\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`          enabled: true\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string scalar\",children:\"        enableSecretRotation: true\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"Google Secret Manager\\uB97C Secrets Store CSI driver\\uC5D0\\uC11C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D GCP\\uC6A9 provider\\uB97C \\uC124\\uCE58\\uD55C\\uB2E4. \\uC544\\uC9C1 \\uD574\\uB2F9 Helm Chart\\uB294 public\\uD558\\uAC8C publish\\uD558\\uC9C0 \\uC54A\\uC544\\uC11C \",(0,e.jsx)(n.a,{href:\"https://github.com/GoogleCloudPlatform/secrets-store-csi-driver-provider-gcp\",children:\"secrets-store-csi-driver-provider-gcp\"}),\" Github Repo\\uB97C Clone\\uD558\\uC5EC \\uC544\\uB798\\uC640 \\uAC19\\uC774 Helm\\uC73C\\uB85C \\uC124\\uCE58\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"helm upgrade \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--install secrets-store-csi-driver-provider-gcp \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`charts/secrets-store-csi-driver-provider-gcp\n`})]})}),(0,e.jsxs)(n.h2,{id:\"test\",children:[(0,e.jsx)(n.a,{href:\"#test\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Test\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"gcloud cli\"}),\"\\uB97C \\uD1B5\\uD574\\uC11C \\uC608\\uC81C Secret \\uAC12\\uC744 \\uC0DD\\uC131\\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"echo\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"helloworld\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` secret.data\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gcloud secrets create testsecret \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--replication-policy\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"automatic \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--data-file\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`secret.data\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uADF8\\uB9AC\\uACE0 \\uD574\\uB2F9 Secret\\uC5D0 \\uC811\\uADFC \\uAD8C\\uD55C\\uC744 \\uC900 service account\\uB97C \\uC0DD\\uC131\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`gcloud iam service-accounts create tutorial-workload\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gcloud iam service-accounts add-iam-policy-binding \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--role roles/iam.workloadIdentityUser \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--member \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"serviceAccount:tutorial-prj.svc.id.goog[default/example]\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`tutorial-workload@tutorial-prj.iam.gserviceaccount.com\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gcloud secrets add-iam-policy-binding testsecret \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--member\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"serviceAccount:tutorial-workload@tutorial-prj.iam.gserviceaccount.com \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--role\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`roles/secretmanager.secretAccessor\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"Secrets Store CSI Driver\\uAC00 \\uC124\\uCE58\\uB418\\uC5C8\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \",(0,e.jsx)(n.code,{children:\"SecretProviderClass\"}),\" Ojbect\\uB97C \\uC0DD\\uC131\\uD55C\\uB2E4. \\uADF8\\uB9AC\\uACE0 secrets-store-csi-driver-provider-gcp\\uAC00 \\uC124\\uCE58\\uB418\\uC5C8\\uAE30 \\uB54C\\uBB38\\uC5D0 spec.provider\\uAC00 gcp\\uB85C \\uC124\\uC815\\uD560 \\uC218\\uAC00 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" secrets\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"store.csi.x\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`k8s.io/v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` SecretProviderClass\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`secrets\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"provider\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` gcp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"parameters\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"secrets\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"|\"}),(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`      - resourceName: \"projects/tutorial-prj/secrets/testsecret/versions/latest\"\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string scalar\",children:'        fileName: \"secret.data\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"secretObjects\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"secretName\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`secrets\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"type\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Opaque\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"data\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"objectName\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` secret.data\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` example\n`]})]})}),(0,e.jsx)(n.p,{children:\"Pod\\uC5D0\\uC11C Secret\\uC5D0 \\uC811\\uADFC\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D Kubernetes\\uC5D0 Service Account\\uB97C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC0DD\\uC131\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` ServiceAccount\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` example\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"namespace\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` default\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"annotations\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"iam.gke.io/gcp-service-account\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" tutorial\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"workload@tutorial\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`prj.iam.gserviceaccount.com\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uB9C8\\uC9C0\\uB9C9\\uC73C\\uB85C Secret\\uC744 driver\\uB97C \\uD1B5\\uD574\\uC11C VolumeMount\\uB97C \\uD558\\uACE0, Sync as Kubernetes Secret \\uAE30\\uB2A5\\uC73C\\uB85C \\uC0DD\\uC131\\uB41C Secret Object\\uC73C\\uB85C \\uD658\\uACBD\\uBCC0\\uC218\\uB97C \\uC8FC\\uC785\\uD558\\uB3C4\\uB85D \\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Pod\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` mypod\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"namespace\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` default\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"serviceAccountName\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` example\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"containers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"image\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" gcr.io/google.com/cloudsdktool/cloud\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"sdk\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`slim\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"imagePullPolicy\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` IfNotPresent\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` mypod\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"envFrom\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"secretRef\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`secrets\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"volumeMounts\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"mountPath\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'/var/secrets'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` mysecret\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"readOnly\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"volumes\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` mysecret\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"csi\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"driver\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" secrets\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`store.csi.k8s.io\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"readOnly\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"volumeAttributes\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"secretProviderClass\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'app-secrets'\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uC124\\uC815\\uC774 \\uB418\\uC5C8\\uB2E4\\uBA74 app-secrets Kubernetes Secret Object\\uAC00 \\uC0DD\\uC131\\uB418\\uACE0, Container\\uC5D0 \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uD658\\uACBD\\uBCC0\\uC218\\uB85C \\uC8FC\\uC785\\uB418\\uAC8C \\uB41C\\uB2E4.\"}),(0,e.jsxs)(n.h2,{id:\"\\uD55C\\uACC4\",children:[(0,e.jsx)(n.a,{href:\"#\\uD55C\\uACC4\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uD55C\\uACC4\"]}),(0,e.jsxs)(n.p,{children:[\"\\uC624\\uD508\\uC18C\\uC2A4\\uB85C \\uC9C1\\uC811 \\uC6B4\\uC601\\uD560 \\uC218 \\uC788\\uB294 Hashicorp Vault\\uC640 \\uBE44\\uAD50\\uD560 \\uB54C, GCP Secret Manager\\uB294 Secret \\uD558\\uB098\\uC5D0 \\uBCF5\\uC218\\uC758 key value\\uB85C \\uC800\\uC7A5\\uD560 \\uC218 \\uC5C6\\uB2E4\\uB294 \\uAC83\\uC774 \\uC544\\uC27D\\uB2E4. Vault\\uB97C \\uC0AC\\uC6A9\\uD560 \\uB54C \",(0,e.jsx)(n.a,{href:\"https://developer.hashicorp.com/vault/docs/platform/k8s/vso\",children:\"Vault Secrets Operator\"}),\"\\uB97C \\uD1B5\\uD574\\uC11C Vault\\uC758 Secret\\uC744 Kubernetes\\uC758 Secret Object\\uC640 Sync\\uB97C \\uD560 \\uC218 \\uC788\\uB2E4. \\uC544\\uB798\\uCC98\\uB7FC Vault Secret\\uC740 \\uD558\\uB098\\uC758 Secret\\uC5D0 \\uBCF5\\uC218\\uC758 key value\\uB85C \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uAE30 \\uB54C\\uBB38\\uC5D0, Container\\uC5D0\\uAC8C \\uD544\\uC694\\uD55C \\uBAA8\\uB4E0 \\uBE44\\uBC00\\uAC12\\uC744 \\uD558\\uB098\\uC758 Secret\\uC73C\\uB85C \\uBB36\\uC5B4\\uC11C \\uAD00\\uB9AC\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(\"img\",{src:\"/static/images/gke-vault-create-secret.png\",alt:\"create new secret on vault ui\"}),(0,e.jsx)(n.p,{children:\"GCP Secret Manager\\uC758 Secret\\uC5D0\\uB294 \\uD558\\uB098\\uC758 key value\\uB9CC \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB2E4. \\uBCF5\\uC218\\uC758 key value\\uB85C \\uAD6C\\uC131\\uB41C JSON\\uAC19\\uC740 \\uD30C\\uC77C\\uB85C \\uC800\\uC7A5\\uD574\\uC11C Secret\\uC5D0 \\uC800\\uC7A5\\uD560 \\uC218 \\uC788\\uC9C0\\uB9CC, \\uADF8\\uAC83\\uC744 \\uD558\\uB098\\uC758 Kubernetes Secret\\uC73C\\uB85C Sync\\uD558\\uB294 \\uBC29\\uBC95\\uC774 \\uC81C\\uACF5\\uB418\\uC9C0 \\uC54A\\uB294\\uB2E4.\"}),(0,e.jsx)(\"img\",{src:\"/static/images/gke-google-create-secret.png\",alt:\"create new secret on gcp console\"}),(0,e.jsx)(n.p,{children:\"GCP Secret Manager\\uC5D0\\uC11C \\uD55C\\uC30D\\uC758 Key Value\\uB85C\\uB9CC \\uAD00\\uB9AC\\uD55C\\uB2E4\\uBA74, Label\\uC744 \\uD1B5\\uD574\\uC11C Secret\\uC744 Group\\uC73C\\uB85C \\uBB36\\uB294 \\uBC29\\uBC95\\uC744 \\uACE0\\uB824\\uD560 \\uC218 \\uC788\\uB2E4. \\uADF8\\uB9AC\\uACE0 SecretProviderClass\\uC5D0\\uC11C \\uBCF5\\uC218\\uC758 Secret\\uB4E4\\uC744 \\uD558\\uB098\\uC758 Kubernetes Secret Object\\uB85C \\uBB36\\uC5B4\\uC8FC\\uB294 \\uC791\\uC5C5\\uC744 \\uD574\\uC918\\uC57C \\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" secrets\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"store.csi.x\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`k8s.io/v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` SecretProviderClass\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`secrets\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"provider\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` gcp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"parameters\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"secrets\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"|\"}),(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`      - resourceName: \"projects/tutorial-prj/secrets/soemthing/versions/latest\"\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`        fileName: \"something\"\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`      - resourceName: \"projects/tutorial-prj/secrets/else/versions/latest\"\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string scalar\",children:'        fileName: \"else\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"secretObjects\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"secretName\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`secrets\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"type\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Opaque\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"data\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"objectName\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` something\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` SOMETHING\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"objectName\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` else\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` ELSE\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uB610\\uD55C Secret\\uC758 key\\uC774\\uB984\\uC774 \\uACE0\\uC720\\uD574\\uC57C \\uD558\\uAE30 \\uB54C\\uBB38\\uC5D0, \\uD658\\uACBD\\uBCC4\\uB85C \\uC5B4\\uD50C\\uB9AC\\uCF00\\uC774\\uC158\\uC774 Secret\\uC744 \\uC9C0\\uC815\\uD558\\uB824\\uBA74 \\uBA85\\uBA85 \\uADDC\\uCE59\\uC774 \\uD544\\uC694\\uD558\\uB2E4.\"}),(0,e.jsxs)(n.h2,{id:\"\\uBE44\\uC6A9\",children:[(0,e.jsx)(n.a,{href:\"#\\uBE44\\uC6A9\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uBE44\\uC6A9\"]}),(0,e.jsxs)(n.p,{children:[\"Secret \\uBC84\\uC804\\uB2F9 \",(0,e.jsx)(n.span,{className:\"math math-inline\",children:(0,e.jsxs)(n.span,{className:\"katex\",children:[(0,e.jsx)(n.span,{className:\"katex-mathml\",children:(0,e.jsx)(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,e.jsxs)(n.semantics,{children:[(0,e.jsxs)(n.mrow,{children:[(0,e.jsx)(n.mn,{children:\"0.06\"}),(0,e.jsx)(n.mtext,{children:\"\\uC640\\uC5D1\\uC138\\uC2A4\\uC791\\uC5C5\"}),(0,e.jsx)(n.mn,{children:\"10\"}),(0,e.jsx)(n.mo,{separator:\"true\",children:\",\"}),(0,e.jsx)(n.mn,{children:\"000\"}),(0,e.jsx)(n.mtext,{children:\"\\uBC88\\uB2F9\"})]}),(0,e.jsx)(n.annotation,{encoding:\"application/x-tex\",children:\"0.06\\uC640 \\uC5D1\\uC138\\uC2A4 \\uC791\\uC5C5 10,000\\uBC88\\uB2F9 \"})]})})}),(0,e.jsx)(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,e.jsxs)(n.span,{className:\"base\",children:[(0,e.jsx)(n.span,{className:\"strut\",style:{height:\".8778em\",verticalAlign:\"-.1944em\"}}),(0,e.jsx)(n.span,{className:\"mord\",children:\"0.06\"}),(0,e.jsx)(n.span,{className:\"mord hangul_fallback\",children:\"\\uC640\\uC5D1\\uC138\\uC2A4\\uC791\\uC5C5\"}),(0,e.jsx)(n.span,{className:\"mord\",children:\"10\"}),(0,e.jsx)(n.span,{className:\"mpunct\",children:\",\"}),(0,e.jsx)(n.span,{className:\"mspace\",style:{marginRight:\".1667em\"}}),(0,e.jsx)(n.span,{className:\"mord\",children:\"000\"}),(0,e.jsx)(n.span,{className:\"mord hangul_fallback\",children:\"\\uBC88\\uB2F9\"})]})})]})}),\"0.03\\uC758 \\uBE44\\uC6A9\\uC774 \\uCCAD\\uAD6C\\uB41C\\uB2E4. Secret Auto Rotation\\uC744 \\uC704\\uD574\\uC11C Pub/Sub\\uC73C\\uB85C Topic\\uC744 \\uBC1C\\uD589\\uD558\\uBA74 \\uCD94\\uAC00\\uB85C \\uC54C\\uB9BC\\uB2F9 $0.05\\uC758 \\uBE44\\uC6A9\\uC774 \\uBC1C\\uC0DD\\uD55C\\uB2E4. \\uC774\\uBC88 \\uACC4\\uC0B0\\uC5D0\\uC11C\\uB294 \\uC54C\\uB9BC\\uC5D0 \\uC758\\uD55C \\uBE44\\uC6A9\\uC740 \\uBB34\\uC2DC\\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:\"\\uADF8\\uB7EC\\uBA74 Secret\\uC758 \\uBC84\\uC804\\uC744 \\uCD5C\\uC2E0 \\uD558\\uB098\\uB9CC \\uC720\\uC9C0\\uD55C\\uB2E4\\uACE0 \\uD588\\uC744 \\uB54C, Secret \\uAC2F\\uC218 * $0.06 \\uAE08\\uC561\\uC774 \\uBC1C\\uC0DD\\uD55C\\uB2E4. Secret\\uC774 100\\uAC1C\\uB77C\\uACE0 \\uD558\\uBA74 6\\uB2EC\\uB7EC \\uAE08\\uC561\\uC774 \\uBC1C\\uC0DD\\uD560 \\uC218 \\uC788\\uB2E4. \\uADF8\\uB9AC\\uACE0 \\uC561\\uC0C8\\uC2A4 \\uC791\\uC5C5\\uC740 Secret Auto Rotation \\uAE30\\uB2A5\\uC758 \\uD65C\\uC131\\uD654\\uB85C Polling\\uD558\\uB294 \\uC8FC\\uAE30\\uC5D0 \\uB530\\uB77C\\uC11C \\uC694\\uAE08\\uC774 \\uCE21\\uC815\\uB420 \\uC218 \\uC788\\uB2E4. Secrets Store CSI Driver\\uC5D0\\uC11C \\uD574\\uB2F9 \\uAE30\\uB2A5\\uC758 \\uAE30\\uBCF8 polling \\uC8FC\\uAE30\\uB294 2\\uBD84\\uC73C\\uB85C \\uC124\\uC815\\uB418\\uC5B4 \\uC788\\uAE30 \\uB54C\\uBB38\\uC5D0, \\uD558\\uB098 Secret\\uB2F9 Polling\\uC5D0 \\uB530\\uB77C\\uC11C \\uBC1C\\uC0DD\\uD558\\uB294 \\uAE08\\uC561\\uC740 \\uC6D4 0.12\\uB2EC\\uB7EC \\uC815\\uB3C4\\uAC00 \\uB41C\\uB2E4. \\uC774\\uAC83\\uB3C4 Secret\\uC774 100\\uAC1C\\uB77C\\uACE0 \\uD558\\uBA74 12\\uB2EC\\uB7EC \\uC815\\uB3C4 \\uAE08\\uC561\\uC774 \\uBC1C\\uC0DD\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.p,{children:\"100~200\\uAC1C\\uC758 Secret\\uC744 \\uAD00\\uB9AC\\uD558\\uB294 \\uAC83\\uC740 Vault\\uB97C HA Mode\\uB85C 3\\uAC1C Node\\uB97C CPU resource request 1\\uB85C \\uC6B4\\uC601\\uD558\\uBA74\\uC11C \\uBC1C\\uC0DD\\uD558\\uB294 VM \\uBE44\\uC6A9\\uBCF4\\uB2E4 \\uC0C1\\uB2F9\\uC774 \\uC720\\uB9AC\\uD558\\uB2E4.\"}),(0,e.jsxs)(n.h2,{id:\"\\uACB0\\uB860\",children:[(0,e.jsx)(n.a,{href:\"#\\uACB0\\uB860\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uACB0\\uB860\"]}),(0,e.jsx)(n.p,{children:\"GKE\\uC5D0\\uC11C Secret Manager\\uB97C \\uC0AC\\uC6A9\\uD558\\uC5EC Application\\uC5D0 \\uBE44\\uBC00\\uAC12\\uC744 \\uC8FC\\uC785\\uD55C\\uB2E4\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC740 \\uC6B0\\uC120\\uC21C\\uC704\\uB85C \\uACE0\\uB824\\uD574\\uBCFC \\uC218 \\uC788\\uACA0\\uB2E4.\"}),(0,e.jsxs)(n.ol,{children:[(0,e.jsxs)(n.li,{children:[\"Google Secret Manager API\\uB85C \\uC9C1\\uC811 \\uBE44\\uBC00\\uAC12\\uC744 \\uBC14\\uB85C \\uAC00\\uC838\\uC640\\uC11C \\uC0AC\\uC6A9\",(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:\"\\uBCF4\\uC548\\uC801\\uC73C\\uB85C \\uAC00\\uC7A5 \\uC720\\uB9AC\"}),(0,e.jsx)(n.li,{children:\"Secret Manager\\uC5D0 \\uC7A5\\uC560\\uAC00 \\uC788\\uC744 \\uB54C \\uBC14\\uB85C \\uC601\\uD5A5\\uC744 \\uBC1B\\uC74C. Google Secret Manager\\uB294 99.95% Uptime SLA\\uB97C \\uC81C\\uACF5\\uD558\\uAE30 \\uB54C\\uBB38\\uC5D0, \\uD55C\\uB2EC\\uC5D0 \\uC57D 22\\uBD84 \\uC774\\uC0C1\\uC740 downtime\\uC774 \\uBC1C\\uC0DD\\uD558\\uC9C0 \\uC54A\\uB3C4\\uB85D \\uD558\\uACE0 \\uC788\\uB2E4.\"})]})]}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\".env\"}),\" \\uD30C\\uC77C\\uACFC \\uAC19\\uC774 \\uD30C\\uC77C \\uD615\\uC2DD\\uC73C\\uB85C \\uBD88\\uB7EC\\uC640\\uC11C \\uC0AC\\uC6A9\",(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:\"Secrets Store CSI Driver\\uB85C Volume Mount\\uB41C \\uD30C\\uC77C\\uC744 \\uADF8\\uB300\\uB85C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.li,{children:\"Vault UI\\uB97C \\uD1B5\\uD574\\uC11C Secret\\uC758 key-pair\\uB97C N\\uAC1C \\uAD00\\uB9AC\\uD558\\uB294 \\uAC83\\uACFC \\uBE44\\uAD50\\uD558\\uBA74 \\uBD88\\uD3B8\\uD558\\uB2E4. \\uAD00\\uB9AC\\uD574\\uC57C \\uB418\\uB294 Secret\\uC774 \\uB9CE\\uB2E4\\uBA74, Secrets Store CSI Driver\\uB97C \\uC0AC\\uC6A9\\uD558\\uB354\\uB77C\\uB3C4 Vault provider\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 \\uAC83\\uC774 \\uB354 \\uBC14\\uB78C\\uC9C1\\uD558\\uB2E4\\uACE0 \\uD310\\uB2E8\\uB41C\\uB2E4.\"})]})]}),(0,e.jsxs)(n.li,{children:[\"Kubernetes Secret Object\\uB85C \\uC8FC\\uC785\\uD560 \\uB54C\\uB294 Secret \\uAC2F\\uC218\\uAC00 \\uC801\\uACE0 \\uBCC0\\uACBD\\uC774 \\uC801\\uB2E4\\uBA74 \",(0,e.jsx)(n.a,{href:\"https://external-secrets.io/latest/provider/google-secrets-manager/\",children:\"External Secrets Operator\"}),\"\\uB098 Secrets Store CIS Driver\\uB97C \\uC0AC\\uC6A9\\uD558\\uACE0, Secret \\uAC2F\\uC218\\uAC00 \\uB9CE\\uACE0 \\uBCC0\\uACBD\\uC774 \\uC7A6\\uC73C\\uBA74 Vault\\uB97C \\uC0AC\\uC6A9\",(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:\"Secret \\uAC2F\\uC218\\uAC00 \\uB9CE\\uC544\\uC9C0\\uBA74 Secret Manager\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 \\uBE44\\uC6A9\\uB3C4 \\uC62C\\uB77C\\uAC00\\uACE0, \\uADF8\\uAC83\\uB4E4\\uC744 \\uAD00\\uB9AC\\uD558\\uB294 \\uAC83\\uB3C4 \\uC5B4\\uB824\\uC6CC\\uC9C4\\uB2E4.\"}),(0,e.jsx)(n.li,{children:\"Vault UI Console\\uC5D0\\uC11C Vault Role\\uC744 \\uD1B5\\uD574\\uC11C \\uAC1C\\uBC1C\\uC790\\uC5D0\\uAC8C \\uAD8C\\uD55C\\uC744 \\uC704\\uC784\\uD558\\uB294 \\uAC83\\uC774 \\uD3B8\\uB9AC\\uD558\\uB2E4. \\uBE44\\uBC00\\uAC12\\uC758 \\uBCC0\\uACBD\\uC774 \\uC7A6\\uACE0 \\uAC1C\\uBC1C\\uC790\\uC5D0\\uAC8C \\uAD00\\uB9AC\\uB97C \\uC704\\uC784\\uD574\\uC57C \\uD55C\\uB2E4\\uBA74 Vault\\uAC00 \\uC720\\uB9AC\\uD558\\uB2E4.\"})]})]})]}),(0,e.jsx)(n.p,{children:\"Kubernetes\\uC5D0\\uC11C Application\\uC5D0 \\uD658\\uACBD\\uBCC0\\uC218\\uB85C \\uBE44\\uBC00\\uAC12\\uC744 \\uC8FC\\uC785\\uD574\\uC57C\\uB418\\uB294 \\uC81C\\uC57D\\uC0AC\\uD56D\\uC774 \\uC788\\uB2E4\\uB77C\\uACE0 \\uD558\\uBA74, Application\\uC774 \\uC5EC\\uB7EC \\uAC1C\\uAC00 \\uC874\\uC7AC\\uD558\\uACE0 \\uB2E4\\uC591\\uD55C \\uBE44\\uBC00\\uAC12\\uC774 \\uAD00\\uB9AC\\uB41C\\uB2E4\\uACE0 \\uD558\\uBA74 Vault\\uB97C \\uC9C1\\uC811 \\uC6B4\\uC601\\uD558\\uC5EC \\uC0AC\\uC6A9\\uD558\\uB294 \\uAC83\\uC774 \\uBC14\\uB78C\\uC9C1\\uD558\\uB2E4\\uACE0 \\uD310\\uB2E8\\uB41C\\uB2E4. \\uC544\\uC8FC \\uAC04\\uB2E8\\uD558\\uAC8C\\uB9CC \\uC0AC\\uC6A9\\uB420 \\uB54C\\uB9CC Secrets Store CSI driver\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 \\uAC83\\uC774 \\uC88B\\uACA0\\uB2E4.\"})]})}}var v=S;return b;})();\n;return Component;","toc":[{"value":"GKE Add-on","url":"#gke-add-on","depth":2},{"value":"secrets-store-csi-driver 직접 설치","url":"#secrets-store-csi-driver-직접-설치","depth":2},{"value":"Test","url":"#test","depth":2},{"value":"한계","url":"#한계","depth":2},{"value":"비용","url":"#비용","depth":2},{"value":"결론","url":"#결론","depth":2}],"frontMatter":{"readingTime":{"text":"8 min read","minutes":7.07,"time":424200,"words":1414},"slug":"20250105-secrets-store-csi-driver-provider-gcp","fileName":"20250105-secrets-store-csi-driver-provider-gcp.md","title":"secrets-store-csi-driver-provider-gcp 사용해보기","date":"2025-01-05T00:00:00.000Z","tags":["gcp","kubernetes"],"images":["/static/images/social-banner.png"],"summary":"GKE에서 add-on 기능으로 관리형 서비스인 Google Secret Manager을 Kubernetes Secrets Store CSI Driver로 쉽게 사용할 수 있다. 하지만 add-on 버전에서는 Sync as Kubernetes Secret 기능을 제공하지 않기 때문에, Kubernetes Secret을 환경변수로 설정하는데 제약사항이 있다. 직접 Kubernetes Secrets Store CSI driver와 GCP provider driver를 설치하여 Sync as Kubernetes Secret 기능을 사용할 수 있다. 이렇게 Sync된 Kubernetes Secret을 환경변수로 주입하도록 설정할 수 있다. Google Secret Manager는 아쉽게도 하나의 Secret에 복수의 key value를 제공하지 않는다. 이번 글에서는 Google Secret Manager를 Kubernetes Secret Object와 Sync해서 사용하는 것이 바람직할지 고민해본다."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.15,"time":9000,"words":30},"slug":["default"],"fileName":"default.md","name":"Jay","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"Thanos Receiver의 empty attribute value 문제","date":"2024-10-26T00:00:00.000Z","tags":["Thanos","opentelemetry"],"images":["/static/images/social-banner.png"],"summary":"Opentelemetry Instrumentation 라이브러리 중에서 Str(), Empty()로 attribute value를 설정하여 Metric을 보내는 경우가 있었다. 문제는 Thanos Receiver를 통해서 Metric을 저장하려고 할 때, Attribute value 값이 빈문자열이면 에러가 발생하였다. Otel 1.38.0 규격 문서를 확인했을 때 Attribute value는 빈문자열도 의미를 가질 수 있고 정상적으로 저장되어야 하는 것으로 정의되어 있었다. 따라서 Attribute value가 빈문자열이 때도 정상적으로 저장될 수 있도록 Thanos 소스코드를 수정하여 Container Image 빌드하여 사용하였다.","slug":"20241026-thanos-prometheus-remote-write"},"next":{"title":"GCP Secret Manager에서 비밀값을 OpenTofu로 관리하기","date":"2025-01-05T00:00:00.000Z","tags":["gcp","terraform","opentofu"],"images":["/static/images/social-banner.png"],"summary":"GCP Secret Manager를 IaS로 관리할 때, 저장하는 Secret 값을 Key Management Service의 비대칭키와 Terraform의 google_kms_secret_asymmetric data source로 관리할 수 있다. 공개키로 암호화한 비밀 값을 Terraform resource definition에 정의하고, 런타임 과정에서 복호화하여 Secret Manager의 비밀값으로 설정할 수 있다. 따라서 Git에 평서문 대신에 공개키로 암호화한 비밀 값으로 정의한 Terraform 파일을 저장하여 관리할 수 있다. 하지만 해당 비밀 값은 State output 같은 곳에 평서문으로 그대로 노출 될 수 있기 때문에, remote state로 관리할 때는 해당 state 파일이 노출되지 않도록 관리를 잘해야 한다. OpenTofu를 이용할 때는 State 파일을 암호화 하는 옵션을 사용하여 State 파일 자체를 암호화해서 관리할 수도 있다.","slug":"20250105-opentofu"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["20250105-secrets-store-csi-driver-provider-gcp"]},"buildId":"oxVbhW_Td-KP5uFz7GpY-","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>