<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="manifest" href="/jayground8/static/favicons/manifest.json"/><link rel="manifest" href="/jayground8/static/favicons/site.webmanifest"/><link rel="shortcut icon" href="/jayground8/static/favicons/favicon.ico"/><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8773084925406986" crossorigin="anonymous"></script><title>Thanos Receiver의 empty attribute value 문제</title><meta name="robots" content="follow, index"/><meta name="description" content="Opentelemetry Instrumentation 라이브러리 중에서 Str(), Empty()로 attribute value를 설정하여 Metric을 보내는 경우가 있었다. 문제는 Thanos Receiver를 통해서 Metric을 저장하려고 할 때, Attribute value 값이 빈문자열이면 에러가 발생하였다. Otel 1.38.0 규격 문서를 확인했을 때 Attribute value는 빈문자열도 의미를 가질 수 있고 정상적으로 저장되어야 하는 것으로 정의되어 있었다. 따라서 Attribute value가 빈문자열이 때도 정상적으로 저장될 수 있도록 Thanos 소스코드를 수정하여 Container Image 빌드하여 사용하였다."/><meta property="og:url" content="https://jayground8.github.io/blog/20241026-thanos-prometheus-remote-write"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Jayground8"/><meta property="og:description" content="Opentelemetry Instrumentation 라이브러리 중에서 Str(), Empty()로 attribute value를 설정하여 Metric을 보내는 경우가 있었다. 문제는 Thanos Receiver를 통해서 Metric을 저장하려고 할 때, Attribute value 값이 빈문자열이면 에러가 발생하였다. Otel 1.38.0 규격 문서를 확인했을 때 Attribute value는 빈문자열도 의미를 가질 수 있고 정상적으로 저장되어야 하는 것으로 정의되어 있었다. 따라서 Attribute value가 빈문자열이 때도 정상적으로 저장될 수 있도록 Thanos 소스코드를 수정하여 Container Image 빌드하여 사용하였다."/><meta property="og:title" content="Thanos Receiver의 empty attribute value 문제"/><meta property="og:image" content="https://jayground8.github.io/static/images/social-banner.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site"/><meta name="twitter:title" content="Thanos Receiver의 empty attribute value 문제"/><meta name="twitter:description" content="Opentelemetry Instrumentation 라이브러리 중에서 Str(), Empty()로 attribute value를 설정하여 Metric을 보내는 경우가 있었다. 문제는 Thanos Receiver를 통해서 Metric을 저장하려고 할 때, Attribute value 값이 빈문자열이면 에러가 발생하였다. Otel 1.38.0 규격 문서를 확인했을 때 Attribute value는 빈문자열도 의미를 가질 수 있고 정상적으로 저장되어야 하는 것으로 정의되어 있었다. 따라서 Attribute value가 빈문자열이 때도 정상적으로 저장될 수 있도록 Thanos 소스코드를 수정하여 Container Image 빌드하여 사용하였다."/><meta name="twitter:image" content="https://jayground8.github.io/static/images/social-banner.png"/><link rel="canonical" href="https://jayground8.github.io/blog/20241026-thanos-prometheus-remote-write"/><meta property="article:published_time" content="2024-10-26T00:00:00.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jayground8.github.io/blog/20241026-thanos-prometheus-remote-write"
  },
  "headline": "Thanos Receiver의 empty attribute value 문제",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://jayground8.github.io/static/images/social-banner.png"
    }
  ],
  "datePublished": "2024-10-26T00:00:00.000Z",
  "dateModified": "2024-10-26T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jay"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Jay",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jayground8.github.ioplayground.png"
    }
  },
  "description": "Opentelemetry Instrumentation 라이브러리 중에서 Str(), Empty()로 attribute value를 설정하여 Metric을 보내는 경우가 있었다. 문제는 Thanos Receiver를 통해서 Metric을 저장하려고 할 때, Attribute value 값이 빈문자열이면 에러가 발생하였다. Otel 1.38.0 규격 문서를 확인했을 때 Attribute value는 빈문자열도 의미를 가질 수 있고 정상적으로 저장되어야 하는 것으로 정의되어 있었다. 따라서 Attribute value가 빈문자열이 때도 정상적으로 저장될 수 있도록 Thanos 소스코드를 수정하여 Container Image 빌드하여 사용하였다."
}</script><meta name="next-head-count" content="24"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preload" href="/_next/static/css/414f98a58444a4f1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/414f98a58444a4f1.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-690364db8bfb1f01.js" defer=""></script><script src="/_next/static/chunks/main-eea1c213342d95c3.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ea6d3fdbf67a6641.js" defer=""></script><script src="/_next/static/chunks/675-70b09cbf0a5309ea.js" defer=""></script><script src="/_next/static/chunks/410-35c4fb535edd9439.js" defer=""></script><script src="/_next/static/chunks/712-376d32740a4ac813.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-8ab66ff6ebabec4c.js" defer=""></script><script src="/_next/static/WTiGgcjIxdebIMrH_uVPJ/_buildManifest.js" defer=""></script><script src="/_next/static/WTiGgcjIxdebIMrH_uVPJ/_ssgManifest.js" defer=""></script><script src="/_next/static/WTiGgcjIxdebIMrH_uVPJ/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="Jayground8" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" width="53.87" height="43.61" viewBox="0 0 512 512" class="fill-black dark:fill-white"><path d="M368.4 17c-8.8 1.3-18.3 5-25.3 9.9-3.8 2.5-22.6 16.1-41.9 30.1-37.1 26.9-38.6 28.3-36.3 33.9 1.7 4 4.9 5.1 14.6 5.1h8.5v128h-17.9c-18.2 0-22.2.6-27.3 4.2l-2.8 1.9V116.9l2.5-2.4c1.5-1.6 3.6-2.5 5.5-2.5s4 .9 5.5 2.5l2.5 2.4v42c0 29.1.3 42.8 1.1 44.5 2.6 5.7 11.5 5.5 13.9-.3.7-1.9 1-15.6.8-46.2-.3-40.1-.4-43.7-2.2-46.9-4.8-9-11.9-13.4-21.6-13.4-13.8 0-22.8 9.1-23.8 24.1l-.5 7.3h-31.5l-1.2-2.9c-1.6-3.9-6-5.8-9.9-4.1-1.6.6-3.5 2.5-4.1 4.1l-1.2 2.9h-63.6l-1.2-2.9c-2.5-6.2-11.5-6.2-14 0l-1.2 2.9H64.3l-.5-7.3c-1-15-10-24.1-23.8-24.1-9.7 0-16.8 4.4-21.6 13.4-1.8 3.3-1.9 7.5-2.2 75-.2 50 .1 72.3.8 74.1 2.1 5.1 8.6 6.3 12.5 2.4l2.5-2.4V116.9l2.5-2.4c3.2-3.3 7.8-3.3 11 0l2.5 2.4V448H32V284.9l-2.5-2.4c-3.8-3.9-10.2-2.7-12.4 2.2-1.6 3.4-1.6 171.2 0 174.6.6 1.4 2.2 3 3.6 3.6 1.6.7 15.6 1.1 43.7 1.1 38 0 41.5-.1 43.4-1.8 1.2-.9 33.4-50.5 71.7-110.2 38.3-59.7 70.5-109.3 71.7-110.3 1.8-1.5 4.3-1.7 19.4-1.7H288v16h-12.5c-13.1 0-16.6.8-18.3 4.4-2 4.5-138.5 216.2-140.4 217.9-1.9 1.6-5.6 1.7-47.9 1.7-31.9 0-46.6.3-48.3 1.1-5.7 2.6-5.5 11.5.3 13.9 1.9.7 16.7 1 50.1.8 46.4-.3 47.6-.3 51.5-2.5 2.2-1.1 5.1-3.3 6.5-4.7 1.3-1.5 10.1-14.7 19.6-29.4l17.1-26.7 18.4-.5c10.1-.3 19.1-.9 20-1.3.9-.5 2.1-1.9 2.8-3.3 1.5-3.4 1.5-35.4 0-38.8-1.1-2.3-4-4-8-4.8-1.3-.2 1.5-5.2 11.5-20.7l13.1-20.5.5 56.5c.3 31 .9 57.1 1.3 58 1.5 3 5.6 3.9 18.2 3.9H256v14c0 14.9.7 18.1 4.7 19.9 1.7.8 34.7 1.1 115.3 1.1s113.6-.3 115.3-1.1c1.4-.6 3-2.2 3.6-3.6 1.5-3.4 1.5-83.2 0-86.6-2.2-4.9-8.6-6.1-12.4-2.2l-2.5 2.4V480H272V272h208v107.1l2.5 2.4c3.8 3.9 10.2 2.7 12.4-2.2 1.5-3.4 1.5-115.2 0-118.6-1.8-3.9-5-4.7-18.4-4.7H464v-40.5c0-27.9-.3-41.2-1.1-42.9-2.6-5.5-11.2-5.5-13.8 0-.8 1.7-1.1 15-1.1 42.9V256h-24v-34.5c0-21.3-.4-36.4-1.1-39.7-3.6-17.3-19.3-32.9-36.7-36.7-16.2-3.4-31.4 1.1-43.3 12.9-7.4 7.3-11.2 13.9-13.4 23.2-1.8 7.9-2.1 50.3-.4 54.2 1.6 3.5 6.1 5.2 9.8 3.7 4.7-2 5.1-4.2 5.1-29.6 0-21.5.2-23.9 2.2-29.2C350.6 168.4 363 160 376 160s25.4 8.4 29.8 20.3c2.1 5.5 2.2 7.4 2.2 40.7v35H304V96h144v24.5c0 16 .4 25.3 1.1 26.9 2.6 5.5 11.2 5.5 13.8 0 .7-1.6 1.1-10.9 1.1-26.9V96h8.5c9.7 0 12.9-1.1 14.6-5.1 2.1-5.2.1-7.5-17.7-20.4C446.2 53.8 445 53 442.1 53c-4.1.1-7.5 3.5-7.5 7.7 0 4 2.2 6.3 14.8 15.3l4.8 3.5-39.1.3c-21.5.1-56.7.1-78.2 0l-39.1-.3 14.9-10.7c8.2-5.9 20.7-15.1 27.8-20.4 14.5-10.8 20.5-14 29.4-15.5 11.6-2.1 22.4 1.3 36.5 11.4 4.3 3.1 9 5.7 10.3 5.7 3.9 0 7.5-4.4 7.1-8.7-.3-3.3-1.1-4.4-7.8-9.6-15.3-11.8-32.3-17.1-47.6-14.7zM96 152v8H64v-16h32v8zm80 0v8h-64v-16h64v8zm48 0v8h-32v-16h32v8zM96 280v104h-4.5c-5.5 0-9 1.5-10.4 4.7-1.5 3.3-1.5 35.4 0 38.7 1.7 3.6 3.1 4 16.2 4.6l11.9.5-5.1 7.7L99 448H64V176h32v104zm80-27.8v76.3l-17.8 27.7-17.7 27.7-14.2.1H112V176h64v76.2zm48-37.3v38.9l-15.6 24.4c-8.6 13.3-15.8 24.5-16 24.7-.2.2-.4-28.2-.4-63.2V176h32v38.9zM256 369v76h-16V317.1l7.8-12c4.2-6.7 7.8-12.1 8-12.1.1 0 .2 34.2.2 76zm-129.1 34.7c-1.2 2.1-3.6 5.7-5.1 8l-2.9 4.3H96v-16h33.2l-2.3 3.7zM192 408v8h-15.1l3.7-5.8c2-3.1 4.4-6.7 5.2-8 .8-1.2 2.4-2.2 3.8-2.2 2.3 0 2.4.2 2.4 8z"></path><path d="M322.5 114.5c-1.6 1.5-2.5 3.6-2.5 5.5s.9 4 2.5 5.5c1.5 1.6 3.6 2.5 5.5 2.5s4-.9 5.5-2.5c1.6-1.5 2.5-3.6 2.5-5.5s-.9-4-2.5-5.5c-1.5-1.6-3.6-2.5-5.5-2.5s-4 .9-5.5 2.5zM418.5 114.5c-1.6 1.5-2.5 3.6-2.5 5.5s.9 4 2.5 5.5c1.5 1.6 3.6 2.5 5.5 2.5s4-.9 5.5-2.5c1.6-1.5 2.5-3.6 2.5-5.5s-.9-4-2.5-5.5c-1.5-1.6-3.6-2.5-5.5-2.5s-4 .9-5.5 2.5zM290.2 290.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6zM450.5 290.5c-5 4.9-1.5 13.5 5.5 13.5 4.1 0 8-3.9 8-8s-3.9-8-8-8c-1.9 0-4 .9-5.5 2.5zM358.1 322c-8.3 2.2-16.5 5.7-19.8 8.6-3.3 2.8-3.9 7.3-1.4 10.6 3.3 4.1 6.4 4.3 13.8.8 23.3-10.9 47.3-7 64.8 10.5 11.5 11.4 16.5 23.6 16.5 39.7 0 15.9-5.1 28.1-16.4 39.4C404.2 443 392.1 448 376 448s-28.1-5-39.5-16.5c-11-11.1-16.5-24.2-16.5-39.5.1-9.5 1.2-14.5 5.6-24.3 3.8-8.3 3.8-10.4.1-14.5-4.7-5.1-10.8-1.7-15.4 8.6-8.6 19.5-8.4 42.7.6 61.7 9.1 19.3 28.3 34.5 49.5 39 11.9 2.6 28.4 1.7 39.3-2.2 23.9-8.6 41.3-27.9 46.9-51.9 1.9-8.5 1.9-24.4-.1-33.1-5.9-25.5-26.7-46.6-52.5-53.3-10.1-2.6-25.8-2.6-35.9 0zM290.2 450.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6zM450.2 450.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6z"></path></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">Jayground8</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">Blog</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-0 left-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><div class="flex justify-end"><button type="button" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2024-10-26T00:00:00.000Z">Saturday, October 26, 2024</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Thanos Receiver의 empty attribute value 문제</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2738%27%20height=%2738%27/%3e"/></span><img alt="avatar" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="h-10 w-10 rounded-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="avatar" srcSet="https://jayground8.github.io/static/images/profile.png?w=48&amp;q=75 1x, https://jayground8.github.io/static/images/profile.png?w=96&amp;q=75 2x" src="https://jayground8.github.io/static/images/profile.png?w=96&amp;q=75" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="h-10 w-10 rounded-full" loading="lazy"/></noscript></span><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Jay</dd><dt class="sr-only">Twitter</dt><dd></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><h2 id="attribute-value가-str와-empty"><a href="#attribute-value가-str와-empty" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Attribute Value가 Str()와 Empty()</h2><p><a target="_blank" rel="noopener noreferrer" href="https://github.com/jayground8/example-opentelemetry-monitoring/tree/main/attribute_example">예제 파일을 참고하여 Nodejs Application과 Python Application에서 Attribute value를 빈문자열이나 null/None 같은 값으로 설정하고, Opentelemetry Debug Exporter를 통해서 Metric을 확인해본다.</a></p><h3 id="nodejs"><a href="#nodejs" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Nodejs</h3><p>Nodejs Application에서 <code>Counter</code> 타입의 metric을 추가하고, 아래처럼 attribute value를 빈문자열로 정의한다.</p><div class="relative"><pre><code class="code-highlight language-js"><span class="code-line">counter1<span class="token punctuation">.</span><span class="token function method property-access">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> hello<span class="token operator">:</span> <span class="token string">&#x27;&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></code></pre></div><p>그러면 debug exporter를 통해서 아래와 같이 <code>Str()</code>으로 남는 것을 확인할 수 있다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">ScopeMetrics <span class="token comment">#1</span>
</span><span class="code-line">ScopeMetrics SchemaURL:
</span><span class="code-line">InstrumentationScope default
</span><span class="code-line">Metric <span class="token comment">#0</span>
</span><span class="code-line">Descriptor:
</span><span class="code-line">     -<span class="token operator">&gt;</span> Name: empty
</span><span class="code-line">     -<span class="token operator">&gt;</span> Description:
</span><span class="code-line">     -<span class="token operator">&gt;</span> Unit:
</span><span class="code-line">     -<span class="token operator">&gt;</span> DataType: Sum
</span><span class="code-line">     -<span class="token operator">&gt;</span> IsMonotonic: <span class="token boolean">true</span>
</span><span class="code-line">     -<span class="token operator">&gt;</span> AggregationTemporality: Cumulative
</span><span class="code-line">NumberDataPoints <span class="token comment">#0</span>
</span><span class="code-line">Data point attributes:
</span><span class="code-line">     -<span class="token operator">&gt;</span> hello: Str<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">StartTimestamp: <span class="token number">2024</span>-10-26 00:05:49.732 +0000 UTC
</span><span class="code-line">Timestamp: <span class="token number">2024</span>-10-26 00:06:46.47 +0000 UTC
</span><span class="code-line">Value: <span class="token number">1.000000</span>
</span></code></pre></div><p>그리고 <code>Counter</code> 타입의 metric을 하나 더 추가하고, 아래처럼 attribute value를 <code>null</code>로 정의한다.</p><div class="relative"><pre><code class="code-highlight language-js"><span class="code-line">counter2<span class="token punctuation">.</span><span class="token function method property-access">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> hello<span class="token operator">:</span> <span class="token keyword nil null">null</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></code></pre></div><p>그러면 이번에는 debug exporter로 아래와 같이 <code>Empty()</code>로 남는 것을 확인할 수 있다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">Metric <span class="token comment">#1</span>
</span><span class="code-line">Descriptor:
</span><span class="code-line">     -<span class="token operator">&gt;</span> Name: null
</span><span class="code-line">     -<span class="token operator">&gt;</span> Description:
</span><span class="code-line">     -<span class="token operator">&gt;</span> Unit:
</span><span class="code-line">     -<span class="token operator">&gt;</span> DataType: Sum
</span><span class="code-line">     -<span class="token operator">&gt;</span> IsMonotonic: <span class="token boolean">true</span>
</span><span class="code-line">     -<span class="token operator">&gt;</span> AggregationTemporality: Cumulative
</span><span class="code-line">NumberDataPoints <span class="token comment">#0</span>
</span><span class="code-line">Data point attributes:
</span><span class="code-line">     -<span class="token operator">&gt;</span> hello: Empty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">StartTimestamp: <span class="token number">2024</span>-10-26 00:05:49.732 +0000 UTC
</span><span class="code-line">Timestamp: <span class="token number">2024</span>-10-26 00:06:46.47 +0000 UTC
</span><span class="code-line">Value: <span class="token number">1.000000</span>
</span></code></pre></div><h3 id="python"><a href="#python" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Python</h3><p>Python Application은 아래와 같이 <code>빈문자열</code>을 넣었을 때는</p><div class="relative"><pre><code class="code-highlight language-python"><span class="code-line">counter1<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></code></pre></div><p>아래처럼 <code>Str()</code>이 찍히는 것을 확인할 수 있다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">ScopeMetrics <span class="token comment">#1</span>
</span><span class="code-line">ScopeMetrics SchemaURL:
</span><span class="code-line">InstrumentationScope <span class="token builtin class-name">test</span>
</span><span class="code-line">Metric <span class="token comment">#0</span>
</span><span class="code-line">Descriptor:
</span><span class="code-line">     -<span class="token operator">&gt;</span> Name: empty
</span><span class="code-line">     -<span class="token operator">&gt;</span> Description:
</span><span class="code-line">     -<span class="token operator">&gt;</span> Unit:
</span><span class="code-line">     -<span class="token operator">&gt;</span> DataType: Sum
</span><span class="code-line">     -<span class="token operator">&gt;</span> IsMonotonic: <span class="token boolean">true</span>
</span><span class="code-line">     -<span class="token operator">&gt;</span> AggregationTemporality: Cumulative
</span><span class="code-line">NumberDataPoints <span class="token comment">#0</span>
</span><span class="code-line">Data point attributes:
</span><span class="code-line">     -<span class="token operator">&gt;</span> test: Str<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">StartTimestamp: <span class="token number">2024</span>-10-26 00:08:02.064389211 +0000 UTC
</span><span class="code-line">Timestamp: <span class="token number">2024</span>-10-26 00:08:25.521302833 +0000 UTC
</span></code></pre></div><p>하지만 Nodejs와 다르게 아래와 같이 <code>None</code>을 설정하였을 때는</p><div class="relative"><pre><code class="code-highlight language-python"><span class="code-line">counter2<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></code></pre></div><p>Python Opentelemetry 패키지에서 아래와 같이 에러가 발생한다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">Failed to encode key test: Invalid <span class="token builtin class-name">type</span> <span class="token operator">&lt;</span>class <span class="token string">&#x27;NoneType&#x27;</span><span class="token operator">&gt;</span> of value None
</span><span class="code-line">Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span>:
</span><span class="code-line">  File <span class="token string">&quot;/venv/lib/python3.11/site-packages/opentelemetry/exporter/otlp/proto/common/_internal/__init__.py&quot;</span>, line <span class="token number">113</span>, <span class="token keyword">in</span> _encode_attributes
</span><span class="code-line">    pb2_attributes.append<span class="token punctuation">(</span>_encode_key_value<span class="token punctuation">(</span>key, value<span class="token punctuation">))</span>
</span><span class="code-line">                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
</span><span class="code-line">  File <span class="token string">&quot;/venv/lib/python3.11/site-packages/opentelemetry/exporter/otlp/proto/common/_internal/__init__.py&quot;</span>, line <span class="token number">94</span>, <span class="token keyword">in</span> _encode_key_value
</span><span class="code-line">    <span class="token builtin class-name">return</span> PB2KeyValue<span class="token punctuation">(</span>key<span class="token operator">=</span>key, <span class="token assign-left variable">value</span><span class="token operator">=</span>_encode_value<span class="token punctuation">(</span>value<span class="token punctuation">))</span>
</span><span class="code-line">                                      ^^^^^^^^^^^^^^^^^^^^
</span><span class="code-line">  File <span class="token string">&quot;/venv/lib/python3.11/site-packages/opentelemetry/exporter/otlp/proto/common/_internal/__init__.py&quot;</span>, line <span class="token number">90</span>, <span class="token keyword">in</span> _encode_value
</span><span class="code-line">    raise Exception<span class="token punctuation">(</span>f<span class="token string">&quot;Invalid type {type(value)} of value {value}&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">Exception: Invalid <span class="token builtin class-name">type</span> <span class="token operator">&lt;</span>class <span class="token string">&#x27;NoneType&#x27;</span><span class="token operator">&gt;</span> of value None
</span></code></pre></div><p>그리고 최종적으로 Opentelemetry Collector에는 Attribute가 없는 상태로 Metric이 전달된다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">Metric <span class="token comment">#1</span>
</span><span class="code-line">Descriptor:
</span><span class="code-line">     -<span class="token operator">&gt;</span> Name: none
</span><span class="code-line">     -<span class="token operator">&gt;</span> Description:
</span><span class="code-line">     -<span class="token operator">&gt;</span> Unit:
</span><span class="code-line">     -<span class="token operator">&gt;</span> DataType: Sum
</span><span class="code-line">     -<span class="token operator">&gt;</span> IsMonotonic: <span class="token boolean">true</span>
</span><span class="code-line">     -<span class="token operator">&gt;</span> AggregationTemporality: Cumulative
</span><span class="code-line">NumberDataPoints <span class="token comment">#0</span>
</span><span class="code-line">StartTimestamp: <span class="token number">2024</span>-10-26 00:08:02.064398086 +0000 UTC
</span><span class="code-line">Timestamp: <span class="token number">2024</span>-10-26 00:08:25.521302833 +0000 UTC
</span><span class="code-line">Value: <span class="token number">1</span>
</span></code></pre></div><h2 id="thanos-receiver-error"><a href="#thanos-receiver-error" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Thanos Receiver Error</h2><p>위에서 살펴본 것처럼 Attribute Value과 <code>Str()</code>나 <code>Empty()</code> 설정되어서 Metric이 전달될 수 있다. 실제로 운영하면서 Nodejs에서는 <a target="_blank" rel="noopener noreferrer" href="https://www.npmjs.com/package/@opentelemetry/instrumentation-http">instrumentation-http</a>에서 <code>net.host.port</code> Attribute value를 <code>Empty()</code>로 보내는 경우가 발생하였다. instrumentation-http가 Socket object를 통해서 host port를 가져오고, 그 값을 metric의 <code>net.host.port</code> attribute 값으로 설정하게 된다. 그런데 어떤 이유에서 이 값이 <code>undefined</code>이 되면서 최종적으로 <code>Empty()</code>로 설정되는 것으로 파악된다. 그리고 .Net instrumentation 중에서도 <code>Str()</code>를 설정하는 경우가 있었다.</p><p>문제는 Thanos Receiver를 통해서 Metric을 저장하려고 할 때, Thanos Receiver가 이러한 empty attribute value가 있을 때 아래처럼 에러를 발생한다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line"><span class="token number">2024</span>-10-26T00:08:25.744Z	error	internal/queue_sender.go:92	Exporting failed. Dropping data.	<span class="token punctuation">{</span><span class="token string">&quot;kind&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;exporter&quot;</span>, <span class="token string">&quot;data_type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;metrics&quot;</span>, <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;prometheusremotewrite&quot;</span>, <span class="token string">&quot;error&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Permanent error: Permanent error: Permanent error: remote write returned HTTP status 409 Conflict; err = %!w(&lt;nil&gt;): add 1 series: label set contains a label with empty name or value<span class="token entity" title="\n">\n</span>&quot;</span>, <span class="token string">&quot;dropped_items&quot;</span><span class="token builtin class-name">:</span> <span class="token number">5</span><span class="token punctuation">}</span>
</span><span class="code-line">go.opentelemetry.io/collector/exporter/exporterhelper/internal.NewQueueSender.func1
</span><span class="code-line">	go.opentelemetry.io/collector/exporter@v0.111.0/exporterhelper/internal/queue_sender.go:92
</span><span class="code-line">go.opentelemetry.io/collector/exporter/internal/queue.<span class="token punctuation">(</span>*boundedMemoryQueue<span class="token punctuation">[</span><span class="token punctuation">..</span>.<span class="token punctuation">]</span><span class="token punctuation">)</span>.Consume
</span><span class="code-line">	go.opentelemetry.io/collector/exporter@v0.111.0/internal/queue/bounded_memory_queue.go:52
</span><span class="code-line">go.opentelemetry.io/collector/exporter/internal/queue.<span class="token punctuation">(</span>*Consumers<span class="token punctuation">[</span><span class="token punctuation">..</span>.<span class="token punctuation">]</span><span class="token punctuation">)</span>.Start.func1
</span><span class="code-line">	go.opentelemetry.io/collector/exporter@v0.111.0/internal/queue/consumers.go:43
</span></code></pre></div><p>테스트를 할 시점의 Thanos Version은 0.36.1이였고, <a target="_blank" rel="noopener noreferrer" href="https://github.com/thanos-io/thanos/blob/v0.36.1/pkg/receive/writer.go">Thanos Receiver Code</a>를 보면 아래와 같다.</p><div class="relative"><pre><code class="code-highlight language-go"><span class="code-line"><span class="token keyword">if</span> numLabelsEmpty <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
</span><span class="code-line">    level<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span>tLogger<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Error on series with empty label name or value&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;numDropped&quot;</span><span class="token punctuation">,</span> numLabelsEmpty<span class="token punctuation">)</span>
</span><span class="code-line">    errs<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>errors<span class="token punctuation">.</span><span class="token function">Wrapf</span><span class="token punctuation">(</span>labelpb<span class="token punctuation">.</span>ErrEmptyLabels<span class="token punctuation">,</span> <span class="token string">&quot;add %d series&quot;</span><span class="token punctuation">,</span> numLabelsEmpty<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p><code>numLabelsEmpty</code>는 <a target="_blank" rel="noopener noreferrer" href="https://github.com/thanos-io/thanos/blob/v0.36.1/pkg/store/labelpb/label.go">label.go</a>에서 아래와 같이 ValidateLabels 함수로 결정된다.</p><div class="relative"><pre><code class="code-highlight language-go"><span class="code-line"><span class="token keyword">func</span> <span class="token function">ValidateLabels</span><span class="token punctuation">(</span>lbls <span class="token punctuation">[</span><span class="token punctuation">]</span>ZLabel<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>lbls<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> ErrEmptyLabels
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">// Check first label.</span>
</span><span class="code-line">	l0 <span class="token operator">:=</span> lbls<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</span><span class="code-line">	<span class="token keyword">if</span> l0<span class="token punctuation">.</span>Name <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token operator">||</span> l0<span class="token punctuation">.</span>Value <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> ErrEmptyLabels
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">// Iterate over the rest, check each for empty / duplicates and</span>
</span><span class="code-line">	<span class="token comment">// check lexicographical (alphabetically) ordering.</span>
</span><span class="code-line">	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> l <span class="token operator">:=</span> <span class="token keyword">range</span> lbls<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">if</span> l<span class="token punctuation">.</span>Name <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token operator">||</span> l<span class="token punctuation">.</span>Value <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-line">			<span class="token keyword">return</span> ErrEmptyLabels
</span><span class="code-line">		<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">		<span class="token keyword">if</span> l<span class="token punctuation">.</span>Name <span class="token operator">==</span> l0<span class="token punctuation">.</span>Name <span class="token punctuation">{</span>
</span><span class="code-line">			<span class="token keyword">return</span> ErrDuplicateLabels
</span><span class="code-line">		<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">		<span class="token keyword">if</span> l<span class="token punctuation">.</span>Name <span class="token operator">&lt;</span> l0<span class="token punctuation">.</span>Name <span class="token punctuation">{</span>
</span><span class="code-line">			<span class="token keyword">return</span> ErrOutOfOrderLabels
</span><span class="code-line">		<span class="token punctuation">}</span>
</span><span class="code-line">		l0 <span class="token operator">=</span> l
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h2 id="str로-보내는-것이-문제인가"><a href="#str로-보내는-것이-문제인가" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Str()로 보내는 것이 문제인가?</h2><p><a target="_blank" rel="noopener noreferrer" href="https://opentelemetry.io/docs/specs/otel/common/">Otel 1.38.0 규격 문서</a>를 보면 아래와 같이 attribute key는 분명하게 null이나 empty string으로 설정되면 안되다고 설명되어 있다.</p><blockquote><p>The attribute key MUST be a non-null and non-empty string.</p></blockquote><p>그리고 attribute value에 대해서는 empty string도 의미가 있는 것으로 판단하고 저장되어야 하는 것으로 설명되어 있다.</p><blockquote><p>Attribute values expressing a numerical value of zero, an empty string, or an empty array are considered meaningful and MUST be stored and passed on to processors / exporters.</p></blockquote><p>Nodejs처럼 null, undefiend로 Empty()로 설정되는 것은 아래의 설명으로 규격에 맞지 않는 결과이고, Python처럼 None을 에러처리하고 아예 Attribute를 설정하지 않는 것이 더 바람직한 것으로 보인다.</p><blockquote><p>Attribute values of null are not valid and attempting to set a null value is undefined behavior.</p></blockquote><h2 id="thanos를-수정"><a href="#thanos를-수정" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Thanos를 수정</h2><p>Otel 1.38.0 규격 문서를 바탕으로 Attribute value가 Str()으로 설정되더라도 Thanos Receiver가 정상적으로 Metric을 수집할 수 있어야 된다고 판단하였다. Nodejs의 http instrumentation에서 Empty()로 남기는 것은 해당 라이브러리에서 개선되어야 하는 것으로 판단된다.</p><p>그래서 Thanos의 소스 코드에서 ValidateLabels 함수를 아래와 같이 수정하였다. 간단하게 Value에 대해서 &quot;&quot; 빈문자열을 ErrEmptyLabels로 판단하지 않도록 하였다.</p><div class="relative"><pre><code class="code-highlight language-go"><span class="code-line"><span class="token keyword">func</span> <span class="token function">ValidateLabels</span><span class="token punctuation">(</span>lbls <span class="token punctuation">[</span><span class="token punctuation">]</span>ZLabel<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
</span><span class="code-line">	<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>lbls<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> ErrEmptyLabels
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">// Check first label.</span>
</span><span class="code-line">	l0 <span class="token operator">:=</span> lbls<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</span><span class="code-line">	<span class="token keyword">if</span> l0<span class="token punctuation">.</span>Name <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> ErrEmptyLabels
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">// Iterate over the rest, check each for empty / duplicates and</span>
</span><span class="code-line">	<span class="token comment">// check lexicographical (alphabetically) ordering.</span>
</span><span class="code-line">	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> l <span class="token operator">:=</span> <span class="token keyword">range</span> lbls<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">if</span> l<span class="token punctuation">.</span>Name <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-line">			<span class="token keyword">return</span> ErrEmptyLabels
</span><span class="code-line">		<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">		<span class="token keyword">if</span> l<span class="token punctuation">.</span>Name <span class="token operator">==</span> l0<span class="token punctuation">.</span>Name <span class="token punctuation">{</span>
</span><span class="code-line">			<span class="token keyword">return</span> ErrDuplicateLabels
</span><span class="code-line">		<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">		<span class="token keyword">if</span> l<span class="token punctuation">.</span>Name <span class="token operator">&lt;</span> l0<span class="token punctuation">.</span>Name <span class="token punctuation">{</span>
</span><span class="code-line">			<span class="token keyword">return</span> ErrOutOfOrderLabels
</span><span class="code-line">		<span class="token punctuation">}</span>
</span><span class="code-line">		l0 <span class="token operator">=</span> l
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">return</span> <span class="token boolean">nil</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p><a target="_blank" rel="noopener noreferrer" href="https://github.com/thanos-io/thanos/blob/v0.36.1/Dockerfile.multi-stage">Thanos 소스코드에서 multi-stage Dockerfile를 제공</a>하기 때문에 이 Dockerfile를 사용하여 수정된 소스코드를 바탕으로 Container Image를 빌드하였다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">docker build -t thanos:v0.36.1 -f Dockerfile.multi-stage <span class="token builtin class-name">.</span>
</span></code></pre></div><p>Minikube에서 확인하기 위해서 Minikube에 로컬환경에서 빌드한 이미지를 추가하고,</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">minikube image load thanos:v0.36.1
</span></code></pre></div><p>Thanos Helm chart value에 image 설정을 추가한다.</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">objstoreConfig</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
</span><span class="code-line">  <span class="token atrule key">type</span><span class="token punctuation">:</span> s3
</span><span class="code-line">  <span class="token atrule key">config</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">bucket</span><span class="token punctuation">:</span> thanos
</span><span class="code-line">    <span class="token atrule key">endpoint</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span> include &quot;thanos.minio.fullname&quot; . <span class="token punctuation">}</span><span class="token punctuation">}</span>.<span class="token punctuation">{</span><span class="token punctuation">{</span> .Release.Namespace <span class="token punctuation">}</span><span class="token punctuation">}</span>.svc.cluster.local<span class="token punctuation">:</span><span class="token number">9000</span>
</span><span class="code-line">    <span class="token atrule key">access_key</span><span class="token punctuation">:</span> minio
</span><span class="code-line">    <span class="token atrule key">secret_key</span><span class="token punctuation">:</span> minio123
</span><span class="code-line">    <span class="token atrule key">insecure</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line"><span class="token atrule key">image</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">repository</span><span class="token punctuation">:</span> thanos
</span><span class="code-line">  <span class="token atrule key">tag</span><span class="token punctuation">:</span> v0.36.1
</span><span class="code-line">  <span class="token atrule key">pullPolicy</span><span class="token punctuation">:</span> Never
</span><span class="code-line"><span class="token atrule key">query</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">dnsDiscovery</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">sidecarsService</span><span class="token punctuation">:</span> prometheus<span class="token punctuation">-</span>kube<span class="token punctuation">-</span>prometheus<span class="token punctuation">-</span>thanos<span class="token punctuation">-</span>discovery
</span><span class="code-line">    <span class="token atrule key">sidecarsNamespace</span><span class="token punctuation">:</span> monitoring
</span><span class="code-line"><span class="token atrule key">compactor</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line"><span class="token atrule key">storegateway</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line"><span class="token atrule key">receive</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line"><span class="token atrule key">metrics</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">  <span class="token atrule key">serviceMonitor</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line"><span class="token atrule key">minio</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="code-line">  <span class="token atrule key">auth</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">rootPassword</span><span class="token punctuation">:</span> minio123
</span><span class="code-line">    <span class="token atrule key">rootUser</span><span class="token punctuation">:</span> minio
</span><span class="code-line">  <span class="token atrule key">monitoringBuckets</span><span class="token punctuation">:</span> thanos
</span><span class="code-line">  <span class="token atrule key">accessKey</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">password</span><span class="token punctuation">:</span> minio
</span><span class="code-line">  <span class="token atrule key">secretKey</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">password</span><span class="token punctuation">:</span> minio123
</span></code></pre></div><p>최종적으로 해당 value를 Minikube에 설치되어 있는 Thanos에 반영한다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">helm upgrade thanos <span class="token punctuation">\</span>
</span><span class="code-line">    --values helm/thanos/values.yml <span class="token punctuation">\</span>
</span><span class="code-line">    --namespace monitoring <span class="token punctuation">\</span>
</span><span class="code-line">    bitnami/thanos
</span></code></pre></div><p>Attribute value가 Str(), Empty()로 설정되더라도 아래처럼 수집이 잘되는 것을 확인할 수 있다.</p><h3 id="empty-attribute-value-일-때"><a href="#empty-attribute-value-일-때" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Empty Attribute value 일 때</h3><img src="/static/images/thanos_empty-attribute_value.png" alt="empty attribute value on Grafana"/><h3 id="non-empty-attribute-value-일-때"><a href="#non-empty-attribute-value-일-때" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Non-Empty Attribute value 일 때</h3><img src="/static/images/thanos_non_empty-attribute_value.png" alt="non-empty attribute value on Grafana"/><h2 id="결론"><a href="#결론" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>결론</h2><p>Thanos Receiver를 통해서 Metric를 저장할 때, Metric Attribute value가 <code>빈문자열</code>일 때 에러가 발생하였다. Otel 1.38.0 규격 문서를 확인했을 때 attribute key는 non-empty, non-null string값으로 설정되어야 된다고 정의되어 있었다. 하지만 attribute value의 경우에는 Empty String도 의미를 가질 수 있고, 이것도 저장되어야 한다고 정의되어 있었다. 따라서 Thanos의 소스코드를 수정하여 attribute value가 Empty String일 때도 저장할 수 있도록 하였다.</p></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"></div><div id="comment"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/thanos">Thanos</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/opentelemetry">opentelemetry</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/20240825-gcalendar-repeated-events">구글 켈린더 반복 일정을 API 생성/수정/삭제 하는 법</a></div></div><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/20250105-secrets-store-csi-driver-provider-gcp">secrets-store-csi-driver-provider-gcp 사용해보기</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:jayground8@gmail.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/jayground8"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Jay</div><div> • </div><div>© 2025</div><div> • </div><a href="/">Jayground8</a></div><div class="mb-8 text-sm text-gray-500 dark:text-gray-400"><a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var r=Object.create;var l=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty;var t=a=\u003el(a,\"__esModule\",{value:!0});var u=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=\u003e{t(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let n of d(s))!h.call(a,n)\u0026\u0026n!==\"default\"\u0026\u0026l(a,n,{get:()=\u003es[n],enumerable:!(c=p(s,n))||c.enumerable});return a},g=a=\u003ek(t(l(a!=null?r(m(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=u((T,i)=\u003e{i.exports=_jsx_runtime});var f={};N(f,{default:()=\u003ev,frontmatter:()=\u003eb});var e=g(o()),b={title:\"Thanos Receiver\\uC758 empty attribute value \\uBB38\\uC81C\",date:\"2024-10-26\",tags:[\"Thanos\",\"opentelemetry\"],images:[\"/static/images/social-banner.png\"],summary:\"Opentelemetry Instrumentation \\uB77C\\uC774\\uBE0C\\uB7EC\\uB9AC \\uC911\\uC5D0\\uC11C Str(), Empty()\\uB85C attribute value\\uB97C \\uC124\\uC815\\uD558\\uC5EC Metric\\uC744 \\uBCF4\\uB0B4\\uB294 \\uACBD\\uC6B0\\uAC00 \\uC788\\uC5C8\\uB2E4. \\uBB38\\uC81C\\uB294 Thanos Receiver\\uB97C \\uD1B5\\uD574\\uC11C Metric\\uC744 \\uC800\\uC7A5\\uD558\\uB824\\uACE0 \\uD560 \\uB54C, Attribute value \\uAC12\\uC774 \\uBE48\\uBB38\\uC790\\uC5F4\\uC774\\uBA74 \\uC5D0\\uB7EC\\uAC00 \\uBC1C\\uC0DD\\uD558\\uC600\\uB2E4. Otel 1.38.0 \\uADDC\\uACA9 \\uBB38\\uC11C\\uB97C \\uD655\\uC778\\uD588\\uC744 \\uB54C Attribute value\\uB294 \\uBE48\\uBB38\\uC790\\uC5F4\\uB3C4 \\uC758\\uBBF8\\uB97C \\uAC00\\uC9C8 \\uC218 \\uC788\\uACE0 \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uC800\\uC7A5\\uB418\\uC5B4\\uC57C \\uD558\\uB294 \\uAC83\\uC73C\\uB85C \\uC815\\uC758\\uB418\\uC5B4 \\uC788\\uC5C8\\uB2E4. \\uB530\\uB77C\\uC11C Attribute value\\uAC00 \\uBE48\\uBB38\\uC790\\uC5F4\\uC774 \\uB54C\\uB3C4 \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uC800\\uC7A5\\uB420 \\uC218 \\uC788\\uB3C4\\uB85D Thanos \\uC18C\\uC2A4\\uCF54\\uB4DC\\uB97C \\uC218\\uC815\\uD558\\uC5EC Container Image \\uBE4C\\uB4DC\\uD558\\uC5EC \\uC0AC\\uC6A9\\uD558\\uC600\\uB2E4.\"};function y(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",h3:\"h3\",code:\"code\",pre:\"pre\",blockquote:\"blockquote\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"attribute-value\\uAC00-str\\uC640-empty\",children:[(0,e.jsx)(n.a,{href:\"#attribute-value\\uAC00-str\\uC640-empty\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Attribute Value\\uAC00 Str()\\uC640 Empty()\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.a,{href:\"https://github.com/jayground8/example-opentelemetry-monitoring/tree/main/attribute_example\",children:\"\\uC608\\uC81C \\uD30C\\uC77C\\uC744 \\uCC38\\uACE0\\uD558\\uC5EC Nodejs Application\\uACFC Python Application\\uC5D0\\uC11C Attribute value\\uB97C \\uBE48\\uBB38\\uC790\\uC5F4\\uC774\\uB098 null/None \\uAC19\\uC740 \\uAC12\\uC73C\\uB85C \\uC124\\uC815\\uD558\\uACE0, Opentelemetry Debug Exporter\\uB97C \\uD1B5\\uD574\\uC11C Metric\\uC744 \\uD655\\uC778\\uD574\\uBCF8\\uB2E4.\"})}),(0,e.jsxs)(n.h3,{id:\"nodejs\",children:[(0,e.jsx)(n.a,{href:\"#nodejs\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Nodejs\"]}),(0,e.jsxs)(n.p,{children:[\"Nodejs Application\\uC5D0\\uC11C \",(0,e.jsx)(n.code,{children:\"Counter\"}),\" \\uD0C0\\uC785\\uC758 metric\\uC744 \\uCD94\\uAC00\\uD558\\uACE0, \\uC544\\uB798\\uCC98\\uB7FC attribute value\\uB97C \\uBE48\\uBB38\\uC790\\uC5F4\\uB85C \\uC815\\uC758\\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-js\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"counter1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"add\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" hello\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"''\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB7EC\\uBA74 debug exporter\\uB97C \\uD1B5\\uD574\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \",(0,e.jsx)(n.code,{children:\"Str()\"}),\"\\uC73C\\uB85C \\uB0A8\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"ScopeMetrics \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#1\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`ScopeMetrics SchemaURL:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`InstrumentationScope default\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Metric \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#0\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Descriptor:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` Name: empty\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` Description:\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` Unit:\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` DataType: Sum\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\" IsMonotonic: \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` AggregationTemporality: Cumulative\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"NumberDataPoints \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#0\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Data point attributes:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\" hello: Str\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"StartTimestamp: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2024\"}),`-10-26 00:05:49.732 +0000 UTC\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Timestamp: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2024\"}),`-10-26 00:06:46.47 +0000 UTC\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Value: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1.000000\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB9AC\\uACE0 \",(0,e.jsx)(n.code,{children:\"Counter\"}),\" \\uD0C0\\uC785\\uC758 metric\\uC744 \\uD558\\uB098 \\uB354 \\uCD94\\uAC00\\uD558\\uACE0, \\uC544\\uB798\\uCC98\\uB7FC attribute value\\uB97C \",(0,e.jsx)(n.code,{children:\"null\"}),\"\\uB85C \\uC815\\uC758\\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-js\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"counter2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"add\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" hello\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword nil null\",children:\"null\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB7EC\\uBA74 \\uC774\\uBC88\\uC5D0\\uB294 debug exporter\\uB85C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \",(0,e.jsx)(n.code,{children:\"Empty()\"}),\"\\uB85C \\uB0A8\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Metric \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#1\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Descriptor:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` Name: null\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` Description:\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` Unit:\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` DataType: Sum\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\" IsMonotonic: \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` AggregationTemporality: Cumulative\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"NumberDataPoints \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#0\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Data point attributes:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\" hello: Empty\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"StartTimestamp: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2024\"}),`-10-26 00:05:49.732 +0000 UTC\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Timestamp: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2024\"}),`-10-26 00:06:46.47 +0000 UTC\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Value: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1.000000\"}),`\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"python\",children:[(0,e.jsx)(n.a,{href:\"#python\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Python\"]}),(0,e.jsxs)(n.p,{children:[\"Python Application\\uC740 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \",(0,e.jsx)(n.code,{children:\"\\uBE48\\uBB38\\uC790\\uC5F4\"}),\"\\uC744 \\uB123\\uC5C8\\uC744 \\uB54C\\uB294\"]}),(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-python\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"counter1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"add\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"test\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})})}),(0,e.jsxs)(n.p,{children:[\"\\uC544\\uB798\\uCC98\\uB7FC \",(0,e.jsx)(n.code,{children:\"Str()\"}),\"\\uC774 \\uCC0D\\uD788\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"ScopeMetrics \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#1\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`ScopeMetrics SchemaURL:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"InstrumentationScope \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"test\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Metric \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#0\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Descriptor:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` Name: empty\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` Description:\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` Unit:\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` DataType: Sum\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\" IsMonotonic: \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` AggregationTemporality: Cumulative\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"NumberDataPoints \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#0\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Data point attributes:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\" test: Str\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"StartTimestamp: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2024\"}),`-10-26 00:08:02.064389211 +0000 UTC\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Timestamp: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2024\"}),`-10-26 00:08:25.521302833 +0000 UTC\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uD558\\uC9C0\\uB9CC Nodejs\\uC640 \\uB2E4\\uB974\\uAC8C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \",(0,e.jsx)(n.code,{children:\"None\"}),\"\\uC744 \\uC124\\uC815\\uD558\\uC600\\uC744 \\uB54C\\uB294\"]}),(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-python\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"counter2\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"add\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"test\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"None\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})})}),(0,e.jsx)(n.p,{children:\"Python Opentelemetry \\uD328\\uD0A4\\uC9C0\\uC5D0\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC5D0\\uB7EC\\uAC00 \\uBC1C\\uC0DD\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Failed to encode key test: Invalid \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"type\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),\"class \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'NoneType'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` of value None\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Traceback \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"most recent call last\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`:\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  File \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"/venv/lib/python3.11/site-packages/opentelemetry/exporter/otlp/proto/common/_internal/__init__.py\"'}),\", line \",(0,e.jsx)(n.span,{className:\"token number\",children:\"113\"}),\", \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),` _encode_attributes\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    pb2_attributes.append\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"_encode_key_value\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"key, value\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"))\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  File \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"/venv/lib/python3.11/site-packages/opentelemetry/exporter/otlp/proto/common/_internal/__init__.py\"'}),\", line \",(0,e.jsx)(n.span,{className:\"token number\",children:\"94\"}),\", \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),` _encode_key_value\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"return\"}),\" PB2KeyValue\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"key\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"key, \",(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"_encode_value\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"value\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"))\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`                                      ^^^^^^^^^^^^^^^^^^^^\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  File \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"/venv/lib/python3.11/site-packages/opentelemetry/exporter/otlp/proto/common/_internal/__init__.py\"'}),\", line \",(0,e.jsx)(n.span,{className:\"token number\",children:\"90\"}),\", \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"in\"}),` _encode_value\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    raise Exception\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"f\",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Invalid type {type(value)} of value {value}\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Exception: Invalid \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"type\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),\"class \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'NoneType'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` of value None\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uADF8\\uB9AC\\uACE0 \\uCD5C\\uC885\\uC801\\uC73C\\uB85C Opentelemetry Collector\\uC5D0\\uB294 Attribute\\uAC00 \\uC5C6\\uB294 \\uC0C1\\uD0DC\\uB85C Metric\\uC774 \\uC804\\uB2EC\\uB41C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Metric \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#1\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Descriptor:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` Name: none\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` Description:\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` Unit:\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` DataType: Sum\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\" IsMonotonic: \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),` AggregationTemporality: Cumulative\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"NumberDataPoints \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"#0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"StartTimestamp: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2024\"}),`-10-26 00:08:02.064398086 +0000 UTC\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Timestamp: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2024\"}),`-10-26 00:08:25.521302833 +0000 UTC\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Value: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"thanos-receiver-error\",children:[(0,e.jsx)(n.a,{href:\"#thanos-receiver-error\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Thanos Receiver Error\"]}),(0,e.jsxs)(n.p,{children:[\"\\uC704\\uC5D0\\uC11C \\uC0B4\\uD3B4\\uBCF8 \\uAC83\\uCC98\\uB7FC Attribute Value\\uACFC \",(0,e.jsx)(n.code,{children:\"Str()\"}),\"\\uB098 \",(0,e.jsx)(n.code,{children:\"Empty()\"}),\" \\uC124\\uC815\\uB418\\uC5B4\\uC11C Metric\\uC774 \\uC804\\uB2EC\\uB420 \\uC218 \\uC788\\uB2E4. \\uC2E4\\uC81C\\uB85C \\uC6B4\\uC601\\uD558\\uBA74\\uC11C Nodejs\\uC5D0\\uC11C\\uB294 \",(0,e.jsx)(n.a,{href:\"https://www.npmjs.com/package/@opentelemetry/instrumentation-http\",children:\"instrumentation-http\"}),\"\\uC5D0\\uC11C \",(0,e.jsx)(n.code,{children:\"net.host.port\"}),\" Attribute value\\uB97C \",(0,e.jsx)(n.code,{children:\"Empty()\"}),\"\\uB85C \\uBCF4\\uB0B4\\uB294 \\uACBD\\uC6B0\\uAC00 \\uBC1C\\uC0DD\\uD558\\uC600\\uB2E4. instrumentation-http\\uAC00 Socket object\\uB97C \\uD1B5\\uD574\\uC11C host port\\uB97C \\uAC00\\uC838\\uC624\\uACE0, \\uADF8 \\uAC12\\uC744 metric\\uC758 \",(0,e.jsx)(n.code,{children:\"net.host.port\"}),\" attribute \\uAC12\\uC73C\\uB85C \\uC124\\uC815\\uD558\\uAC8C \\uB41C\\uB2E4. \\uADF8\\uB7F0\\uB370 \\uC5B4\\uB5A4 \\uC774\\uC720\\uC5D0\\uC11C \\uC774 \\uAC12\\uC774 \",(0,e.jsx)(n.code,{children:\"undefined\"}),\"\\uC774 \\uB418\\uBA74\\uC11C \\uCD5C\\uC885\\uC801\\uC73C\\uB85C \",(0,e.jsx)(n.code,{children:\"Empty()\"}),\"\\uB85C \\uC124\\uC815\\uB418\\uB294 \\uAC83\\uC73C\\uB85C \\uD30C\\uC545\\uB41C\\uB2E4. \\uADF8\\uB9AC\\uACE0 .Net instrumentation \\uC911\\uC5D0\\uC11C\\uB3C4 \",(0,e.jsx)(n.code,{children:\"Str()\"}),\"\\uB97C \\uC124\\uC815\\uD558\\uB294 \\uACBD\\uC6B0\\uAC00 \\uC788\\uC5C8\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:\"\\uBB38\\uC81C\\uB294 Thanos Receiver\\uB97C \\uD1B5\\uD574\\uC11C Metric\\uC744 \\uC800\\uC7A5\\uD558\\uB824\\uACE0 \\uD560 \\uB54C, Thanos Receiver\\uAC00 \\uC774\\uB7EC\\uD55C empty attribute value\\uAC00 \\uC788\\uC744 \\uB54C \\uC544\\uB798\\uCC98\\uB7FC \\uC5D0\\uB7EC\\uB97C \\uBC1C\\uC0DD\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"2024\"}),\"-10-26T00:08:25.744Z\terror\tinternal/queue_sender.go:92\tExporting failed. Dropping data.\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"kind\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"exporter\"'}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"data_type\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"metrics\"'}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"name\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"prometheusremotewrite\"'}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"error\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsxs)(n.span,{className:\"token string\",children:['\"Permanent error: Permanent error: Permanent error: remote write returned HTTP status 409 Conflict; err = %!w(\u003cnil\u003e): add 1 series: label set contains a label with empty name or value',(0,e.jsx)(n.span,{className:\"token entity\",title:\"\\\\n\",children:\"\\\\n\"}),'\"']}),\", \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"dropped_items\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`go.opentelemetry.io/collector/exporter/exporterhelper/internal.NewQueueSender.func1\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\tgo.opentelemetry.io/collector/exporter@v0.111.0/exporterhelper/internal/queue_sender.go:92\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"go.opentelemetry.io/collector/exporter/internal/queue.\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"*boundedMemoryQueue\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"..\"}),\".\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`.Consume\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\tgo.opentelemetry.io/collector/exporter@v0.111.0/internal/queue/bounded_memory_queue.go:52\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"go.opentelemetry.io/collector/exporter/internal/queue.\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"*Consumers\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"..\"}),\".\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`.Start.func1\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\tgo.opentelemetry.io/collector/exporter@v0.111.0/internal/queue/consumers.go:43\n`})]})}),(0,e.jsxs)(n.p,{children:[\"\\uD14C\\uC2A4\\uD2B8\\uB97C \\uD560 \\uC2DC\\uC810\\uC758 Thanos Version\\uC740 0.36.1\\uC774\\uC600\\uACE0, \",(0,e.jsx)(n.a,{href:\"https://github.com/thanos-io/thanos/blob/v0.36.1/pkg/receive/writer.go\",children:\"Thanos Receiver Code\"}),\"\\uB97C \\uBCF4\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-go\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" numLabelsEmpty \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    level\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Info\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"tLogger\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Log\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"msg\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Error on series with empty label name or value\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"numDropped\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" numLabelsEmpty\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    errs\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Add\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"errors\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"Wrapf\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"labelpb\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"ErrEmptyLabels\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"add %d series\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" numLabelsEmpty\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"numLabelsEmpty\"}),\"\\uB294 \",(0,e.jsx)(n.a,{href:\"https://github.com/thanos-io/thanos/blob/v0.36.1/pkg/store/labelpb/label.go\",children:\"label.go\"}),\"\\uC5D0\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC774 ValidateLabels \\uD568\\uC218\\uB85C \\uACB0\\uC815\\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-go\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"ValidateLabels\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"lbls \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\"ZLabel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"error\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"lbls\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),` ErrEmptyLabels\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Check first label.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tl0 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" lbls\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" l0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Name \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"||\"}),\" l0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Value \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),` ErrEmptyLabels\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Iterate over the rest, check each for empty / duplicates and\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// check lexicographical (alphabetically) ordering.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" l \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"range\"}),\" lbls\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" l\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Name \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"||\"}),\" l\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Value \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),` ErrEmptyLabels\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" l\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Name \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" l0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Name \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),` ErrDuplicateLabels\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" l\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Name \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),\" l0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Name \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),` ErrOutOfOrderLabels\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tl0 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),` l\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"str\\uB85C-\\uBCF4\\uB0B4\\uB294-\\uAC83\\uC774-\\uBB38\\uC81C\\uC778\\uAC00\",children:[(0,e.jsx)(n.a,{href:\"#str\\uB85C-\\uBCF4\\uB0B4\\uB294-\\uAC83\\uC774-\\uBB38\\uC81C\\uC778\\uAC00\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Str()\\uB85C \\uBCF4\\uB0B4\\uB294 \\uAC83\\uC774 \\uBB38\\uC81C\\uC778\\uAC00?\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://opentelemetry.io/docs/specs/otel/common/\",children:\"Otel 1.38.0 \\uADDC\\uACA9 \\uBB38\\uC11C\"}),\"\\uB97C \\uBCF4\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 attribute key\\uB294 \\uBD84\\uBA85\\uD558\\uAC8C null\\uC774\\uB098 empty string\\uC73C\\uB85C \\uC124\\uC815\\uB418\\uBA74 \\uC548\\uB418\\uB2E4\\uACE0 \\uC124\\uBA85\\uB418\\uC5B4 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"The attribute key MUST be a non-null and non-empty string.\"})}),(0,e.jsx)(n.p,{children:\"\\uADF8\\uB9AC\\uACE0 attribute value\\uC5D0 \\uB300\\uD574\\uC11C\\uB294 empty string\\uB3C4 \\uC758\\uBBF8\\uAC00 \\uC788\\uB294 \\uAC83\\uC73C\\uB85C \\uD310\\uB2E8\\uD558\\uACE0 \\uC800\\uC7A5\\uB418\\uC5B4\\uC57C \\uD558\\uB294 \\uAC83\\uC73C\\uB85C \\uC124\\uBA85\\uB418\\uC5B4 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"Attribute values expressing a numerical value of zero, an empty string, or an empty array are considered meaningful and MUST be stored and passed on to processors / exporters.\"})}),(0,e.jsx)(n.p,{children:\"Nodejs\\uCC98\\uB7FC null, undefiend\\uB85C Empty()\\uB85C \\uC124\\uC815\\uB418\\uB294 \\uAC83\\uC740 \\uC544\\uB798\\uC758 \\uC124\\uBA85\\uC73C\\uB85C \\uADDC\\uACA9\\uC5D0 \\uB9DE\\uC9C0 \\uC54A\\uB294 \\uACB0\\uACFC\\uC774\\uACE0, Python\\uCC98\\uB7FC None\\uC744 \\uC5D0\\uB7EC\\uCC98\\uB9AC\\uD558\\uACE0 \\uC544\\uC608 Attribute\\uB97C \\uC124\\uC815\\uD558\\uC9C0 \\uC54A\\uB294 \\uAC83\\uC774 \\uB354 \\uBC14\\uB78C\\uC9C1\\uD55C \\uAC83\\uC73C\\uB85C \\uBCF4\\uC778\\uB2E4.\"}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"Attribute values of null are not valid and attempting to set a null value is undefined behavior.\"})}),(0,e.jsxs)(n.h2,{id:\"thanos\\uB97C-\\uC218\\uC815\",children:[(0,e.jsx)(n.a,{href:\"#thanos\\uB97C-\\uC218\\uC815\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Thanos\\uB97C \\uC218\\uC815\"]}),(0,e.jsx)(n.p,{children:\"Otel 1.38.0 \\uADDC\\uACA9 \\uBB38\\uC11C\\uB97C \\uBC14\\uD0D5\\uC73C\\uB85C Attribute value\\uAC00 Str()\\uC73C\\uB85C \\uC124\\uC815\\uB418\\uB354\\uB77C\\uB3C4 Thanos Receiver\\uAC00 \\uC815\\uC0C1\\uC801\\uC73C\\uB85C Metric\\uC744 \\uC218\\uC9D1\\uD560 \\uC218 \\uC788\\uC5B4\\uC57C \\uB41C\\uB2E4\\uACE0 \\uD310\\uB2E8\\uD558\\uC600\\uB2E4. Nodejs\\uC758 http instrumentation\\uC5D0\\uC11C Empty()\\uB85C \\uB0A8\\uAE30\\uB294 \\uAC83\\uC740 \\uD574\\uB2F9 \\uB77C\\uC774\\uBE0C\\uB7EC\\uB9AC\\uC5D0\\uC11C \\uAC1C\\uC120\\uB418\\uC5B4\\uC57C \\uD558\\uB294 \\uAC83\\uC73C\\uB85C \\uD310\\uB2E8\\uB41C\\uB2E4.\"}),(0,e.jsx)(n.p,{children:'\\uADF8\\uB798\\uC11C Thanos\\uC758 \\uC18C\\uC2A4 \\uCF54\\uB4DC\\uC5D0\\uC11C ValidateLabels \\uD568\\uC218\\uB97C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC218\\uC815\\uD558\\uC600\\uB2E4. \\uAC04\\uB2E8\\uD558\\uAC8C Value\\uC5D0 \\uB300\\uD574\\uC11C \"\" \\uBE48\\uBB38\\uC790\\uC5F4\\uC744 ErrEmptyLabels\\uB85C \\uD310\\uB2E8\\uD558\\uC9C0 \\uC54A\\uB3C4\\uB85D \\uD558\\uC600\\uB2E4.'}),(0,e.jsx)(n.pre,{className:\"language-go\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-go\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"ValidateLabels\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"lbls \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\"ZLabel\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"error\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"len\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"lbls\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),` ErrEmptyLabels\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Check first label.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tl0 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" lbls\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" l0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Name \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),` ErrEmptyLabels\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Iterate over the rest, check each for empty / duplicates and\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// check lexicographical (alphabetically) ordering.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"_\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" l \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"range\"}),\" lbls\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" l\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Name \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),` ErrEmptyLabels\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" l\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Name \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" l0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Name \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),` ErrDuplicateLabels\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" l\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Name \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),\" l0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"Name \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),` ErrOutOfOrderLabels\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tl0 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),` l\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://github.com/thanos-io/thanos/blob/v0.36.1/Dockerfile.multi-stage\",children:\"Thanos \\uC18C\\uC2A4\\uCF54\\uB4DC\\uC5D0\\uC11C multi-stage Dockerfile\\uB97C \\uC81C\\uACF5\"}),\"\\uD558\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uC774 Dockerfile\\uB97C \\uC0AC\\uC6A9\\uD558\\uC5EC \\uC218\\uC815\\uB41C \\uC18C\\uC2A4\\uCF54\\uB4DC\\uB97C \\uBC14\\uD0D5\\uC73C\\uB85C Container Image\\uB97C \\uBE4C\\uB4DC\\uD558\\uC600\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"docker build -t thanos:v0.36.1 -f Dockerfile.multi-stage \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\".\"}),`\n`]})})}),(0,e.jsx)(n.p,{children:\"Minikube\\uC5D0\\uC11C \\uD655\\uC778\\uD558\\uAE30 \\uC704\\uD574\\uC11C Minikube\\uC5D0 \\uB85C\\uCEEC\\uD658\\uACBD\\uC5D0\\uC11C \\uBE4C\\uB4DC\\uD55C \\uC774\\uBBF8\\uC9C0\\uB97C \\uCD94\\uAC00\\uD558\\uACE0,\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`minikube image load thanos:v0.36.1\n`})})}),(0,e.jsx)(n.p,{children:\"Thanos Helm chart value\\uC5D0 image \\uC124\\uC815\\uC744 \\uCD94\\uAC00\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"objstoreConfig\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"|\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"type\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` s3\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"config\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"bucket\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` thanos\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"endpoint\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),' include \"thanos.minio.fullname\" . ',(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\".\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" .Release.Namespace \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\".svc.cluster.local\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"9000\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"access_key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` minio\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"secret_key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` minio123\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"insecure\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"image\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"repository\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` thanos\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"tag\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` v0.36.1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"pullPolicy\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Never\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"query\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"dnsDiscovery\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"sidecarsService\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" prometheus\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"kube\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"prometheus\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"thanos\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`discovery\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"sidecarsNamespace\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` monitoring\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"compactor\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"storegateway\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"receive\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metrics\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"serviceMonitor\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"minio\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"auth\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"rootPassword\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` minio123\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"rootUser\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` minio\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"monitoringBuckets\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` thanos\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"accessKey\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"password\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` minio\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"secretKey\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"password\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` minio123\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uCD5C\\uC885\\uC801\\uC73C\\uB85C \\uD574\\uB2F9 value\\uB97C Minikube\\uC5D0 \\uC124\\uCE58\\uB418\\uC5B4 \\uC788\\uB294 Thanos\\uC5D0 \\uBC18\\uC601\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"helm upgrade thanos \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    --values helm/thanos/values.yml \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    --namespace monitoring \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    bitnami/thanos\n`})]})}),(0,e.jsx)(n.p,{children:\"Attribute value\\uAC00 Str(), Empty()\\uB85C \\uC124\\uC815\\uB418\\uB354\\uB77C\\uB3C4 \\uC544\\uB798\\uCC98\\uB7FC \\uC218\\uC9D1\\uC774 \\uC798\\uB418\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsxs)(n.h3,{id:\"empty-attribute-value-\\uC77C-\\uB54C\",children:[(0,e.jsx)(n.a,{href:\"#empty-attribute-value-\\uC77C-\\uB54C\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Empty Attribute value \\uC77C \\uB54C\"]}),(0,e.jsx)(\"img\",{src:\"/static/images/thanos_empty-attribute_value.png\",alt:\"empty attribute value on Grafana\"}),(0,e.jsxs)(n.h3,{id:\"non-empty-attribute-value-\\uC77C-\\uB54C\",children:[(0,e.jsx)(n.a,{href:\"#non-empty-attribute-value-\\uC77C-\\uB54C\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Non-Empty Attribute value \\uC77C \\uB54C\"]}),(0,e.jsx)(\"img\",{src:\"/static/images/thanos_non_empty-attribute_value.png\",alt:\"non-empty attribute value on Grafana\"}),(0,e.jsxs)(n.h2,{id:\"\\uACB0\\uB860\",children:[(0,e.jsx)(n.a,{href:\"#\\uACB0\\uB860\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uACB0\\uB860\"]}),(0,e.jsxs)(n.p,{children:[\"Thanos Receiver\\uB97C \\uD1B5\\uD574\\uC11C Metric\\uB97C \\uC800\\uC7A5\\uD560 \\uB54C, Metric Attribute value\\uAC00 \",(0,e.jsx)(n.code,{children:\"\\uBE48\\uBB38\\uC790\\uC5F4\"}),\"\\uC77C \\uB54C \\uC5D0\\uB7EC\\uAC00 \\uBC1C\\uC0DD\\uD558\\uC600\\uB2E4. Otel 1.38.0 \\uADDC\\uACA9 \\uBB38\\uC11C\\uB97C \\uD655\\uC778\\uD588\\uC744 \\uB54C attribute key\\uB294 non-empty, non-null string\\uAC12\\uC73C\\uB85C \\uC124\\uC815\\uB418\\uC5B4\\uC57C \\uB41C\\uB2E4\\uACE0 \\uC815\\uC758\\uB418\\uC5B4 \\uC788\\uC5C8\\uB2E4. \\uD558\\uC9C0\\uB9CC attribute value\\uC758 \\uACBD\\uC6B0\\uC5D0\\uB294 Empty String\\uB3C4 \\uC758\\uBBF8\\uB97C \\uAC00\\uC9C8 \\uC218 \\uC788\\uACE0, \\uC774\\uAC83\\uB3C4 \\uC800\\uC7A5\\uB418\\uC5B4\\uC57C \\uD55C\\uB2E4\\uACE0 \\uC815\\uC758\\uB418\\uC5B4 \\uC788\\uC5C8\\uB2E4. \\uB530\\uB77C\\uC11C Thanos\\uC758 \\uC18C\\uC2A4\\uCF54\\uB4DC\\uB97C \\uC218\\uC815\\uD558\\uC5EC attribute value\\uAC00 Empty String\\uC77C \\uB54C\\uB3C4 \\uC800\\uC7A5\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D \\uD558\\uC600\\uB2E4.\"]})]})}}var v=y;return f;})();\n;return Component;","toc":[{"value":"Attribute Value가 Str()와 Empty()","url":"#attribute-value가-str와-empty","depth":2},{"value":"Nodejs","url":"#nodejs","depth":3},{"value":"Python","url":"#python","depth":3},{"value":"Thanos Receiver Error","url":"#thanos-receiver-error","depth":2},{"value":"Str()로 보내는 것이 문제인가?","url":"#str로-보내는-것이-문제인가","depth":2},{"value":"Thanos를 수정","url":"#thanos를-수정","depth":2},{"value":"Empty Attribute value 일 때","url":"#empty-attribute-value-일-때","depth":3},{"value":"Non-Empty Attribute value 일 때","url":"#non-empty-attribute-value-일-때","depth":3},{"value":"결론","url":"#결론","depth":2}],"frontMatter":{"readingTime":{"text":"9 min read","minutes":8.865,"time":531900,"words":1773},"slug":"20241026-thanos-prometheus-remote-write","fileName":"20241026-thanos-prometheus-remote-write.md","title":"Thanos Receiver의 empty attribute value 문제","date":"2024-10-26T00:00:00.000Z","tags":["Thanos","opentelemetry"],"images":["/static/images/social-banner.png"],"summary":"Opentelemetry Instrumentation 라이브러리 중에서 Str(), Empty()로 attribute value를 설정하여 Metric을 보내는 경우가 있었다. 문제는 Thanos Receiver를 통해서 Metric을 저장하려고 할 때, Attribute value 값이 빈문자열이면 에러가 발생하였다. Otel 1.38.0 규격 문서를 확인했을 때 Attribute value는 빈문자열도 의미를 가질 수 있고 정상적으로 저장되어야 하는 것으로 정의되어 있었다. 따라서 Attribute value가 빈문자열이 때도 정상적으로 저장될 수 있도록 Thanos 소스코드를 수정하여 Container Image 빌드하여 사용하였다."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.15,"time":9000,"words":30},"slug":["default"],"fileName":"default.md","name":"Jay","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"구글 켈린더 반복 일정을 API 생성/수정/삭제 하는 법","date":"2024-08-25T00:00:00.000Z","tags":["development"],"images":["/static/images/social-banner.png"],"summary":"구글 켈린더에서 RFC 5545로 정의된 값으로 반복일정을 생성할 수 있다. 그런데 구글 켈린더의 반복 일정을 API로 생성/수정/삭제 하는 과정에서 삽질을 하게 되었다.😂 혹시나 누군가 구글 켈린더 반복일정을 API로 수정/변경/삭제 해야하는 경우, 이 블로그 글을 통해서 불필요하게 삽질을 하지 않기 바라며 작성했다. 반복일정을 수정/삭제 할 때 선택하는 세 가지 옵션(이 일정, 모든 일정, 이 일정 및 향후 일정)에 따라서 이벤트 id를 다르게 설정하여 요청해야 한다.","slug":"20240825-gcalendar-repeated-events"},"next":{"title":"secrets-store-csi-driver-provider-gcp 사용해보기","date":"2025-01-05T00:00:00.000Z","tags":["gcp","kubernetes"],"images":["/static/images/social-banner.png"],"summary":"GKE에서 add-on 기능으로 관리형 서비스인 Google Secret Manager을 Kubernetes Secrets Store CSI Driver로 쉽게 사용할 수 있다. 하지만 add-on 버전에서는 Sync as Kubernetes Secret 기능을 제공하지 않기 때문에, Kubernetes Secret을 환경변수로 설정하는데 제약사항이 있다. 직접 Kubernetes Secrets Store CSI driver와 GCP provider driver를 설치하여 Sync as Kubernetes Secret 기능을 사용할 수 있다. 이렇게 Sync된 Kubernetes Secret을 환경변수로 주입하도록 설정할 수 있다. Google Secret Manager는 아쉽게도 하나의 Secret에 복수의 key value를 제공하지 않는다. 이번 글에서는 Google Secret Manager를 Kubernetes Secret Object와 Sync해서 사용하는 것이 바람직할지 고민해본다.","slug":"20250105-secrets-store-csi-driver-provider-gcp"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["20241026-thanos-prometheus-remote-write"]},"buildId":"WTiGgcjIxdebIMrH_uVPJ","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>