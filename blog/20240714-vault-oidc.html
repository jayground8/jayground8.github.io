<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="manifest" href="/jayground8/static/favicons/manifest.json"/><link rel="manifest" href="/jayground8/static/favicons/site.webmanifest"/><link rel="shortcut icon" href="/jayground8/static/favicons/favicon.ico"/><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8773084925406986" crossorigin="anonymous"></script><title>구글 계정으로 Vault 로그인하기</title><meta name="robots" content="follow, index"/><meta name="description" content="Vault를 구글 인증을 통해서 로그인하도록 설정해본다. Admin Directory API를 통해서 workspace의 user와 group의 정보를 가져올 수 있고, 해당 정보를 통해서 인증 조건을 추가할 수 있다. 예로 특정 workspace group에 속한 계정만 인증에 성공할 수 있도록 조건을 추가할 수 있다. Admin Directory API에 요청하기 위해서 필요한 권한을 설정할 수 있는데, Service Account의 key 파일을 생성하는 대신에, Application Default Credentials를 활용해보았다. Application Default Credentials를 사용하는 과정에서 삽질을 많이 했는데, 혹시나 동일한 작업을 하는 분들은 나처럼 시간을 허비하지 않기를 바라며 글을 작성한다.🥹"/><meta property="og:url" content="https://jayground8.github.io/blog/20240714-vault-oidc"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Jayground8"/><meta property="og:description" content="Vault를 구글 인증을 통해서 로그인하도록 설정해본다. Admin Directory API를 통해서 workspace의 user와 group의 정보를 가져올 수 있고, 해당 정보를 통해서 인증 조건을 추가할 수 있다. 예로 특정 workspace group에 속한 계정만 인증에 성공할 수 있도록 조건을 추가할 수 있다. Admin Directory API에 요청하기 위해서 필요한 권한을 설정할 수 있는데, Service Account의 key 파일을 생성하는 대신에, Application Default Credentials를 활용해보았다. Application Default Credentials를 사용하는 과정에서 삽질을 많이 했는데, 혹시나 동일한 작업을 하는 분들은 나처럼 시간을 허비하지 않기를 바라며 글을 작성한다.🥹"/><meta property="og:title" content="구글 계정으로 Vault 로그인하기"/><meta property="og:image" content="https://jayground8.github.io/static/images/social-banner.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site"/><meta name="twitter:title" content="구글 계정으로 Vault 로그인하기"/><meta name="twitter:description" content="Vault를 구글 인증을 통해서 로그인하도록 설정해본다. Admin Directory API를 통해서 workspace의 user와 group의 정보를 가져올 수 있고, 해당 정보를 통해서 인증 조건을 추가할 수 있다. 예로 특정 workspace group에 속한 계정만 인증에 성공할 수 있도록 조건을 추가할 수 있다. Admin Directory API에 요청하기 위해서 필요한 권한을 설정할 수 있는데, Service Account의 key 파일을 생성하는 대신에, Application Default Credentials를 활용해보았다. Application Default Credentials를 사용하는 과정에서 삽질을 많이 했는데, 혹시나 동일한 작업을 하는 분들은 나처럼 시간을 허비하지 않기를 바라며 글을 작성한다.🥹"/><meta name="twitter:image" content="https://jayground8.github.io/static/images/social-banner.png"/><link rel="canonical" href="https://jayground8.github.io/blog/20240714-vault-oidc"/><meta property="article:published_time" content="2024-07-14T00:00:00.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jayground8.github.io/blog/20240714-vault-oidc"
  },
  "headline": "구글 계정으로 Vault 로그인하기",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://jayground8.github.io/static/images/social-banner.png"
    }
  ],
  "datePublished": "2024-07-14T00:00:00.000Z",
  "dateModified": "2024-07-14T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jay"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Jay",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jayground8.github.ioplayground.png"
    }
  },
  "description": "Vault를 구글 인증을 통해서 로그인하도록 설정해본다. Admin Directory API를 통해서 workspace의 user와 group의 정보를 가져올 수 있고, 해당 정보를 통해서 인증 조건을 추가할 수 있다. 예로 특정 workspace group에 속한 계정만 인증에 성공할 수 있도록 조건을 추가할 수 있다. Admin Directory API에 요청하기 위해서 필요한 권한을 설정할 수 있는데, Service Account의 key 파일을 생성하는 대신에, Application Default Credentials를 활용해보았다. Application Default Credentials를 사용하는 과정에서 삽질을 많이 했는데, 혹시나 동일한 작업을 하는 분들은 나처럼 시간을 허비하지 않기를 바라며 글을 작성한다.🥹"
}</script><meta name="next-head-count" content="24"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preload" href="/_next/static/css/414f98a58444a4f1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/414f98a58444a4f1.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-690364db8bfb1f01.js" defer=""></script><script src="/_next/static/chunks/main-eea1c213342d95c3.js" defer=""></script><script src="/_next/static/chunks/pages/_app-7b281fb55ef8153b.js" defer=""></script><script src="/_next/static/chunks/675-70b09cbf0a5309ea.js" defer=""></script><script src="/_next/static/chunks/410-35c4fb535edd9439.js" defer=""></script><script src="/_next/static/chunks/712-376d32740a4ac813.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-8ab66ff6ebabec4c.js" defer=""></script><script src="/_next/static/pgk04D_iZGZPDfMeQaKFq/_buildManifest.js" defer=""></script><script src="/_next/static/pgk04D_iZGZPDfMeQaKFq/_ssgManifest.js" defer=""></script><script src="/_next/static/pgk04D_iZGZPDfMeQaKFq/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="Jayground8" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" width="53.87" height="43.61" viewBox="0 0 512 512" class="fill-black dark:fill-white"><path d="M368.4 17c-8.8 1.3-18.3 5-25.3 9.9-3.8 2.5-22.6 16.1-41.9 30.1-37.1 26.9-38.6 28.3-36.3 33.9 1.7 4 4.9 5.1 14.6 5.1h8.5v128h-17.9c-18.2 0-22.2.6-27.3 4.2l-2.8 1.9V116.9l2.5-2.4c1.5-1.6 3.6-2.5 5.5-2.5s4 .9 5.5 2.5l2.5 2.4v42c0 29.1.3 42.8 1.1 44.5 2.6 5.7 11.5 5.5 13.9-.3.7-1.9 1-15.6.8-46.2-.3-40.1-.4-43.7-2.2-46.9-4.8-9-11.9-13.4-21.6-13.4-13.8 0-22.8 9.1-23.8 24.1l-.5 7.3h-31.5l-1.2-2.9c-1.6-3.9-6-5.8-9.9-4.1-1.6.6-3.5 2.5-4.1 4.1l-1.2 2.9h-63.6l-1.2-2.9c-2.5-6.2-11.5-6.2-14 0l-1.2 2.9H64.3l-.5-7.3c-1-15-10-24.1-23.8-24.1-9.7 0-16.8 4.4-21.6 13.4-1.8 3.3-1.9 7.5-2.2 75-.2 50 .1 72.3.8 74.1 2.1 5.1 8.6 6.3 12.5 2.4l2.5-2.4V116.9l2.5-2.4c3.2-3.3 7.8-3.3 11 0l2.5 2.4V448H32V284.9l-2.5-2.4c-3.8-3.9-10.2-2.7-12.4 2.2-1.6 3.4-1.6 171.2 0 174.6.6 1.4 2.2 3 3.6 3.6 1.6.7 15.6 1.1 43.7 1.1 38 0 41.5-.1 43.4-1.8 1.2-.9 33.4-50.5 71.7-110.2 38.3-59.7 70.5-109.3 71.7-110.3 1.8-1.5 4.3-1.7 19.4-1.7H288v16h-12.5c-13.1 0-16.6.8-18.3 4.4-2 4.5-138.5 216.2-140.4 217.9-1.9 1.6-5.6 1.7-47.9 1.7-31.9 0-46.6.3-48.3 1.1-5.7 2.6-5.5 11.5.3 13.9 1.9.7 16.7 1 50.1.8 46.4-.3 47.6-.3 51.5-2.5 2.2-1.1 5.1-3.3 6.5-4.7 1.3-1.5 10.1-14.7 19.6-29.4l17.1-26.7 18.4-.5c10.1-.3 19.1-.9 20-1.3.9-.5 2.1-1.9 2.8-3.3 1.5-3.4 1.5-35.4 0-38.8-1.1-2.3-4-4-8-4.8-1.3-.2 1.5-5.2 11.5-20.7l13.1-20.5.5 56.5c.3 31 .9 57.1 1.3 58 1.5 3 5.6 3.9 18.2 3.9H256v14c0 14.9.7 18.1 4.7 19.9 1.7.8 34.7 1.1 115.3 1.1s113.6-.3 115.3-1.1c1.4-.6 3-2.2 3.6-3.6 1.5-3.4 1.5-83.2 0-86.6-2.2-4.9-8.6-6.1-12.4-2.2l-2.5 2.4V480H272V272h208v107.1l2.5 2.4c3.8 3.9 10.2 2.7 12.4-2.2 1.5-3.4 1.5-115.2 0-118.6-1.8-3.9-5-4.7-18.4-4.7H464v-40.5c0-27.9-.3-41.2-1.1-42.9-2.6-5.5-11.2-5.5-13.8 0-.8 1.7-1.1 15-1.1 42.9V256h-24v-34.5c0-21.3-.4-36.4-1.1-39.7-3.6-17.3-19.3-32.9-36.7-36.7-16.2-3.4-31.4 1.1-43.3 12.9-7.4 7.3-11.2 13.9-13.4 23.2-1.8 7.9-2.1 50.3-.4 54.2 1.6 3.5 6.1 5.2 9.8 3.7 4.7-2 5.1-4.2 5.1-29.6 0-21.5.2-23.9 2.2-29.2C350.6 168.4 363 160 376 160s25.4 8.4 29.8 20.3c2.1 5.5 2.2 7.4 2.2 40.7v35H304V96h144v24.5c0 16 .4 25.3 1.1 26.9 2.6 5.5 11.2 5.5 13.8 0 .7-1.6 1.1-10.9 1.1-26.9V96h8.5c9.7 0 12.9-1.1 14.6-5.1 2.1-5.2.1-7.5-17.7-20.4C446.2 53.8 445 53 442.1 53c-4.1.1-7.5 3.5-7.5 7.7 0 4 2.2 6.3 14.8 15.3l4.8 3.5-39.1.3c-21.5.1-56.7.1-78.2 0l-39.1-.3 14.9-10.7c8.2-5.9 20.7-15.1 27.8-20.4 14.5-10.8 20.5-14 29.4-15.5 11.6-2.1 22.4 1.3 36.5 11.4 4.3 3.1 9 5.7 10.3 5.7 3.9 0 7.5-4.4 7.1-8.7-.3-3.3-1.1-4.4-7.8-9.6-15.3-11.8-32.3-17.1-47.6-14.7zM96 152v8H64v-16h32v8zm80 0v8h-64v-16h64v8zm48 0v8h-32v-16h32v8zM96 280v104h-4.5c-5.5 0-9 1.5-10.4 4.7-1.5 3.3-1.5 35.4 0 38.7 1.7 3.6 3.1 4 16.2 4.6l11.9.5-5.1 7.7L99 448H64V176h32v104zm80-27.8v76.3l-17.8 27.7-17.7 27.7-14.2.1H112V176h64v76.2zm48-37.3v38.9l-15.6 24.4c-8.6 13.3-15.8 24.5-16 24.7-.2.2-.4-28.2-.4-63.2V176h32v38.9zM256 369v76h-16V317.1l7.8-12c4.2-6.7 7.8-12.1 8-12.1.1 0 .2 34.2.2 76zm-129.1 34.7c-1.2 2.1-3.6 5.7-5.1 8l-2.9 4.3H96v-16h33.2l-2.3 3.7zM192 408v8h-15.1l3.7-5.8c2-3.1 4.4-6.7 5.2-8 .8-1.2 2.4-2.2 3.8-2.2 2.3 0 2.4.2 2.4 8z"></path><path d="M322.5 114.5c-1.6 1.5-2.5 3.6-2.5 5.5s.9 4 2.5 5.5c1.5 1.6 3.6 2.5 5.5 2.5s4-.9 5.5-2.5c1.6-1.5 2.5-3.6 2.5-5.5s-.9-4-2.5-5.5c-1.5-1.6-3.6-2.5-5.5-2.5s-4 .9-5.5 2.5zM418.5 114.5c-1.6 1.5-2.5 3.6-2.5 5.5s.9 4 2.5 5.5c1.5 1.6 3.6 2.5 5.5 2.5s4-.9 5.5-2.5c1.6-1.5 2.5-3.6 2.5-5.5s-.9-4-2.5-5.5c-1.5-1.6-3.6-2.5-5.5-2.5s-4 .9-5.5 2.5zM290.2 290.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6zM450.5 290.5c-5 4.9-1.5 13.5 5.5 13.5 4.1 0 8-3.9 8-8s-3.9-8-8-8c-1.9 0-4 .9-5.5 2.5zM358.1 322c-8.3 2.2-16.5 5.7-19.8 8.6-3.3 2.8-3.9 7.3-1.4 10.6 3.3 4.1 6.4 4.3 13.8.8 23.3-10.9 47.3-7 64.8 10.5 11.5 11.4 16.5 23.6 16.5 39.7 0 15.9-5.1 28.1-16.4 39.4C404.2 443 392.1 448 376 448s-28.1-5-39.5-16.5c-11-11.1-16.5-24.2-16.5-39.5.1-9.5 1.2-14.5 5.6-24.3 3.8-8.3 3.8-10.4.1-14.5-4.7-5.1-10.8-1.7-15.4 8.6-8.6 19.5-8.4 42.7.6 61.7 9.1 19.3 28.3 34.5 49.5 39 11.9 2.6 28.4 1.7 39.3-2.2 23.9-8.6 41.3-27.9 46.9-51.9 1.9-8.5 1.9-24.4-.1-33.1-5.9-25.5-26.7-46.6-52.5-53.3-10.1-2.6-25.8-2.6-35.9 0zM290.2 450.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6zM450.2 450.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6z"></path></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">Jayground8</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">Blog</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-0 left-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><div class="flex justify-end"><button type="button" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2024-07-14T00:00:00.000Z">Sunday, July 14, 2024</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">구글 계정으로 Vault 로그인하기</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2738%27%20height=%2738%27/%3e"/></span><img alt="avatar" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="h-10 w-10 rounded-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="avatar" srcSet="https://jayground8.github.io/static/images/profile.png?w=48&amp;q=75 1x, https://jayground8.github.io/static/images/profile.png?w=96&amp;q=75 2x" src="https://jayground8.github.io/static/images/profile.png?w=96&amp;q=75" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="h-10 w-10 rounded-full" loading="lazy"/></noscript></span><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Jay</dd><dt class="sr-only">Twitter</dt><dd></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><p>Google Workspace를 사용하는 경우 Google 계정으로 통합해서 인증을 하는 것을 고민해볼 수 있다. Vault에서도 인증방법으로 OIDC를 제공하고 있기 때문에, Google 계정으로 인증하여 권한을 받을 수 있다. <a target="_blank" rel="noopener noreferrer" href="https://developer.hashicorp.com/vault/docs/auth/jwt/oidc-providers/google">Vault 문서에서 설정을 어떻게 하는지 친절하게 설명</a>하고 있다. 따라서 간단하게 설정이 완료될 것이라 예상했지만, 이런 저런 삽질을 하면서 또 다른 삽질기가 되었다. 혹시가 동일한 작업을 할 때, 다른 사람들은 시간을 덜 허비하길 바라면서 정리해서 글을 올려본다.</p><p>Oauth2로 인증을 하고, <a target="_blank" rel="noopener noreferrer" href="https://developers.google.com/admin-sdk/directory/reference/rest">Google Workspace Directory API</a>를 통해서 user정보와 group정보를 가져와서 추가적인 조건을 줄 수가 있다. 예를 들어서 Google workspace의 vault group에 있는 계정만 인증에 성공하도록 설정할 수 있다.</p><h2 id="oauth-20-client-생성"><a href="#oauth-20-client-생성" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Oauth 2.0 Client 생성</h2><p><code>GCP 콘솔</code>에서 아래 그림처럼 <code>Web application</code> 타입으로 생성한다.</p><img src="/static/images/vault-oidc-oauth2.png" alt="add Oauth2.0 Client"/><p>redirect url를 아래와 같은 path로 등록을 해준다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">http://localhost:8000/ui/vault/auth/oidc/oidc/callback
</span><span class="code-line">http://localhost:8000/oidc/callback
</span></code></pre></div><h2 id="service-account-생성"><a href="#service-account-생성" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Service Account 생성</h2><p><code>GCP 콘솔</code>에서 Service Account를 생성한다.</p><img src="/static/images/vault-oidc-service-account.png" alt="create new service account"/><h2 id="설정-옵션"><a href="#설정-옵션" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>설정 옵션</h2><p>세 가지 방법으로 Google Workspace의 User와 Group 정보를 가져오는 것을 설정할 수 있다.Role을 연결하는 대신에 domain-wide delegation으로 권한을 주는 것이 관리 측면에서 편하다. 그리고 static하게 service account key 파일을 생성하는 것보다, Refresh Token를 사용하는 Application Default Credentials이 조금 더 보안적으로 유리하다고 본다. 따라서 세 번째 방법으로 설정하는 것을 설명한다.</p><ol><li>service account key를 생성 + 해당 service account에 Role을 부여</li><li>service account key를 생성 + domain-wide delegation 설정</li><li>service account key를 생성하는 대신에 ADC를 이용 + domain-wide delegation 설정</li></ol><h2 id="방법-3"><a href="#방법-3" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>방법 3</h2><h3 id="directory-api-권한-부여"><a href="#directory-api-권한-부여" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Directory API 권한 부여</h3><p>Directory API를 통해서 user와 group정보를 가져오기 위해서 아래와 같은 scope이 설정되어야 한다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">https://www.googleapis.com/auth/admin.directory.group.readonly
</span><span class="code-line">https://www.googleapis.com/auth/admin.directory.user.readonly
</span></code></pre></div><p>Domain wide delegation 방식으로 권한을 부여하기 위해서 아래와 같이 Workspace Admin 콘솔에서 부여한다. 위의 두가지 scope를 사용할 Service Account ID에 추가해준다.</p><img src="/static/images/vault-oidc-domain-wide-delegation.png" alt="Domain Wide Delegation"/><p>생성할 때 Client ID를 Vault OIDC 인증 설정의 impersonate_principal에 사용되는 service account를 사용해야 한다.</p><img src="/static/images/domain-wide-delegation-add.png" alt="Add Scopes with Domain Wide Delegation"/><p>Service Account의 Advanced Settings에 들어가면 아래처럼 Domain-wide Delegation 영역에 Client ID가 나와있다. 이 ClientID를 통해서 Directory API에 접근할 수 있는 scope을 부여한다.</p><img src="/static/images/domain-wide-delegation-config.png" alt="Service Account Advanced Settings"/><h3 id="필요한-service-사용하도록-설정"><a href="#필요한-service-사용하도록-설정" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>필요한 Service 사용하도록 설정</h3><p>ADC(Application Default Credentials)에서 사용할 서비스를 <code>enable</code> 해준다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">gcloud services <span class="token builtin class-name">enable</span> iamcredentials.googleapis.com
</span></code></pre></div><h3 id="service-account에-필요한-권한-부여"><a href="#service-account에-필요한-권한-부여" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Service Account에 필요한 권한 부여</h3><p>ADC(Application Default Credentials) 방법으로 accessToken을 받아오기 위해서는 Service Account에 필요한 권한을 설정해야 한다. 따라서 이미 GCP에 만들어진 Role을 Service Account에 부여해준다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">gcloud projects add-iam-policy-binding <span class="token punctuation">{</span>project ID<span class="token punctuation">}</span> --member<span class="token operator">=</span>serviceAccount:<span class="token punctuation">{</span>service account명<span class="token punctuation">}</span>@<span class="token punctuation">{</span>proejct ID<span class="token punctuation">}</span>.iam.gserviceaccount.com --role<span class="token operator">=</span>roles/iam.serviceAccountTokenCreator
</span><span class="code-line">gcloud projects add-iam-policy-binding <span class="token punctuation">{</span>project ID<span class="token punctuation">}</span> --member<span class="token operator">=</span>serviceAccount:<span class="token punctuation">{</span>service account명<span class="token punctuation">}</span>@<span class="token punctuation">{</span>proejct ID<span class="token punctuation">}</span>.iam.gserviceaccount.com --role<span class="token operator">=</span>roles/iam.serviceAccountUser
</span></code></pre></div><p>ADC를 사용할 때 roles/iam.serviceAccountUser를 부여하지 않아서 계속 권한 에러가 발생했었다. <a target="_blank" rel="noopener noreferrer" href="https://cloud.google.com/iam/docs/service-account-permissions#roles">Service Account를 사용할 때 해당 Role이 부여되어야지 해당 Service Account가 리소스에 접근할 수 있다.</a></p><h3 id="local-adc-파일-생성"><a href="#local-adc-파일-생성" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>local ADC 파일 생성</h3><p>아래와 같은 명령어로 local ADC 파일을 생성할 수 있다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">gcloud auth application-default login --impersonate-service-account <span class="token punctuation">{</span>service account명<span class="token punctuation">}</span>@<span class="token punctuation">{</span>proejct ID<span class="token punctuation">}</span>.iam.gserviceaccount.com
</span></code></pre></div><p>아래와 같은 경로에 파일이 생성된 것을 확인할 수 있다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line"><span class="token function">cat</span> ~/.config/gcloud/application_default_credentials.json
</span></code></pre></div><p>파일은 아래와 같은 값을 가지고 있다. <code>https://iamcredentials</code> 경로로 url이 설정된 것을 볼수가 있고, refresh_token 값도 있는 것을 볼 수가 있다.</p><div class="relative"><pre><code class="code-highlight language-json"><span class="code-line"><span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token property">&quot;delegates&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;service_account_impersonation_url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://iamcredentials.googleapis.com/v1/projects/-/serviceAccounts/{service account명}@{proejct ID}.iam.gserviceaccount.com:generateAccessToken&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;source_credentials&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token property">&quot;account&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;client_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{client ID}&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;client_secret&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{client secret}&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;refresh_token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{refresh Token}&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;authorized_user&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;universe_domain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;googleapis.com&quot;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;impersonated_service_account&quot;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h3 id="vault-설정"><a href="#vault-설정" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Vault 설정</h3><p>Vault를 kubernetes에서 운영하고 있다면 Vault pod에 접근하여 위에서 만든 Local ADC 파일을 동일한 경로로 저장해준다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line"><span class="token function">mkdir</span> -p ~/.config/gcloud
</span><span class="code-line"><span class="token function">vi</span> ~/.config/gcloud/application_default_credentials.json
</span></code></pre></div><p>oidc 설정값을 아래와 같이 설정한다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">vault auth <span class="token builtin class-name">enable</span> oidc
</span><span class="code-line">vault <span class="token function">write</span> auth/oidc/config -<span class="token operator">&lt;&lt;</span><span class="token string">EOF
</span></span><span class="code-line"><span class="token string">{
</span></span><span class="code-line"><span class="token string">    &quot;oidc_discovery_url&quot;: &quot;https://accounts.google.com&quot;,
</span></span><span class="code-line"><span class="token string">    &quot;oidc_client_id&quot;: &quot;{생성한 oauth2 client ID}&quot;,
</span></span><span class="code-line"><span class="token string">    &quot;oidc_client_secret&quot;: &quot;{생성한 oauth2 client secret}&quot;,
</span></span><span class="code-line"><span class="token string">    &quot;default_role&quot;: &quot;sample&quot;,
</span></span><span class="code-line"><span class="token string">    &quot;provider_config&quot;: {
</span></span><span class="code-line"><span class="token string">            &quot;provider&quot;: &quot;gsuite&quot;,
</span></span><span class="code-line"><span class="token string">            &quot;fetch_groups&quot;: true,
</span></span><span class="code-line"><span class="token string">            &quot;groups_recurse_max_depth&quot;: 5,
</span></span><span class="code-line"><span class="token string">            &quot;domain&quot;: &quot;{workspace domain 이름}&quot;,
</span></span><span class="code-line"><span class="token string">            &quot;gsuite_admin_impersonate&quot;: &quot;{구글 계정}&quot;,
</span></span><span class="code-line"><span class="token string">            &quot;impersonate_principal&quot;: &quot;{service account 이름}@{project ID}.iam.gserviceaccount.com&quot;
</span></span><span class="code-line"><span class="token string">    }
</span></span><span class="code-line"><span class="token string">}
</span></span><span class="code-line"><span class="token string">EOF</span>
</span></code></pre></div><p>그리고 role에 대해서 특정 workspace group에 속한 경우만 인증이 되도록 설정한다. <code>user_claim</code>을 email로 하기 위해서는 <code>oidc_scopes</code>에 <code>email</code>를 추가해줘야 한다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">vault <span class="token function">write</span> auth/oidc/role/sample -<span class="token operator">&lt;&lt;</span><span class="token string">EOF
</span></span><span class="code-line"><span class="token string">{
</span></span><span class="code-line"><span class="token string">  &quot;allowed_redirect_uris&quot;: &quot;http://localhost:8000/ui/vault/auth/oidc/oidc/callback,http://localhost:8000/oidc/callback&quot;,
</span></span><span class="code-line"><span class="token string">  &quot;oidc_scopes&quot;: [
</span></span><span class="code-line"><span class="token string">    &quot;openid&quot;,
</span></span><span class="code-line"><span class="token string">    &quot;email&quot;
</span></span><span class="code-line"><span class="token string">  ],
</span></span><span class="code-line"><span class="token string">  &quot;user_claim&quot;: &quot;email&quot;,
</span></span><span class="code-line"><span class="token string">  &quot;groups_claim&quot;: &quot;groups&quot;,
</span></span><span class="code-line"><span class="token string">  &quot;bound_claims&quot;: {
</span></span><span class="code-line"><span class="token string">    &quot;groups&quot;: [&quot;{group명}@{workspace 도메인명}&quot;]
</span></span><span class="code-line"><span class="token string">  }
</span></span><span class="code-line"><span class="token string">}
</span></span><span class="code-line"><span class="token string">EOF</span>
</span></code></pre></div><h3 id="vault-oidc-login"><a href="#vault-oidc-login" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Vault OIDC Login</h3><p>설정이 정상적으로 되었다면 아래의 화면에서 정상적으로 로그인이 된다.</p><img src="/static/images/vault-oidc-ui.png" alt="vault oidc login page"/><h2 id="방법-1"><a href="#방법-1" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>방법 1</h2><h3 id="service-account-key-파일-사용"><a href="#service-account-key-파일-사용" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Service Account key 파일 사용</h3><p>GCP 콘솔에서 Service Account Key를 발급하여 사용한다고 하면 먼저 원하는 경로에 해당 파일을 복사한다. 예를 들어서 Home Directory에 service-account.json 파일로 생성했다면, <code>gsuite_service_account</code>에 해당 경로를 설정한다. 그러면 이제 service account key file을 통해서 Directory API에 접근한다. 이번에는 domain wide delegation 방식으로 권한을 주지 않도록 <code>impersonate_principal</code>와 <code>gsuite_admin_impersonate</code> 설정은 하지 않았다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">vault <span class="token function">write</span> auth/oidc/config -<span class="token operator">&lt;&lt;</span><span class="token string">EOF
</span></span><span class="code-line"><span class="token string">{
</span></span><span class="code-line"><span class="token string">    &quot;oidc_discovery_url&quot;: &quot;https://accounts.google.com&quot;,
</span></span><span class="code-line"><span class="token string">    &quot;oidc_client_id&quot;: &quot;{생성한 oauth2 client ID}&quot;,
</span></span><span class="code-line"><span class="token string">    &quot;oidc_client_secret&quot;: &quot;{생성한 oauth2 client secret}&quot;,
</span></span><span class="code-line"><span class="token string">    &quot;default_role&quot;: &quot;sample&quot;,
</span></span><span class="code-line"><span class="token string">    &quot;provider_config&quot;: {
</span></span><span class="code-line"><span class="token string">            &quot;provider&quot;: &quot;gsuite&quot;,
</span></span><span class="code-line"><span class="token string">            &quot;gsuite_service_account&quot;: &quot;/home/vault/service-account.json&quot;,
</span></span><span class="code-line"><span class="token string">            &quot;fetch_groups&quot;: true,
</span></span><span class="code-line"><span class="token string">            &quot;groups_recurse_max_depth&quot;: 5,
</span></span><span class="code-line"><span class="token string">            &quot;domain&quot;: &quot;{workspace domain 이름}&quot;
</span></span><span class="code-line"><span class="token string">    }
</span></span><span class="code-line"><span class="token string">}
</span></span><span class="code-line"><span class="token string">EOF</span>
</span></code></pre></div><h3 id="role-부여"><a href="#role-부여" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Role 부여</h3><p><a target="_blank" rel="noopener noreferrer" href="https://developers.google.com/admin-sdk/directory/reference/rest/v1/roles/list">아래처럼 웹 페이지의 오른쪽에 있는 창으로 API 요청을 바로 테스트 할 수 있다.</a></p><img src="/static/images/vault-oidc-role.png" alt="Request Role List On Web"/><p>요청을 해보면 Admin Directory Role들이 보이고, 그중에서 필요한 권한이 있는 <code>_GROUPS_ADMIN_ROLE</code>를 사용한다.</p><div class="relative"><pre><code class="code-highlight language-json"><span class="code-line"><span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token property">&quot;kind&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin#directory#role&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;etag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\&quot;d9aT4dOLOjokkvLTmm9XBfjJDibmEEBPEGlwx1-6rsA/iUlV2qBguyme9hsqIzEaTwZJ7J8\&quot;&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;roleId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;39020349843721106&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;roleName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_GROUPS_ADMIN_ROLE&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;roleDescription&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Groups Administrator&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;rolePrivileges&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-line">    <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token property">&quot;privilegeName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;GROUPS_ALL&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;serviceId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;-&quot;</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token property">&quot;privilegeName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;GROUPS_MANAGE_LOCKED_LABEL&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;serviceId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;-&quot;</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token property">&quot;privilegeName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;GROUPS_MANAGE_SECURITY_LABEL&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;serviceId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;-&quot;</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token property">&quot;privilegeName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ORGANIZATION_UNITS_RETRIEVE&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;serviceId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;-&quot;</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token property">&quot;privilegeName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;USERS_RETRIEVE&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;serviceId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;-&quot;</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token property">&quot;privilegeName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ADMIN_DASHBOARD&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token property">&quot;serviceId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;-&quot;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;isSystemRole&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;isSuperAdminRole&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p><a target="_blank" rel="noopener noreferrer" href="https://developers.google.com/admin-sdk/directory/reference/rest/v1/roleAssignments/insert">동일한 방식으로 이제 RoleAssignment API를 웹 화면에서 바로 요청 한다.</a> <code>assignedTo</code>를 service account의 cleint ID를 설정하여 해당 Role이 부여되도록 요청한다.</p><div class="relative"><pre><code class="code-highlight language-json"><span class="code-line"><span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token property">&quot;assignedTo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{service account client ID}&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;roleId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;39020349843721106&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;scopeType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CUSTOMER&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token property">&quot;kind&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin#directory#roleAssignment&quot;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h2 id="결론"><a href="#결론" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>결론</h2><p>Google Workspace를 사용한다면 Vault OIDC 인증 방식을 사용하는 것이 좋겠다. Application Default Credentials방식에서 사용되는 RefreshToken의 만료기간이나 회수조건에 대해서는 더 알아봐야겠지만, Static하게 Service Account Key를 발급받는 것보다는 더 좋은 방법이라고 생각이 든다. 따라서 ADC를 활용해서 설정을 해보고 싶었다. 하지만 그 과정에서 필요한 권한들을 부여하지 않아서 Workspace의 User와 Group 정보를 가져오는데 권한문제가 발생했다. 또 한번 삽질을 통해서 올바른 설정 방법을 알게 되었다.😭</p></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"></div><div id="comment"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/vault">vault</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/devsecops">devsecops</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/20240713-add-package-to-distroless-image">Distroless Image에 Package 추가하기</a></div></div><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/20240825-gcalendar-repeated-events">구글 켈린더 반복 일정을 API 생성/수정/삭제 하는 법</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:jayground8@gmail.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/jayground8"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Jay</div><div> • </div><div>© 2025</div><div> • </div><a href="/">Jayground8</a></div><div class="mb-8 text-sm text-gray-500 dark:text-gray-400"><a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var t=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var i=a=\u003el(a,\"__esModule\",{value:!0});var N=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),u=(a,s)=\u003e{i(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},g=(a,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let n of p(s))!m.call(a,n)\u0026\u0026n!==\"default\"\u0026\u0026l(a,n,{get:()=\u003es[n],enumerable:!(c=d(s,n))||c.enumerable});return a},k=a=\u003eg(i(l(a!=null?t(h(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=N((I,r)=\u003e{r.exports=_jsx_runtime});var A={};u(A,{default:()=\u003ey,frontmatter:()=\u003ev});var e=k(o()),v={title:\"\\uAD6C\\uAE00 \\uACC4\\uC815\\uC73C\\uB85C Vault \\uB85C\\uADF8\\uC778\\uD558\\uAE30\",date:\"2024-07-14\",tags:[\"vault\",\"devsecops\"],images:[\"/static/images/social-banner.png\"],summary:\"Vault\\uB97C \\uAD6C\\uAE00 \\uC778\\uC99D\\uC744 \\uD1B5\\uD574\\uC11C \\uB85C\\uADF8\\uC778\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uD574\\uBCF8\\uB2E4. Admin Directory API\\uB97C \\uD1B5\\uD574\\uC11C workspace\\uC758 user\\uC640 group\\uC758 \\uC815\\uBCF4\\uB97C \\uAC00\\uC838\\uC62C \\uC218 \\uC788\\uACE0, \\uD574\\uB2F9 \\uC815\\uBCF4\\uB97C \\uD1B5\\uD574\\uC11C \\uC778\\uC99D \\uC870\\uAC74\\uC744 \\uCD94\\uAC00\\uD560 \\uC218 \\uC788\\uB2E4. \\uC608\\uB85C \\uD2B9\\uC815 workspace group\\uC5D0 \\uC18D\\uD55C \\uACC4\\uC815\\uB9CC \\uC778\\uC99D\\uC5D0 \\uC131\\uACF5\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D \\uC870\\uAC74\\uC744 \\uCD94\\uAC00\\uD560 \\uC218 \\uC788\\uB2E4. Admin Directory API\\uC5D0 \\uC694\\uCCAD\\uD558\\uAE30 \\uC704\\uD574\\uC11C \\uD544\\uC694\\uD55C \\uAD8C\\uD55C\\uC744 \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB294\\uB370, Service Account\\uC758 key \\uD30C\\uC77C\\uC744 \\uC0DD\\uC131\\uD558\\uB294 \\uB300\\uC2E0\\uC5D0, Application Default Credentials\\uB97C \\uD65C\\uC6A9\\uD574\\uBCF4\\uC558\\uB2E4. Application Default Credentials\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 \\uACFC\\uC815\\uC5D0\\uC11C \\uC0BD\\uC9C8\\uC744 \\uB9CE\\uC774 \\uD588\\uB294\\uB370, \\uD639\\uC2DC\\uB098 \\uB3D9\\uC77C\\uD55C \\uC791\\uC5C5\\uC744 \\uD558\\uB294 \\uBD84\\uB4E4\\uC740 \\uB098\\uCC98\\uB7FC \\uC2DC\\uAC04\\uC744 \\uD5C8\\uBE44\\uD558\\uC9C0 \\uC54A\\uAE30\\uB97C \\uBC14\\uB77C\\uBA70 \\uAE00\\uC744 \\uC791\\uC131\\uD55C\\uB2E4.\\u{1F979}\"};function _(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({p:\"p\",a:\"a\",h2:\"h2\",span:\"span\",code:\"code\",pre:\"pre\",ol:\"ol\",li:\"li\",h3:\"h3\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.p,{children:[\"Google Workspace\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 \\uACBD\\uC6B0 Google \\uACC4\\uC815\\uC73C\\uB85C \\uD1B5\\uD569\\uD574\\uC11C \\uC778\\uC99D\\uC744 \\uD558\\uB294 \\uAC83\\uC744 \\uACE0\\uBBFC\\uD574\\uBCFC \\uC218 \\uC788\\uB2E4. Vault\\uC5D0\\uC11C\\uB3C4 \\uC778\\uC99D\\uBC29\\uBC95\\uC73C\\uB85C OIDC\\uB97C \\uC81C\\uACF5\\uD558\\uACE0 \\uC788\\uAE30 \\uB54C\\uBB38\\uC5D0, Google \\uACC4\\uC815\\uC73C\\uB85C \\uC778\\uC99D\\uD558\\uC5EC \\uAD8C\\uD55C\\uC744 \\uBC1B\\uC744 \\uC218 \\uC788\\uB2E4. \",(0,e.jsx)(n.a,{href:\"https://developer.hashicorp.com/vault/docs/auth/jwt/oidc-providers/google\",children:\"Vault \\uBB38\\uC11C\\uC5D0\\uC11C \\uC124\\uC815\\uC744 \\uC5B4\\uB5BB\\uAC8C \\uD558\\uB294\\uC9C0 \\uCE5C\\uC808\\uD558\\uAC8C \\uC124\\uBA85\"}),\"\\uD558\\uACE0 \\uC788\\uB2E4. \\uB530\\uB77C\\uC11C \\uAC04\\uB2E8\\uD558\\uAC8C \\uC124\\uC815\\uC774 \\uC644\\uB8CC\\uB420 \\uAC83\\uC774\\uB77C \\uC608\\uC0C1\\uD588\\uC9C0\\uB9CC, \\uC774\\uB7F0 \\uC800\\uB7F0 \\uC0BD\\uC9C8\\uC744 \\uD558\\uBA74\\uC11C \\uB610 \\uB2E4\\uB978 \\uC0BD\\uC9C8\\uAE30\\uAC00 \\uB418\\uC5C8\\uB2E4. \\uD639\\uC2DC\\uAC00 \\uB3D9\\uC77C\\uD55C \\uC791\\uC5C5\\uC744 \\uD560 \\uB54C, \\uB2E4\\uB978 \\uC0AC\\uB78C\\uB4E4\\uC740 \\uC2DC\\uAC04\\uC744 \\uB35C \\uD5C8\\uBE44\\uD558\\uAE38 \\uBC14\\uB77C\\uBA74\\uC11C \\uC815\\uB9AC\\uD574\\uC11C \\uAE00\\uC744 \\uC62C\\uB824\\uBCF8\\uB2E4.\"]}),(0,e.jsxs)(n.p,{children:[\"Oauth2\\uB85C \\uC778\\uC99D\\uC744 \\uD558\\uACE0, \",(0,e.jsx)(n.a,{href:\"https://developers.google.com/admin-sdk/directory/reference/rest\",children:\"Google Workspace Directory API\"}),\"\\uB97C \\uD1B5\\uD574\\uC11C user\\uC815\\uBCF4\\uC640 group\\uC815\\uBCF4\\uB97C \\uAC00\\uC838\\uC640\\uC11C \\uCD94\\uAC00\\uC801\\uC778 \\uC870\\uAC74\\uC744 \\uC904 \\uC218\\uAC00 \\uC788\\uB2E4. \\uC608\\uB97C \\uB4E4\\uC5B4\\uC11C Google workspace\\uC758 vault group\\uC5D0 \\uC788\\uB294 \\uACC4\\uC815\\uB9CC \\uC778\\uC99D\\uC5D0 \\uC131\\uACF5\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsxs)(n.h2,{id:\"oauth-20-client-\\uC0DD\\uC131\",children:[(0,e.jsx)(n.a,{href:\"#oauth-20-client-\\uC0DD\\uC131\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Oauth 2.0 Client \\uC0DD\\uC131\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"GCP \\uCF58\\uC194\"}),\"\\uC5D0\\uC11C \\uC544\\uB798 \\uADF8\\uB9BC\\uCC98\\uB7FC \",(0,e.jsx)(n.code,{children:\"Web application\"}),\" \\uD0C0\\uC785\\uC73C\\uB85C \\uC0DD\\uC131\\uD55C\\uB2E4.\"]}),(0,e.jsx)(\"img\",{src:\"/static/images/vault-oidc-oauth2.png\",alt:\"add Oauth2.0 Client\"}),(0,e.jsx)(n.p,{children:\"redirect url\\uB97C \\uC544\\uB798\\uC640 \\uAC19\\uC740 path\\uB85C \\uB4F1\\uB85D\\uC744 \\uD574\\uC900\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`http://localhost:8000/ui/vault/auth/oidc/oidc/callback\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`http://localhost:8000/oidc/callback\n`})]})}),(0,e.jsxs)(n.h2,{id:\"service-account-\\uC0DD\\uC131\",children:[(0,e.jsx)(n.a,{href:\"#service-account-\\uC0DD\\uC131\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Service Account \\uC0DD\\uC131\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"GCP \\uCF58\\uC194\"}),\"\\uC5D0\\uC11C Service Account\\uB97C \\uC0DD\\uC131\\uD55C\\uB2E4.\"]}),(0,e.jsx)(\"img\",{src:\"/static/images/vault-oidc-service-account.png\",alt:\"create new service account\"}),(0,e.jsxs)(n.h2,{id:\"\\uC124\\uC815-\\uC635\\uC158\",children:[(0,e.jsx)(n.a,{href:\"#\\uC124\\uC815-\\uC635\\uC158\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uC124\\uC815 \\uC635\\uC158\"]}),(0,e.jsx)(n.p,{children:\"\\uC138 \\uAC00\\uC9C0 \\uBC29\\uBC95\\uC73C\\uB85C Google Workspace\\uC758 User\\uC640 Group \\uC815\\uBCF4\\uB97C \\uAC00\\uC838\\uC624\\uB294 \\uAC83\\uC744 \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB2E4.Role\\uC744 \\uC5F0\\uACB0\\uD558\\uB294 \\uB300\\uC2E0\\uC5D0 domain-wide delegation\\uC73C\\uB85C \\uAD8C\\uD55C\\uC744 \\uC8FC\\uB294 \\uAC83\\uC774 \\uAD00\\uB9AC \\uCE21\\uBA74\\uC5D0\\uC11C \\uD3B8\\uD558\\uB2E4. \\uADF8\\uB9AC\\uACE0 static\\uD558\\uAC8C service account key \\uD30C\\uC77C\\uC744 \\uC0DD\\uC131\\uD558\\uB294 \\uAC83\\uBCF4\\uB2E4, Refresh Token\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 Application Default Credentials\\uC774 \\uC870\\uAE08 \\uB354 \\uBCF4\\uC548\\uC801\\uC73C\\uB85C \\uC720\\uB9AC\\uD558\\uB2E4\\uACE0 \\uBCF8\\uB2E4. \\uB530\\uB77C\\uC11C \\uC138 \\uBC88\\uC9F8 \\uBC29\\uBC95\\uC73C\\uB85C \\uC124\\uC815\\uD558\\uB294 \\uAC83\\uC744 \\uC124\\uBA85\\uD55C\\uB2E4.\"}),(0,e.jsxs)(n.ol,{children:[(0,e.jsx)(n.li,{children:\"service account key\\uB97C \\uC0DD\\uC131 + \\uD574\\uB2F9 service account\\uC5D0 Role\\uC744 \\uBD80\\uC5EC\"}),(0,e.jsx)(n.li,{children:\"service account key\\uB97C \\uC0DD\\uC131 + domain-wide delegation \\uC124\\uC815\"}),(0,e.jsx)(n.li,{children:\"service account key\\uB97C \\uC0DD\\uC131\\uD558\\uB294 \\uB300\\uC2E0\\uC5D0 ADC\\uB97C \\uC774\\uC6A9 + domain-wide delegation \\uC124\\uC815\"})]}),(0,e.jsxs)(n.h2,{id:\"\\uBC29\\uBC95-3\",children:[(0,e.jsx)(n.a,{href:\"#\\uBC29\\uBC95-3\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uBC29\\uBC95 3\"]}),(0,e.jsxs)(n.h3,{id:\"directory-api-\\uAD8C\\uD55C-\\uBD80\\uC5EC\",children:[(0,e.jsx)(n.a,{href:\"#directory-api-\\uAD8C\\uD55C-\\uBD80\\uC5EC\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Directory API \\uAD8C\\uD55C \\uBD80\\uC5EC\"]}),(0,e.jsx)(n.p,{children:\"Directory API\\uB97C \\uD1B5\\uD574\\uC11C user\\uC640 group\\uC815\\uBCF4\\uB97C \\uAC00\\uC838\\uC624\\uAE30 \\uC704\\uD574\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC740 scope\\uC774 \\uC124\\uC815\\uB418\\uC5B4\\uC57C \\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`https://www.googleapis.com/auth/admin.directory.group.readonly\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`https://www.googleapis.com/auth/admin.directory.user.readonly\n`})]})}),(0,e.jsx)(n.p,{children:\"Domain wide delegation \\uBC29\\uC2DD\\uC73C\\uB85C \\uAD8C\\uD55C\\uC744 \\uBD80\\uC5EC\\uD558\\uAE30 \\uC704\\uD574\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC774 Workspace Admin \\uCF58\\uC194\\uC5D0\\uC11C \\uBD80\\uC5EC\\uD55C\\uB2E4. \\uC704\\uC758 \\uB450\\uAC00\\uC9C0 scope\\uB97C \\uC0AC\\uC6A9\\uD560 Service Account ID\\uC5D0 \\uCD94\\uAC00\\uD574\\uC900\\uB2E4.\"}),(0,e.jsx)(\"img\",{src:\"/static/images/vault-oidc-domain-wide-delegation.png\",alt:\"Domain Wide Delegation\"}),(0,e.jsx)(n.p,{children:\"\\uC0DD\\uC131\\uD560 \\uB54C Client ID\\uB97C Vault OIDC \\uC778\\uC99D \\uC124\\uC815\\uC758 impersonate_principal\\uC5D0 \\uC0AC\\uC6A9\\uB418\\uB294 service account\\uB97C \\uC0AC\\uC6A9\\uD574\\uC57C \\uD55C\\uB2E4.\"}),(0,e.jsx)(\"img\",{src:\"/static/images/domain-wide-delegation-add.png\",alt:\"Add Scopes with Domain Wide Delegation\"}),(0,e.jsx)(n.p,{children:\"Service Account\\uC758 Advanced Settings\\uC5D0 \\uB4E4\\uC5B4\\uAC00\\uBA74 \\uC544\\uB798\\uCC98\\uB7FC Domain-wide Delegation \\uC601\\uC5ED\\uC5D0 Client ID\\uAC00 \\uB098\\uC640\\uC788\\uB2E4. \\uC774 ClientID\\uB97C \\uD1B5\\uD574\\uC11C Directory API\\uC5D0 \\uC811\\uADFC\\uD560 \\uC218 \\uC788\\uB294 scope\\uC744 \\uBD80\\uC5EC\\uD55C\\uB2E4.\"}),(0,e.jsx)(\"img\",{src:\"/static/images/domain-wide-delegation-config.png\",alt:\"Service Account Advanced Settings\"}),(0,e.jsxs)(n.h3,{id:\"\\uD544\\uC694\\uD55C-service-\\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D-\\uC124\\uC815\",children:[(0,e.jsx)(n.a,{href:\"#\\uD544\\uC694\\uD55C-service-\\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D-\\uC124\\uC815\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uD544\\uC694\\uD55C Service \\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D \\uC124\\uC815\"]}),(0,e.jsxs)(n.p,{children:[\"ADC(Application Default Credentials)\\uC5D0\\uC11C \\uC0AC\\uC6A9\\uD560 \\uC11C\\uBE44\\uC2A4\\uB97C \",(0,e.jsx)(n.code,{children:\"enable\"}),\" \\uD574\\uC900\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gcloud services \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"enable\"}),` iamcredentials.googleapis.com\n`]})})}),(0,e.jsxs)(n.h3,{id:\"service-account\\uC5D0-\\uD544\\uC694\\uD55C-\\uAD8C\\uD55C-\\uBD80\\uC5EC\",children:[(0,e.jsx)(n.a,{href:\"#service-account\\uC5D0-\\uD544\\uC694\\uD55C-\\uAD8C\\uD55C-\\uBD80\\uC5EC\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Service Account\\uC5D0 \\uD544\\uC694\\uD55C \\uAD8C\\uD55C \\uBD80\\uC5EC\"]}),(0,e.jsx)(n.p,{children:\"ADC(Application Default Credentials) \\uBC29\\uBC95\\uC73C\\uB85C accessToken\\uC744 \\uBC1B\\uC544\\uC624\\uAE30 \\uC704\\uD574\\uC11C\\uB294 Service Account\\uC5D0 \\uD544\\uC694\\uD55C \\uAD8C\\uD55C\\uC744 \\uC124\\uC815\\uD574\\uC57C \\uD55C\\uB2E4. \\uB530\\uB77C\\uC11C \\uC774\\uBBF8 GCP\\uC5D0 \\uB9CC\\uB4E4\\uC5B4\\uC9C4 Role\\uC744 Service Account\\uC5D0 \\uBD80\\uC5EC\\uD574\\uC900\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gcloud projects add-iam-policy-binding \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"project ID\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" --member\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"serviceAccount:\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"service account\\uBA85\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\"@\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"proejct ID\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\".iam.gserviceaccount.com --role\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`roles/iam.serviceAccountTokenCreator\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gcloud projects add-iam-policy-binding \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"project ID\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" --member\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"serviceAccount:\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"service account\\uBA85\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\"@\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"proejct ID\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\".iam.gserviceaccount.com --role\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`roles/iam.serviceAccountUser\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"ADC\\uB97C \\uC0AC\\uC6A9\\uD560 \\uB54C roles/iam.serviceAccountUser\\uB97C \\uBD80\\uC5EC\\uD558\\uC9C0 \\uC54A\\uC544\\uC11C \\uACC4\\uC18D \\uAD8C\\uD55C \\uC5D0\\uB7EC\\uAC00 \\uBC1C\\uC0DD\\uD588\\uC5C8\\uB2E4. \",(0,e.jsx)(n.a,{href:\"https://cloud.google.com/iam/docs/service-account-permissions#roles\",children:\"Service Account\\uB97C \\uC0AC\\uC6A9\\uD560 \\uB54C \\uD574\\uB2F9 Role\\uC774 \\uBD80\\uC5EC\\uB418\\uC5B4\\uC57C\\uC9C0 \\uD574\\uB2F9 Service Account\\uAC00 \\uB9AC\\uC18C\\uC2A4\\uC5D0 \\uC811\\uADFC\\uD560 \\uC218 \\uC788\\uB2E4.\"})]}),(0,e.jsxs)(n.h3,{id:\"local-adc-\\uD30C\\uC77C-\\uC0DD\\uC131\",children:[(0,e.jsx)(n.a,{href:\"#local-adc-\\uD30C\\uC77C-\\uC0DD\\uC131\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"local ADC \\uD30C\\uC77C \\uC0DD\\uC131\"]}),(0,e.jsx)(n.p,{children:\"\\uC544\\uB798\\uC640 \\uAC19\\uC740 \\uBA85\\uB839\\uC5B4\\uB85C local ADC \\uD30C\\uC77C\\uC744 \\uC0DD\\uC131\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gcloud auth application-default login --impersonate-service-account \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"service account\\uBA85\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\"@\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"proejct ID\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`.iam.gserviceaccount.com\n`]})})}),(0,e.jsx)(n.p,{children:\"\\uC544\\uB798\\uC640 \\uAC19\\uC740 \\uACBD\\uB85C\\uC5D0 \\uD30C\\uC77C\\uC774 \\uC0DD\\uC131\\uB41C \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"cat\"}),` ~/.config/gcloud/application_default_credentials.json\n`]})})}),(0,e.jsxs)(n.p,{children:[\"\\uD30C\\uC77C\\uC740 \\uC544\\uB798\\uC640 \\uAC19\\uC740 \\uAC12\\uC744 \\uAC00\\uC9C0\\uACE0 \\uC788\\uB2E4. \",(0,e.jsx)(n.code,{children:\"https://iamcredentials\"}),\" \\uACBD\\uB85C\\uB85C url\\uC774 \\uC124\\uC815\\uB41C \\uAC83\\uC744 \\uBCFC\\uC218\\uAC00 \\uC788\\uACE0, refresh_token \\uAC12\\uB3C4 \\uC788\\uB294 \\uAC83\\uC744 \\uBCFC \\uC218\\uAC00 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-json\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-json\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"delegates\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"service_account_impersonation_url\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"https://iamcredentials.googleapis.com/v1/projects/-/serviceAccounts/{service account\\uBA85}@{proejct ID}.iam.gserviceaccount.com:generateAccessToken\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"source_credentials\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"account\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"client_id\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"{client ID}\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"client_secret\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"{client secret}\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"refresh_token\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"{refresh Token}\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"type\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"authorized_user\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"universe_domain\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"googleapis.com\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"type\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"impersonated_service_account\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"vault-\\uC124\\uC815\",children:[(0,e.jsx)(n.a,{href:\"#vault-\\uC124\\uC815\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Vault \\uC124\\uC815\"]}),(0,e.jsx)(n.p,{children:\"Vault\\uB97C kubernetes\\uC5D0\\uC11C \\uC6B4\\uC601\\uD558\\uACE0 \\uC788\\uB2E4\\uBA74 Vault pod\\uC5D0 \\uC811\\uADFC\\uD558\\uC5EC \\uC704\\uC5D0\\uC11C \\uB9CC\\uB4E0 Local ADC \\uD30C\\uC77C\\uC744 \\uB3D9\\uC77C\\uD55C \\uACBD\\uB85C\\uB85C \\uC800\\uC7A5\\uD574\\uC900\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"mkdir\"}),` -p ~/.config/gcloud\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"vi\"}),` ~/.config/gcloud/application_default_credentials.json\n`]})]})}),(0,e.jsx)(n.p,{children:\"oidc \\uC124\\uC815\\uAC12\\uC744 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC124\\uC815\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"vault auth \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"enable\"}),` oidc\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"vault \",(0,e.jsx)(n.span,{className:\"token function\",children:\"write\"}),\" auth/oidc/config -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\u003c\"}),(0,e.jsx)(n.span,{className:\"token string\",children:`EOF\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`{\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"oidc_discovery_url\": \"https://accounts.google.com\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"oidc_client_id\": \"{\\uC0DD\\uC131\\uD55C oauth2 client ID}\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"oidc_client_secret\": \"{\\uC0DD\\uC131\\uD55C oauth2 client secret}\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"default_role\": \"sample\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"provider_config\": {\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"provider\": \"gsuite\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"fetch_groups\": true,\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"groups_recurse_max_depth\": 5,\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"domain\": \"{workspace domain \\uC774\\uB984}\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"gsuite_admin_impersonate\": \"{\\uAD6C\\uAE00 \\uACC4\\uC815}\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"impersonate_principal\": \"{service account \\uC774\\uB984}@{project ID}.iam.gserviceaccount.com\"\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    }\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`}\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:\"EOF\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB9AC\\uACE0 role\\uC5D0 \\uB300\\uD574\\uC11C \\uD2B9\\uC815 workspace group\\uC5D0 \\uC18D\\uD55C \\uACBD\\uC6B0\\uB9CC \\uC778\\uC99D\\uC774 \\uB418\\uB3C4\\uB85D \\uC124\\uC815\\uD55C\\uB2E4. \",(0,e.jsx)(n.code,{children:\"user_claim\"}),\"\\uC744 email\\uB85C \\uD558\\uAE30 \\uC704\\uD574\\uC11C\\uB294 \",(0,e.jsx)(n.code,{children:\"oidc_scopes\"}),\"\\uC5D0 \",(0,e.jsx)(n.code,{children:\"email\"}),\"\\uB97C \\uCD94\\uAC00\\uD574\\uC918\\uC57C \\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"vault \",(0,e.jsx)(n.span,{className:\"token function\",children:\"write\"}),\" auth/oidc/role/sample -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\u003c\"}),(0,e.jsx)(n.span,{className:\"token string\",children:`EOF\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`{\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  \"allowed_redirect_uris\": \"http://localhost:8000/ui/vault/auth/oidc/oidc/callback,http://localhost:8000/oidc/callback\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  \"oidc_scopes\": [\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"openid\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"email\"\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  ],\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  \"user_claim\": \"email\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  \"groups_claim\": \"groups\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  \"bound_claims\": {\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"groups\": [\"{group\\uBA85}@{workspace \\uB3C4\\uBA54\\uC778\\uBA85}\"]\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  }\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`}\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:\"EOF\"}),`\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"vault-oidc-login\",children:[(0,e.jsx)(n.a,{href:\"#vault-oidc-login\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Vault OIDC Login\"]}),(0,e.jsx)(n.p,{children:\"\\uC124\\uC815\\uC774 \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uB418\\uC5C8\\uB2E4\\uBA74 \\uC544\\uB798\\uC758 \\uD654\\uBA74\\uC5D0\\uC11C \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uB85C\\uADF8\\uC778\\uC774 \\uB41C\\uB2E4.\"}),(0,e.jsx)(\"img\",{src:\"/static/images/vault-oidc-ui.png\",alt:\"vault oidc login page\"}),(0,e.jsxs)(n.h2,{id:\"\\uBC29\\uBC95-1\",children:[(0,e.jsx)(n.a,{href:\"#\\uBC29\\uBC95-1\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uBC29\\uBC95 1\"]}),(0,e.jsxs)(n.h3,{id:\"service-account-key-\\uD30C\\uC77C-\\uC0AC\\uC6A9\",children:[(0,e.jsx)(n.a,{href:\"#service-account-key-\\uD30C\\uC77C-\\uC0AC\\uC6A9\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Service Account key \\uD30C\\uC77C \\uC0AC\\uC6A9\"]}),(0,e.jsxs)(n.p,{children:[\"GCP \\uCF58\\uC194\\uC5D0\\uC11C Service Account Key\\uB97C \\uBC1C\\uAE09\\uD558\\uC5EC \\uC0AC\\uC6A9\\uD55C\\uB2E4\\uACE0 \\uD558\\uBA74 \\uBA3C\\uC800 \\uC6D0\\uD558\\uB294 \\uACBD\\uB85C\\uC5D0 \\uD574\\uB2F9 \\uD30C\\uC77C\\uC744 \\uBCF5\\uC0AC\\uD55C\\uB2E4. \\uC608\\uB97C \\uB4E4\\uC5B4\\uC11C Home Directory\\uC5D0 service-account.json \\uD30C\\uC77C\\uB85C \\uC0DD\\uC131\\uD588\\uB2E4\\uBA74, \",(0,e.jsx)(n.code,{children:\"gsuite_service_account\"}),\"\\uC5D0 \\uD574\\uB2F9 \\uACBD\\uB85C\\uB97C \\uC124\\uC815\\uD55C\\uB2E4. \\uADF8\\uB7EC\\uBA74 \\uC774\\uC81C service account key file\\uC744 \\uD1B5\\uD574\\uC11C Directory API\\uC5D0 \\uC811\\uADFC\\uD55C\\uB2E4. \\uC774\\uBC88\\uC5D0\\uB294 domain wide delegation \\uBC29\\uC2DD\\uC73C\\uB85C \\uAD8C\\uD55C\\uC744 \\uC8FC\\uC9C0 \\uC54A\\uB3C4\\uB85D \",(0,e.jsx)(n.code,{children:\"impersonate_principal\"}),\"\\uC640 \",(0,e.jsx)(n.code,{children:\"gsuite_admin_impersonate\"}),\" \\uC124\\uC815\\uC740 \\uD558\\uC9C0 \\uC54A\\uC558\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"vault \",(0,e.jsx)(n.span,{className:\"token function\",children:\"write\"}),\" auth/oidc/config -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\u003c\"}),(0,e.jsx)(n.span,{className:\"token string\",children:`EOF\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`{\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"oidc_discovery_url\": \"https://accounts.google.com\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"oidc_client_id\": \"{\\uC0DD\\uC131\\uD55C oauth2 client ID}\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"oidc_client_secret\": \"{\\uC0DD\\uC131\\uD55C oauth2 client secret}\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"default_role\": \"sample\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"provider_config\": {\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"provider\": \"gsuite\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"gsuite_service_account\": \"/home/vault/service-account.json\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"fetch_groups\": true,\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"groups_recurse_max_depth\": 5,\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"domain\": \"{workspace domain \\uC774\\uB984}\"\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    }\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`}\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:\"EOF\"}),`\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"role-\\uBD80\\uC5EC\",children:[(0,e.jsx)(n.a,{href:\"#role-\\uBD80\\uC5EC\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Role \\uBD80\\uC5EC\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.a,{href:\"https://developers.google.com/admin-sdk/directory/reference/rest/v1/roles/list\",children:\"\\uC544\\uB798\\uCC98\\uB7FC \\uC6F9 \\uD398\\uC774\\uC9C0\\uC758 \\uC624\\uB978\\uCABD\\uC5D0 \\uC788\\uB294 \\uCC3D\\uC73C\\uB85C API \\uC694\\uCCAD\\uC744 \\uBC14\\uB85C \\uD14C\\uC2A4\\uD2B8 \\uD560 \\uC218 \\uC788\\uB2E4.\"})}),(0,e.jsx)(\"img\",{src:\"/static/images/vault-oidc-role.png\",alt:\"Request Role List On Web\"}),(0,e.jsxs)(n.p,{children:[\"\\uC694\\uCCAD\\uC744 \\uD574\\uBCF4\\uBA74 Admin Directory Role\\uB4E4\\uC774 \\uBCF4\\uC774\\uACE0, \\uADF8\\uC911\\uC5D0\\uC11C \\uD544\\uC694\\uD55C \\uAD8C\\uD55C\\uC774 \\uC788\\uB294 \",(0,e.jsx)(n.code,{children:\"_GROUPS_ADMIN_ROLE\"}),\"\\uB97C \\uC0AC\\uC6A9\\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-json\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-json\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"kind\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"admin#directory#role\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"etag\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\\\\\"d9aT4dOLOjokkvLTmm9XBfjJDibmEEBPEGlwx1-6rsA/iUlV2qBguyme9hsqIzEaTwZJ7J8\\\\\"\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"roleId\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"39020349843721106\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"roleName\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"_GROUPS_ADMIN_ROLE\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"roleDescription\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Groups Administrator\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"rolePrivileges\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"privilegeName\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"GROUPS_ALL\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"serviceId\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"-\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"privilegeName\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"GROUPS_MANAGE_LOCKED_LABEL\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"serviceId\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"-\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"privilegeName\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"GROUPS_MANAGE_SECURITY_LABEL\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"serviceId\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"-\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"privilegeName\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"ORGANIZATION_UNITS_RETRIEVE\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"serviceId\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"-\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"privilegeName\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"USERS_RETRIEVE\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"serviceId\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"-\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"privilegeName\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"ADMIN_DASHBOARD\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"serviceId\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"-\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"isSystemRole\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"isSuperAdminRole\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"false\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://developers.google.com/admin-sdk/directory/reference/rest/v1/roleAssignments/insert\",children:\"\\uB3D9\\uC77C\\uD55C \\uBC29\\uC2DD\\uC73C\\uB85C \\uC774\\uC81C RoleAssignment API\\uB97C \\uC6F9 \\uD654\\uBA74\\uC5D0\\uC11C \\uBC14\\uB85C \\uC694\\uCCAD \\uD55C\\uB2E4.\"}),\" \",(0,e.jsx)(n.code,{children:\"assignedTo\"}),\"\\uB97C service account\\uC758 cleint ID\\uB97C \\uC124\\uC815\\uD558\\uC5EC \\uD574\\uB2F9 Role\\uC774 \\uBD80\\uC5EC\\uB418\\uB3C4\\uB85D \\uC694\\uCCAD\\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-json\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-json\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"assignedTo\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"{service account client ID}\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"roleId\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"39020349843721106\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"scopeType\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"CUSTOMER\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"kind\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"admin#directory#roleAssignment\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"\\uACB0\\uB860\",children:[(0,e.jsx)(n.a,{href:\"#\\uACB0\\uB860\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uACB0\\uB860\"]}),(0,e.jsx)(n.p,{children:\"Google Workspace\\uB97C \\uC0AC\\uC6A9\\uD55C\\uB2E4\\uBA74 Vault OIDC \\uC778\\uC99D \\uBC29\\uC2DD\\uC744 \\uC0AC\\uC6A9\\uD558\\uB294 \\uAC83\\uC774 \\uC88B\\uACA0\\uB2E4. Application Default Credentials\\uBC29\\uC2DD\\uC5D0\\uC11C \\uC0AC\\uC6A9\\uB418\\uB294 RefreshToken\\uC758 \\uB9CC\\uB8CC\\uAE30\\uAC04\\uC774\\uB098 \\uD68C\\uC218\\uC870\\uAC74\\uC5D0 \\uB300\\uD574\\uC11C\\uB294 \\uB354 \\uC54C\\uC544\\uBD10\\uC57C\\uACA0\\uC9C0\\uB9CC, Static\\uD558\\uAC8C Service Account Key\\uB97C \\uBC1C\\uAE09\\uBC1B\\uB294 \\uAC83\\uBCF4\\uB2E4\\uB294 \\uB354 \\uC88B\\uC740 \\uBC29\\uBC95\\uC774\\uB77C\\uACE0 \\uC0DD\\uAC01\\uC774 \\uB4E0\\uB2E4. \\uB530\\uB77C\\uC11C ADC\\uB97C \\uD65C\\uC6A9\\uD574\\uC11C \\uC124\\uC815\\uC744 \\uD574\\uBCF4\\uACE0 \\uC2F6\\uC5C8\\uB2E4. \\uD558\\uC9C0\\uB9CC \\uADF8 \\uACFC\\uC815\\uC5D0\\uC11C \\uD544\\uC694\\uD55C \\uAD8C\\uD55C\\uB4E4\\uC744 \\uBD80\\uC5EC\\uD558\\uC9C0 \\uC54A\\uC544\\uC11C Workspace\\uC758 User\\uC640 Group \\uC815\\uBCF4\\uB97C \\uAC00\\uC838\\uC624\\uB294\\uB370 \\uAD8C\\uD55C\\uBB38\\uC81C\\uAC00 \\uBC1C\\uC0DD\\uD588\\uB2E4. \\uB610 \\uD55C\\uBC88 \\uC0BD\\uC9C8\\uC744 \\uD1B5\\uD574\\uC11C \\uC62C\\uBC14\\uB978 \\uC124\\uC815 \\uBC29\\uBC95\\uC744 \\uC54C\\uAC8C \\uB418\\uC5C8\\uB2E4.\\u{1F62D}\"})]})}}var y=_;return A;})();\n;return Component;","toc":[{"value":"Oauth 2.0 Client 생성","url":"#oauth-20-client-생성","depth":2},{"value":"Service Account 생성","url":"#service-account-생성","depth":2},{"value":"설정 옵션","url":"#설정-옵션","depth":2},{"value":"방법 3","url":"#방법-3","depth":2},{"value":"Directory API 권한 부여","url":"#directory-api-권한-부여","depth":3},{"value":"필요한 Service 사용하도록 설정","url":"#필요한-service-사용하도록-설정","depth":3},{"value":"Service Account에 필요한 권한 부여","url":"#service-account에-필요한-권한-부여","depth":3},{"value":"local ADC 파일 생성","url":"#local-adc-파일-생성","depth":3},{"value":"Vault 설정","url":"#vault-설정","depth":3},{"value":"Vault OIDC Login","url":"#vault-oidc-login","depth":3},{"value":"방법 1","url":"#방법-1","depth":2},{"value":"Service Account key 파일 사용","url":"#service-account-key-파일-사용","depth":3},{"value":"Role 부여","url":"#role-부여","depth":3},{"value":"결론","url":"#결론","depth":2}],"frontMatter":{"readingTime":{"text":"7 min read","minutes":6.32,"time":379200,"words":1264},"slug":"20240714-vault-oidc","fileName":"20240714-vault-oidc.md","title":"구글 계정으로 Vault 로그인하기","date":"2024-07-14T00:00:00.000Z","tags":["vault","devsecops"],"images":["/static/images/social-banner.png"],"summary":"Vault를 구글 인증을 통해서 로그인하도록 설정해본다. Admin Directory API를 통해서 workspace의 user와 group의 정보를 가져올 수 있고, 해당 정보를 통해서 인증 조건을 추가할 수 있다. 예로 특정 workspace group에 속한 계정만 인증에 성공할 수 있도록 조건을 추가할 수 있다. Admin Directory API에 요청하기 위해서 필요한 권한을 설정할 수 있는데, Service Account의 key 파일을 생성하는 대신에, Application Default Credentials를 활용해보았다. Application Default Credentials를 사용하는 과정에서 삽질을 많이 했는데, 혹시나 동일한 작업을 하는 분들은 나처럼 시간을 허비하지 않기를 바라며 글을 작성한다.🥹"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.15,"time":9000,"words":30},"slug":["default"],"fileName":"default.md","name":"Jay","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"Distroless Image에 Package 추가하기","date":"2024-07-13T00:00:00.000Z","tags":["kubernetes","distroless","devsecops"],"images":["/static/images/social-banner.png"],"summary":"컨테이너 이미지에 최소한으로 필요한 software만 포함하는 것이 보안적으로 모범사례이다. 이러한 모범사례를 따르는 가장 쉽고 합리적인 방법은 구글에서 제공하는 Distroless Image를 활용하는 것이다. Distroless Image는 nonroot, debug, debug-nonroot Tag를 가지고 있다. nonroot은 conatiner에게 root 권한을 주지않고, shell도 없어서 Terminal로 접속이 불가능하다. 그런데 Distroless Image에 추가로 필요한 debian package를 설치하면 어떻게 해야할까? 이번 글에서는 bazel로 빌드할 때 원하는 debian package를 추가하는 방법을 알아 본다.","slug":"20240713-add-package-to-distroless-image"},"next":{"title":"구글 켈린더 반복 일정을 API 생성/수정/삭제 하는 법","date":"2024-08-25T00:00:00.000Z","tags":["development"],"images":["/static/images/social-banner.png"],"summary":"구글 켈린더에서 RFC 5545로 정의된 값으로 반복일정을 생성할 수 있다. 그런데 구글 켈린더의 반복 일정을 API로 생성/수정/삭제 하는 과정에서 삽질을 하게 되었다.😂 혹시나 누군가 구글 켈린더 반복일정을 API로 수정/변경/삭제 해야하는 경우, 이 블로그 글을 통해서 불필요하게 삽질을 하지 않기 바라며 작성했다. 반복일정을 수정/삭제 할 때 선택하는 세 가지 옵션(이 일정, 모든 일정, 이 일정 및 향후 일정)에 따라서 이벤트 id를 다르게 설정하여 요청해야 한다.","slug":"20240825-gcalendar-repeated-events"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["20240714-vault-oidc"]},"buildId":"pgk04D_iZGZPDfMeQaKFq","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>