<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="manifest" href="/jayground8/static/favicons/manifest.json"/><link rel="manifest" href="/jayground8/static/favicons/site.webmanifest"/><link rel="shortcut icon" href="/jayground8/static/favicons/favicon.ico"/><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8773084925406986" crossorigin="anonymous"></script><title>k8s-device-plugin으로 NVIDIA GPU Multi-Process Service 사용하기</title><meta name="robots" content="follow, index"/><meta name="description" content="Kubernetes에서 k8s-device-plugin을 통해서 NVIDIA GPU 자원을 쉽게 사용할 수 있다. 하나의 어플리케이션에서 GPU 자원을 온전히 사용하지 못하고 낭비될 때, Time slicing, MPS, MIG 등을 사용하여 여러 프로세스가 GPU 자원을 공유하도록 설정할 수 있다. 네이버 공공 클라우드에서 Tesla T4와 Telsa V100을 제공한다. 해당 GPU 아키텍쳐가 MIG을 지원히지 않기 때문에, MPS를 적용하여 GPU 자원을 공유하는 것을 고려하였다. 최근에 release된 k8s-device-plugin v0.15.0-rc.1부터 MPS가 지원되기 시작되어 해당 버전으로 MPS를 설정해보았다."/><meta property="og:url" content="https://jayground8.github.io/blog/20240324-k8s-device-plugin"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Jayground8"/><meta property="og:description" content="Kubernetes에서 k8s-device-plugin을 통해서 NVIDIA GPU 자원을 쉽게 사용할 수 있다. 하나의 어플리케이션에서 GPU 자원을 온전히 사용하지 못하고 낭비될 때, Time slicing, MPS, MIG 등을 사용하여 여러 프로세스가 GPU 자원을 공유하도록 설정할 수 있다. 네이버 공공 클라우드에서 Tesla T4와 Telsa V100을 제공한다. 해당 GPU 아키텍쳐가 MIG을 지원히지 않기 때문에, MPS를 적용하여 GPU 자원을 공유하는 것을 고려하였다. 최근에 release된 k8s-device-plugin v0.15.0-rc.1부터 MPS가 지원되기 시작되어 해당 버전으로 MPS를 설정해보았다."/><meta property="og:title" content="k8s-device-plugin으로 NVIDIA GPU Multi-Process Service 사용하기"/><meta property="og:image" content="https://jayground8.github.io/static/images/social-banner.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site"/><meta name="twitter:title" content="k8s-device-plugin으로 NVIDIA GPU Multi-Process Service 사용하기"/><meta name="twitter:description" content="Kubernetes에서 k8s-device-plugin을 통해서 NVIDIA GPU 자원을 쉽게 사용할 수 있다. 하나의 어플리케이션에서 GPU 자원을 온전히 사용하지 못하고 낭비될 때, Time slicing, MPS, MIG 등을 사용하여 여러 프로세스가 GPU 자원을 공유하도록 설정할 수 있다. 네이버 공공 클라우드에서 Tesla T4와 Telsa V100을 제공한다. 해당 GPU 아키텍쳐가 MIG을 지원히지 않기 때문에, MPS를 적용하여 GPU 자원을 공유하는 것을 고려하였다. 최근에 release된 k8s-device-plugin v0.15.0-rc.1부터 MPS가 지원되기 시작되어 해당 버전으로 MPS를 설정해보았다."/><meta name="twitter:image" content="https://jayground8.github.io/static/images/social-banner.png"/><link rel="canonical" href="https://jayground8.github.io/blog/20240324-k8s-device-plugin"/><meta property="article:published_time" content="2024-03-24T00:00:00.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jayground8.github.io/blog/20240324-k8s-device-plugin"
  },
  "headline": "k8s-device-plugin으로 NVIDIA GPU Multi-Process Service 사용하기",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://jayground8.github.io/static/images/social-banner.png"
    }
  ],
  "datePublished": "2024-03-24T00:00:00.000Z",
  "dateModified": "2024-03-24T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jay"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Jay",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jayground8.github.ioplayground.png"
    }
  },
  "description": "Kubernetes에서 k8s-device-plugin을 통해서 NVIDIA GPU 자원을 쉽게 사용할 수 있다. 하나의 어플리케이션에서 GPU 자원을 온전히 사용하지 못하고 낭비될 때, Time slicing, MPS, MIG 등을 사용하여 여러 프로세스가 GPU 자원을 공유하도록 설정할 수 있다. 네이버 공공 클라우드에서 Tesla T4와 Telsa V100을 제공한다. 해당 GPU 아키텍쳐가 MIG을 지원히지 않기 때문에, MPS를 적용하여 GPU 자원을 공유하는 것을 고려하였다. 최근에 release된 k8s-device-plugin v0.15.0-rc.1부터 MPS가 지원되기 시작되어 해당 버전으로 MPS를 설정해보았다."
}</script><meta name="next-head-count" content="24"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preload" href="/_next/static/css/414f98a58444a4f1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/414f98a58444a4f1.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-690364db8bfb1f01.js" defer=""></script><script src="/_next/static/chunks/main-eea1c213342d95c3.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ddd6d910eb46e8f1.js" defer=""></script><script src="/_next/static/chunks/675-70b09cbf0a5309ea.js" defer=""></script><script src="/_next/static/chunks/410-35c4fb535edd9439.js" defer=""></script><script src="/_next/static/chunks/712-376d32740a4ac813.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-8ab66ff6ebabec4c.js" defer=""></script><script src="/_next/static/iEzl0etbHnbMpxbcLGlmm/_buildManifest.js" defer=""></script><script src="/_next/static/iEzl0etbHnbMpxbcLGlmm/_ssgManifest.js" defer=""></script><script src="/_next/static/iEzl0etbHnbMpxbcLGlmm/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="Jayground8" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" width="53.87" height="43.61" viewBox="0 0 512 512" class="fill-black dark:fill-white"><path d="M368.4 17c-8.8 1.3-18.3 5-25.3 9.9-3.8 2.5-22.6 16.1-41.9 30.1-37.1 26.9-38.6 28.3-36.3 33.9 1.7 4 4.9 5.1 14.6 5.1h8.5v128h-17.9c-18.2 0-22.2.6-27.3 4.2l-2.8 1.9V116.9l2.5-2.4c1.5-1.6 3.6-2.5 5.5-2.5s4 .9 5.5 2.5l2.5 2.4v42c0 29.1.3 42.8 1.1 44.5 2.6 5.7 11.5 5.5 13.9-.3.7-1.9 1-15.6.8-46.2-.3-40.1-.4-43.7-2.2-46.9-4.8-9-11.9-13.4-21.6-13.4-13.8 0-22.8 9.1-23.8 24.1l-.5 7.3h-31.5l-1.2-2.9c-1.6-3.9-6-5.8-9.9-4.1-1.6.6-3.5 2.5-4.1 4.1l-1.2 2.9h-63.6l-1.2-2.9c-2.5-6.2-11.5-6.2-14 0l-1.2 2.9H64.3l-.5-7.3c-1-15-10-24.1-23.8-24.1-9.7 0-16.8 4.4-21.6 13.4-1.8 3.3-1.9 7.5-2.2 75-.2 50 .1 72.3.8 74.1 2.1 5.1 8.6 6.3 12.5 2.4l2.5-2.4V116.9l2.5-2.4c3.2-3.3 7.8-3.3 11 0l2.5 2.4V448H32V284.9l-2.5-2.4c-3.8-3.9-10.2-2.7-12.4 2.2-1.6 3.4-1.6 171.2 0 174.6.6 1.4 2.2 3 3.6 3.6 1.6.7 15.6 1.1 43.7 1.1 38 0 41.5-.1 43.4-1.8 1.2-.9 33.4-50.5 71.7-110.2 38.3-59.7 70.5-109.3 71.7-110.3 1.8-1.5 4.3-1.7 19.4-1.7H288v16h-12.5c-13.1 0-16.6.8-18.3 4.4-2 4.5-138.5 216.2-140.4 217.9-1.9 1.6-5.6 1.7-47.9 1.7-31.9 0-46.6.3-48.3 1.1-5.7 2.6-5.5 11.5.3 13.9 1.9.7 16.7 1 50.1.8 46.4-.3 47.6-.3 51.5-2.5 2.2-1.1 5.1-3.3 6.5-4.7 1.3-1.5 10.1-14.7 19.6-29.4l17.1-26.7 18.4-.5c10.1-.3 19.1-.9 20-1.3.9-.5 2.1-1.9 2.8-3.3 1.5-3.4 1.5-35.4 0-38.8-1.1-2.3-4-4-8-4.8-1.3-.2 1.5-5.2 11.5-20.7l13.1-20.5.5 56.5c.3 31 .9 57.1 1.3 58 1.5 3 5.6 3.9 18.2 3.9H256v14c0 14.9.7 18.1 4.7 19.9 1.7.8 34.7 1.1 115.3 1.1s113.6-.3 115.3-1.1c1.4-.6 3-2.2 3.6-3.6 1.5-3.4 1.5-83.2 0-86.6-2.2-4.9-8.6-6.1-12.4-2.2l-2.5 2.4V480H272V272h208v107.1l2.5 2.4c3.8 3.9 10.2 2.7 12.4-2.2 1.5-3.4 1.5-115.2 0-118.6-1.8-3.9-5-4.7-18.4-4.7H464v-40.5c0-27.9-.3-41.2-1.1-42.9-2.6-5.5-11.2-5.5-13.8 0-.8 1.7-1.1 15-1.1 42.9V256h-24v-34.5c0-21.3-.4-36.4-1.1-39.7-3.6-17.3-19.3-32.9-36.7-36.7-16.2-3.4-31.4 1.1-43.3 12.9-7.4 7.3-11.2 13.9-13.4 23.2-1.8 7.9-2.1 50.3-.4 54.2 1.6 3.5 6.1 5.2 9.8 3.7 4.7-2 5.1-4.2 5.1-29.6 0-21.5.2-23.9 2.2-29.2C350.6 168.4 363 160 376 160s25.4 8.4 29.8 20.3c2.1 5.5 2.2 7.4 2.2 40.7v35H304V96h144v24.5c0 16 .4 25.3 1.1 26.9 2.6 5.5 11.2 5.5 13.8 0 .7-1.6 1.1-10.9 1.1-26.9V96h8.5c9.7 0 12.9-1.1 14.6-5.1 2.1-5.2.1-7.5-17.7-20.4C446.2 53.8 445 53 442.1 53c-4.1.1-7.5 3.5-7.5 7.7 0 4 2.2 6.3 14.8 15.3l4.8 3.5-39.1.3c-21.5.1-56.7.1-78.2 0l-39.1-.3 14.9-10.7c8.2-5.9 20.7-15.1 27.8-20.4 14.5-10.8 20.5-14 29.4-15.5 11.6-2.1 22.4 1.3 36.5 11.4 4.3 3.1 9 5.7 10.3 5.7 3.9 0 7.5-4.4 7.1-8.7-.3-3.3-1.1-4.4-7.8-9.6-15.3-11.8-32.3-17.1-47.6-14.7zM96 152v8H64v-16h32v8zm80 0v8h-64v-16h64v8zm48 0v8h-32v-16h32v8zM96 280v104h-4.5c-5.5 0-9 1.5-10.4 4.7-1.5 3.3-1.5 35.4 0 38.7 1.7 3.6 3.1 4 16.2 4.6l11.9.5-5.1 7.7L99 448H64V176h32v104zm80-27.8v76.3l-17.8 27.7-17.7 27.7-14.2.1H112V176h64v76.2zm48-37.3v38.9l-15.6 24.4c-8.6 13.3-15.8 24.5-16 24.7-.2.2-.4-28.2-.4-63.2V176h32v38.9zM256 369v76h-16V317.1l7.8-12c4.2-6.7 7.8-12.1 8-12.1.1 0 .2 34.2.2 76zm-129.1 34.7c-1.2 2.1-3.6 5.7-5.1 8l-2.9 4.3H96v-16h33.2l-2.3 3.7zM192 408v8h-15.1l3.7-5.8c2-3.1 4.4-6.7 5.2-8 .8-1.2 2.4-2.2 3.8-2.2 2.3 0 2.4.2 2.4 8z"></path><path d="M322.5 114.5c-1.6 1.5-2.5 3.6-2.5 5.5s.9 4 2.5 5.5c1.5 1.6 3.6 2.5 5.5 2.5s4-.9 5.5-2.5c1.6-1.5 2.5-3.6 2.5-5.5s-.9-4-2.5-5.5c-1.5-1.6-3.6-2.5-5.5-2.5s-4 .9-5.5 2.5zM418.5 114.5c-1.6 1.5-2.5 3.6-2.5 5.5s.9 4 2.5 5.5c1.5 1.6 3.6 2.5 5.5 2.5s4-.9 5.5-2.5c1.6-1.5 2.5-3.6 2.5-5.5s-.9-4-2.5-5.5c-1.5-1.6-3.6-2.5-5.5-2.5s-4 .9-5.5 2.5zM290.2 290.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6zM450.5 290.5c-5 4.9-1.5 13.5 5.5 13.5 4.1 0 8-3.9 8-8s-3.9-8-8-8c-1.9 0-4 .9-5.5 2.5zM358.1 322c-8.3 2.2-16.5 5.7-19.8 8.6-3.3 2.8-3.9 7.3-1.4 10.6 3.3 4.1 6.4 4.3 13.8.8 23.3-10.9 47.3-7 64.8 10.5 11.5 11.4 16.5 23.6 16.5 39.7 0 15.9-5.1 28.1-16.4 39.4C404.2 443 392.1 448 376 448s-28.1-5-39.5-16.5c-11-11.1-16.5-24.2-16.5-39.5.1-9.5 1.2-14.5 5.6-24.3 3.8-8.3 3.8-10.4.1-14.5-4.7-5.1-10.8-1.7-15.4 8.6-8.6 19.5-8.4 42.7.6 61.7 9.1 19.3 28.3 34.5 49.5 39 11.9 2.6 28.4 1.7 39.3-2.2 23.9-8.6 41.3-27.9 46.9-51.9 1.9-8.5 1.9-24.4-.1-33.1-5.9-25.5-26.7-46.6-52.5-53.3-10.1-2.6-25.8-2.6-35.9 0zM290.2 450.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6zM450.2 450.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6z"></path></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">Jayground8</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">블로그</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-0 left-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><div class="flex justify-end"><button type="button" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">블로그</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2024-03-24T00:00:00.000Z">2024년 3월 24일 일요일</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">k8s-device-plugin으로 NVIDIA GPU Multi-Process Service 사용하기</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2738%27%20height=%2738%27/%3e"/></span><img alt="avatar" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="h-10 w-10 rounded-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="avatar" srcSet="https://jayground8.github.io/static/images/profile.png?w=48&amp;q=75 1x, https://jayground8.github.io/static/images/profile.png?w=96&amp;q=75 2x" src="https://jayground8.github.io/static/images/profile.png?w=96&amp;q=75" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="h-10 w-10 rounded-full" loading="lazy"/></noscript></span><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Jay</dd><dt class="sr-only">Twitter</dt><dd></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><h2 id="네이버-공공-클라우드에서-사용할-수-있는-옵션"><a href="#네이버-공공-클라우드에서-사용할-수-있는-옵션" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>네이버 공공 클라우드에서 사용할 수 있는 옵션</h2><p>NVIDIA GPU는 자원을 공유하기 위한 방법으로 아래와 같은 방법들을 제공한다.</p><ul><li>Time slicing</li><li>Multi-Process Service</li><li>Multi-instance GPU</li></ul><p>네이버 공공 클라우드에서 사용한 가능한 GPU에는 Tesla V100(arch: Volta)과 Tesla T4(arch: Turing)가 있다. Hardware단에서 Partition을 하여 격리할 수 있는 <code>MIG(Multi-instance GPU)</code>는 <code>A100</code>과 같은 <code>Ampere</code> 아키텍쳐에서 가능하다. 따라서 T4와 V100에서는 <code>MIG</code>를 사용할 수가 없다. 대신에 <code>MPS(Multi-Process Service)</code>는 T4와 V100 모두에서 사용이 가능하다. <code>Time slicing</code> 방식은 GPU를 많이 사용하는 다수의 프로세스가 공유해서 사용할 때, Context Switch에 의한 overload가 상당히 발생할 수 있다. 반면에 <code>MPS</code>는 하나의 Cuda Context를 공유하기 때문에, <code>Time slicing</code>보다 Context switch에 대한 overload를 줄일 수 있다. 하지만 이렇게 하나의 Cuda Context를 공유하기 때문에 error가 발생했을 때 모든 MPS client에 영향을 미칠 수 있다. (<a target="_blank" rel="noopener noreferrer" href="https://docs.nvidia.com/deploy/mps/index.html#topic_3_3_3_2">Volta MPS에서는 좀 제한적인 영향을 미치는 것 같다.</a>)</p><h2 id="k8s-device-plugin"><a href="#k8s-device-plugin" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>k8s-device-plugin</h2><p>Kubernetes에서 GPU를 kubelet이 인지하고 사용할 수 있도록, <a target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/watch?v=Q2GuTUO170w&amp;t=922s">NVIDIA에서 공식적으로 device plugin</a>을 제공하고 있다. 그리고 Helm chart를 같이 제공한다. 따라서 Helm으로 <code>k8s-device-plugin</code>을 설치를 했다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">helm repo <span class="token function">add</span> nvdp https://nvidia.github.io/k8s-device-plugin
</span></code></pre></div><p>원하는 Worker node에 Daemonset이 실행될 수 있도록 <code>affinity</code>와 <code>tolerations</code> 설정을 추가하였다.</p><p><code>values.yml</code></p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">affinity</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">nodeAffinity</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">requiredDuringSchedulingIgnoredDuringExecution</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">nodeSelectorTerms</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token punctuation">-</span> <span class="token atrule key">matchExpressions</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token atrule key">key</span><span class="token punctuation">:</span> serverType
</span><span class="code-line">              <span class="token atrule key">operator</span><span class="token punctuation">:</span> In
</span><span class="code-line">              <span class="token atrule key">values</span><span class="token punctuation">:</span>
</span><span class="code-line">                <span class="token punctuation">-</span> gpu
</span><span class="code-line"><span class="token atrule key">tolerations</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token atrule key">key</span><span class="token punctuation">:</span> nvidia.com/gpu
</span><span class="code-line">    <span class="token atrule key">operator</span><span class="token punctuation">:</span> Exists
</span><span class="code-line">    <span class="token atrule key">effect</span><span class="token punctuation">:</span> NoSchedule
</span></code></pre></div><p>그리고 device plugin 설정파일에 MPS 설정을 추가하였다.</p><p><code>config.yaml</code></p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">version</span><span class="token punctuation">:</span> v1
</span><span class="code-line"><span class="token atrule key">sharing</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">mps</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">resources</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> nvidia.com/gpu
</span><span class="code-line">        <span class="token atrule key">replicas</span><span class="token punctuation">:</span> <span class="token number">10</span>
</span></code></pre></div><p>NVIDIA의 k8s-device-plugin에서 <code>v0.15.0</code>부터 MPS를 지원하기 시작했다. 지금 이 글을 쓰는 시점에 <code>v0.15.0-rc.2</code>가 최신 버전이고, 아직 <code>rc</code> 환경으로 제공되고 있다. 따라서 Helm으로 설치를 할 때 아래와 같이 version flag를 통해서 0.15.0-rc.2를 설정해준다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">helm <span class="token function">install</span> k8s-device-plugin nvdp/nvidia-device-plugin <span class="token punctuation">\</span>
</span><span class="code-line">--version <span class="token number">0.15</span>.0-rc.2 <span class="token punctuation">\</span>
</span><span class="code-line">--namespace nvidia-device-plugin <span class="token punctuation">\</span>
</span><span class="code-line">--create-namespace <span class="token punctuation">\</span>
</span><span class="code-line">--values values.yaml <span class="token punctuation">\</span>
</span><span class="code-line">--set-file config.map.config<span class="token operator">=</span>config.yaml
</span></code></pre></div><p>Helm으로 설치하고 나면 아래와 같이 두개의 Daemonset Object가 만들어진 것을 확인할 수 있다. Deamonset k8s-device-plugin-nvidia-device-plugin-mps-control-daemon가 실행되기 위해서는 Worker Node에 nvidia.com/mps.capable=true가 설정되어야 한다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">$ kubectl get ds -n nvidia-device-plugin
</span><span class="code-line">NAMESPACE              NAME                                                        DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR
</span><span class="code-line">nvidia-device-plugin   k8s-device-plugin-nvidia-device-plugin                      <span class="token number">1</span>         <span class="token number">1</span>         <span class="token number">1</span>       <span class="token number">1</span>            <span class="token number">1</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>                        5s
</span><span class="code-line">nvidia-device-plugin   k8s-device-plugin-nvidia-device-plugin-mps-control-daemon   <span class="token number">0</span>         <span class="token number">0</span>         <span class="token number">0</span>       <span class="token number">0</span>            <span class="token number">0</span>           nvidia.com/mps.capable<span class="token operator">=</span>true   5s
</span></code></pre></div><p>해당 Label때문에 MPS daemon이 실행되지 못했고, 그래서 k8s-device-plugin-nvidia-device-plugin Pod에 아래와 같은 에러 로그가 남게 되었다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">Failed to start plugin: error waiting <span class="token keyword">for</span> MPS daemon: error checking MPS daemon health: failed to send <span class="token builtin class-name">command</span> to MPS daemon: <span class="token builtin class-name">exit</span> status <span class="token number">1</span>
</span></code></pre></div><p>이제 GPU worker node에 label을 추가해주면 MPS daemon이 실행되고, 정상적으로 MPS가 적용된다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">kubectl label node gpu-node nvidia.com/mps.capable<span class="token operator">=</span>true
</span></code></pre></div><p>MPS에서 replica를 10으로 설정했기 때문에, Node의 nvida.com/gpu 자원을 확인하면 1에서 10으로 증가한 것을 확인할 수 있다.</p><div class="relative"><pre><code class="language-bash code-highlight"><span class="code-line">$ kubectl describe node gpu-node
</span><span class="code-line">Allocatable:
</span><span class="code-line">  cpu:                3920m
</span><span class="code-line">  ephemeral-storage:  <span class="token number">47267522073</span>
</span><span class="code-line">  hugepages-1Gi:      <span class="token number">0</span>
</span><span class="code-line">  hugepages-2Mi:      <span class="token number">0</span>
</span><span class="code-line">  memory:             17413608Ki
</span><span class="code-line">  nvidia.com/gpu:     <span class="token number">10</span>
</span><span class="code-line">  pods:               <span class="token number">110</span>
</span></code></pre></div><p>해당 노드에 <code>nvida.com/gpu</code> resource request가 1인 Pod 하나만 스케쥴링이 될 수 있었는데, 이제 10으로 늘어나서 다수의 Pod를 해당 노드에서 실행할 수 있게 되었다.</p><h2 id="궁금증"><a href="#궁금증" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>궁금증</h2><p>MPS를 통해서 GPU core 1을 10개로 나누면, 예를 들어서 하나의 Container는 8개로 요청하여 GPU 자원을 80%를 사용하고, 다른 하나는 2개로 요청하여 20%를 사용하도록 하고 싶었다. 하지만 <a target="_blank" rel="noopener noreferrer" href="https://github.com/NVIDIA/k8s-device-plugin/releases/tag/v0.15.0-rc.2">v0.15.0-rc.2 release note</a>를 보면 <code>failRequestsGreaterThanOne</code>가 <code>true</code>로 설정되어 있는 것을 확인할 수 있다. 그래서 1를 초과하여 요청할 수가 없다.</p><p>이제 MPS로 10개로 나눴을 때 GPU와 Memory 자원을 1/10만큼 사용할 수 있기 때문에, container가 1/10보다 더 사용하도록 설정할 수가 없다.</p><blockquote><p>Furthermore, each of these resources -- either nvidia.com/gpu or nvidia.com/gpu.shared -- would have access to the same fraction (1/10) of the total memory and compute resources of the GPU.</p></blockquote><p><a target="_blank" rel="noopener noreferrer" href="https://github.com/NVIDIA/k8s-device-plugin/releases/tag/v0.15.0">이 글을 작성하는 시점으로 3일전에 v0.15.0이 release 되었는데,</a> 아래와 같은 내용이 설명되어 있다.</p><blockquote><p>It is not possible to &quot;combine&quot; MPS GPU requests to allow for access to more memory by a single container.</p></blockquote><p>따라서 GPU 자원을 계속 사용하지 않아서 두 개의 Container가 GPU 자원을 공유하고, 가능하면 Full로 GPU 자원을 사용하고 싶다면, MPS 방법은 적합하지 않다. 이럴때는 Context switch가 문제가 되지 않는 범위에서 time slicing으로 자원을 공유해야 하는 것인가?🤔</p></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"></div><div id="comment"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/kubernetes">kubernetes</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/ncloud">ncloud</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/20240214-containerd-LimitNOFILE">containerd nofile default 설정값</a></div></div><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/20240324-book-review-what-can-a-body-do">책 &quot;다른 몸들을 위한 디자인&quot;을 읽고...</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:jayground8@gmail.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/jayground8"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Jay</div><div> • </div><div>© 2025</div><div> • </div><a href="/">Jayground8</a></div><div class="mb-8 text-sm text-gray-500 dark:text-gray-400"><a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var o=Object.create;var l=Object.defineProperty;var t=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var i=a=\u003el(a,\"__esModule\",{value:!0});var u=(a,c)=\u003e()=\u003e(c||a((c={exports:{}}).exports,c),c.exports),N=(a,c)=\u003e{i(a);for(var s in c)l(a,s,{get:c[s],enumerable:!0})},k=(a,c,s)=\u003e{if(c\u0026\u0026typeof c==\"object\"||typeof c==\"function\")for(let n of h(c))!m.call(a,n)\u0026\u0026n!==\"default\"\u0026\u0026l(a,n,{get:()=\u003ec[n],enumerable:!(s=t(c,n))||s.enumerable});return a},g=a=\u003ek(i(l(a!=null?o(p(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var d=u((f,r)=\u003e{r.exports=_jsx_runtime});var y={};N(y,{default:()=\u003eP,frontmatter:()=\u003ev});var e=g(d()),v={title:\"k8s-device-plugin\\uC73C\\uB85C NVIDIA GPU Multi-Process Service \\uC0AC\\uC6A9\\uD558\\uAE30\",date:\"2024-03-24\",tags:[\"kubernetes\",\"ncloud\"],images:[\"/static/images/social-banner.png\"],summary:\"Kubernetes\\uC5D0\\uC11C k8s-device-plugin\\uC744 \\uD1B5\\uD574\\uC11C NVIDIA GPU \\uC790\\uC6D0\\uC744 \\uC27D\\uAC8C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB2E4. \\uD558\\uB098\\uC758 \\uC5B4\\uD50C\\uB9AC\\uCF00\\uC774\\uC158\\uC5D0\\uC11C GPU \\uC790\\uC6D0\\uC744 \\uC628\\uC804\\uD788 \\uC0AC\\uC6A9\\uD558\\uC9C0 \\uBABB\\uD558\\uACE0 \\uB0AD\\uBE44\\uB420 \\uB54C, Time slicing, MPS, MIG \\uB4F1\\uC744 \\uC0AC\\uC6A9\\uD558\\uC5EC \\uC5EC\\uB7EC \\uD504\\uB85C\\uC138\\uC2A4\\uAC00 GPU \\uC790\\uC6D0\\uC744 \\uACF5\\uC720\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB2E4. \\uB124\\uC774\\uBC84 \\uACF5\\uACF5 \\uD074\\uB77C\\uC6B0\\uB4DC\\uC5D0\\uC11C Tesla T4\\uC640 Telsa V100\\uC744 \\uC81C\\uACF5\\uD55C\\uB2E4. \\uD574\\uB2F9 GPU \\uC544\\uD0A4\\uD14D\\uCCD0\\uAC00 MIG\\uC744 \\uC9C0\\uC6D0\\uD788\\uC9C0 \\uC54A\\uAE30 \\uB54C\\uBB38\\uC5D0, MPS\\uB97C \\uC801\\uC6A9\\uD558\\uC5EC GPU \\uC790\\uC6D0\\uC744 \\uACF5\\uC720\\uD558\\uB294 \\uAC83\\uC744 \\uACE0\\uB824\\uD558\\uC600\\uB2E4. \\uCD5C\\uADFC\\uC5D0 release\\uB41C k8s-device-plugin v0.15.0-rc.1\\uBD80\\uD130 MPS\\uAC00 \\uC9C0\\uC6D0\\uB418\\uAE30 \\uC2DC\\uC791\\uB418\\uC5B4 \\uD574\\uB2F9 \\uBC84\\uC804\\uC73C\\uB85C MPS\\uB97C \\uC124\\uC815\\uD574\\uBCF4\\uC558\\uB2E4.\"};function b(a={}){let{wrapper:c}=a.components||{};return c?(0,e.jsx)(c,Object.assign({},a,{children:(0,e.jsx)(s,{})})):s();function s(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",ul:\"ul\",li:\"li\",code:\"code\",pre:\"pre\",blockquote:\"blockquote\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"\\uB124\\uC774\\uBC84-\\uACF5\\uACF5-\\uD074\\uB77C\\uC6B0\\uB4DC\\uC5D0\\uC11C-\\uC0AC\\uC6A9\\uD560-\\uC218-\\uC788\\uB294-\\uC635\\uC158\",children:[(0,e.jsx)(n.a,{href:\"#\\uB124\\uC774\\uBC84-\\uACF5\\uACF5-\\uD074\\uB77C\\uC6B0\\uB4DC\\uC5D0\\uC11C-\\uC0AC\\uC6A9\\uD560-\\uC218-\\uC788\\uB294-\\uC635\\uC158\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uB124\\uC774\\uBC84 \\uACF5\\uACF5 \\uD074\\uB77C\\uC6B0\\uB4DC\\uC5D0\\uC11C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB294 \\uC635\\uC158\"]}),(0,e.jsx)(n.p,{children:\"NVIDIA GPU\\uB294 \\uC790\\uC6D0\\uC744 \\uACF5\\uC720\\uD558\\uAE30 \\uC704\\uD55C \\uBC29\\uBC95\\uC73C\\uB85C \\uC544\\uB798\\uC640 \\uAC19\\uC740 \\uBC29\\uBC95\\uB4E4\\uC744 \\uC81C\\uACF5\\uD55C\\uB2E4.\"}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:\"Time slicing\"}),(0,e.jsx)(n.li,{children:\"Multi-Process Service\"}),(0,e.jsx)(n.li,{children:\"Multi-instance GPU\"})]}),(0,e.jsxs)(n.p,{children:[\"\\uB124\\uC774\\uBC84 \\uACF5\\uACF5 \\uD074\\uB77C\\uC6B0\\uB4DC\\uC5D0\\uC11C \\uC0AC\\uC6A9\\uD55C \\uAC00\\uB2A5\\uD55C GPU\\uC5D0\\uB294 Tesla V100(arch: Volta)\\uACFC Tesla T4(arch: Turing)\\uAC00 \\uC788\\uB2E4. Hardware\\uB2E8\\uC5D0\\uC11C Partition\\uC744 \\uD558\\uC5EC \\uACA9\\uB9AC\\uD560 \\uC218 \\uC788\\uB294 \",(0,e.jsx)(n.code,{children:\"MIG(Multi-instance GPU)\"}),\"\\uB294 \",(0,e.jsx)(n.code,{children:\"A100\"}),\"\\uACFC \\uAC19\\uC740 \",(0,e.jsx)(n.code,{children:\"Ampere\"}),\" \\uC544\\uD0A4\\uD14D\\uCCD0\\uC5D0\\uC11C \\uAC00\\uB2A5\\uD558\\uB2E4. \\uB530\\uB77C\\uC11C T4\\uC640 V100\\uC5D0\\uC11C\\uB294 \",(0,e.jsx)(n.code,{children:\"MIG\"}),\"\\uB97C \\uC0AC\\uC6A9\\uD560 \\uC218\\uAC00 \\uC5C6\\uB2E4. \\uB300\\uC2E0\\uC5D0 \",(0,e.jsx)(n.code,{children:\"MPS(Multi-Process Service)\"}),\"\\uB294 T4\\uC640 V100 \\uBAA8\\uB450\\uC5D0\\uC11C \\uC0AC\\uC6A9\\uC774 \\uAC00\\uB2A5\\uD558\\uB2E4. \",(0,e.jsx)(n.code,{children:\"Time slicing\"}),\" \\uBC29\\uC2DD\\uC740 GPU\\uB97C \\uB9CE\\uC774 \\uC0AC\\uC6A9\\uD558\\uB294 \\uB2E4\\uC218\\uC758 \\uD504\\uB85C\\uC138\\uC2A4\\uAC00 \\uACF5\\uC720\\uD574\\uC11C \\uC0AC\\uC6A9\\uD560 \\uB54C, Context Switch\\uC5D0 \\uC758\\uD55C overload\\uAC00 \\uC0C1\\uB2F9\\uD788 \\uBC1C\\uC0DD\\uD560 \\uC218 \\uC788\\uB2E4. \\uBC18\\uBA74\\uC5D0 \",(0,e.jsx)(n.code,{children:\"MPS\"}),\"\\uB294 \\uD558\\uB098\\uC758 Cuda Context\\uB97C \\uACF5\\uC720\\uD558\\uAE30 \\uB54C\\uBB38\\uC5D0, \",(0,e.jsx)(n.code,{children:\"Time slicing\"}),\"\\uBCF4\\uB2E4 Context switch\\uC5D0 \\uB300\\uD55C overload\\uB97C \\uC904\\uC77C \\uC218 \\uC788\\uB2E4. \\uD558\\uC9C0\\uB9CC \\uC774\\uB807\\uAC8C \\uD558\\uB098\\uC758 Cuda Context\\uB97C \\uACF5\\uC720\\uD558\\uAE30 \\uB54C\\uBB38\\uC5D0 error\\uAC00 \\uBC1C\\uC0DD\\uD588\\uC744 \\uB54C \\uBAA8\\uB4E0 MPS client\\uC5D0 \\uC601\\uD5A5\\uC744 \\uBBF8\\uCE60 \\uC218 \\uC788\\uB2E4. (\",(0,e.jsx)(n.a,{href:\"https://docs.nvidia.com/deploy/mps/index.html#topic_3_3_3_2\",children:\"Volta MPS\\uC5D0\\uC11C\\uB294 \\uC880 \\uC81C\\uD55C\\uC801\\uC778 \\uC601\\uD5A5\\uC744 \\uBBF8\\uCE58\\uB294 \\uAC83 \\uAC19\\uB2E4.\"}),\")\"]}),(0,e.jsxs)(n.h2,{id:\"k8s-device-plugin\",children:[(0,e.jsx)(n.a,{href:\"#k8s-device-plugin\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"k8s-device-plugin\"]}),(0,e.jsxs)(n.p,{children:[\"Kubernetes\\uC5D0\\uC11C GPU\\uB97C kubelet\\uC774 \\uC778\\uC9C0\\uD558\\uACE0 \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D, \",(0,e.jsx)(n.a,{href:\"https://www.youtube.com/watch?v=Q2GuTUO170w\u0026t=922s\",children:\"NVIDIA\\uC5D0\\uC11C \\uACF5\\uC2DD\\uC801\\uC73C\\uB85C device plugin\"}),\"\\uC744 \\uC81C\\uACF5\\uD558\\uACE0 \\uC788\\uB2E4. \\uADF8\\uB9AC\\uACE0 Helm chart\\uB97C \\uAC19\\uC774 \\uC81C\\uACF5\\uD55C\\uB2E4. \\uB530\\uB77C\\uC11C Helm\\uC73C\\uB85C \",(0,e.jsx)(n.code,{children:\"k8s-device-plugin\"}),\"\\uC744 \\uC124\\uCE58\\uB97C \\uD588\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"helm repo \",(0,e.jsx)(n.span,{className:\"token function\",children:\"add\"}),` nvdp https://nvidia.github.io/k8s-device-plugin\n`]})})}),(0,e.jsxs)(n.p,{children:[\"\\uC6D0\\uD558\\uB294 Worker node\\uC5D0 Daemonset\\uC774 \\uC2E4\\uD589\\uB420 \\uC218 \\uC788\\uB3C4\\uB85D \",(0,e.jsx)(n.code,{children:\"affinity\"}),\"\\uC640 \",(0,e.jsx)(n.code,{children:\"tolerations\"}),\" \\uC124\\uC815\\uC744 \\uCD94\\uAC00\\uD558\\uC600\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"values.yml\"})}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"affinity\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"nodeAffinity\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"requiredDuringSchedulingIgnoredDuringExecution\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"nodeSelectorTerms\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"matchExpressions\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` serverType\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"operator\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` In\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"values\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` gpu\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"tolerations\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` nvidia.com/gpu\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"operator\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Exists\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"effect\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` NoSchedule\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uADF8\\uB9AC\\uACE0 device plugin \\uC124\\uC815\\uD30C\\uC77C\\uC5D0 MPS \\uC124\\uC815\\uC744 \\uCD94\\uAC00\\uD558\\uC600\\uB2E4.\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"config.yaml\"})}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"version\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"sharing\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"mps\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"resources\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` nvidia.com/gpu\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"replicas\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"NVIDIA\\uC758 k8s-device-plugin\\uC5D0\\uC11C \",(0,e.jsx)(n.code,{children:\"v0.15.0\"}),\"\\uBD80\\uD130 MPS\\uB97C \\uC9C0\\uC6D0\\uD558\\uAE30 \\uC2DC\\uC791\\uD588\\uB2E4. \\uC9C0\\uAE08 \\uC774 \\uAE00\\uC744 \\uC4F0\\uB294 \\uC2DC\\uC810\\uC5D0 \",(0,e.jsx)(n.code,{children:\"v0.15.0-rc.2\"}),\"\\uAC00 \\uCD5C\\uC2E0 \\uBC84\\uC804\\uC774\\uACE0, \\uC544\\uC9C1 \",(0,e.jsx)(n.code,{children:\"rc\"}),\" \\uD658\\uACBD\\uC73C\\uB85C \\uC81C\\uACF5\\uB418\\uACE0 \\uC788\\uB2E4. \\uB530\\uB77C\\uC11C Helm\\uC73C\\uB85C \\uC124\\uCE58\\uB97C \\uD560 \\uB54C \\uC544\\uB798\\uC640 \\uAC19\\uC774 version flag\\uB97C \\uD1B5\\uD574\\uC11C 0.15.0-rc.2\\uB97C \\uC124\\uC815\\uD574\\uC900\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"helm \",(0,e.jsx)(n.span,{className:\"token function\",children:\"install\"}),\" k8s-device-plugin nvdp/nvidia-device-plugin \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--version \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0.15\"}),\".0-rc.2 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--namespace nvidia-device-plugin \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--create-namespace \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--values values.yaml \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--set-file config.map.config\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`config.yaml\n`]})]})}),(0,e.jsx)(n.p,{children:\"Helm\\uC73C\\uB85C \\uC124\\uCE58\\uD558\\uACE0 \\uB098\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uB450\\uAC1C\\uC758 Daemonset Object\\uAC00 \\uB9CC\\uB4E4\\uC5B4\\uC9C4 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. Deamonset k8s-device-plugin-nvidia-device-plugin-mps-control-daemon\\uAC00 \\uC2E4\\uD589\\uB418\\uAE30 \\uC704\\uD574\\uC11C\\uB294 Worker Node\\uC5D0 nvidia.com/mps.capable=true\\uAC00 \\uC124\\uC815\\uB418\\uC5B4\\uC57C \\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`$ kubectl get ds -n nvidia-device-plugin\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`NAMESPACE              NAME                                                        DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"nvidia-device-plugin   k8s-device-plugin-nvidia-device-plugin                      \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\"         \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\"         \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\"       \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\"            \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\"           \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),\"none\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),`                        5s\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"nvidia-device-plugin   k8s-device-plugin-nvidia-device-plugin-mps-control-daemon   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\"         \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\"         \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\"       \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\"            \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\"           nvidia.com/mps.capable\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`true   5s\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uD574\\uB2F9 Label\\uB54C\\uBB38\\uC5D0 MPS daemon\\uC774 \\uC2E4\\uD589\\uB418\\uC9C0 \\uBABB\\uD588\\uACE0, \\uADF8\\uB798\\uC11C k8s-device-plugin-nvidia-device-plugin Pod\\uC5D0 \\uC544\\uB798\\uC640 \\uAC19\\uC740 \\uC5D0\\uB7EC \\uB85C\\uADF8\\uAC00 \\uB0A8\\uAC8C \\uB418\\uC5C8\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Failed to start plugin: error waiting \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" MPS daemon: error checking MPS daemon health: failed to send \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"command\"}),\" to MPS daemon: \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"exit\"}),\" status \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]})})}),(0,e.jsx)(n.p,{children:\"\\uC774\\uC81C GPU worker node\\uC5D0 label\\uC744 \\uCD94\\uAC00\\uD574\\uC8FC\\uBA74 MPS daemon\\uC774 \\uC2E4\\uD589\\uB418\\uACE0, \\uC815\\uC0C1\\uC801\\uC73C\\uB85C MPS\\uAC00 \\uC801\\uC6A9\\uB41C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"kubectl label node gpu-node nvidia.com/mps.capable\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`true\n`]})})}),(0,e.jsx)(n.p,{children:\"MPS\\uC5D0\\uC11C replica\\uB97C 10\\uC73C\\uB85C \\uC124\\uC815\\uD588\\uAE30 \\uB54C\\uBB38\\uC5D0, Node\\uC758 nvida.com/gpu \\uC790\\uC6D0\\uC744 \\uD655\\uC778\\uD558\\uBA74 1\\uC5D0\\uC11C 10\\uC73C\\uB85C \\uC99D\\uAC00\\uD55C \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`$ kubectl describe node gpu-node\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Allocatable:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  cpu:                3920m\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  ephemeral-storage:  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"47267522073\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  hugepages-1Gi:      \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  hugepages-2Mi:      \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  memory:             17413608Ki\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  nvidia.com/gpu:     \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  pods:               \",(0,e.jsx)(n.span,{className:\"token number\",children:\"110\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uD574\\uB2F9 \\uB178\\uB4DC\\uC5D0 \",(0,e.jsx)(n.code,{children:\"nvida.com/gpu\"}),\" resource request\\uAC00 1\\uC778 Pod \\uD558\\uB098\\uB9CC \\uC2A4\\uCF00\\uC974\\uB9C1\\uC774 \\uB420 \\uC218 \\uC788\\uC5C8\\uB294\\uB370, \\uC774\\uC81C 10\\uC73C\\uB85C \\uB298\\uC5B4\\uB098\\uC11C \\uB2E4\\uC218\\uC758 Pod\\uB97C \\uD574\\uB2F9 \\uB178\\uB4DC\\uC5D0\\uC11C \\uC2E4\\uD589\\uD560 \\uC218 \\uC788\\uAC8C \\uB418\\uC5C8\\uB2E4.\"]}),(0,e.jsxs)(n.h2,{id:\"\\uAD81\\uAE08\\uC99D\",children:[(0,e.jsx)(n.a,{href:\"#\\uAD81\\uAE08\\uC99D\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uAD81\\uAE08\\uC99D\"]}),(0,e.jsxs)(n.p,{children:[\"MPS\\uB97C \\uD1B5\\uD574\\uC11C GPU core 1\\uC744 10\\uAC1C\\uB85C \\uB098\\uB204\\uBA74, \\uC608\\uB97C \\uB4E4\\uC5B4\\uC11C \\uD558\\uB098\\uC758 Container\\uB294 8\\uAC1C\\uB85C \\uC694\\uCCAD\\uD558\\uC5EC GPU \\uC790\\uC6D0\\uC744 80%\\uB97C \\uC0AC\\uC6A9\\uD558\\uACE0, \\uB2E4\\uB978 \\uD558\\uB098\\uB294 2\\uAC1C\\uB85C \\uC694\\uCCAD\\uD558\\uC5EC 20%\\uB97C \\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D \\uD558\\uACE0 \\uC2F6\\uC5C8\\uB2E4. \\uD558\\uC9C0\\uB9CC \",(0,e.jsx)(n.a,{href:\"https://github.com/NVIDIA/k8s-device-plugin/releases/tag/v0.15.0-rc.2\",children:\"v0.15.0-rc.2 release note\"}),\"\\uB97C \\uBCF4\\uBA74 \",(0,e.jsx)(n.code,{children:\"failRequestsGreaterThanOne\"}),\"\\uAC00 \",(0,e.jsx)(n.code,{children:\"true\"}),\"\\uB85C \\uC124\\uC815\\uB418\\uC5B4 \\uC788\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. \\uADF8\\uB798\\uC11C 1\\uB97C \\uCD08\\uACFC\\uD558\\uC5EC \\uC694\\uCCAD\\uD560 \\uC218\\uAC00 \\uC5C6\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:\"\\uC774\\uC81C MPS\\uB85C 10\\uAC1C\\uB85C \\uB098\\uB234\\uC744 \\uB54C GPU\\uC640 Memory \\uC790\\uC6D0\\uC744 1/10\\uB9CC\\uD07C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uAE30 \\uB54C\\uBB38\\uC5D0, container\\uAC00 1/10\\uBCF4\\uB2E4 \\uB354 \\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uD560 \\uC218\\uAC00 \\uC5C6\\uB2E4.\"}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"Furthermore, each of these resources -- either nvidia.com/gpu or nvidia.com/gpu.shared -- would have access to the same fraction (1/10) of the total memory and compute resources of the GPU.\"})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://github.com/NVIDIA/k8s-device-plugin/releases/tag/v0.15.0\",children:\"\\uC774 \\uAE00\\uC744 \\uC791\\uC131\\uD558\\uB294 \\uC2DC\\uC810\\uC73C\\uB85C 3\\uC77C\\uC804\\uC5D0 v0.15.0\\uC774 release \\uB418\\uC5C8\\uB294\\uB370,\"}),\" \\uC544\\uB798\\uC640 \\uAC19\\uC740 \\uB0B4\\uC6A9\\uC774 \\uC124\\uBA85\\uB418\\uC5B4 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:'It is not possible to \"combine\" MPS GPU requests to allow for access to more memory by a single container.'})}),(0,e.jsx)(n.p,{children:\"\\uB530\\uB77C\\uC11C GPU \\uC790\\uC6D0\\uC744 \\uACC4\\uC18D \\uC0AC\\uC6A9\\uD558\\uC9C0 \\uC54A\\uC544\\uC11C \\uB450 \\uAC1C\\uC758 Container\\uAC00 GPU \\uC790\\uC6D0\\uC744 \\uACF5\\uC720\\uD558\\uACE0, \\uAC00\\uB2A5\\uD558\\uBA74 Full\\uB85C GPU \\uC790\\uC6D0\\uC744 \\uC0AC\\uC6A9\\uD558\\uACE0 \\uC2F6\\uB2E4\\uBA74, MPS \\uBC29\\uBC95\\uC740 \\uC801\\uD569\\uD558\\uC9C0 \\uC54A\\uB2E4. \\uC774\\uB7F4\\uB54C\\uB294 Context switch\\uAC00 \\uBB38\\uC81C\\uAC00 \\uB418\\uC9C0 \\uC54A\\uB294 \\uBC94\\uC704\\uC5D0\\uC11C time slicing\\uC73C\\uB85C \\uC790\\uC6D0\\uC744 \\uACF5\\uC720\\uD574\\uC57C \\uD558\\uB294 \\uAC83\\uC778\\uAC00?\\u{1F914}\"})]})}}var P=b;return y;})();\n;return Component;","toc":[{"value":"네이버 공공 클라우드에서 사용할 수 있는 옵션","url":"#네이버-공공-클라우드에서-사용할-수-있는-옵션","depth":2},{"value":"k8s-device-plugin","url":"#k8s-device-plugin","depth":2},{"value":"궁금증","url":"#궁금증","depth":2}],"frontMatter":{"readingTime":{"text":"4 min read","minutes":3.94,"time":236400,"words":788},"slug":"20240324-k8s-device-plugin","fileName":"20240324-k8s-device-plugin.md","title":"k8s-device-plugin으로 NVIDIA GPU Multi-Process Service 사용하기","date":"2024-03-24T00:00:00.000Z","tags":["kubernetes","ncloud"],"images":["/static/images/social-banner.png"],"summary":"Kubernetes에서 k8s-device-plugin을 통해서 NVIDIA GPU 자원을 쉽게 사용할 수 있다. 하나의 어플리케이션에서 GPU 자원을 온전히 사용하지 못하고 낭비될 때, Time slicing, MPS, MIG 등을 사용하여 여러 프로세스가 GPU 자원을 공유하도록 설정할 수 있다. 네이버 공공 클라우드에서 Tesla T4와 Telsa V100을 제공한다. 해당 GPU 아키텍쳐가 MIG을 지원히지 않기 때문에, MPS를 적용하여 GPU 자원을 공유하는 것을 고려하였다. 최근에 release된 k8s-device-plugin v0.15.0-rc.1부터 MPS가 지원되기 시작되어 해당 버전으로 MPS를 설정해보았다."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.15,"time":9000,"words":30},"slug":["default"],"fileName":"default.md","name":"Jay","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"containerd nofile default 설정값","date":"2024-02-14T00:00:00.000Z","tags":["kubernetes","containerd"],"images":["/static/images/social-banner.png"],"summary":"Kubernetes에서 pod가 실행될 때, 해당 process의 open file 갯수 limit이 어떻게 되는지 궁금하였다. Containerd가 systemd service로 동작하는 상황에서 systemd에서 LimitNOFILE이 inifinity로 설정되어 있는 것을 확인하였다. infinity가 Ubuntu systemd 240 버전 이상에서는 process에 최대로 할당할 수 있는 File 갯수인 fs.nr_open 값으로 설정된다. 실제로 test용 pod를 띄어서 containerd에 의해서 실행되는 process의 nofile limit이 LimitNOFILE에 설정된 값으로 동일하게 설정되는 것을 확인하였다.","slug":"20240214-containerd-LimitNOFILE"},"next":{"title":"책 \"다른 몸들을 위한 디자인\"을 읽고...","date":"2024-03-24T00:00:00.000Z","tags":["Book"],"images":["/static/images/social-banner.png"],"summary":"내가 일상 생활에서 장애를 직접 경험하지 않기 때문에 장애인이 경험하는 우리의 사회에 대해서 진지하게 고민할 기회가 많지 않았다. 봉사활동과 여러가지 프로젝트 참여를 통해서 장애인에 대한 여러가지 생각을 했지만, 내 삶에서 당장 중요한 문제가 아니다보니 일시적인 생각으로만 끝났다. 이 책을 읽으면서 느낀 점이나 생각들도 반복된 일상속에서 그냥 증발해버릴 것 같다는 생각이 들었다. 하지만 이러한 작은 관심과 생각들이 나의 무의식에 있던 사고들에 변화를 조금씩 가져오고, 그것이 쌓여서 나중에는 내가 무언가 사회에 조금이나마 영향을 미칠 수 있는 역할을 할 수 있지 않을까? 조금은 긍정적인 마음으로 독후감을 작성해보았다.","slug":"20240324-book-review-what-can-a-body-do"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["20240324-k8s-device-plugin"]},"buildId":"iEzl0etbHnbMpxbcLGlmm","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>