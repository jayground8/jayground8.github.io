<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="manifest" href="/jayground8/static/favicons/manifest.json"/><link rel="manifest" href="/jayground8/static/favicons/site.webmanifest"/><link rel="shortcut icon" href="/jayground8/static/favicons/favicon.ico"/><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8773084925406986" crossorigin="anonymous"></script><title>OpenTelemetry GcpDetector를 이해하기</title><meta name="robots" content="follow, index"/><meta name="description" content="OpenTelemetry Operator로 Auto-Instrumentation을 주입할 수 있다. 그런데 환경변수 설정을 올바르게 하지 않거나 OpenTelemetry Collector에서 proccessor 설정을 제대로 해주지 않으면, Resource attribute중 k8s.namespace.name가 빈문자열로 보내질 수 있다. 이러한 경우에 Auto-Instrumentation에서 Resource attribute가 어떻게 자동으로 설정되는지 resourceDetector들을 이해하면 쉽게 해결할 수 있다. 따라서 이번 글에서는 Resource Detector들에 대해서 자세히 살펴본다."/><meta property="og:url" content="https://jayground8.github.io/blog/20250119-otel-gcp-detector"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Jayground8"/><meta property="og:description" content="OpenTelemetry Operator로 Auto-Instrumentation을 주입할 수 있다. 그런데 환경변수 설정을 올바르게 하지 않거나 OpenTelemetry Collector에서 proccessor 설정을 제대로 해주지 않으면, Resource attribute중 k8s.namespace.name가 빈문자열로 보내질 수 있다. 이러한 경우에 Auto-Instrumentation에서 Resource attribute가 어떻게 자동으로 설정되는지 resourceDetector들을 이해하면 쉽게 해결할 수 있다. 따라서 이번 글에서는 Resource Detector들에 대해서 자세히 살펴본다."/><meta property="og:title" content="OpenTelemetry GcpDetector를 이해하기"/><meta property="og:image" content="https://jayground8.github.io/static/images/social-banner.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site"/><meta name="twitter:title" content="OpenTelemetry GcpDetector를 이해하기"/><meta name="twitter:description" content="OpenTelemetry Operator로 Auto-Instrumentation을 주입할 수 있다. 그런데 환경변수 설정을 올바르게 하지 않거나 OpenTelemetry Collector에서 proccessor 설정을 제대로 해주지 않으면, Resource attribute중 k8s.namespace.name가 빈문자열로 보내질 수 있다. 이러한 경우에 Auto-Instrumentation에서 Resource attribute가 어떻게 자동으로 설정되는지 resourceDetector들을 이해하면 쉽게 해결할 수 있다. 따라서 이번 글에서는 Resource Detector들에 대해서 자세히 살펴본다."/><meta name="twitter:image" content="https://jayground8.github.io/static/images/social-banner.png"/><link rel="canonical" href="https://jayground8.github.io/blog/20250119-otel-gcp-detector"/><meta property="article:published_time" content="2025-01-19T00:00:00.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jayground8.github.io/blog/20250119-otel-gcp-detector"
  },
  "headline": "OpenTelemetry GcpDetector를 이해하기",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://jayground8.github.io/static/images/social-banner.png"
    }
  ],
  "datePublished": "2025-01-19T00:00:00.000Z",
  "dateModified": "2025-01-19T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jay"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Jay",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jayground8.github.ioplayground.png"
    }
  },
  "description": "OpenTelemetry Operator로 Auto-Instrumentation을 주입할 수 있다. 그런데 환경변수 설정을 올바르게 하지 않거나 OpenTelemetry Collector에서 proccessor 설정을 제대로 해주지 않으면, Resource attribute중 k8s.namespace.name가 빈문자열로 보내질 수 있다. 이러한 경우에 Auto-Instrumentation에서 Resource attribute가 어떻게 자동으로 설정되는지 resourceDetector들을 이해하면 쉽게 해결할 수 있다. 따라서 이번 글에서는 Resource Detector들에 대해서 자세히 살펴본다."
}</script><meta name="next-head-count" content="24"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preload" href="/_next/static/css/414f98a58444a4f1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/414f98a58444a4f1.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-690364db8bfb1f01.js" defer=""></script><script src="/_next/static/chunks/main-eea1c213342d95c3.js" defer=""></script><script src="/_next/static/chunks/pages/_app-5b5ab7804f808f5a.js" defer=""></script><script src="/_next/static/chunks/675-70b09cbf0a5309ea.js" defer=""></script><script src="/_next/static/chunks/410-35c4fb535edd9439.js" defer=""></script><script src="/_next/static/chunks/712-376d32740a4ac813.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-8ab66ff6ebabec4c.js" defer=""></script><script src="/_next/static/aZB0OZMJIIlSfZorUzSCa/_buildManifest.js" defer=""></script><script src="/_next/static/aZB0OZMJIIlSfZorUzSCa/_ssgManifest.js" defer=""></script><script src="/_next/static/aZB0OZMJIIlSfZorUzSCa/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="Jayground8" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" width="53.87" height="43.61" viewBox="0 0 512 512" class="fill-black dark:fill-white"><path d="M368.4 17c-8.8 1.3-18.3 5-25.3 9.9-3.8 2.5-22.6 16.1-41.9 30.1-37.1 26.9-38.6 28.3-36.3 33.9 1.7 4 4.9 5.1 14.6 5.1h8.5v128h-17.9c-18.2 0-22.2.6-27.3 4.2l-2.8 1.9V116.9l2.5-2.4c1.5-1.6 3.6-2.5 5.5-2.5s4 .9 5.5 2.5l2.5 2.4v42c0 29.1.3 42.8 1.1 44.5 2.6 5.7 11.5 5.5 13.9-.3.7-1.9 1-15.6.8-46.2-.3-40.1-.4-43.7-2.2-46.9-4.8-9-11.9-13.4-21.6-13.4-13.8 0-22.8 9.1-23.8 24.1l-.5 7.3h-31.5l-1.2-2.9c-1.6-3.9-6-5.8-9.9-4.1-1.6.6-3.5 2.5-4.1 4.1l-1.2 2.9h-63.6l-1.2-2.9c-2.5-6.2-11.5-6.2-14 0l-1.2 2.9H64.3l-.5-7.3c-1-15-10-24.1-23.8-24.1-9.7 0-16.8 4.4-21.6 13.4-1.8 3.3-1.9 7.5-2.2 75-.2 50 .1 72.3.8 74.1 2.1 5.1 8.6 6.3 12.5 2.4l2.5-2.4V116.9l2.5-2.4c3.2-3.3 7.8-3.3 11 0l2.5 2.4V448H32V284.9l-2.5-2.4c-3.8-3.9-10.2-2.7-12.4 2.2-1.6 3.4-1.6 171.2 0 174.6.6 1.4 2.2 3 3.6 3.6 1.6.7 15.6 1.1 43.7 1.1 38 0 41.5-.1 43.4-1.8 1.2-.9 33.4-50.5 71.7-110.2 38.3-59.7 70.5-109.3 71.7-110.3 1.8-1.5 4.3-1.7 19.4-1.7H288v16h-12.5c-13.1 0-16.6.8-18.3 4.4-2 4.5-138.5 216.2-140.4 217.9-1.9 1.6-5.6 1.7-47.9 1.7-31.9 0-46.6.3-48.3 1.1-5.7 2.6-5.5 11.5.3 13.9 1.9.7 16.7 1 50.1.8 46.4-.3 47.6-.3 51.5-2.5 2.2-1.1 5.1-3.3 6.5-4.7 1.3-1.5 10.1-14.7 19.6-29.4l17.1-26.7 18.4-.5c10.1-.3 19.1-.9 20-1.3.9-.5 2.1-1.9 2.8-3.3 1.5-3.4 1.5-35.4 0-38.8-1.1-2.3-4-4-8-4.8-1.3-.2 1.5-5.2 11.5-20.7l13.1-20.5.5 56.5c.3 31 .9 57.1 1.3 58 1.5 3 5.6 3.9 18.2 3.9H256v14c0 14.9.7 18.1 4.7 19.9 1.7.8 34.7 1.1 115.3 1.1s113.6-.3 115.3-1.1c1.4-.6 3-2.2 3.6-3.6 1.5-3.4 1.5-83.2 0-86.6-2.2-4.9-8.6-6.1-12.4-2.2l-2.5 2.4V480H272V272h208v107.1l2.5 2.4c3.8 3.9 10.2 2.7 12.4-2.2 1.5-3.4 1.5-115.2 0-118.6-1.8-3.9-5-4.7-18.4-4.7H464v-40.5c0-27.9-.3-41.2-1.1-42.9-2.6-5.5-11.2-5.5-13.8 0-.8 1.7-1.1 15-1.1 42.9V256h-24v-34.5c0-21.3-.4-36.4-1.1-39.7-3.6-17.3-19.3-32.9-36.7-36.7-16.2-3.4-31.4 1.1-43.3 12.9-7.4 7.3-11.2 13.9-13.4 23.2-1.8 7.9-2.1 50.3-.4 54.2 1.6 3.5 6.1 5.2 9.8 3.7 4.7-2 5.1-4.2 5.1-29.6 0-21.5.2-23.9 2.2-29.2C350.6 168.4 363 160 376 160s25.4 8.4 29.8 20.3c2.1 5.5 2.2 7.4 2.2 40.7v35H304V96h144v24.5c0 16 .4 25.3 1.1 26.9 2.6 5.5 11.2 5.5 13.8 0 .7-1.6 1.1-10.9 1.1-26.9V96h8.5c9.7 0 12.9-1.1 14.6-5.1 2.1-5.2.1-7.5-17.7-20.4C446.2 53.8 445 53 442.1 53c-4.1.1-7.5 3.5-7.5 7.7 0 4 2.2 6.3 14.8 15.3l4.8 3.5-39.1.3c-21.5.1-56.7.1-78.2 0l-39.1-.3 14.9-10.7c8.2-5.9 20.7-15.1 27.8-20.4 14.5-10.8 20.5-14 29.4-15.5 11.6-2.1 22.4 1.3 36.5 11.4 4.3 3.1 9 5.7 10.3 5.7 3.9 0 7.5-4.4 7.1-8.7-.3-3.3-1.1-4.4-7.8-9.6-15.3-11.8-32.3-17.1-47.6-14.7zM96 152v8H64v-16h32v8zm80 0v8h-64v-16h64v8zm48 0v8h-32v-16h32v8zM96 280v104h-4.5c-5.5 0-9 1.5-10.4 4.7-1.5 3.3-1.5 35.4 0 38.7 1.7 3.6 3.1 4 16.2 4.6l11.9.5-5.1 7.7L99 448H64V176h32v104zm80-27.8v76.3l-17.8 27.7-17.7 27.7-14.2.1H112V176h64v76.2zm48-37.3v38.9l-15.6 24.4c-8.6 13.3-15.8 24.5-16 24.7-.2.2-.4-28.2-.4-63.2V176h32v38.9zM256 369v76h-16V317.1l7.8-12c4.2-6.7 7.8-12.1 8-12.1.1 0 .2 34.2.2 76zm-129.1 34.7c-1.2 2.1-3.6 5.7-5.1 8l-2.9 4.3H96v-16h33.2l-2.3 3.7zM192 408v8h-15.1l3.7-5.8c2-3.1 4.4-6.7 5.2-8 .8-1.2 2.4-2.2 3.8-2.2 2.3 0 2.4.2 2.4 8z"></path><path d="M322.5 114.5c-1.6 1.5-2.5 3.6-2.5 5.5s.9 4 2.5 5.5c1.5 1.6 3.6 2.5 5.5 2.5s4-.9 5.5-2.5c1.6-1.5 2.5-3.6 2.5-5.5s-.9-4-2.5-5.5c-1.5-1.6-3.6-2.5-5.5-2.5s-4 .9-5.5 2.5zM418.5 114.5c-1.6 1.5-2.5 3.6-2.5 5.5s.9 4 2.5 5.5c1.5 1.6 3.6 2.5 5.5 2.5s4-.9 5.5-2.5c1.6-1.5 2.5-3.6 2.5-5.5s-.9-4-2.5-5.5c-1.5-1.6-3.6-2.5-5.5-2.5s-4 .9-5.5 2.5zM290.2 290.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6zM450.5 290.5c-5 4.9-1.5 13.5 5.5 13.5 4.1 0 8-3.9 8-8s-3.9-8-8-8c-1.9 0-4 .9-5.5 2.5zM358.1 322c-8.3 2.2-16.5 5.7-19.8 8.6-3.3 2.8-3.9 7.3-1.4 10.6 3.3 4.1 6.4 4.3 13.8.8 23.3-10.9 47.3-7 64.8 10.5 11.5 11.4 16.5 23.6 16.5 39.7 0 15.9-5.1 28.1-16.4 39.4C404.2 443 392.1 448 376 448s-28.1-5-39.5-16.5c-11-11.1-16.5-24.2-16.5-39.5.1-9.5 1.2-14.5 5.6-24.3 3.8-8.3 3.8-10.4.1-14.5-4.7-5.1-10.8-1.7-15.4 8.6-8.6 19.5-8.4 42.7.6 61.7 9.1 19.3 28.3 34.5 49.5 39 11.9 2.6 28.4 1.7 39.3-2.2 23.9-8.6 41.3-27.9 46.9-51.9 1.9-8.5 1.9-24.4-.1-33.1-5.9-25.5-26.7-46.6-52.5-53.3-10.1-2.6-25.8-2.6-35.9 0zM290.2 450.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6zM450.2 450.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6z"></path></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">Jayground8</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">블로그</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-0 left-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><div class="flex justify-end"><button type="button" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">블로그</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2025-01-19T00:00:00.000Z">2025년 1월 19일 일요일</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">OpenTelemetry GcpDetector를 이해하기</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2738%27%20height=%2738%27/%3e"/></span><img alt="avatar" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="h-10 w-10 rounded-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="avatar" srcSet="https://jayground8.github.io/static/images/profile.png?w=48&amp;q=75 1x, https://jayground8.github.io/static/images/profile.png?w=96&amp;q=75 2x" src="https://jayground8.github.io/static/images/profile.png?w=96&amp;q=75" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="h-10 w-10 rounded-full" loading="lazy"/></noscript></span><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Jay</dd><dt class="sr-only">Twitter</dt><dd></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><p>아래와 같은 환경에서 운영할 때, 어떻게 Resource attribute들이 설정되는지 세부적으로 이해하지 못하면 <code>k8s.namespace.name</code>이나 <code>container.name</code>이 빈 문자열로 나오는 것에 대한 해결책을 찾는데 시간을 낭비할 수 있다. 따라서 이번 글에서는 어떻게 구성되어 있는 자세한 설명을 하고자 한다.</p><h2 id="가정된-환경"><a href="#가정된-환경" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>가정된 환경</h2><ul><li>GKE에서 OpenTelemetry로 Log, Metric, Trace를 수집</li><li><a target="_blank" rel="noopener noreferrer" href="https://opentelemetry.io/docs/kubernetes/operator/automatic/">OpenTelemetry Operator로 Auto injection</a>을 설정</li><li>Nodejs로 application을 개발</li></ul><h2 id="injecting-auto-instrumentation"><a href="#injecting-auto-instrumentation" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Injecting Auto-Instrumentation</h2><p><a target="_blank" rel="noopener noreferrer" href="https://opentelemetry.io/docs/languages/js/getting-started/nodejs/">OpenTelemetry 공식 문서에서 Nodejs에서 어플리케이션 코드를 수정하지 않고 --require flag를 통해서 OpenTelemetry Instrumentation 설정하는 것을 설명한다.</a> OpenTelemetry Operator를 통해서 Auto-Instrumentation을 설정하면, Init Container를 통해서 필요한 npm module과 스크립트를 특정 위치에 mounting한다. 그리고 나의 Nodejs Application Container에 환경변수로 <code>NODE_OPTIONS</code>를 아래와 같이 설정한다.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">--require /otel-auto-instrumentation-nodejs/autoinstrumentation.js
</span></code></pre></div><p><a target="_blank" rel="noopener noreferrer" href="https://github.com/open-telemetry/opentelemetry-operator/blob/main/autoinstrumentation/nodejs/src/autoinstrumentation.ts"><code>autoinstrumentation.js</code>는 아래와 같이 작성되어 있다.</a> Nodejs에서는 Trace와 Metric에 대해서 설정이 되기 때문에, Log는 Log API를 통해서 별도로 설정해야 한다.</p><div class="relative"><pre><code class="code-highlight language-js"><span class="code-line"><span class="token keyword">function</span> <span class="token function">getTraceExporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">let</span> protocol <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">OTEL_EXPORTER_OTLP_PROTOCOL</span>
</span><span class="code-line">  <span class="token keyword control-flow">switch</span> <span class="token punctuation">(</span>protocol<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">case</span> <span class="token keyword nil">undefined</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token keyword">case</span> <span class="token string">&#x27;&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token keyword">case</span> <span class="token string">&#x27;grpc&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">      <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">OTLPGrpcTraceExporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">case</span> <span class="token string">&#x27;http/json&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">      <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">OTLPHttpTraceExporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">case</span> <span class="token string">&#x27;http/protobuf&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">      <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">OTLPProtoTraceExporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword module">default</span><span class="token operator">:</span>
</span><span class="code-line">      <span class="token keyword control-flow">throw</span> <span class="token class-name known-class-name">Error</span><span class="token punctuation">(</span>
</span><span class="code-line">        <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string">Creating traces exporter based on &quot;</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>protocol<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string">&quot; protocol (configured via environment variable OTEL_EXPORTER_OTLP_PROTOCOL) is not implemented!</span><span class="token string template-punctuation">`</span></span>
</span><span class="code-line">      <span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">function</span> <span class="token function">getMetricReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword control-flow">switch</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">OTEL_METRICS_EXPORTER</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">case</span> <span class="token keyword nil">undefined</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token keyword">case</span> <span class="token string">&#x27;&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">    <span class="token keyword">case</span> <span class="token string">&#x27;otlp&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">      diag<span class="token punctuation">.</span><span class="token function property-access method">info</span><span class="token punctuation">(</span><span class="token string">&#x27;using otel metrics exporter&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">PeriodicExportingMetricReader</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">        exporter<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">OTLPMetricExporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">case</span> <span class="token string">&#x27;prometheus&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">      diag<span class="token punctuation">.</span><span class="token function property-access method">info</span><span class="token punctuation">(</span><span class="token string">&#x27;using prometheus metrics exporter&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">PrometheusExporter</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">case</span> <span class="token string">&#x27;none&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">      diag<span class="token punctuation">.</span><span class="token function property-access method">info</span><span class="token punctuation">(</span><span class="token string">&#x27;disabling metrics reader&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token keyword control-flow">return</span> <span class="token keyword nil">undefined</span>
</span><span class="code-line">    <span class="token keyword module">default</span><span class="token operator">:</span>
</span><span class="code-line">      <span class="token keyword control-flow">throw</span> <span class="token class-name known-class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string">no valid option for OTEL_METRICS_EXPORTER: </span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">OTEL_METRICS_EXPORTER</span><span class="token punctuation interpolation-punctuation">}</span></span><span class="token string template-punctuation">`</span></span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> sdk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NodeSDK</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">  autoDetectResources<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line">  instrumentations<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">getNodeAutoInstrumentations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">  traceExporter<span class="token operator">:</span> <span class="token function">getTraceExporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">  metricReader<span class="token operator">:</span> <span class="token function">getMetricReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">  resourceDetectors<span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-line">    <span class="token comment">// Standard resource detectors.</span>
</span><span class="code-line">    containerDetector<span class="token punctuation">,</span>
</span><span class="code-line">    envDetector<span class="token punctuation">,</span>
</span><span class="code-line">    hostDetector<span class="token punctuation">,</span>
</span><span class="code-line">    osDetector<span class="token punctuation">,</span>
</span><span class="code-line">    processDetector<span class="token punctuation">,</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// Cloud resource detectors.</span>
</span><span class="code-line">    alibabaCloudEcsDetector<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token comment">// Ordered AWS Resource Detectors as per:</span>
</span><span class="code-line">    <span class="token comment">// https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/processor/resourcedetectionprocessor/README.md#ordering</span>
</span><span class="code-line">    awsEksDetector<span class="token punctuation">,</span>
</span><span class="code-line">    awsEc2Detector<span class="token punctuation">,</span>
</span><span class="code-line">    gcpDetector<span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">sdk<span class="token punctuation">.</span><span class="token function property-access method">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><h2 id="resourcedetector"><a href="#resourcedetector" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>resourceDetector</h2><p>위에서 OpenTelemetry Operator가 Auto-Instrumentation을 주입하는 방법을 간략하게 살펴보았다. <code>NODE_OPTIONS</code> 환경변수말고도 OpenTelemetry Operator에 의해서 설정되는 환경변수들이 존재한다. 그중에 <code>OTEL_RESOURCE_ATTRIBUTES</code>는 아래와 같이 설정이 되어 있다. (보기 편하도록 줄바꿈을 추가했다. 실제로는 줄바꿈없이 한줄의 문자열로 되어 있다.)</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">k8s.container.name<span class="token operator">=</span>app,
</span><span class="code-line">k8s.deployment.name<span class="token operator">=</span>example,
</span><span class="code-line">k8s.namespace.name<span class="token operator">=</span>tutorial,
</span><span class="code-line">k8s.node.name<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>OTEL_RESOURCE_ATTRIBUTES_NODE_NAME<span class="token variable">)</span></span>,
</span><span class="code-line">k8s.pod.name<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>OTEL_RESOURCE_ATTRIBUTES_POD_NAME<span class="token variable">)</span></span>,
</span><span class="code-line">k8s.replicaset.name<span class="token operator">=</span>tutorial-54bb8755cf,
</span><span class="code-line">service.instance.id<span class="token operator">=</span>dtutorial.<span class="token variable"><span class="token variable">$(</span>OTEL_RESOURCE_ATTRIBUTES_POD_NAME<span class="token variable">)</span></span>.app,
</span><span class="code-line">service.version<span class="token operator">=</span>3faacb70440664dc3dea73d21aab98ffe90e3e24
</span></code></pre></div><p>위의 <code>autoinstrumentation.js</code> 코드에서 resourceDetectors부분이 아래와 같이 설정되어 있었다. 자동으로 OpenTelemetry Resource attribute들을 설정해주는 Detector들이 정의되어 있다.</p><div class="relative"><pre><code class="code-highlight language-js"><span class="code-line">resourceDetectors<span class="token operator">:</span>
</span><span class="code-line"><span class="token punctuation">[</span>
</span><span class="code-line">    <span class="token comment">// Standard resource detectors.</span>
</span><span class="code-line">    containerDetector<span class="token punctuation">,</span>
</span><span class="code-line">    envDetector<span class="token punctuation">,</span>
</span><span class="code-line">    hostDetector<span class="token punctuation">,</span>
</span><span class="code-line">    osDetector<span class="token punctuation">,</span>
</span><span class="code-line">    processDetector<span class="token punctuation">,</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// Cloud resource detectors.</span>
</span><span class="code-line">    alibabaCloudEcsDetector<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token comment">// Ordered AWS Resource Detectors as per:</span>
</span><span class="code-line">    <span class="token comment">// https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/processor/resourcedetectionprocessor/README.md#ordering</span>
</span><span class="code-line">    awsEksDetector<span class="token punctuation">,</span>
</span><span class="code-line">    awsEc2Detector<span class="token punctuation">,</span>
</span><span class="code-line">    gcpDetector<span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span></code></pre></div><h3 id="envdetector"><a href="#envdetector" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>envDetector</h3><p>resourceDetectors Array를 보면 envDetector가 보인다. <a target="_blank" rel="noopener noreferrer" href="https://github.com/open-telemetry/opentelemetry-js/blob/main/packages/opentelemetry-resources/src/detectors/EnvDetectorSync.ts">소스코드를 보면 아래와 같이 OTEL_RESOURCE_ATTRIBUTES 환경변수의 값을 사용하여 Resourc의 attribute를 설정하는 것을 확인할 수 있다.</a> OpenTelemetry Operator가 OTEL_RESOURCE_ATTRIBUTES를 자동으로 설정하고, envDetector에 의해서 자동으로 Resource attribute들이 설정되는 것이다.</p><div class="relative"><pre><code class="code-highlight language-js"><span class="code-line"><span class="token function">detect</span><span class="token punctuation">(</span>_config<span class="token operator">?</span><span class="token operator">:</span> <span class="token maybe-class-name">ResourceDetectionConfig</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token maybe-class-name">IResource</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> attributes<span class="token operator">:</span> <span class="token maybe-class-name">Attributes</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> env <span class="token operator">=</span> <span class="token function">getEnv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">const</span> rawAttributes <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token constant">OTEL_RESOURCE_ATTRIBUTES</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> serviceName <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token constant">OTEL_SERVICE_NAME</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>rawAttributes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword">const</span> parsedAttributes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function property-access method">_parseResourceAttributes</span><span class="token punctuation">(</span>rawAttributes<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token class-name known-class-name">Object</span><span class="token punctuation">.</span><span class="token function property-access method">assign</span><span class="token punctuation">(</span>attributes<span class="token punctuation">,</span> parsedAttributes<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      diag<span class="token punctuation">.</span><span class="token function property-access method">debug</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string">EnvDetector failed: </span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>e<span class="token punctuation">.</span><span class="token property-access">message</span><span class="token punctuation interpolation-punctuation">}</span></span><span class="token string template-punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>serviceName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    attributes<span class="token punctuation">[</span><span class="token constant">SEMRESATTRS_SERVICE_NAME</span><span class="token punctuation">]</span> <span class="token operator">=</span> serviceName<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">Resource</span><span class="token punctuation">(</span>attributes<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p><code>OTEL_LOG_LEVEL</code> 환경변수를 <code>DEBUG</code>로 설정하면 아래와 같이 envDetector로 설정된 것을 확인할 수 있다.</p><div class="relative"><pre><code class="code-highlight language-js"><span class="code-line"><span class="token maybe-class-name">EnvDetector</span> found resource<span class="token punctuation">.</span> <span class="token property-access"><span class="token maybe-class-name">Resource</span></span> <span class="token punctuation">{</span>
</span><span class="code-line">  _attributes<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token string">&#x27;k8s.container.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;app&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;k8s.deployment.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;example&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;k8s.namespace.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;tutorial&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;k8s.node.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;gke-tutorial-k8s-cluster-default-pool-d4535262-s702&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;k8s.pod.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;example-54bb8755cf-7fgkp&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;k8s.replicaset.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;example-54bb8755cf&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;service.instance.id&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;tutorial.example-54bb8755cf-7fgkp.app&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;service.version&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;3faacb70440664dc3dea73d21aab98ffe90e3e24&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;service.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;example-svc&#x27;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  asyncAttributesPending<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line">  _syncAttributes<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  _asyncAttributesPromise<span class="token operator">:</span> <span class="token class-name known-class-name">Promise</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token string">&#x27;k8s.container.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;app&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token string">&#x27;k8s.deployment.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;example&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token string">&#x27;k8s.namespace.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;tutorial&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token string">&#x27;k8s.node.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;gke-tutorial-k8s-cluster-default-pool-d4535262-s702&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token string">&#x27;k8s.pod.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;example-54bb8755cf-7fgkp&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token string">&#x27;k8s.replicaset.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;example-54bb8755cf&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token string">&#x27;service.instance.id&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;tutorial.example-54bb8755cf-7fgkp.app&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token string">&#x27;service.version&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;3faacb70440664dc3dea73d21aab98ffe90e3e24&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token string">&#x27;service.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;example-svc&#x27;</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">[</span><span class="token class-name known-class-name">Symbol</span><span class="token punctuation">(</span>async_id_symbol<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">111</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">[</span><span class="token class-name known-class-name">Symbol</span><span class="token punctuation">(</span>trigger_async_id_symbol<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">0</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h3 id="gcpdetector"><a href="#gcpdetector" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>gcpDetector</h3><p>resourceDetectors Array의 마지막 index에 <code>gcpDetector</code>가 있다. GKE를 사용하는 경우에는 해당 detector의 로직이 실행된다. <a target="_blank" rel="noopener noreferrer" href="https://github.com/open-telemetry/opentelemetry-js-contrib/blob/main/detectors/node/opentelemetry-resource-detector-gcp/src/detectors/GcpDetector.ts"><code>gcpDetector</code>의 소스코드를 살펴보면 아래와 같이 k8s.namespace.name과 k8s.container.name을 특정 환경변수로 설정되는 것을 확인할 수 있다.</a> envDetector를 통해서 설정되었던 k8s.namespace.name과 container.name이 마지막의 gcpDetector에 의해서 덮어쓰기가 되는 것이다. Container에 NAMESPACE, CONTAINER_NAME 환경변수가 설정되지 않았다면 이제 이부분이 빈 문자열로 덮어쓰여진다.</p><div class="relative"><pre><code class="code-highlight language-js"><span class="code-line"><span class="token keyword">private</span> <span class="token function">_addK8sAttributes</span><span class="token punctuation">(</span>
</span><span class="code-line">  attributes<span class="token operator">:</span> <span class="token maybe-class-name">ResourceAttributes</span><span class="token punctuation">,</span>
</span><span class="code-line">  clusterName<span class="token operator">:</span> string
</span><span class="code-line"><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> env <span class="token operator">=</span> <span class="token function">getEnv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  attributes<span class="token punctuation">[</span><span class="token constant">SEMRESATTRS_K8S_CLUSTER_NAME</span><span class="token punctuation">]</span> <span class="token operator">=</span> clusterName<span class="token punctuation">;</span>
</span><span class="code-line">  attributes<span class="token punctuation">[</span><span class="token constant">SEMRESATTRS_K8S_NAMESPACE_NAME</span><span class="token punctuation">]</span> <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token constant">NAMESPACE</span><span class="token punctuation">;</span>
</span><span class="code-line">  attributes<span class="token punctuation">[</span><span class="token constant">SEMRESATTRS_K8S_POD_NAME</span><span class="token punctuation">]</span> <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token constant">HOSTNAME</span><span class="token punctuation">;</span>
</span><span class="code-line">  attributes<span class="token punctuation">[</span><span class="token constant">SEMRESATTRS_CONTAINER_NAME</span><span class="token punctuation">]</span> <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token constant">CONTAINER_NAME</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p><code>OTEL_LOG_LEVEL</code> 환경변수를 <code>DEBUG</code>로 설정하면 아래와 같이 설정된 것을 확인할 수 있다.</p><div class="relative"><pre><code class="code-highlight language-js"><span class="code-line"><span class="token maybe-class-name">GcpDetector</span> found resource<span class="token punctuation">.</span> <span class="token property-access"><span class="token maybe-class-name">Resource</span></span> <span class="token punctuation">{</span>
</span><span class="code-line">  _attributes<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token string">&#x27;cloud.account.id&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;tutorial-prj&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;host.id&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;6769112033492981631&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;host.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;gke-tutorial-k8s-cluster-default-pool-d4535262-s702.c.tutorial-prj.internal&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;cloud.availability_zone&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;us-west1-a&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;cloud.provider&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;gcp&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;k8s.cluster.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;tutorial-k8s-cluster&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;k8s.namespace.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;k8s.pod.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;example-54bb8755cf-7fgkp&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token string">&#x27;container.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;&#x27;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  asyncAttributesPending<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line">  _syncAttributes<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  _asyncAttributesPromise<span class="token operator">:</span> <span class="token class-name known-class-name">Promise</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token string">&#x27;cloud.account.id&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;tutorial-prj&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token string">&#x27;host.id&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;6769112033492981631&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token string">&#x27;host.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;gke-tutorial-k8s-cluster-default-pool-d4535262-s702.c.tutorial-prj.internal&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token string">&#x27;cloud.availability_zone&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;us-west1-a&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token string">&#x27;cloud.provider&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;gcp&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token string">&#x27;k8s.cluster.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;tutorial-k8s-cluster&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token string">&#x27;k8s.namespace.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token string">&#x27;k8s.pod.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;example-54bb8755cf-7fgkp&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token string">&#x27;container.name&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;&#x27;</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">[</span><span class="token class-name known-class-name">Symbol</span><span class="token punctuation">(</span>async_id_symbol<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">44635</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">[</span><span class="token class-name known-class-name">Symbol</span><span class="token punctuation">(</span>trigger_async_id_symbol<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">0</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h2 id="pod"><a href="#pod" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>pod</h2><p>이제 auto-instrumentation을 사용할 때, 다양한 종류의 resource detector를 통해서 resource attribute가 자동으로 설정되는 것을 이해했다. 그리고 resource detector의 순서에 따라서 GKE를 사용할 때는 gcpDetector에서 필요한 환경변수를 설정해야 되는 것을 알았다. 따라서 Pod에 아래와 같이 필요한 환경변수를 추가해준다. 이제 위에서 gcpDetector에서 빈문자열 값이 원하던 값으로 설정된 것으로 확인할 수 있다.</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">env</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> NAMESPACE
</span><span class="code-line">    <span class="token atrule key">valueFrom</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">fieldRef</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">fieldPath</span><span class="token punctuation">:</span> metadata.namespace
</span><span class="code-line">  <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> CONTAINER_NAME
</span><span class="code-line">    <span class="token atrule key">value</span><span class="token punctuation">:</span> app
</span></code></pre></div><h2 id="opentelelemetry-collector"><a href="#opentelelemetry-collector" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>OpenTelelemetry Collector</h2><p>실제로 OpenTelemetry를 사용할 때, OpenTelemetry Collector를 활용하는 것을 추천한다. OpenTelemetry에서 여러가지 처리를 해주는 processor에서 <a target="_blank" rel="noopener noreferrer" href="https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/processor/k8sattributesprocessor/README.md">Kubernetes Attribute Processor</a>를 활횽하면 OpenTelemetry Colllector에서 필요한 Resource Attribute들을 설정할 수가 있다. k8s.namespace.name은 default로 설정되어 있다.</p><ul><li>k8s.namespace.name</li><li>k8s.pod.name</li><li>k8s.pod.uid</li><li>k8s.pod.start_time</li><li>k8s.deployment.name</li><li>k8s.node.name</li></ul><p>그리고 container.id resource attribute가 제공되면 k8s Attribute Processor에서 아래와 같은 attribute들도 추가할 수 있다.</p><ul><li>k8s.container.name</li><li>container.image.name</li><li>container.image.tag</li><li>container.image.repo_digests</li></ul><p>위에서 containerDetector가 Array의 첫번째 값으로 설정되어 있는 것을 확인해보자. <a target="_blank" rel="noopener noreferrer" href="https://github.com/open-telemetry/opentelemetry-js-contrib/blob/main/detectors/node/opentelemetry-resource-detector-container/src/detectors/ContainerDetector.ts">containerDetector는 container.id을 자동으로 채워주는 역할을 한다.</a> Kubernetes에서는 <a target="_blank" rel="noopener noreferrer" href="https://kubernetes.io/docs/concepts/workloads/pods/downward-api/">Downward API를 통해서 pod 이름, pod의 namespace 등을 참조할 수 있다.</a> 하지만 container.id는 Kubernetes에서 제공하는 방법이 없다. 따라서 containerDectector에서는 아래와 같이 Cgroup이 V1일 때와 V2일 때 proc file system에 있는 정보를 통해서 container id를 가져오려고 한다.</p><div class="relative"><pre><code class="code-highlight language-ts"><span class="code-line"><span class="token keyword">readonly</span> <span class="token constant">DEFAULT_CGROUP_V1_PATH</span> <span class="token operator">=</span> <span class="token string">&#x27;/proc/self/cgroup&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">readonly</span> <span class="token constant">DEFAULT_CGROUP_V2_PATH</span> <span class="token operator">=</span> <span class="token string">&#x27;/proc/self/mountinfo&#x27;</span><span class="token punctuation">;</span>
</span></code></pre></div><p>GKE에서는 현재 버전에서는 cgroup V2으로 기본 운영된다. V1은 deprecated될 예정이다. 따라서 containerDetector에서 /proc/self/mountinfo를 통해서 contaienr id를 가져올려고 하지만, 해당 파일에 contaienr id 정보가 없다. 따라서 containerDetector로 container.id를 정상적으로 설정하지 못 한다.</p><blockquote><p>For versions 1.26 or later, cgroupv2 is the default for new nodes.</p></blockquote><p>지금까지 설명으로 봤을 때는 k8s Attribute Processor가 k8s.namespace.name을 채워줄 것으로 기대된다. 하지만 k8s Attribute Processor는 telemetry data에 이미 존재하는 resource atrribute에 대해서 덮어쓰기를 하지 않는다. 이미 Auto-Instrumentation을 통해서 k8s.namespace.name가 빈문자열로 설정이 되었고, k8s Attribute Processor는 이 빈문자열을 유지한다.</p><p>Resource Processor에서 k8s.namespace.name을 삭제하고,</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">processors</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">resource/tester</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">attributes</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> <span class="token atrule key">action</span><span class="token punctuation">:</span> delete
</span><span class="code-line">        <span class="token atrule key">key</span><span class="token punctuation">:</span> k8s.namespace.name
</span></code></pre></div><p>그다음에 k8s Attribute Processor가 처리하게 하면 정상적으로 k8s.namespace.name가 채워지는 것을 확인할 수 있다.</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">logs</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">exporters</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> debug
</span><span class="code-line">  <span class="token atrule key">processors</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token punctuation">-</span> resource/tester
</span><span class="code-line">    <span class="token punctuation">-</span> k8sattributes
</span></code></pre></div><p>결론적으로 OpenTelemetry Operator로 Auto-Insturmentation을 주입할 때, k8s.container.name은 자동으로 채워진다. 그리고 NAMESPACE 환경변수를 통해서 GcpDetector가 k8s.namespace.name을 설정하지 않으면, 해당 Resource Attribute는 빈문자열로 설정이 된다. k8s Attribute Processor는 telemetry data의 기존 Resource Attribute에 대해서 덮어쓰기를 하지 않기 때문에, 최종적으로 exporter에는 빈문자열로 전달된다. 추가적으로 Resource Processor에서 삭제를 하고 k8s Attribute Processor가 채워넣게 할수도 있지만, GcpDetector에서 처음부터 제대로 채워넣도록 NAMESPACE 환경변수를 설정하는 것이 실수를 줄일 수 있을 것이다.</p><h2 id="결론"><a href="#결론" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>결론</h2><p>OpenTelemetry에서 Resource Attribute를 통해서 Log, Trace, Metric 데이터에 원하는 메타데이터를 추가할 수 있다. OpenTelemetry에서는 소스코드 변경없이 Instrumentation을 Java의 경우는 java agent를 통해서, nodejs는 --require flag를 통해서, 그리고 python은 sitecustomize를 이용해서 구현하고 있다. OpenTelemetry Operator를 사용하면 Auto-Instrumentation을 Kubernetes 환경에서 annotation으로 편하게 주입할 수 있다. (<a target="_blank" rel="noopener noreferrer" href="https://github.com/open-telemetry/opentelemetry-python-contrib/issues/385">참고로 Python FastAPI를 Uvicorn으로 사용할 때는 정상적으로 작동하지 않았다</a>) Auto-Instrumentation 과정에서 Resource Attribute들도 Resource Detector에 의해서 자동으로 설정이 된다. 이번 글에서는 envDetector, gcpDetector, containerDetector이 어떻게 Resource Attribute들을 자동으로 설정해주는지 살펴보았다. 혹시 GKE를 사용하는 과정에서 k8s.namespace.name이 빈문자열로 설정이 되면, resource detector들에 대한 이해를 바탕으로 올바른 설정을 해줄 수 있을 것이다.</p></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"></div><div id="comment"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/gcp">gcp</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/kubernetes">kubernetes</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/opentelemetry">opentelemetry</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/20250117-google-oidc-bitbucket">Bitbucket OIDC with GCP</a></div></div><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/20250125-google-cloud-exporter">Google Cloud Exporter가 Log의 Resource Attribute를 Cloud Logging Label로 어떻게 변환할까?</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:jayground8@gmail.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/jayground8"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Jay</div><div> • </div><div>© 2025</div><div> • </div><a href="/">Jayground8</a></div><div class="mb-8 text-sm text-gray-500 dark:text-gray-400"><a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var i=Object.create;var t=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty;var l=a=\u003et(a,\"__esModule\",{value:!0});var u=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=\u003e{l(a);for(var c in s)t(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let n of d(s))!h.call(a,n)\u0026\u0026n!==\"default\"\u0026\u0026t(a,n,{get:()=\u003es[n],enumerable:!(c=p(s,n))||c.enumerable});return a},g=a=\u003ek(l(t(a!=null?i(m(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var r=u((T,o)=\u003e{o.exports=_jsx_runtime});var f={};N(f,{default:()=\u003eE,frontmatter:()=\u003ey});var e=g(r()),y={title:\"OpenTelemetry GcpDetector\\uB97C \\uC774\\uD574\\uD558\\uAE30\",date:\"2025-01-19\",tags:[\"gcp\",\"kubernetes\",\"opentelemetry\"],images:[\"/static/images/social-banner.png\"],summary:\"OpenTelemetry Operator\\uB85C Auto-Instrumentation\\uC744 \\uC8FC\\uC785\\uD560 \\uC218 \\uC788\\uB2E4. \\uADF8\\uB7F0\\uB370 \\uD658\\uACBD\\uBCC0\\uC218 \\uC124\\uC815\\uC744 \\uC62C\\uBC14\\uB974\\uAC8C \\uD558\\uC9C0 \\uC54A\\uAC70\\uB098 OpenTelemetry Collector\\uC5D0\\uC11C proccessor \\uC124\\uC815\\uC744 \\uC81C\\uB300\\uB85C \\uD574\\uC8FC\\uC9C0 \\uC54A\\uC73C\\uBA74, Resource attribute\\uC911 k8s.namespace.name\\uAC00 \\uBE48\\uBB38\\uC790\\uC5F4\\uB85C \\uBCF4\\uB0B4\\uC9C8 \\uC218 \\uC788\\uB2E4. \\uC774\\uB7EC\\uD55C \\uACBD\\uC6B0\\uC5D0 Auto-Instrumentation\\uC5D0\\uC11C Resource attribute\\uAC00 \\uC5B4\\uB5BB\\uAC8C \\uC790\\uB3D9\\uC73C\\uB85C \\uC124\\uC815\\uB418\\uB294\\uC9C0 resourceDetector\\uB4E4\\uC744 \\uC774\\uD574\\uD558\\uBA74 \\uC27D\\uAC8C \\uD574\\uACB0\\uD560 \\uC218 \\uC788\\uB2E4. \\uB530\\uB77C\\uC11C \\uC774\\uBC88 \\uAE00\\uC5D0\\uC11C\\uB294 Resource Detector\\uB4E4\\uC5D0 \\uB300\\uD574\\uC11C \\uC790\\uC138\\uD788 \\uC0B4\\uD3B4\\uBCF8\\uB2E4.\"};function b(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({p:\"p\",code:\"code\",h2:\"h2\",a:\"a\",span:\"span\",ul:\"ul\",li:\"li\",pre:\"pre\",h3:\"h3\",blockquote:\"blockquote\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.p,{children:[\"\\uC544\\uB798\\uC640 \\uAC19\\uC740 \\uD658\\uACBD\\uC5D0\\uC11C \\uC6B4\\uC601\\uD560 \\uB54C, \\uC5B4\\uB5BB\\uAC8C Resource attribute\\uB4E4\\uC774 \\uC124\\uC815\\uB418\\uB294\\uC9C0 \\uC138\\uBD80\\uC801\\uC73C\\uB85C \\uC774\\uD574\\uD558\\uC9C0 \\uBABB\\uD558\\uBA74 \",(0,e.jsx)(n.code,{children:\"k8s.namespace.name\"}),\"\\uC774\\uB098 \",(0,e.jsx)(n.code,{children:\"container.name\"}),\"\\uC774 \\uBE48 \\uBB38\\uC790\\uC5F4\\uB85C \\uB098\\uC624\\uB294 \\uAC83\\uC5D0 \\uB300\\uD55C \\uD574\\uACB0\\uCC45\\uC744 \\uCC3E\\uB294\\uB370 \\uC2DC\\uAC04\\uC744 \\uB0AD\\uBE44\\uD560 \\uC218 \\uC788\\uB2E4. \\uB530\\uB77C\\uC11C \\uC774\\uBC88 \\uAE00\\uC5D0\\uC11C\\uB294 \\uC5B4\\uB5BB\\uAC8C \\uAD6C\\uC131\\uB418\\uC5B4 \\uC788\\uB294 \\uC790\\uC138\\uD55C \\uC124\\uBA85\\uC744 \\uD558\\uACE0\\uC790 \\uD55C\\uB2E4.\"]}),(0,e.jsxs)(n.h2,{id:\"\\uAC00\\uC815\\uB41C-\\uD658\\uACBD\",children:[(0,e.jsx)(n.a,{href:\"#\\uAC00\\uC815\\uB41C-\\uD658\\uACBD\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uAC00\\uC815\\uB41C \\uD658\\uACBD\"]}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:\"GKE\\uC5D0\\uC11C OpenTelemetry\\uB85C Log, Metric, Trace\\uB97C \\uC218\\uC9D1\"}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.a,{href:\"https://opentelemetry.io/docs/kubernetes/operator/automatic/\",children:\"OpenTelemetry Operator\\uB85C Auto injection\"}),\"\\uC744 \\uC124\\uC815\"]}),(0,e.jsx)(n.li,{children:\"Nodejs\\uB85C application\\uC744 \\uAC1C\\uBC1C\"})]}),(0,e.jsxs)(n.h2,{id:\"injecting-auto-instrumentation\",children:[(0,e.jsx)(n.a,{href:\"#injecting-auto-instrumentation\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Injecting Auto-Instrumentation\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://opentelemetry.io/docs/languages/js/getting-started/nodejs/\",children:\"OpenTelemetry \\uACF5\\uC2DD \\uBB38\\uC11C\\uC5D0\\uC11C Nodejs\\uC5D0\\uC11C \\uC5B4\\uD50C\\uB9AC\\uCF00\\uC774\\uC158 \\uCF54\\uB4DC\\uB97C \\uC218\\uC815\\uD558\\uC9C0 \\uC54A\\uACE0 --require flag\\uB97C \\uD1B5\\uD574\\uC11C OpenTelemetry Instrumentation \\uC124\\uC815\\uD558\\uB294 \\uAC83\\uC744 \\uC124\\uBA85\\uD55C\\uB2E4.\"}),\" OpenTelemetry Operator\\uB97C \\uD1B5\\uD574\\uC11C Auto-Instrumentation\\uC744 \\uC124\\uC815\\uD558\\uBA74, Init Container\\uB97C \\uD1B5\\uD574\\uC11C \\uD544\\uC694\\uD55C npm module\\uACFC \\uC2A4\\uD06C\\uB9BD\\uD2B8\\uB97C \\uD2B9\\uC815 \\uC704\\uCE58\\uC5D0 mounting\\uD55C\\uB2E4. \\uADF8\\uB9AC\\uACE0 \\uB098\\uC758 Nodejs Application Container\\uC5D0 \\uD658\\uACBD\\uBCC0\\uC218\\uB85C \",(0,e.jsx)(n.code,{children:\"NODE_OPTIONS\"}),\"\\uB97C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC124\\uC815\\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-bash\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`--require /otel-auto-instrumentation-nodejs/autoinstrumentation.js\n`})})}),(0,e.jsxs)(n.p,{children:[(0,e.jsxs)(n.a,{href:\"https://github.com/open-telemetry/opentelemetry-operator/blob/main/autoinstrumentation/nodejs/src/autoinstrumentation.ts\",children:[(0,e.jsx)(n.code,{children:\"autoinstrumentation.js\"}),\"\\uB294 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC791\\uC131\\uB418\\uC5B4 \\uC788\\uB2E4.\"]}),\" Nodejs\\uC5D0\\uC11C\\uB294 Trace\\uC640 Metric\\uC5D0 \\uB300\\uD574\\uC11C \\uC124\\uC815\\uC774 \\uB418\\uAE30 \\uB54C\\uBB38\\uC5D0, Log\\uB294 Log API\\uB97C \\uD1B5\\uD574\\uC11C \\uBCC4\\uB3C4\\uB85C \\uC124\\uC815\\uD574\\uC57C \\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-js\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getTraceExporter\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" protocol \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"OTEL_EXPORTER_OTLP_PROTOCOL\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"switch\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"protocol\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword nil\",children:\"undefined\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"''\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'grpc'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"OTLPGrpcTraceExporter\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'http/json'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"OTLPHttpTraceExporter\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'http/protobuf'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"OTLPProtoTraceExporter\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"default\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"throw\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name known-class-name\",children:\"Error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsxs)(n.span,{className:\"token template-string\",children:[(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'Creating traces exporter based on \"'}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"${\"}),\"protocol\",(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:'\" protocol (configured via environment variable OTEL_EXPORTER_OTLP_PROTOCOL) is not implemented!'}),(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getMetricReader\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"switch\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"OTEL_METRICS_EXPORTER\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword nil\",children:\"undefined\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"''\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'otlp'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      diag\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function property-access method\",children:\"info\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'using otel metrics exporter'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"PeriodicExportingMetricReader\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        exporter\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"OTLPMetricExporter\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'prometheus'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      diag\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function property-access method\",children:\"info\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'using prometheus metrics exporter'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"PrometheusExporter\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'none'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      diag\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function property-access method\",children:\"info\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'disabling metrics reader'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword nil\",children:\"undefined\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"default\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"throw\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name known-class-name\",children:\"Error\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token template-string\",children:[(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"no valid option for OTEL_METRICS_EXPORTER: \"}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"${\"}),\"process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"OTEL_METRICS_EXPORTER\"}),(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" sdk \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"NodeSDK\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  autoDetectResources\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  instrumentations\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"getNodeAutoInstrumentations\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  traceExporter\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getTraceExporter\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  metricReader\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getMetricReader\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  resourceDetectors\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Standard resource detectors.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    containerDetector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    envDetector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    hostDetector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    osDetector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    processDetector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Cloud resource detectors.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    alibabaCloudEcsDetector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Ordered AWS Resource Detectors as per:\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/processor/resourcedetectionprocessor/README.md#ordering\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    awsEksDetector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    awsEc2Detector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    gcpDetector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"sdk\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function property-access method\",children:\"start\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"resourcedetector\",children:[(0,e.jsx)(n.a,{href:\"#resourcedetector\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"resourceDetector\"]}),(0,e.jsxs)(n.p,{children:[\"\\uC704\\uC5D0\\uC11C OpenTelemetry Operator\\uAC00 Auto-Instrumentation\\uC744 \\uC8FC\\uC785\\uD558\\uB294 \\uBC29\\uBC95\\uC744 \\uAC04\\uB7B5\\uD558\\uAC8C \\uC0B4\\uD3B4\\uBCF4\\uC558\\uB2E4. \",(0,e.jsx)(n.code,{children:\"NODE_OPTIONS\"}),\" \\uD658\\uACBD\\uBCC0\\uC218\\uB9D0\\uACE0\\uB3C4 OpenTelemetry Operator\\uC5D0 \\uC758\\uD574\\uC11C \\uC124\\uC815\\uB418\\uB294 \\uD658\\uACBD\\uBCC0\\uC218\\uB4E4\\uC774 \\uC874\\uC7AC\\uD55C\\uB2E4. \\uADF8\\uC911\\uC5D0 \",(0,e.jsx)(n.code,{children:\"OTEL_RESOURCE_ATTRIBUTES\"}),\"\\uB294 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC124\\uC815\\uC774 \\uB418\\uC5B4 \\uC788\\uB2E4. (\\uBCF4\\uAE30 \\uD3B8\\uD558\\uB3C4\\uB85D \\uC904\\uBC14\\uAFC8\\uC744 \\uCD94\\uAC00\\uD588\\uB2E4. \\uC2E4\\uC81C\\uB85C\\uB294 \\uC904\\uBC14\\uAFC8\\uC5C6\\uC774 \\uD55C\\uC904\\uC758 \\uBB38\\uC790\\uC5F4\\uB85C \\uB418\\uC5B4 \\uC788\\uB2E4.)\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"k8s.container.name\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`app,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"k8s.deployment.name\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`example,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"k8s.namespace.name\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`tutorial,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"k8s.node.name\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsxs)(n.span,{className:\"token variable\",children:[(0,e.jsx)(n.span,{className:\"token variable\",children:\"$(\"}),\"OTEL_RESOURCE_ATTRIBUTES_NODE_NAME\",(0,e.jsx)(n.span,{className:\"token variable\",children:\")\"})]}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"k8s.pod.name\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsxs)(n.span,{className:\"token variable\",children:[(0,e.jsx)(n.span,{className:\"token variable\",children:\"$(\"}),\"OTEL_RESOURCE_ATTRIBUTES_POD_NAME\",(0,e.jsx)(n.span,{className:\"token variable\",children:\")\"})]}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"k8s.replicaset.name\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`tutorial-54bb8755cf,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"service.instance.id\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"dtutorial.\",(0,e.jsxs)(n.span,{className:\"token variable\",children:[(0,e.jsx)(n.span,{className:\"token variable\",children:\"$(\"}),\"OTEL_RESOURCE_ATTRIBUTES_POD_NAME\",(0,e.jsx)(n.span,{className:\"token variable\",children:\")\"})]}),`.app,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"service.version\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`3faacb70440664dc3dea73d21aab98ffe90e3e24\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uC704\\uC758 \",(0,e.jsx)(n.code,{children:\"autoinstrumentation.js\"}),\" \\uCF54\\uB4DC\\uC5D0\\uC11C resourceDetectors\\uBD80\\uBD84\\uC774 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC124\\uC815\\uB418\\uC5B4 \\uC788\\uC5C8\\uB2E4. \\uC790\\uB3D9\\uC73C\\uB85C OpenTelemetry Resource attribute\\uB4E4\\uC744 \\uC124\\uC815\\uD574\\uC8FC\\uB294 Detector\\uB4E4\\uC774 \\uC815\\uC758\\uB418\\uC5B4 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-js\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"resourceDetectors\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Standard resource detectors.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    containerDetector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    envDetector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    hostDetector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    osDetector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    processDetector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Cloud resource detectors.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    alibabaCloudEcsDetector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Ordered AWS Resource Detectors as per:\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/processor/resourcedetectionprocessor/README.md#ordering\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    awsEksDetector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    awsEc2Detector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    gcpDetector\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"envdetector\",children:[(0,e.jsx)(n.a,{href:\"#envdetector\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"envDetector\"]}),(0,e.jsxs)(n.p,{children:[\"resourceDetectors Array\\uB97C \\uBCF4\\uBA74 envDetector\\uAC00 \\uBCF4\\uC778\\uB2E4. \",(0,e.jsx)(n.a,{href:\"https://github.com/open-telemetry/opentelemetry-js/blob/main/packages/opentelemetry-resources/src/detectors/EnvDetectorSync.ts\",children:\"\\uC18C\\uC2A4\\uCF54\\uB4DC\\uB97C \\uBCF4\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 OTEL_RESOURCE_ATTRIBUTES \\uD658\\uACBD\\uBCC0\\uC218\\uC758 \\uAC12\\uC744 \\uC0AC\\uC6A9\\uD558\\uC5EC Resourc\\uC758 attribute\\uB97C \\uC124\\uC815\\uD558\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"}),\" OpenTelemetry Operator\\uAC00 OTEL_RESOURCE_ATTRIBUTES\\uB97C \\uC790\\uB3D9\\uC73C\\uB85C \\uC124\\uC815\\uD558\\uACE0, envDetector\\uC5D0 \\uC758\\uD574\\uC11C \\uC790\\uB3D9\\uC73C\\uB85C Resource attribute\\uB4E4\\uC774 \\uC124\\uC815\\uB418\\uB294 \\uAC83\\uC774\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-js\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"detect\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"_config\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"?\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"ResourceDetectionConfig\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"IResource\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" attributes\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"Attributes\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" env \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getEnv\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" rawAttributes \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" env\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"OTEL_RESOURCE_ATTRIBUTES\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" serviceName \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" env\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"OTEL_SERVICE_NAME\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"rawAttributes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"try\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" parsedAttributes \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"this\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function property-access method\",children:\"_parseResourceAttributes\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"rawAttributes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token class-name known-class-name\",children:\"Object\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function property-access method\",children:\"assign\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"attributes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" parsedAttributes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"catch\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"e\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      diag\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function property-access method\",children:\"debug\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token template-string\",children:[(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"EnvDetector failed: \"}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"${\"}),\"e\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"message\"}),(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"serviceName\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    attributes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"SEMRESATTRS_SERVICE_NAME\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" serviceName\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"Resource\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"attributes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"OTEL_LOG_LEVEL\"}),\" \\uD658\\uACBD\\uBCC0\\uC218\\uB97C \",(0,e.jsx)(n.code,{children:\"DEBUG\"}),\"\\uB85C \\uC124\\uC815\\uD558\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 envDetector\\uB85C \\uC124\\uC815\\uB41C \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-js\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"EnvDetector\"}),\" found resource\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\" \",(0,e.jsx)(n.span,{className:\"token property-access\",children:(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"Resource\"})}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  _attributes\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.container.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'app'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.deployment.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'example'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.namespace.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'tutorial'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.node.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'gke-tutorial-k8s-cluster-default-pool-d4535262-s702'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.pod.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'example-54bb8755cf-7fgkp'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.replicaset.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'example-54bb8755cf'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'service.instance.id'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'tutorial.example-54bb8755cf-7fgkp.app'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'service.version'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'3faacb70440664dc3dea73d21aab98ffe90e3e24'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'service.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'example-svc'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  asyncAttributesPending\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"false\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  _syncAttributes\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  _asyncAttributesPromise\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name known-class-name\",children:\"Promise\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.container.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'app'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.deployment.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'example'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.namespace.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'tutorial'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.node.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'gke-tutorial-k8s-cluster-default-pool-d4535262-s702'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.pod.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'example-54bb8755cf-7fgkp'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.replicaset.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'example-54bb8755cf'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'service.instance.id'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'tutorial.example-54bb8755cf-7fgkp.app'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'service.version'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'3faacb70440664dc3dea73d21aab98ffe90e3e24'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'service.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'example-svc'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token class-name known-class-name\",children:\"Symbol\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"async_id_symbol\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"111\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token class-name known-class-name\",children:\"Symbol\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"trigger_async_id_symbol\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"gcpdetector\",children:[(0,e.jsx)(n.a,{href:\"#gcpdetector\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"gcpDetector\"]}),(0,e.jsxs)(n.p,{children:[\"resourceDetectors Array\\uC758 \\uB9C8\\uC9C0\\uB9C9 index\\uC5D0 \",(0,e.jsx)(n.code,{children:\"gcpDetector\"}),\"\\uAC00 \\uC788\\uB2E4. GKE\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 \\uACBD\\uC6B0\\uC5D0\\uB294 \\uD574\\uB2F9 detector\\uC758 \\uB85C\\uC9C1\\uC774 \\uC2E4\\uD589\\uB41C\\uB2E4. \",(0,e.jsxs)(n.a,{href:\"https://github.com/open-telemetry/opentelemetry-js-contrib/blob/main/detectors/node/opentelemetry-resource-detector-gcp/src/detectors/GcpDetector.ts\",children:[(0,e.jsx)(n.code,{children:\"gcpDetector\"}),\"\\uC758 \\uC18C\\uC2A4\\uCF54\\uB4DC\\uB97C \\uC0B4\\uD3B4\\uBCF4\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 k8s.namespace.name\\uACFC k8s.container.name\\uC744 \\uD2B9\\uC815 \\uD658\\uACBD\\uBCC0\\uC218\\uB85C \\uC124\\uC815\\uB418\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),\" envDetector\\uB97C \\uD1B5\\uD574\\uC11C \\uC124\\uC815\\uB418\\uC5C8\\uB358 k8s.namespace.name\\uACFC container.name\\uC774 \\uB9C8\\uC9C0\\uB9C9\\uC758 gcpDetector\\uC5D0 \\uC758\\uD574\\uC11C \\uB36E\\uC5B4\\uC4F0\\uAE30\\uAC00 \\uB418\\uB294 \\uAC83\\uC774\\uB2E4. Container\\uC5D0 NAMESPACE, CONTAINER_NAME \\uD658\\uACBD\\uBCC0\\uC218\\uAC00 \\uC124\\uC815\\uB418\\uC9C0 \\uC54A\\uC558\\uB2E4\\uBA74 \\uC774\\uC81C \\uC774\\uBD80\\uBD84\\uC774 \\uBE48 \\uBB38\\uC790\\uC5F4\\uB85C \\uB36E\\uC5B4\\uC4F0\\uC5EC\\uC9C4\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-js\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"_addK8sAttributes\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  attributes\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"ResourceAttributes\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  clusterName\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),` string\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" env \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getEnv\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  attributes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"SEMRESATTRS_K8S_CLUSTER_NAME\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" clusterName\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  attributes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"SEMRESATTRS_K8S_NAMESPACE_NAME\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" env\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"NAMESPACE\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  attributes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"SEMRESATTRS_K8S_POD_NAME\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" env\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"HOSTNAME\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  attributes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"SEMRESATTRS_CONTAINER_NAME\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" env\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"CONTAINER_NAME\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"OTEL_LOG_LEVEL\"}),\" \\uD658\\uACBD\\uBCC0\\uC218\\uB97C \",(0,e.jsx)(n.code,{children:\"DEBUG\"}),\"\\uB85C \\uC124\\uC815\\uD558\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC124\\uC815\\uB41C \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-js\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"GcpDetector\"}),\" found resource\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\" \",(0,e.jsx)(n.span,{className:\"token property-access\",children:(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"Resource\"})}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  _attributes\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'cloud.account.id'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'tutorial-prj'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'host.id'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'6769112033492981631'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'host.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'gke-tutorial-k8s-cluster-default-pool-d4535262-s702.c.tutorial-prj.internal'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'cloud.availability_zone'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'us-west1-a'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'cloud.provider'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'gcp'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.cluster.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'tutorial-k8s-cluster'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.namespace.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"''\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.pod.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'example-54bb8755cf-7fgkp'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'container.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"''\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  asyncAttributesPending\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"false\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  _syncAttributes\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  _asyncAttributesPromise\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name known-class-name\",children:\"Promise\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'cloud.account.id'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'tutorial-prj'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'host.id'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'6769112033492981631'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'host.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'gke-tutorial-k8s-cluster-default-pool-d4535262-s702.c.tutorial-prj.internal'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'cloud.availability_zone'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'us-west1-a'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'cloud.provider'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'gcp'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.cluster.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'tutorial-k8s-cluster'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.namespace.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"''\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'k8s.pod.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'example-54bb8755cf-7fgkp'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'container.name'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"''\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token class-name known-class-name\",children:\"Symbol\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"async_id_symbol\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"44635\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token class-name known-class-name\",children:\"Symbol\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"trigger_async_id_symbol\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"pod\",children:[(0,e.jsx)(n.a,{href:\"#pod\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"pod\"]}),(0,e.jsx)(n.p,{children:\"\\uC774\\uC81C auto-instrumentation\\uC744 \\uC0AC\\uC6A9\\uD560 \\uB54C, \\uB2E4\\uC591\\uD55C \\uC885\\uB958\\uC758 resource detector\\uB97C \\uD1B5\\uD574\\uC11C resource attribute\\uAC00 \\uC790\\uB3D9\\uC73C\\uB85C \\uC124\\uC815\\uB418\\uB294 \\uAC83\\uC744 \\uC774\\uD574\\uD588\\uB2E4. \\uADF8\\uB9AC\\uACE0 resource detector\\uC758 \\uC21C\\uC11C\\uC5D0 \\uB530\\uB77C\\uC11C GKE\\uB97C \\uC0AC\\uC6A9\\uD560 \\uB54C\\uB294 gcpDetector\\uC5D0\\uC11C \\uD544\\uC694\\uD55C \\uD658\\uACBD\\uBCC0\\uC218\\uB97C \\uC124\\uC815\\uD574\\uC57C \\uB418\\uB294 \\uAC83\\uC744 \\uC54C\\uC558\\uB2E4. \\uB530\\uB77C\\uC11C Pod\\uC5D0 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uD544\\uC694\\uD55C \\uD658\\uACBD\\uBCC0\\uC218\\uB97C \\uCD94\\uAC00\\uD574\\uC900\\uB2E4. \\uC774\\uC81C \\uC704\\uC5D0\\uC11C gcpDetector\\uC5D0\\uC11C \\uBE48\\uBB38\\uC790\\uC5F4 \\uAC12\\uC774 \\uC6D0\\uD558\\uB358 \\uAC12\\uC73C\\uB85C \\uC124\\uC815\\uB41C \\uAC83\\uC73C\\uB85C \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` NAMESPACE\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"valueFrom\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"fieldRef\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"fieldPath\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` metadata.namespace\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` CONTAINER_NAME\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` app\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"opentelelemetry-collector\",children:[(0,e.jsx)(n.a,{href:\"#opentelelemetry-collector\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"OpenTelelemetry Collector\"]}),(0,e.jsxs)(n.p,{children:[\"\\uC2E4\\uC81C\\uB85C OpenTelemetry\\uB97C \\uC0AC\\uC6A9\\uD560 \\uB54C, OpenTelemetry Collector\\uB97C \\uD65C\\uC6A9\\uD558\\uB294 \\uAC83\\uC744 \\uCD94\\uCC9C\\uD55C\\uB2E4. OpenTelemetry\\uC5D0\\uC11C \\uC5EC\\uB7EC\\uAC00\\uC9C0 \\uCC98\\uB9AC\\uB97C \\uD574\\uC8FC\\uB294 processor\\uC5D0\\uC11C \",(0,e.jsx)(n.a,{href:\"https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/processor/k8sattributesprocessor/README.md\",children:\"Kubernetes Attribute Processor\"}),\"\\uB97C \\uD65C\\uD6BD\\uD558\\uBA74 OpenTelemetry Colllector\\uC5D0\\uC11C \\uD544\\uC694\\uD55C Resource Attribute\\uB4E4\\uC744 \\uC124\\uC815\\uD560 \\uC218\\uAC00 \\uC788\\uB2E4. k8s.namespace.name\\uC740 default\\uB85C \\uC124\\uC815\\uB418\\uC5B4 \\uC788\\uB2E4.\"]}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:\"k8s.namespace.name\"}),(0,e.jsx)(n.li,{children:\"k8s.pod.name\"}),(0,e.jsx)(n.li,{children:\"k8s.pod.uid\"}),(0,e.jsx)(n.li,{children:\"k8s.pod.start_time\"}),(0,e.jsx)(n.li,{children:\"k8s.deployment.name\"}),(0,e.jsx)(n.li,{children:\"k8s.node.name\"})]}),(0,e.jsx)(n.p,{children:\"\\uADF8\\uB9AC\\uACE0 container.id resource attribute\\uAC00 \\uC81C\\uACF5\\uB418\\uBA74 k8s Attribute Processor\\uC5D0\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC740 attribute\\uB4E4\\uB3C4 \\uCD94\\uAC00\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:\"k8s.container.name\"}),(0,e.jsx)(n.li,{children:\"container.image.name\"}),(0,e.jsx)(n.li,{children:\"container.image.tag\"}),(0,e.jsx)(n.li,{children:\"container.image.repo_digests\"})]}),(0,e.jsxs)(n.p,{children:[\"\\uC704\\uC5D0\\uC11C containerDetector\\uAC00 Array\\uC758 \\uCCAB\\uBC88\\uC9F8 \\uAC12\\uC73C\\uB85C \\uC124\\uC815\\uB418\\uC5B4 \\uC788\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD574\\uBCF4\\uC790. \",(0,e.jsx)(n.a,{href:\"https://github.com/open-telemetry/opentelemetry-js-contrib/blob/main/detectors/node/opentelemetry-resource-detector-container/src/detectors/ContainerDetector.ts\",children:\"containerDetector\\uB294 container.id\\uC744 \\uC790\\uB3D9\\uC73C\\uB85C \\uCC44\\uC6CC\\uC8FC\\uB294 \\uC5ED\\uD560\\uC744 \\uD55C\\uB2E4.\"}),\" Kubernetes\\uC5D0\\uC11C\\uB294 \",(0,e.jsx)(n.a,{href:\"https://kubernetes.io/docs/concepts/workloads/pods/downward-api/\",children:\"Downward API\\uB97C \\uD1B5\\uD574\\uC11C pod \\uC774\\uB984, pod\\uC758 namespace \\uB4F1\\uC744 \\uCC38\\uC870\\uD560 \\uC218 \\uC788\\uB2E4.\"}),\" \\uD558\\uC9C0\\uB9CC container.id\\uB294 Kubernetes\\uC5D0\\uC11C \\uC81C\\uACF5\\uD558\\uB294 \\uBC29\\uBC95\\uC774 \\uC5C6\\uB2E4. \\uB530\\uB77C\\uC11C containerDectector\\uC5D0\\uC11C\\uB294 \\uC544\\uB798\\uC640 \\uAC19\\uC774 Cgroup\\uC774 V1\\uC77C \\uB54C\\uC640 V2\\uC77C \\uB54C proc file system\\uC5D0 \\uC788\\uB294 \\uC815\\uBCF4\\uB97C \\uD1B5\\uD574\\uC11C container id\\uB97C \\uAC00\\uC838\\uC624\\uB824\\uACE0 \\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-ts\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-ts\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"readonly\"}),\" \",(0,e.jsx)(n.span,{className:\"token constant\",children:\"DEFAULT_CGROUP_V1_PATH\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'/proc/self/cgroup'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"readonly\"}),\" \",(0,e.jsx)(n.span,{className:\"token constant\",children:\"DEFAULT_CGROUP_V2_PATH\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'/proc/self/mountinfo'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"GKE\\uC5D0\\uC11C\\uB294 \\uD604\\uC7AC \\uBC84\\uC804\\uC5D0\\uC11C\\uB294 cgroup V2\\uC73C\\uB85C \\uAE30\\uBCF8 \\uC6B4\\uC601\\uB41C\\uB2E4. V1\\uC740 deprecated\\uB420 \\uC608\\uC815\\uC774\\uB2E4. \\uB530\\uB77C\\uC11C containerDetector\\uC5D0\\uC11C /proc/self/mountinfo\\uB97C \\uD1B5\\uD574\\uC11C contaienr id\\uB97C \\uAC00\\uC838\\uC62C\\uB824\\uACE0 \\uD558\\uC9C0\\uB9CC, \\uD574\\uB2F9 \\uD30C\\uC77C\\uC5D0 contaienr id \\uC815\\uBCF4\\uAC00 \\uC5C6\\uB2E4. \\uB530\\uB77C\\uC11C containerDetector\\uB85C container.id\\uB97C \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uC124\\uC815\\uD558\\uC9C0 \\uBABB \\uD55C\\uB2E4.\"}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"For versions 1.26 or later, cgroupv2 is the default for new nodes.\"})}),(0,e.jsx)(n.p,{children:\"\\uC9C0\\uAE08\\uAE4C\\uC9C0 \\uC124\\uBA85\\uC73C\\uB85C \\uBD24\\uC744 \\uB54C\\uB294 k8s Attribute Processor\\uAC00 k8s.namespace.name\\uC744 \\uCC44\\uC6CC\\uC904 \\uAC83\\uC73C\\uB85C \\uAE30\\uB300\\uB41C\\uB2E4. \\uD558\\uC9C0\\uB9CC k8s Attribute Processor\\uB294 telemetry data\\uC5D0 \\uC774\\uBBF8 \\uC874\\uC7AC\\uD558\\uB294 resource atrribute\\uC5D0 \\uB300\\uD574\\uC11C \\uB36E\\uC5B4\\uC4F0\\uAE30\\uB97C \\uD558\\uC9C0 \\uC54A\\uB294\\uB2E4. \\uC774\\uBBF8 Auto-Instrumentation\\uC744 \\uD1B5\\uD574\\uC11C k8s.namespace.name\\uAC00 \\uBE48\\uBB38\\uC790\\uC5F4\\uB85C \\uC124\\uC815\\uC774 \\uB418\\uC5C8\\uACE0, k8s Attribute Processor\\uB294 \\uC774 \\uBE48\\uBB38\\uC790\\uC5F4\\uC744 \\uC720\\uC9C0\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.p,{children:\"Resource Processor\\uC5D0\\uC11C k8s.namespace.name\\uC744 \\uC0AD\\uC81C\\uD558\\uACE0,\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"processors\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"resource/tester\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"attributes\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"action\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` delete\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` k8s.namespace.name\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uADF8\\uB2E4\\uC74C\\uC5D0 k8s Attribute Processor\\uAC00 \\uCC98\\uB9AC\\uD558\\uAC8C \\uD558\\uBA74 \\uC815\\uC0C1\\uC801\\uC73C\\uB85C k8s.namespace.name\\uAC00 \\uCC44\\uC6CC\\uC9C0\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"logs\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"exporters\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` debug\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"processors\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` resource/tester\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` k8sattributes\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uACB0\\uB860\\uC801\\uC73C\\uB85C OpenTelemetry Operator\\uB85C Auto-Insturmentation\\uC744 \\uC8FC\\uC785\\uD560 \\uB54C, k8s.container.name\\uC740 \\uC790\\uB3D9\\uC73C\\uB85C \\uCC44\\uC6CC\\uC9C4\\uB2E4. \\uADF8\\uB9AC\\uACE0 NAMESPACE \\uD658\\uACBD\\uBCC0\\uC218\\uB97C \\uD1B5\\uD574\\uC11C GcpDetector\\uAC00 k8s.namespace.name\\uC744 \\uC124\\uC815\\uD558\\uC9C0 \\uC54A\\uC73C\\uBA74, \\uD574\\uB2F9 Resource Attribute\\uB294 \\uBE48\\uBB38\\uC790\\uC5F4\\uB85C \\uC124\\uC815\\uC774 \\uB41C\\uB2E4. k8s Attribute Processor\\uB294 telemetry data\\uC758 \\uAE30\\uC874 Resource Attribute\\uC5D0 \\uB300\\uD574\\uC11C \\uB36E\\uC5B4\\uC4F0\\uAE30\\uB97C \\uD558\\uC9C0 \\uC54A\\uAE30 \\uB54C\\uBB38\\uC5D0, \\uCD5C\\uC885\\uC801\\uC73C\\uB85C exporter\\uC5D0\\uB294 \\uBE48\\uBB38\\uC790\\uC5F4\\uB85C \\uC804\\uB2EC\\uB41C\\uB2E4. \\uCD94\\uAC00\\uC801\\uC73C\\uB85C Resource Processor\\uC5D0\\uC11C \\uC0AD\\uC81C\\uB97C \\uD558\\uACE0 k8s Attribute Processor\\uAC00 \\uCC44\\uC6CC\\uB123\\uAC8C \\uD560\\uC218\\uB3C4 \\uC788\\uC9C0\\uB9CC, GcpDetector\\uC5D0\\uC11C \\uCC98\\uC74C\\uBD80\\uD130 \\uC81C\\uB300\\uB85C \\uCC44\\uC6CC\\uB123\\uB3C4\\uB85D NAMESPACE \\uD658\\uACBD\\uBCC0\\uC218\\uB97C \\uC124\\uC815\\uD558\\uB294 \\uAC83\\uC774 \\uC2E4\\uC218\\uB97C \\uC904\\uC77C \\uC218 \\uC788\\uC744 \\uAC83\\uC774\\uB2E4.\"}),(0,e.jsxs)(n.h2,{id:\"\\uACB0\\uB860\",children:[(0,e.jsx)(n.a,{href:\"#\\uACB0\\uB860\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uACB0\\uB860\"]}),(0,e.jsxs)(n.p,{children:[\"OpenTelemetry\\uC5D0\\uC11C Resource Attribute\\uB97C \\uD1B5\\uD574\\uC11C Log, Trace, Metric \\uB370\\uC774\\uD130\\uC5D0 \\uC6D0\\uD558\\uB294 \\uBA54\\uD0C0\\uB370\\uC774\\uD130\\uB97C \\uCD94\\uAC00\\uD560 \\uC218 \\uC788\\uB2E4. OpenTelemetry\\uC5D0\\uC11C\\uB294 \\uC18C\\uC2A4\\uCF54\\uB4DC \\uBCC0\\uACBD\\uC5C6\\uC774 Instrumentation\\uC744 Java\\uC758 \\uACBD\\uC6B0\\uB294 java agent\\uB97C \\uD1B5\\uD574\\uC11C, nodejs\\uB294 --require flag\\uB97C \\uD1B5\\uD574\\uC11C, \\uADF8\\uB9AC\\uACE0 python\\uC740 sitecustomize\\uB97C \\uC774\\uC6A9\\uD574\\uC11C \\uAD6C\\uD604\\uD558\\uACE0 \\uC788\\uB2E4. OpenTelemetry Operator\\uB97C \\uC0AC\\uC6A9\\uD558\\uBA74 Auto-Instrumentation\\uC744 Kubernetes \\uD658\\uACBD\\uC5D0\\uC11C annotation\\uC73C\\uB85C \\uD3B8\\uD558\\uAC8C \\uC8FC\\uC785\\uD560 \\uC218 \\uC788\\uB2E4. (\",(0,e.jsx)(n.a,{href:\"https://github.com/open-telemetry/opentelemetry-python-contrib/issues/385\",children:\"\\uCC38\\uACE0\\uB85C Python FastAPI\\uB97C Uvicorn\\uC73C\\uB85C \\uC0AC\\uC6A9\\uD560 \\uB54C\\uB294 \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uC791\\uB3D9\\uD558\\uC9C0 \\uC54A\\uC558\\uB2E4\"}),\") Auto-Instrumentation \\uACFC\\uC815\\uC5D0\\uC11C Resource Attribute\\uB4E4\\uB3C4 Resource Detector\\uC5D0 \\uC758\\uD574\\uC11C \\uC790\\uB3D9\\uC73C\\uB85C \\uC124\\uC815\\uC774 \\uB41C\\uB2E4. \\uC774\\uBC88 \\uAE00\\uC5D0\\uC11C\\uB294 envDetector, gcpDetector, containerDetector\\uC774 \\uC5B4\\uB5BB\\uAC8C Resource Attribute\\uB4E4\\uC744 \\uC790\\uB3D9\\uC73C\\uB85C \\uC124\\uC815\\uD574\\uC8FC\\uB294\\uC9C0 \\uC0B4\\uD3B4\\uBCF4\\uC558\\uB2E4. \\uD639\\uC2DC GKE\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 \\uACFC\\uC815\\uC5D0\\uC11C k8s.namespace.name\\uC774 \\uBE48\\uBB38\\uC790\\uC5F4\\uB85C \\uC124\\uC815\\uC774 \\uB418\\uBA74, resource detector\\uB4E4\\uC5D0 \\uB300\\uD55C \\uC774\\uD574\\uB97C \\uBC14\\uD0D5\\uC73C\\uB85C \\uC62C\\uBC14\\uB978 \\uC124\\uC815\\uC744 \\uD574\\uC904 \\uC218 \\uC788\\uC744 \\uAC83\\uC774\\uB2E4.\"]})]})}}var E=b;return f;})();\n;return Component;","toc":[{"value":"가정된 환경","url":"#가정된-환경","depth":2},{"value":"Injecting Auto-Instrumentation","url":"#injecting-auto-instrumentation","depth":2},{"value":"resourceDetector","url":"#resourcedetector","depth":2},{"value":"envDetector","url":"#envdetector","depth":3},{"value":"gcpDetector","url":"#gcpdetector","depth":3},{"value":"pod","url":"#pod","depth":2},{"value":"OpenTelelemetry Collector","url":"#opentelelemetry-collector","depth":2},{"value":"결론","url":"#결론","depth":2}],"frontMatter":{"readingTime":{"text":"11 min read","minutes":10.105,"time":606300,"words":2021},"slug":"20250119-otel-gcp-detector","fileName":"20250119-otel-gcp-detector.md","title":"OpenTelemetry GcpDetector를 이해하기","date":"2025-01-19T00:00:00.000Z","tags":["gcp","kubernetes","opentelemetry"],"images":["/static/images/social-banner.png"],"summary":"OpenTelemetry Operator로 Auto-Instrumentation을 주입할 수 있다. 그런데 환경변수 설정을 올바르게 하지 않거나 OpenTelemetry Collector에서 proccessor 설정을 제대로 해주지 않으면, Resource attribute중 k8s.namespace.name가 빈문자열로 보내질 수 있다. 이러한 경우에 Auto-Instrumentation에서 Resource attribute가 어떻게 자동으로 설정되는지 resourceDetector들을 이해하면 쉽게 해결할 수 있다. 따라서 이번 글에서는 Resource Detector들에 대해서 자세히 살펴본다."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.15,"time":9000,"words":30},"slug":["default"],"fileName":"default.md","name":"Jay","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"Bitbucket OIDC with GCP","date":"2025-01-17T00:00:00.000Z","tags":["gcp","oidc","bitbucket"],"images":["/static/images/social-banner.png"],"summary":"Bitbucket OIDC를 이용하여 GCP 리소스를 접근하는 방법을 설명한다. Bitbucket Pipeline으로 GCP 리소스를 배포/변경할 때 OIDC를 통해서 임시 Credential를 발급할 수 있다. 다른 사람이 동일한 작업을 할 때, 삽질하지 않도록 완전한 예제를 공유하고자 작성한다.","slug":"20250117-google-oidc-bitbucket"},"next":{"title":"Google Cloud Exporter가 Log의 Resource Attribute를 Cloud Logging Label로 어떻게 변환할까?","date":"2025-01-25T00:00:00.000Z","tags":["gcp","kubernetes","opentelemetry"],"images":["/static/images/social-banner.png"],"summary":"OpenTelemetry Collector를 사용할 때, 다양한 exporter를 통해서 Telemetry data를 저장할 수 있다. GCP를 사용하는 경우에는 Google Cloud Exporter를 사용해서 Telemetry data를 쉽게 저장할 수 있다. 그런데 Log의 경우에는 내가 설정한 Resource attribute가 기대한 것처럼 Google Cloud Logging의 Label에 등록되지 않는 경우를 경험할 수도 있다. 따라서 오늘은 Google Cloud Exporter를 사용할 때, Resource Attribute들이 Cloud Logging Label로 어떻게 변환되는지 자세히 설명한다.","slug":"20250125-google-cloud-exporter"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["20250119-otel-gcp-detector"]},"buildId":"aZB0OZMJIIlSfZorUzSCa","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>