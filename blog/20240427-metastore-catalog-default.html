<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="manifest" href="/jayground8/static/favicons/manifest.json"/><link rel="manifest" href="/jayground8/static/favicons/site.webmanifest"/><link rel="shortcut icon" href="/jayground8/static/favicons/favicon.ico"/><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8773084925406986" crossorigin="anonymous"></script><title>Spark에서 Hive database가 조회가 안 되는 문제</title><meta name="robots" content="follow, index"/><meta name="description" content="Spark에서 SparkSession에 hive 설정을 해서 Hive의 데이터를 읽기/쓰기가 가능하다. 하지만 Hive에서 생성한 데이터베이스가 Spark에서는 조회가 되지 않았다. Spark에서 Hive Metastore를 Catalog로 사용할 때, hive-site.xml에 설정된 값을 이해하면 왜 조회가 되지 않는지 이해할 수 있다. hive-site.xml의 metadata.catalog.default 값이 어떻게 영향을 미치지는 살펴봤다."/><meta property="og:url" content="https://jayground8.github.io/blog/20240427-metastore-catalog-default"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Jayground8"/><meta property="og:description" content="Spark에서 SparkSession에 hive 설정을 해서 Hive의 데이터를 읽기/쓰기가 가능하다. 하지만 Hive에서 생성한 데이터베이스가 Spark에서는 조회가 되지 않았다. Spark에서 Hive Metastore를 Catalog로 사용할 때, hive-site.xml에 설정된 값을 이해하면 왜 조회가 되지 않는지 이해할 수 있다. hive-site.xml의 metadata.catalog.default 값이 어떻게 영향을 미치지는 살펴봤다."/><meta property="og:title" content="Spark에서 Hive database가 조회가 안 되는 문제"/><meta property="og:image" content="https://jayground8.github.io/static/images/social-banner.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site"/><meta name="twitter:title" content="Spark에서 Hive database가 조회가 안 되는 문제"/><meta name="twitter:description" content="Spark에서 SparkSession에 hive 설정을 해서 Hive의 데이터를 읽기/쓰기가 가능하다. 하지만 Hive에서 생성한 데이터베이스가 Spark에서는 조회가 되지 않았다. Spark에서 Hive Metastore를 Catalog로 사용할 때, hive-site.xml에 설정된 값을 이해하면 왜 조회가 되지 않는지 이해할 수 있다. hive-site.xml의 metadata.catalog.default 값이 어떻게 영향을 미치지는 살펴봤다."/><meta name="twitter:image" content="https://jayground8.github.io/static/images/social-banner.png"/><link rel="canonical" href="https://jayground8.github.io/blog/20240427-metastore-catalog-default"/><meta property="article:published_time" content="2024-04-27T00:00:00.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jayground8.github.io/blog/20240427-metastore-catalog-default"
  },
  "headline": "Spark에서 Hive database가 조회가 안 되는 문제",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://jayground8.github.io/static/images/social-banner.png"
    }
  ],
  "datePublished": "2024-04-27T00:00:00.000Z",
  "dateModified": "2024-04-27T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jay"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Jay",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jayground8.github.ioplayground.png"
    }
  },
  "description": "Spark에서 SparkSession에 hive 설정을 해서 Hive의 데이터를 읽기/쓰기가 가능하다. 하지만 Hive에서 생성한 데이터베이스가 Spark에서는 조회가 되지 않았다. Spark에서 Hive Metastore를 Catalog로 사용할 때, hive-site.xml에 설정된 값을 이해하면 왜 조회가 되지 않는지 이해할 수 있다. hive-site.xml의 metadata.catalog.default 값이 어떻게 영향을 미치지는 살펴봤다."
}</script><meta name="next-head-count" content="24"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preload" href="/_next/static/css/414f98a58444a4f1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/414f98a58444a4f1.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-690364db8bfb1f01.js" defer=""></script><script src="/_next/static/chunks/main-eea1c213342d95c3.js" defer=""></script><script src="/_next/static/chunks/pages/_app-86269c274ea428e9.js" defer=""></script><script src="/_next/static/chunks/675-70b09cbf0a5309ea.js" defer=""></script><script src="/_next/static/chunks/410-35c4fb535edd9439.js" defer=""></script><script src="/_next/static/chunks/712-376d32740a4ac813.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-8ab66ff6ebabec4c.js" defer=""></script><script src="/_next/static/YVp8inUj3T3ALc6g3E6U4/_buildManifest.js" defer=""></script><script src="/_next/static/YVp8inUj3T3ALc6g3E6U4/_ssgManifest.js" defer=""></script><script src="/_next/static/YVp8inUj3T3ALc6g3E6U4/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="Jayground8" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" width="53.87" height="43.61" viewBox="0 0 512 512" class="fill-black dark:fill-white"><path d="M368.4 17c-8.8 1.3-18.3 5-25.3 9.9-3.8 2.5-22.6 16.1-41.9 30.1-37.1 26.9-38.6 28.3-36.3 33.9 1.7 4 4.9 5.1 14.6 5.1h8.5v128h-17.9c-18.2 0-22.2.6-27.3 4.2l-2.8 1.9V116.9l2.5-2.4c1.5-1.6 3.6-2.5 5.5-2.5s4 .9 5.5 2.5l2.5 2.4v42c0 29.1.3 42.8 1.1 44.5 2.6 5.7 11.5 5.5 13.9-.3.7-1.9 1-15.6.8-46.2-.3-40.1-.4-43.7-2.2-46.9-4.8-9-11.9-13.4-21.6-13.4-13.8 0-22.8 9.1-23.8 24.1l-.5 7.3h-31.5l-1.2-2.9c-1.6-3.9-6-5.8-9.9-4.1-1.6.6-3.5 2.5-4.1 4.1l-1.2 2.9h-63.6l-1.2-2.9c-2.5-6.2-11.5-6.2-14 0l-1.2 2.9H64.3l-.5-7.3c-1-15-10-24.1-23.8-24.1-9.7 0-16.8 4.4-21.6 13.4-1.8 3.3-1.9 7.5-2.2 75-.2 50 .1 72.3.8 74.1 2.1 5.1 8.6 6.3 12.5 2.4l2.5-2.4V116.9l2.5-2.4c3.2-3.3 7.8-3.3 11 0l2.5 2.4V448H32V284.9l-2.5-2.4c-3.8-3.9-10.2-2.7-12.4 2.2-1.6 3.4-1.6 171.2 0 174.6.6 1.4 2.2 3 3.6 3.6 1.6.7 15.6 1.1 43.7 1.1 38 0 41.5-.1 43.4-1.8 1.2-.9 33.4-50.5 71.7-110.2 38.3-59.7 70.5-109.3 71.7-110.3 1.8-1.5 4.3-1.7 19.4-1.7H288v16h-12.5c-13.1 0-16.6.8-18.3 4.4-2 4.5-138.5 216.2-140.4 217.9-1.9 1.6-5.6 1.7-47.9 1.7-31.9 0-46.6.3-48.3 1.1-5.7 2.6-5.5 11.5.3 13.9 1.9.7 16.7 1 50.1.8 46.4-.3 47.6-.3 51.5-2.5 2.2-1.1 5.1-3.3 6.5-4.7 1.3-1.5 10.1-14.7 19.6-29.4l17.1-26.7 18.4-.5c10.1-.3 19.1-.9 20-1.3.9-.5 2.1-1.9 2.8-3.3 1.5-3.4 1.5-35.4 0-38.8-1.1-2.3-4-4-8-4.8-1.3-.2 1.5-5.2 11.5-20.7l13.1-20.5.5 56.5c.3 31 .9 57.1 1.3 58 1.5 3 5.6 3.9 18.2 3.9H256v14c0 14.9.7 18.1 4.7 19.9 1.7.8 34.7 1.1 115.3 1.1s113.6-.3 115.3-1.1c1.4-.6 3-2.2 3.6-3.6 1.5-3.4 1.5-83.2 0-86.6-2.2-4.9-8.6-6.1-12.4-2.2l-2.5 2.4V480H272V272h208v107.1l2.5 2.4c3.8 3.9 10.2 2.7 12.4-2.2 1.5-3.4 1.5-115.2 0-118.6-1.8-3.9-5-4.7-18.4-4.7H464v-40.5c0-27.9-.3-41.2-1.1-42.9-2.6-5.5-11.2-5.5-13.8 0-.8 1.7-1.1 15-1.1 42.9V256h-24v-34.5c0-21.3-.4-36.4-1.1-39.7-3.6-17.3-19.3-32.9-36.7-36.7-16.2-3.4-31.4 1.1-43.3 12.9-7.4 7.3-11.2 13.9-13.4 23.2-1.8 7.9-2.1 50.3-.4 54.2 1.6 3.5 6.1 5.2 9.8 3.7 4.7-2 5.1-4.2 5.1-29.6 0-21.5.2-23.9 2.2-29.2C350.6 168.4 363 160 376 160s25.4 8.4 29.8 20.3c2.1 5.5 2.2 7.4 2.2 40.7v35H304V96h144v24.5c0 16 .4 25.3 1.1 26.9 2.6 5.5 11.2 5.5 13.8 0 .7-1.6 1.1-10.9 1.1-26.9V96h8.5c9.7 0 12.9-1.1 14.6-5.1 2.1-5.2.1-7.5-17.7-20.4C446.2 53.8 445 53 442.1 53c-4.1.1-7.5 3.5-7.5 7.7 0 4 2.2 6.3 14.8 15.3l4.8 3.5-39.1.3c-21.5.1-56.7.1-78.2 0l-39.1-.3 14.9-10.7c8.2-5.9 20.7-15.1 27.8-20.4 14.5-10.8 20.5-14 29.4-15.5 11.6-2.1 22.4 1.3 36.5 11.4 4.3 3.1 9 5.7 10.3 5.7 3.9 0 7.5-4.4 7.1-8.7-.3-3.3-1.1-4.4-7.8-9.6-15.3-11.8-32.3-17.1-47.6-14.7zM96 152v8H64v-16h32v8zm80 0v8h-64v-16h64v8zm48 0v8h-32v-16h32v8zM96 280v104h-4.5c-5.5 0-9 1.5-10.4 4.7-1.5 3.3-1.5 35.4 0 38.7 1.7 3.6 3.1 4 16.2 4.6l11.9.5-5.1 7.7L99 448H64V176h32v104zm80-27.8v76.3l-17.8 27.7-17.7 27.7-14.2.1H112V176h64v76.2zm48-37.3v38.9l-15.6 24.4c-8.6 13.3-15.8 24.5-16 24.7-.2.2-.4-28.2-.4-63.2V176h32v38.9zM256 369v76h-16V317.1l7.8-12c4.2-6.7 7.8-12.1 8-12.1.1 0 .2 34.2.2 76zm-129.1 34.7c-1.2 2.1-3.6 5.7-5.1 8l-2.9 4.3H96v-16h33.2l-2.3 3.7zM192 408v8h-15.1l3.7-5.8c2-3.1 4.4-6.7 5.2-8 .8-1.2 2.4-2.2 3.8-2.2 2.3 0 2.4.2 2.4 8z"></path><path d="M322.5 114.5c-1.6 1.5-2.5 3.6-2.5 5.5s.9 4 2.5 5.5c1.5 1.6 3.6 2.5 5.5 2.5s4-.9 5.5-2.5c1.6-1.5 2.5-3.6 2.5-5.5s-.9-4-2.5-5.5c-1.5-1.6-3.6-2.5-5.5-2.5s-4 .9-5.5 2.5zM418.5 114.5c-1.6 1.5-2.5 3.6-2.5 5.5s.9 4 2.5 5.5c1.5 1.6 3.6 2.5 5.5 2.5s4-.9 5.5-2.5c1.6-1.5 2.5-3.6 2.5-5.5s-.9-4-2.5-5.5c-1.5-1.6-3.6-2.5-5.5-2.5s-4 .9-5.5 2.5zM290.2 290.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6zM450.5 290.5c-5 4.9-1.5 13.5 5.5 13.5 4.1 0 8-3.9 8-8s-3.9-8-8-8c-1.9 0-4 .9-5.5 2.5zM358.1 322c-8.3 2.2-16.5 5.7-19.8 8.6-3.3 2.8-3.9 7.3-1.4 10.6 3.3 4.1 6.4 4.3 13.8.8 23.3-10.9 47.3-7 64.8 10.5 11.5 11.4 16.5 23.6 16.5 39.7 0 15.9-5.1 28.1-16.4 39.4C404.2 443 392.1 448 376 448s-28.1-5-39.5-16.5c-11-11.1-16.5-24.2-16.5-39.5.1-9.5 1.2-14.5 5.6-24.3 3.8-8.3 3.8-10.4.1-14.5-4.7-5.1-10.8-1.7-15.4 8.6-8.6 19.5-8.4 42.7.6 61.7 9.1 19.3 28.3 34.5 49.5 39 11.9 2.6 28.4 1.7 39.3-2.2 23.9-8.6 41.3-27.9 46.9-51.9 1.9-8.5 1.9-24.4-.1-33.1-5.9-25.5-26.7-46.6-52.5-53.3-10.1-2.6-25.8-2.6-35.9 0zM290.2 450.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6zM450.2 450.3c-5 5.3-1.3 13.7 5.9 13.7 4.7 0 7.9-3.4 7.9-8.1 0-7.1-9-10.7-13.8-5.6z"></path></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">Jayground8</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">블로그</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-0 left-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><div class="flex justify-end"><button type="button" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">블로그</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2024-04-27T00:00:00.000Z">2024년 4월 27일 토요일</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Spark에서 Hive database가 조회가 안 되는 문제</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2738%27%20height=%2738%27/%3e"/></span><img alt="avatar" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="h-10 w-10 rounded-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="avatar" srcSet="https://jayground8.github.io/static/images/profile.png?w=48&amp;q=75 1x, https://jayground8.github.io/static/images/profile.png?w=96&amp;q=75 2x" src="https://jayground8.github.io/static/images/profile.png?w=96&amp;q=75" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="h-10 w-10 rounded-full" loading="lazy"/></noscript></span><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Jay</dd><dt class="sr-only">Twitter</dt><dd></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><p>Spark SQL를 사용할 때, Hive의 데이터에 대해서 읽기/쓰기를 할 수 있다. <a target="_blank" rel="noopener noreferrer" href="https://spark.apache.org/docs/2.4.8/sql-data-sources-hive-tables.html">Spark 2.4.8의 문서</a>를 보면, 아래와 같이. <code>SparkSession</code>에 hive 설정을 해서 사용할 수 있다.</p><div class="relative"><pre><code class="code-highlight language-java"><span class="code-line">val spark <span class="token operator">=</span> <span class="token class-name">SparkSession</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">appName</span><span class="token punctuation">(</span><span class="token string">&quot;Spark Hive Example&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token string">&quot;spark.sql.warehouse.dir&quot;</span><span class="token punctuation">,</span> warehouseLocation<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">enableHiveSupport</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">getOrCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><p>이렇게 hive 설정을 했을 때, <code>/etc/spark2/conf/hive-site.xml</code>에 설정파일이 있으면 해당 설정파일에 의해서 Hive Metastore를 사용할 수 있다. <code>hive-site.xml</code>을 보면 <code>hive.metastore.uris</code>는 Metastore Thrift server에 접근하기 위해서 thrift protocol로 정의가 되어 있다.</p><div class="relative"><pre><code class="code-highlight language-xml"><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.metastore.uris<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>thrift://{manager node1},thrift://{manager node2}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</span></code></pre></div><p>그리고 아래와 같이 <code>metastore.catalog.default</code>도 설정되어 있다. 이번 글에서는 이 설정값이 어떤 영향을 미치는지 살펴보려고 한다.🧐</p><div class="relative"><pre><code class="code-highlight language-xml"><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>metastore.catalog.default<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>spark<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</span></code></pre></div><p>사용 환경</p><ul><li>Hive: 3.1.2</li><li>Spark: 2.4.8</li></ul><h2 id="catalog란"><a href="#catalog란" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>catalog란?</h2><p>Hive를 사용해서 Database나 Table을 생성하면 Hive catalog에 존재하고, Spark를 사용해서 Database나 Table를 생성하면 Spark catalog에 존재하게 된다. Catalog는 어떤 의미를 가지는 것일까?🧐 Catalog는 데이터들의 관계, 정의, 설명등이 보관되어 있는 곳이라고 생각할 수 있겠다. 그래서 Catalog가 더 큰 범주를 가지고, 그 안에 Hive Metastore이 들어간다고 볼 수 있겠다(?).</p><p><code>Hive를 사용해서 Database나 Table을 생성하면 Hive catalog에 존재하게 된다</code>는 것은 데이터의 관계, 데이터가 저장된 위치, 데이터의 schema등 다양한 정보들이 Hive catalog에 존재하게 되는데, 그것을 Hive Metastore가 담당하고 있다는 것으로 생각할 수 있겠다. Spark는 catalog를 <code>in-memory</code> 방식으로 관리하여 Spark session동안만 유지하게 하거나, <code>Hive metastore</code>를 사용하여 지속 가능한 catalog 설정을 할 수 있다. 그리고 <code>Hive</code> 환경이 없는 경우에는 Spark 자체적으로 Derby를 이용해서 Hive metastore를 구성한다고 한다. <code>Spark catalog에 존재</code>는 설정에 따라서 in-memory, local metastore with Derby, external hive metastore 등에 저장될 수 있다라는 것을 의미한다. 따라서 위에서 <code>hive-site.xml</code>에 Hive metastore에 대한 설정들이 되어 있는 Spark의 경우에는 <code>External hive metastore</code>가 Spark catalog가 되는 것이다.</p><h2 id="spark에서-생성한-database가-hive에서-조회되지가-않는다"><a href="#spark에서-생성한-database가-hive에서-조회되지가-않는다" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Spark에서 생성한 Database가 Hive에서 조회되지가 않는다</h2><p>Spark를 Python으로 사용할 때, 아래와 같이 작성할 수 있다. SparkSession에서 <code>hive-site.xml</code>의 설정파일에 의해서 Hive Metastore를 사용하도록 자동 설정된다. 간단하게 database를 생성하고, database 목록 조회를 한다.</p><div class="relative"><pre><code class="code-highlight language-py"><span class="code-line"><span class="token keyword">from</span> os<span class="token punctuation">.</span>path <span class="token keyword">import</span> abspath
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">from</span> pyspark<span class="token punctuation">.</span>sql <span class="token keyword">import</span> SparkSession
</span><span class="code-line"><span class="token keyword">from</span> pyspark<span class="token punctuation">.</span>sql <span class="token keyword">import</span> Row
</span><span class="code-line">
</span><span class="code-line">warehouse_location <span class="token operator">=</span> abspath<span class="token punctuation">(</span><span class="token string">&#x27;spark-warehouse&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">spark <span class="token operator">=</span> SparkSession \
</span><span class="code-line">    <span class="token punctuation">.</span>builder \
</span><span class="code-line">    <span class="token punctuation">.</span>appName<span class="token punctuation">(</span><span class="token string">&quot;Python Spark SQL Hive integration example&quot;</span><span class="token punctuation">)</span> \
</span><span class="code-line">    <span class="token punctuation">.</span>config<span class="token punctuation">(</span><span class="token string">&quot;spark.sql.warehouse.dir&quot;</span><span class="token punctuation">,</span> warehouse_location<span class="token punctuation">)</span> \
</span><span class="code-line">    <span class="token punctuation">.</span>enableHiveSupport<span class="token punctuation">(</span><span class="token punctuation">)</span> \
</span><span class="code-line">    <span class="token punctuation">.</span>getOrCreate<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">spark<span class="token punctuation">.</span>sql<span class="token punctuation">(</span><span class="token string">&quot;create database example&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">spark<span class="token punctuation">.</span>sql<span class="token punctuation">(</span><span class="token string">&quot;show databases&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><p><code>pyspark</code>로 해당 python script를 실행하면 Console에 아래와 같은 내용이 출력되는 것을 확인할 수 있다.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">+------------------+
</span><span class="code-line"><span class="token operator">|</span>      databaseName<span class="token operator">|</span>
</span><span class="code-line">+------------------+
</span><span class="code-line"><span class="token operator">|</span>           default<span class="token operator">|</span>
</span><span class="code-line"><span class="token operator">|</span>        		example<span class="token operator">|</span>
</span><span class="code-line">+------------------+
</span></code></pre></div><p>그런데 Hive shell을 통해서 확인하면 새로 생성한 database <code>example</code>이 조회되지 않는다.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">$ hive
</span><span class="code-line"><span class="token operator">&gt;</span> show databases<span class="token punctuation">;</span>
</span><span class="code-line">OK
</span><span class="code-line">default
</span><span class="code-line">information_schema
</span><span class="code-line">sys
</span></code></pre></div><p>여기서 <code>hive-site.xml</code>의 <code>metastore.catalog.default</code> 설정값을 생각해 볼 필요가 있다. 위에서 아래와 같이 <code>spark</code>로 설정되어 있다고 설명했었다. Hive에서는 해당 값이 기본값 <code>hive</code>로 설정되어 있다. 따라서 해당 설정값을 <code>spark</code> -&gt; <code>hive</code>로 변경 적용하고, Spark을 재시작한다. 다시 spark에서 database를 조회하면 동일한 목록이 보이게 된다.</p><div class="relative"><pre><code class="code-highlight language-xml"><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>metastore.catalog.default<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>spark<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</span></code></pre></div><h2 id="metastore-catalog는-무엇인가"><a href="#metastore-catalog는-무엇인가" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>metastore catalog는 무엇인가?</h2><p><code>Catalog</code>, <code>Hive Metastore</code>, <code>Metastore Catalog</code>등 용어들이 내 머릿속에 혼재되어서 헛갈렸다. <code>metastore.catalog.default</code> 설정값에서 <code>metastore.catalog</code>는 무엇이란 말인가?🤨 Hive Metastore Thrift Server가 있고, 저장소로 Derby, MySQL, PostgreSQL등 데이터베이스가 사용된다. <code>metastore.catalog</code>는 Metastore가 저장소에 저장할 때, Metastore에 저장된 데이터를 namespace처럼 구분하기 위한 이름이라고 생각된다.</p><p>네이버 클라우드에서 제공하는 관리형 Hadoop Service에서는 MySQL를 사용하고 있는데, 해당 환경에서 확인을 해보았다. 먼저 <code>/etc/hive/conf</code> 경로에서 <code>hive-site.xml</code> 파일을 확인해보면 아래처럼 설정이 되어 있다.</p><p><code>hive-site.xml</code></p><div class="relative"><pre><code class="code-highlight language-xml"><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionURL<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>jdbc:mysql://mysql.local:3306/hive_9880<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionUserName<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>{username}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</span></code></pre></div><p>이제 mysql client를 통해서 MySQL 접속하여 Schema를 확인해본다.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">mysql -h mysql.local -u <span class="token punctuation">{</span>username<span class="token punctuation">}</span> -p
</span></code></pre></div><p>저장된 데이터를 확인해보면 Hive Metastore를 사용하고 있는 다양한 service들에 대한 Database가 보인다.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">mysql<span class="token operator">&gt;</span> show databases<span class="token punctuation">;</span>
</span><span class="code-line">+--------------------+
</span><span class="code-line"><span class="token operator">|</span> Database           <span class="token operator">|</span>
</span><span class="code-line">+--------------------+
</span><span class="code-line"><span class="token operator">|</span> information_schema <span class="token operator">|</span>
</span><span class="code-line"><span class="token operator">|</span> ambari_9880        <span class="token operator">|</span>
</span><span class="code-line"><span class="token operator">|</span> grafana_9880       <span class="token operator">|</span>
</span><span class="code-line"><span class="token operator">|</span> hive_9880          <span class="token operator">|</span>
</span><span class="code-line"><span class="token operator">|</span> hue_9880           <span class="token operator">|</span>
</span><span class="code-line"><span class="token operator">|</span> logsearch_9880     <span class="token operator">|</span>
</span><span class="code-line"><span class="token operator">|</span> oozie_9880         <span class="token operator">|</span>
</span><span class="code-line"><span class="token operator">|</span> ranger_9880        <span class="token operator">|</span>
</span><span class="code-line"><span class="token operator">|</span> ranger_kms_9880    <span class="token operator">|</span>
</span><span class="code-line">+--------------------+
</span></code></pre></div><p>그리고 <code>hive_9880</code> Database에 있는 <code>DBS</code> table의 레코드들을 확인해본다.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">mysql<span class="token operator">&gt;</span> use hive_9880<span class="token punctuation">;</span>
</span><span class="code-line">mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> * from DBS<span class="token punctuation">;</span>
</span></code></pre></div><p>그러면 Hive에서 만들어진 database와 Spark에서 생성한 <code>example</code>이 조회되는 것을 확인할 수 있다. 이렇게 <code>metadata.catalog.default</code>에 설정된 값으로 구분이 되어 있고, Metastore Thrift Server가 MySQL 저장소에 Query를 할 때 이 값으로 구분해서 가져오는 것으로 생각된다. (저장소를 MySQL를 사용하는 과정에서 general_log를 보면 Query문이 어떻게 되는지 확인하면 확실하게 알 수 있을 것이다.)</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">+------------------+----------+
</span><span class="code-line"><span class="token operator">|</span>NAME              <span class="token operator">|</span>CTLG_NAME <span class="token operator">|</span>
</span><span class="code-line">+------------------+----------+
</span><span class="code-line"><span class="token operator">|</span>default           <span class="token operator">|</span>hive      <span class="token operator">|</span>
</span><span class="code-line"><span class="token operator">|</span>sys               <span class="token operator">|</span>hive      <span class="token operator">|</span>
</span><span class="code-line"><span class="token operator">|</span>information_schema<span class="token operator">|</span>hive      <span class="token operator">|</span>
</span><span class="code-line"><span class="token operator">|</span>example           <span class="token operator">|</span>spark     <span class="token operator">|</span>
</span><span class="code-line">+------------------+----------+
</span></code></pre></div><p><a target="_blank" rel="noopener noreferrer" href="https://github.com/apache/hive/pull/320">Github Pull Request 기록</a>을 보면, catalog 변수를 추가하면서 default로 <code>hive</code>를 하도록 하고, Server side에서 설정값으로 변경할 수 있도록 변경이 된 것을 확인할 수 있다. 그리고 Query를 할 때 catalog 값을 사용해서 가져오는 것도 확인할 수 있다.</p><h2 id="결론"><a href="#결론" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>결론</h2><p>Hive Metastore는 다양한 어플리케이션에서 Metadata를 저장하기 위해서 사용될 수 있다. Spark에서도 메모리에 Metadata를 보관하는 대신에 Hive Metastore를 사용하여 저장소에 보관할 수 있다. 그리고 Spark에서 Hive support option을 통해서 Hive의 데이터에 접근할 수 있다. 그런데 Hive에서 생성한 메타데이터는 <code>metastore.catalog.default</code>가 <code>hive</code>로 설정되어 저장되고, Spark에서 생성한 메타데이터는 <code>metastore.catalog.default</code>가 <code>spark</code>로 설정되어 저장된다. 메타데이터를 가져올 때도 이 catalog 이름으로 구분되어 가져오게 된다. 따라서 Spark에서 Hive에서 생성된 데이터베이스를 조회하지 못하게 된다. Spark의 <code>hive-site.xml</code> 설정값을 통해서 <code>metastore.catalog.default</code>를 <code>hive</code>로 설정하면, Hive에서 생성된 데이터베이스를 조회할 수 있게 된다.</p></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"></div><div id="comment"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/spark">spark</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/20240420-kubelet-imagegc">Kubelet imageGC</a></div></div><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/20240501-opentelemetry-syslog">OpenTelmetry로 auth.log와 syslog 수집하기</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:jayground8@gmail.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/jayground8"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Jay</div><div> • </div><div>© 2025</div><div> • </div><a href="/">Jayground8</a></div><div class="mb-8 text-sm text-gray-500 dark:text-gray-400"><a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var r=Object.create;var l=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var t=n=\u003el(n,\"__esModule\",{value:!0});var N=(n,s)=\u003e()=\u003e(s||n((s={exports:{}}).exports,s),s.exports),u=(n,s)=\u003e{t(n);for(var c in s)l(n,c,{get:s[c],enumerable:!0})},k=(n,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let a of d(s))!m.call(n,a)\u0026\u0026a!==\"default\"\u0026\u0026l(n,a,{get:()=\u003es[a],enumerable:!(c=p(s,a))||c.enumerable});return n},g=n=\u003ek(t(l(n!=null?r(h(n)):{},\"default\",n\u0026\u0026n.__esModule\u0026\u0026\"default\"in n?{get:()=\u003en.default,enumerable:!0}:{value:n,enumerable:!0})),n);var o=N((x,i)=\u003e{i.exports=_jsx_runtime});var y={};u(y,{default:()=\u003eS,frontmatter:()=\u003ev});var e=g(o()),v={title:\"Spark\\uC5D0\\uC11C Hive database\\uAC00 \\uC870\\uD68C\\uAC00 \\uC548 \\uB418\\uB294 \\uBB38\\uC81C\",date:\"2024-04-27\",tags:[\"spark\"],images:[\"/static/images/social-banner.png\"],summary:\"Spark\\uC5D0\\uC11C SparkSession\\uC5D0 hive \\uC124\\uC815\\uC744 \\uD574\\uC11C Hive\\uC758 \\uB370\\uC774\\uD130\\uB97C \\uC77D\\uAE30/\\uC4F0\\uAE30\\uAC00 \\uAC00\\uB2A5\\uD558\\uB2E4. \\uD558\\uC9C0\\uB9CC Hive\\uC5D0\\uC11C \\uC0DD\\uC131\\uD55C \\uB370\\uC774\\uD130\\uBCA0\\uC774\\uC2A4\\uAC00 Spark\\uC5D0\\uC11C\\uB294 \\uC870\\uD68C\\uAC00 \\uB418\\uC9C0 \\uC54A\\uC558\\uB2E4. Spark\\uC5D0\\uC11C Hive Metastore\\uB97C Catalog\\uB85C \\uC0AC\\uC6A9\\uD560 \\uB54C, hive-site.xml\\uC5D0 \\uC124\\uC815\\uB41C \\uAC12\\uC744 \\uC774\\uD574\\uD558\\uBA74 \\uC65C \\uC870\\uD68C\\uAC00 \\uB418\\uC9C0 \\uC54A\\uB294\\uC9C0 \\uC774\\uD574\\uD560 \\uC218 \\uC788\\uB2E4. hive-site.xml\\uC758 metadata.catalog.default \\uAC12\\uC774 \\uC5B4\\uB5BB\\uAC8C \\uC601\\uD5A5\\uC744 \\uBBF8\\uCE58\\uC9C0\\uB294 \\uC0B4\\uD3B4\\uBD24\\uB2E4.\"};function b(n={}){let{wrapper:s}=n.components||{};return s?(0,e.jsx)(s,Object.assign({},n,{children:(0,e.jsx)(c,{})})):c();function c(){let a=Object.assign({p:\"p\",a:\"a\",code:\"code\",pre:\"pre\",span:\"span\",ul:\"ul\",li:\"li\",h2:\"h2\"},n.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(a.p,{children:[\"Spark SQL\\uB97C \\uC0AC\\uC6A9\\uD560 \\uB54C, Hive\\uC758 \\uB370\\uC774\\uD130\\uC5D0 \\uB300\\uD574\\uC11C \\uC77D\\uAE30/\\uC4F0\\uAE30\\uB97C \\uD560 \\uC218 \\uC788\\uB2E4. \",(0,e.jsx)(a.a,{href:\"https://spark.apache.org/docs/2.4.8/sql-data-sources-hive-tables.html\",children:\"Spark 2.4.8\\uC758 \\uBB38\\uC11C\"}),\"\\uB97C \\uBCF4\\uBA74, \\uC544\\uB798\\uC640 \\uAC19\\uC774. \",(0,e.jsx)(a.code,{children:\"SparkSession\"}),\"\\uC5D0 hive \\uC124\\uC815\\uC744 \\uD574\\uC11C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(a.pre,{className:\"language-java\",children:(0,e.jsxs)(a.code,{className:\"code-highlight language-java\",children:[(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"val spark \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(a.span,{className:\"token class-name\",children:\"SparkSession\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(a.span,{className:\"token function\",children:\"builder\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(a.span,{className:\"token function\",children:\"appName\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(a.span,{className:\"token string\",children:'\"Spark Hive Example\"'}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(a.span,{className:\"token function\",children:\"config\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(a.span,{className:\"token string\",children:'\"spark.sql.warehouse.dir\"'}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" warehouseLocation\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(a.span,{className:\"token function\",children:\"enableHiveSupport\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(a.span,{className:\"token function\",children:\"getOrCreate\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsxs)(a.p,{children:[\"\\uC774\\uB807\\uAC8C hive \\uC124\\uC815\\uC744 \\uD588\\uC744 \\uB54C, \",(0,e.jsx)(a.code,{children:\"/etc/spark2/conf/hive-site.xml\"}),\"\\uC5D0 \\uC124\\uC815\\uD30C\\uC77C\\uC774 \\uC788\\uC73C\\uBA74 \\uD574\\uB2F9 \\uC124\\uC815\\uD30C\\uC77C\\uC5D0 \\uC758\\uD574\\uC11C Hive Metastore\\uB97C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB2E4. \",(0,e.jsx)(a.code,{children:\"hive-site.xml\"}),\"\\uC744 \\uBCF4\\uBA74 \",(0,e.jsx)(a.code,{children:\"hive.metastore.uris\"}),\"\\uB294 Metastore Thrift server\\uC5D0 \\uC811\\uADFC\\uD558\\uAE30 \\uC704\\uD574\\uC11C thrift protocol\\uB85C \\uC815\\uC758\\uAC00 \\uB418\\uC5B4 \\uC788\\uB2E4.\"]}),(0,e.jsx)(a.pre,{className:\"language-xml\",children:(0,e.jsxs)(a.code,{className:\"code-highlight language-xml\",children:[(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c\"}),\"property\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"\t\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c\"}),\"name\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"hive.metastore.uris\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"name\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"\t\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c\"}),\"value\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"thrift://{manager node1},thrift://{manager node2}\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"value\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"property\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]})]})}),(0,e.jsxs)(a.p,{children:[\"\\uADF8\\uB9AC\\uACE0 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \",(0,e.jsx)(a.code,{children:\"metastore.catalog.default\"}),\"\\uB3C4 \\uC124\\uC815\\uB418\\uC5B4 \\uC788\\uB2E4. \\uC774\\uBC88 \\uAE00\\uC5D0\\uC11C\\uB294 \\uC774 \\uC124\\uC815\\uAC12\\uC774 \\uC5B4\\uB5A4 \\uC601\\uD5A5\\uC744 \\uBBF8\\uCE58\\uB294\\uC9C0 \\uC0B4\\uD3B4\\uBCF4\\uB824\\uACE0 \\uD55C\\uB2E4.\\u{1F9D0}\"]}),(0,e.jsx)(a.pre,{className:\"language-xml\",children:(0,e.jsxs)(a.code,{className:\"code-highlight language-xml\",children:[(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c\"}),\"property\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"\t\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c\"}),\"name\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"metastore.catalog.default\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"name\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"\t\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c\"}),\"value\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"spark\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"value\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"property\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]})]})}),(0,e.jsx)(a.p,{children:\"\\uC0AC\\uC6A9 \\uD658\\uACBD\"}),(0,e.jsxs)(a.ul,{children:[(0,e.jsx)(a.li,{children:\"Hive: 3.1.2\"}),(0,e.jsx)(a.li,{children:\"Spark: 2.4.8\"})]}),(0,e.jsxs)(a.h2,{id:\"catalog\\uB780\",children:[(0,e.jsx)(a.a,{href:\"#catalog\\uB780\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(a.span,{className:\"icon icon-link\"})}),\"catalog\\uB780?\"]}),(0,e.jsx)(a.p,{children:\"Hive\\uB97C \\uC0AC\\uC6A9\\uD574\\uC11C Database\\uB098 Table\\uC744 \\uC0DD\\uC131\\uD558\\uBA74 Hive catalog\\uC5D0 \\uC874\\uC7AC\\uD558\\uACE0, Spark\\uB97C \\uC0AC\\uC6A9\\uD574\\uC11C Database\\uB098 Table\\uB97C \\uC0DD\\uC131\\uD558\\uBA74 Spark catalog\\uC5D0 \\uC874\\uC7AC\\uD558\\uAC8C \\uB41C\\uB2E4. Catalog\\uB294 \\uC5B4\\uB5A4 \\uC758\\uBBF8\\uB97C \\uAC00\\uC9C0\\uB294 \\uAC83\\uC77C\\uAE4C?\\u{1F9D0} Catalog\\uB294 \\uB370\\uC774\\uD130\\uB4E4\\uC758 \\uAD00\\uACC4, \\uC815\\uC758, \\uC124\\uBA85\\uB4F1\\uC774 \\uBCF4\\uAD00\\uB418\\uC5B4 \\uC788\\uB294 \\uACF3\\uC774\\uB77C\\uACE0 \\uC0DD\\uAC01\\uD560 \\uC218 \\uC788\\uACA0\\uB2E4. \\uADF8\\uB798\\uC11C Catalog\\uAC00 \\uB354 \\uD070 \\uBC94\\uC8FC\\uB97C \\uAC00\\uC9C0\\uACE0, \\uADF8 \\uC548\\uC5D0 Hive Metastore\\uC774 \\uB4E4\\uC5B4\\uAC04\\uB2E4\\uACE0 \\uBCFC \\uC218 \\uC788\\uACA0\\uB2E4(?).\"}),(0,e.jsxs)(a.p,{children:[(0,e.jsx)(a.code,{children:\"Hive\\uB97C \\uC0AC\\uC6A9\\uD574\\uC11C Database\\uB098 Table\\uC744 \\uC0DD\\uC131\\uD558\\uBA74 Hive catalog\\uC5D0 \\uC874\\uC7AC\\uD558\\uAC8C \\uB41C\\uB2E4\"}),\"\\uB294 \\uAC83\\uC740 \\uB370\\uC774\\uD130\\uC758 \\uAD00\\uACC4, \\uB370\\uC774\\uD130\\uAC00 \\uC800\\uC7A5\\uB41C \\uC704\\uCE58, \\uB370\\uC774\\uD130\\uC758 schema\\uB4F1 \\uB2E4\\uC591\\uD55C \\uC815\\uBCF4\\uB4E4\\uC774 Hive catalog\\uC5D0 \\uC874\\uC7AC\\uD558\\uAC8C \\uB418\\uB294\\uB370, \\uADF8\\uAC83\\uC744 Hive Metastore\\uAC00 \\uB2F4\\uB2F9\\uD558\\uACE0 \\uC788\\uB2E4\\uB294 \\uAC83\\uC73C\\uB85C \\uC0DD\\uAC01\\uD560 \\uC218 \\uC788\\uACA0\\uB2E4. Spark\\uB294 catalog\\uB97C \",(0,e.jsx)(a.code,{children:\"in-memory\"}),\" \\uBC29\\uC2DD\\uC73C\\uB85C \\uAD00\\uB9AC\\uD558\\uC5EC Spark session\\uB3D9\\uC548\\uB9CC \\uC720\\uC9C0\\uD558\\uAC8C \\uD558\\uAC70\\uB098, \",(0,e.jsx)(a.code,{children:\"Hive metastore\"}),\"\\uB97C \\uC0AC\\uC6A9\\uD558\\uC5EC \\uC9C0\\uC18D \\uAC00\\uB2A5\\uD55C catalog \\uC124\\uC815\\uC744 \\uD560 \\uC218 \\uC788\\uB2E4. \\uADF8\\uB9AC\\uACE0 \",(0,e.jsx)(a.code,{children:\"Hive\"}),\" \\uD658\\uACBD\\uC774 \\uC5C6\\uB294 \\uACBD\\uC6B0\\uC5D0\\uB294 Spark \\uC790\\uCCB4\\uC801\\uC73C\\uB85C Derby\\uB97C \\uC774\\uC6A9\\uD574\\uC11C Hive metastore\\uB97C \\uAD6C\\uC131\\uD55C\\uB2E4\\uACE0 \\uD55C\\uB2E4. \",(0,e.jsx)(a.code,{children:\"Spark catalog\\uC5D0 \\uC874\\uC7AC\"}),\"\\uB294 \\uC124\\uC815\\uC5D0 \\uB530\\uB77C\\uC11C in-memory, local metastore with Derby, external hive metastore \\uB4F1\\uC5D0 \\uC800\\uC7A5\\uB420 \\uC218 \\uC788\\uB2E4\\uB77C\\uB294 \\uAC83\\uC744 \\uC758\\uBBF8\\uD55C\\uB2E4. \\uB530\\uB77C\\uC11C \\uC704\\uC5D0\\uC11C \",(0,e.jsx)(a.code,{children:\"hive-site.xml\"}),\"\\uC5D0 Hive metastore\\uC5D0 \\uB300\\uD55C \\uC124\\uC815\\uB4E4\\uC774 \\uB418\\uC5B4 \\uC788\\uB294 Spark\\uC758 \\uACBD\\uC6B0\\uC5D0\\uB294 \",(0,e.jsx)(a.code,{children:\"External hive metastore\"}),\"\\uAC00 Spark catalog\\uAC00 \\uB418\\uB294 \\uAC83\\uC774\\uB2E4.\"]}),(0,e.jsxs)(a.h2,{id:\"spark\\uC5D0\\uC11C-\\uC0DD\\uC131\\uD55C-database\\uAC00-hive\\uC5D0\\uC11C-\\uC870\\uD68C\\uB418\\uC9C0\\uAC00-\\uC54A\\uB294\\uB2E4\",children:[(0,e.jsx)(a.a,{href:\"#spark\\uC5D0\\uC11C-\\uC0DD\\uC131\\uD55C-database\\uAC00-hive\\uC5D0\\uC11C-\\uC870\\uD68C\\uB418\\uC9C0\\uAC00-\\uC54A\\uB294\\uB2E4\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(a.span,{className:\"icon icon-link\"})}),\"Spark\\uC5D0\\uC11C \\uC0DD\\uC131\\uD55C Database\\uAC00 Hive\\uC5D0\\uC11C \\uC870\\uD68C\\uB418\\uC9C0\\uAC00 \\uC54A\\uB294\\uB2E4\"]}),(0,e.jsxs)(a.p,{children:[\"Spark\\uB97C Python\\uC73C\\uB85C \\uC0AC\\uC6A9\\uD560 \\uB54C, \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC791\\uC131\\uD560 \\uC218 \\uC788\\uB2E4. SparkSession\\uC5D0\\uC11C \",(0,e.jsx)(a.code,{children:\"hive-site.xml\"}),\"\\uC758 \\uC124\\uC815\\uD30C\\uC77C\\uC5D0 \\uC758\\uD574\\uC11C Hive Metastore\\uB97C \\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D \\uC790\\uB3D9 \\uC124\\uC815\\uB41C\\uB2E4. \\uAC04\\uB2E8\\uD558\\uAC8C database\\uB97C \\uC0DD\\uC131\\uD558\\uACE0, database \\uBAA9\\uB85D \\uC870\\uD68C\\uB97C \\uD55C\\uB2E4.\"]}),(0,e.jsx)(a.pre,{className:\"language-py\",children:(0,e.jsxs)(a.code,{className:\"code-highlight language-py\",children:[(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token keyword\",children:\"from\"}),\" os\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"path \",(0,e.jsx)(a.span,{className:\"token keyword\",children:\"import\"}),` abspath\n`]}),(0,e.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token keyword\",children:\"from\"}),\" pyspark\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"sql \",(0,e.jsx)(a.span,{className:\"token keyword\",children:\"import\"}),` SparkSession\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token keyword\",children:\"from\"}),\" pyspark\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"sql \",(0,e.jsx)(a.span,{className:\"token keyword\",children:\"import\"}),` Row\n`]}),(0,e.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"warehouse_location \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" abspath\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(a.span,{className:\"token string\",children:\"'spark-warehouse'\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"spark \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"=\"}),` SparkSession \\\\\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),`builder \\\\\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"appName\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(a.span,{className:\"token string\",children:'\"Python Spark SQL Hive integration example\"'}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),` \\\\\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"config\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(a.span,{className:\"token string\",children:'\"spark.sql.warehouse.dir\"'}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" warehouse_location\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),` \\\\\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"enableHiveSupport\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),` \\\\\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"getOrCreate\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"spark\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"sql\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(a.span,{className:\"token string\",children:'\"create database example\"'}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"spark\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"sql\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(a.span,{className:\"token string\",children:'\"show databases\"'}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"show\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsxs)(a.p,{children:[(0,e.jsx)(a.code,{children:\"pyspark\"}),\"\\uB85C \\uD574\\uB2F9 python script\\uB97C \\uC2E4\\uD589\\uD558\\uBA74 Console\\uC5D0 \\uC544\\uB798\\uC640 \\uAC19\\uC740 \\uB0B4\\uC6A9\\uC774 \\uCD9C\\uB825\\uB418\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(a.pre,{className:\"language-bash\",children:(0,e.jsxs)(a.code,{className:\"code-highlight language-bash\",children:[(0,e.jsx)(a.span,{className:\"code-line\",children:`+------------------+\n`}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\"      databaseName\",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsx)(a.span,{className:\"code-line\",children:`+------------------+\n`}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\"           default\",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\"        \t\texample\",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsx)(a.span,{className:\"code-line\",children:`+------------------+\n`})]})}),(0,e.jsxs)(a.p,{children:[\"\\uADF8\\uB7F0\\uB370 Hive shell\\uC744 \\uD1B5\\uD574\\uC11C \\uD655\\uC778\\uD558\\uBA74 \\uC0C8\\uB85C \\uC0DD\\uC131\\uD55C database \",(0,e.jsx)(a.code,{children:\"example\"}),\"\\uC774 \\uC870\\uD68C\\uB418\\uC9C0 \\uC54A\\uB294\\uB2E4.\"]}),(0,e.jsx)(a.pre,{className:\"language-bash\",children:(0,e.jsxs)(a.code,{className:\"code-highlight language-bash\",children:[(0,e.jsx)(a.span,{className:\"code-line\",children:`$ hive\n`}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"\u003e\"}),\" show databases\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(a.span,{className:\"code-line\",children:`OK\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`default\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`information_schema\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`sys\n`})]})}),(0,e.jsxs)(a.p,{children:[\"\\uC5EC\\uAE30\\uC11C \",(0,e.jsx)(a.code,{children:\"hive-site.xml\"}),\"\\uC758 \",(0,e.jsx)(a.code,{children:\"metastore.catalog.default\"}),\" \\uC124\\uC815\\uAC12\\uC744 \\uC0DD\\uAC01\\uD574 \\uBCFC \\uD544\\uC694\\uAC00 \\uC788\\uB2E4. \\uC704\\uC5D0\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \",(0,e.jsx)(a.code,{children:\"spark\"}),\"\\uB85C \\uC124\\uC815\\uB418\\uC5B4 \\uC788\\uB2E4\\uACE0 \\uC124\\uBA85\\uD588\\uC5C8\\uB2E4. Hive\\uC5D0\\uC11C\\uB294 \\uD574\\uB2F9 \\uAC12\\uC774 \\uAE30\\uBCF8\\uAC12 \",(0,e.jsx)(a.code,{children:\"hive\"}),\"\\uB85C \\uC124\\uC815\\uB418\\uC5B4 \\uC788\\uB2E4. \\uB530\\uB77C\\uC11C \\uD574\\uB2F9 \\uC124\\uC815\\uAC12\\uC744 \",(0,e.jsx)(a.code,{children:\"spark\"}),\" -\u003e \",(0,e.jsx)(a.code,{children:\"hive\"}),\"\\uB85C \\uBCC0\\uACBD \\uC801\\uC6A9\\uD558\\uACE0, Spark\\uC744 \\uC7AC\\uC2DC\\uC791\\uD55C\\uB2E4. \\uB2E4\\uC2DC spark\\uC5D0\\uC11C database\\uB97C \\uC870\\uD68C\\uD558\\uBA74 \\uB3D9\\uC77C\\uD55C \\uBAA9\\uB85D\\uC774 \\uBCF4\\uC774\\uAC8C \\uB41C\\uB2E4.\"]}),(0,e.jsx)(a.pre,{className:\"language-xml\",children:(0,e.jsxs)(a.code,{className:\"code-highlight language-xml\",children:[(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c\"}),\"property\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"\t\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c\"}),\"name\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"metastore.catalog.default\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"name\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"\t\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c\"}),\"value\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"spark\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"value\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"property\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]})]})}),(0,e.jsxs)(a.h2,{id:\"metastore-catalog\\uB294-\\uBB34\\uC5C7\\uC778\\uAC00\",children:[(0,e.jsx)(a.a,{href:\"#metastore-catalog\\uB294-\\uBB34\\uC5C7\\uC778\\uAC00\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(a.span,{className:\"icon icon-link\"})}),\"metastore catalog\\uB294 \\uBB34\\uC5C7\\uC778\\uAC00?\"]}),(0,e.jsxs)(a.p,{children:[(0,e.jsx)(a.code,{children:\"Catalog\"}),\", \",(0,e.jsx)(a.code,{children:\"Hive Metastore\"}),\", \",(0,e.jsx)(a.code,{children:\"Metastore Catalog\"}),\"\\uB4F1 \\uC6A9\\uC5B4\\uB4E4\\uC774 \\uB0B4 \\uBA38\\uB9BF\\uC18D\\uC5D0 \\uD63C\\uC7AC\\uB418\\uC5B4\\uC11C \\uD5DB\\uAC08\\uB838\\uB2E4. \",(0,e.jsx)(a.code,{children:\"metastore.catalog.default\"}),\" \\uC124\\uC815\\uAC12\\uC5D0\\uC11C \",(0,e.jsx)(a.code,{children:\"metastore.catalog\"}),\"\\uB294 \\uBB34\\uC5C7\\uC774\\uB780 \\uB9D0\\uC778\\uAC00?\\u{1F928} Hive Metastore Thrift Server\\uAC00 \\uC788\\uACE0, \\uC800\\uC7A5\\uC18C\\uB85C Derby, MySQL, PostgreSQL\\uB4F1 \\uB370\\uC774\\uD130\\uBCA0\\uC774\\uC2A4\\uAC00 \\uC0AC\\uC6A9\\uB41C\\uB2E4. \",(0,e.jsx)(a.code,{children:\"metastore.catalog\"}),\"\\uB294 Metastore\\uAC00 \\uC800\\uC7A5\\uC18C\\uC5D0 \\uC800\\uC7A5\\uD560 \\uB54C, Metastore\\uC5D0 \\uC800\\uC7A5\\uB41C \\uB370\\uC774\\uD130\\uB97C namespace\\uCC98\\uB7FC \\uAD6C\\uBD84\\uD558\\uAE30 \\uC704\\uD55C \\uC774\\uB984\\uC774\\uB77C\\uACE0 \\uC0DD\\uAC01\\uB41C\\uB2E4.\"]}),(0,e.jsxs)(a.p,{children:[\"\\uB124\\uC774\\uBC84 \\uD074\\uB77C\\uC6B0\\uB4DC\\uC5D0\\uC11C \\uC81C\\uACF5\\uD558\\uB294 \\uAD00\\uB9AC\\uD615 Hadoop Service\\uC5D0\\uC11C\\uB294 MySQL\\uB97C \\uC0AC\\uC6A9\\uD558\\uACE0 \\uC788\\uB294\\uB370, \\uD574\\uB2F9 \\uD658\\uACBD\\uC5D0\\uC11C \\uD655\\uC778\\uC744 \\uD574\\uBCF4\\uC558\\uB2E4. \\uBA3C\\uC800 \",(0,e.jsx)(a.code,{children:\"/etc/hive/conf\"}),\" \\uACBD\\uB85C\\uC5D0\\uC11C \",(0,e.jsx)(a.code,{children:\"hive-site.xml\"}),\" \\uD30C\\uC77C\\uC744 \\uD655\\uC778\\uD574\\uBCF4\\uBA74 \\uC544\\uB798\\uCC98\\uB7FC \\uC124\\uC815\\uC774 \\uB418\\uC5B4 \\uC788\\uB2E4.\"]}),(0,e.jsx)(a.p,{children:(0,e.jsx)(a.code,{children:\"hive-site.xml\"})}),(0,e.jsx)(a.pre,{className:\"language-xml\",children:(0,e.jsxs)(a.code,{className:\"code-highlight language-xml\",children:[(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c\"}),\"property\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"\t\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c\"}),\"name\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"javax.jdo.option.ConnectionURL\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"name\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"\t\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c\"}),\"value\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"jdbc:mysql://mysql.local:3306/hive_9880\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"value\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"property\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c\"}),\"property\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"\t\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c\"}),\"name\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"javax.jdo.option.ConnectionUserName\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"name\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"\t\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c\"}),\"value\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),\"{username}\",(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"value\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsxs)(a.span,{className:\"token tag\",children:[(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"property\"]}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]})]})}),(0,e.jsx)(a.p,{children:\"\\uC774\\uC81C mysql client\\uB97C \\uD1B5\\uD574\\uC11C MySQL \\uC811\\uC18D\\uD558\\uC5EC Schema\\uB97C \\uD655\\uC778\\uD574\\uBCF8\\uB2E4.\"}),(0,e.jsx)(a.pre,{className:\"language-bash\",children:(0,e.jsx)(a.code,{className:\"code-highlight language-bash\",children:(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"mysql -h mysql.local -u \",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),\"username\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),` -p\n`]})})}),(0,e.jsx)(a.p,{children:\"\\uC800\\uC7A5\\uB41C \\uB370\\uC774\\uD130\\uB97C \\uD655\\uC778\\uD574\\uBCF4\\uBA74 Hive Metastore\\uB97C \\uC0AC\\uC6A9\\uD558\\uACE0 \\uC788\\uB294 \\uB2E4\\uC591\\uD55C service\\uB4E4\\uC5D0 \\uB300\\uD55C Database\\uAC00 \\uBCF4\\uC778\\uB2E4.\"}),(0,e.jsx)(a.pre,{className:\"language-bash\",children:(0,e.jsxs)(a.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"mysql\",(0,e.jsx)(a.span,{className:\"token operator\",children:\"\u003e\"}),\" show databases\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(a.span,{className:\"code-line\",children:`+--------------------+\n`}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\" Database           \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsx)(a.span,{className:\"code-line\",children:`+--------------------+\n`}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\" information_schema \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\" ambari_9880        \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\" grafana_9880       \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\" hive_9880          \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\" hue_9880           \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\" logsearch_9880     \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\" oozie_9880         \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\" ranger_9880        \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\" ranger_kms_9880    \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsx)(a.span,{className:\"code-line\",children:`+--------------------+\n`})]})}),(0,e.jsxs)(a.p,{children:[\"\\uADF8\\uB9AC\\uACE0 \",(0,e.jsx)(a.code,{children:\"hive_9880\"}),\" Database\\uC5D0 \\uC788\\uB294 \",(0,e.jsx)(a.code,{children:\"DBS\"}),\" table\\uC758 \\uB808\\uCF54\\uB4DC\\uB4E4\\uC744 \\uD655\\uC778\\uD574\\uBCF8\\uB2E4.\"]}),(0,e.jsx)(a.pre,{className:\"language-bash\",children:(0,e.jsxs)(a.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"mysql\",(0,e.jsx)(a.span,{className:\"token operator\",children:\"\u003e\"}),\" use hive_9880\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"mysql\",(0,e.jsx)(a.span,{className:\"token operator\",children:\"\u003e\"}),\" \",(0,e.jsx)(a.span,{className:\"token keyword\",children:\"select\"}),\" * from DBS\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),(0,e.jsxs)(a.p,{children:[\"\\uADF8\\uB7EC\\uBA74 Hive\\uC5D0\\uC11C \\uB9CC\\uB4E4\\uC5B4\\uC9C4 database\\uC640 Spark\\uC5D0\\uC11C \\uC0DD\\uC131\\uD55C \",(0,e.jsx)(a.code,{children:\"example\"}),\"\\uC774 \\uC870\\uD68C\\uB418\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. \\uC774\\uB807\\uAC8C \",(0,e.jsx)(a.code,{children:\"metadata.catalog.default\"}),\"\\uC5D0 \\uC124\\uC815\\uB41C \\uAC12\\uC73C\\uB85C \\uAD6C\\uBD84\\uC774 \\uB418\\uC5B4 \\uC788\\uACE0, Metastore Thrift Server\\uAC00 MySQL \\uC800\\uC7A5\\uC18C\\uC5D0 Query\\uB97C \\uD560 \\uB54C \\uC774 \\uAC12\\uC73C\\uB85C \\uAD6C\\uBD84\\uD574\\uC11C \\uAC00\\uC838\\uC624\\uB294 \\uAC83\\uC73C\\uB85C \\uC0DD\\uAC01\\uB41C\\uB2E4. (\\uC800\\uC7A5\\uC18C\\uB97C MySQL\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 \\uACFC\\uC815\\uC5D0\\uC11C general_log\\uB97C \\uBCF4\\uBA74 Query\\uBB38\\uC774 \\uC5B4\\uB5BB\\uAC8C \\uB418\\uB294\\uC9C0 \\uD655\\uC778\\uD558\\uBA74 \\uD655\\uC2E4\\uD558\\uAC8C \\uC54C \\uC218 \\uC788\\uC744 \\uAC83\\uC774\\uB2E4.)\"]}),(0,e.jsx)(a.pre,{className:\"language-bash\",children:(0,e.jsxs)(a.code,{className:\"code-highlight language-bash\",children:[(0,e.jsx)(a.span,{className:\"code-line\",children:`+------------------+----------+\n`}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\"NAME              \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\"CTLG_NAME \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsx)(a.span,{className:\"code-line\",children:`+------------------+----------+\n`}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\"default           \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\"hive      \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\"sys               \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\"hive      \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\"information_schema\",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\"hive      \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\"example           \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),\"spark     \",(0,e.jsx)(a.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsx)(a.span,{className:\"code-line\",children:`+------------------+----------+\n`})]})}),(0,e.jsxs)(a.p,{children:[(0,e.jsx)(a.a,{href:\"https://github.com/apache/hive/pull/320\",children:\"Github Pull Request \\uAE30\\uB85D\"}),\"\\uC744 \\uBCF4\\uBA74, catalog \\uBCC0\\uC218\\uB97C \\uCD94\\uAC00\\uD558\\uBA74\\uC11C default\\uB85C \",(0,e.jsx)(a.code,{children:\"hive\"}),\"\\uB97C \\uD558\\uB3C4\\uB85D \\uD558\\uACE0, Server side\\uC5D0\\uC11C \\uC124\\uC815\\uAC12\\uC73C\\uB85C \\uBCC0\\uACBD\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D \\uBCC0\\uACBD\\uC774 \\uB41C \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. \\uADF8\\uB9AC\\uACE0 Query\\uB97C \\uD560 \\uB54C catalog \\uAC12\\uC744 \\uC0AC\\uC6A9\\uD574\\uC11C \\uAC00\\uC838\\uC624\\uB294 \\uAC83\\uB3C4 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsxs)(a.h2,{id:\"\\uACB0\\uB860\",children:[(0,e.jsx)(a.a,{href:\"#\\uACB0\\uB860\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(a.span,{className:\"icon icon-link\"})}),\"\\uACB0\\uB860\"]}),(0,e.jsxs)(a.p,{children:[\"Hive Metastore\\uB294 \\uB2E4\\uC591\\uD55C \\uC5B4\\uD50C\\uB9AC\\uCF00\\uC774\\uC158\\uC5D0\\uC11C Metadata\\uB97C \\uC800\\uC7A5\\uD558\\uAE30 \\uC704\\uD574\\uC11C \\uC0AC\\uC6A9\\uB420 \\uC218 \\uC788\\uB2E4. Spark\\uC5D0\\uC11C\\uB3C4 \\uBA54\\uBAA8\\uB9AC\\uC5D0 Metadata\\uB97C \\uBCF4\\uAD00\\uD558\\uB294 \\uB300\\uC2E0\\uC5D0 Hive Metastore\\uB97C \\uC0AC\\uC6A9\\uD558\\uC5EC \\uC800\\uC7A5\\uC18C\\uC5D0 \\uBCF4\\uAD00\\uD560 \\uC218 \\uC788\\uB2E4. \\uADF8\\uB9AC\\uACE0 Spark\\uC5D0\\uC11C Hive support option\\uC744 \\uD1B5\\uD574\\uC11C Hive\\uC758 \\uB370\\uC774\\uD130\\uC5D0 \\uC811\\uADFC\\uD560 \\uC218 \\uC788\\uB2E4. \\uADF8\\uB7F0\\uB370 Hive\\uC5D0\\uC11C \\uC0DD\\uC131\\uD55C \\uBA54\\uD0C0\\uB370\\uC774\\uD130\\uB294 \",(0,e.jsx)(a.code,{children:\"metastore.catalog.default\"}),\"\\uAC00 \",(0,e.jsx)(a.code,{children:\"hive\"}),\"\\uB85C \\uC124\\uC815\\uB418\\uC5B4 \\uC800\\uC7A5\\uB418\\uACE0, Spark\\uC5D0\\uC11C \\uC0DD\\uC131\\uD55C \\uBA54\\uD0C0\\uB370\\uC774\\uD130\\uB294 \",(0,e.jsx)(a.code,{children:\"metastore.catalog.default\"}),\"\\uAC00 \",(0,e.jsx)(a.code,{children:\"spark\"}),\"\\uB85C \\uC124\\uC815\\uB418\\uC5B4 \\uC800\\uC7A5\\uB41C\\uB2E4. \\uBA54\\uD0C0\\uB370\\uC774\\uD130\\uB97C \\uAC00\\uC838\\uC62C \\uB54C\\uB3C4 \\uC774 catalog \\uC774\\uB984\\uC73C\\uB85C \\uAD6C\\uBD84\\uB418\\uC5B4 \\uAC00\\uC838\\uC624\\uAC8C \\uB41C\\uB2E4. \\uB530\\uB77C\\uC11C Spark\\uC5D0\\uC11C Hive\\uC5D0\\uC11C \\uC0DD\\uC131\\uB41C \\uB370\\uC774\\uD130\\uBCA0\\uC774\\uC2A4\\uB97C \\uC870\\uD68C\\uD558\\uC9C0 \\uBABB\\uD558\\uAC8C \\uB41C\\uB2E4. Spark\\uC758 \",(0,e.jsx)(a.code,{children:\"hive-site.xml\"}),\" \\uC124\\uC815\\uAC12\\uC744 \\uD1B5\\uD574\\uC11C \",(0,e.jsx)(a.code,{children:\"metastore.catalog.default\"}),\"\\uB97C \",(0,e.jsx)(a.code,{children:\"hive\"}),\"\\uB85C \\uC124\\uC815\\uD558\\uBA74, Hive\\uC5D0\\uC11C \\uC0DD\\uC131\\uB41C \\uB370\\uC774\\uD130\\uBCA0\\uC774\\uC2A4\\uB97C \\uC870\\uD68C\\uD560 \\uC218 \\uC788\\uAC8C \\uB41C\\uB2E4.\"]})]})}}var S=b;return y;})();\n;return Component;","toc":[{"value":"catalog란?","url":"#catalog란","depth":2},{"value":"Spark에서 생성한 Database가 Hive에서 조회되지가 않는다","url":"#spark에서-생성한-database가-hive에서-조회되지가-않는다","depth":2},{"value":"metastore catalog는 무엇인가?","url":"#metastore-catalog는-무엇인가","depth":2},{"value":"결론","url":"#결론","depth":2}],"frontMatter":{"readingTime":{"text":"6 min read","minutes":5.325,"time":319500,"words":1065},"slug":"20240427-metastore-catalog-default","fileName":"20240427-metastore-catalog-default.md","title":"Spark에서 Hive database가 조회가 안 되는 문제","date":"2024-04-27T00:00:00.000Z","tags":["spark"],"images":["/static/images/social-banner.png"],"summary":"Spark에서 SparkSession에 hive 설정을 해서 Hive의 데이터를 읽기/쓰기가 가능하다. 하지만 Hive에서 생성한 데이터베이스가 Spark에서는 조회가 되지 않았다. Spark에서 Hive Metastore를 Catalog로 사용할 때, hive-site.xml에 설정된 값을 이해하면 왜 조회가 되지 않는지 이해할 수 있다. hive-site.xml의 metadata.catalog.default 값이 어떻게 영향을 미치지는 살펴봤다."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.15,"time":9000,"words":30},"slug":["default"],"fileName":"default.md","name":"Jay","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"Kubelet imageGC","date":"2024-04-20T00:00:00.000Z","tags":["kubernetes","ncloud"],"images":["/static/images/social-banner.png"],"summary":"사이즈가 큰 컨테이너 이미지를 내려받기 위해서 Containerd의 설정값 root을 새로운 스토리지를 추가한 경로로 수정하였다. Kubelet은 imageGCHighThresholdPercent로 설정된 임계치보다 disk 사용량이 많으면, 컨테이너 이미지를 정리하여 disk 공간을 확보하려고 한다. imageGCHighThresholdPercent이 기본값으로 85로 설정되어 있고, disk의 85 퍼센트 이상 사용했을 때 정리 프로세스가 실행된다. 문제는 Containerd root 경로의 volume이 거의 꽉 차더라도, 전체 volume의 사용량은 85 퍼센트가 되지 않을 수 있다는 것이다. Containerd root 경로의 volume에 여유가 없어서 새로 스케쥴된 Pod의 컨테이너 이미지를 내려 받지 못하는 문제가 발생할 수 있다. imageGCHighThresholdPercent 설정값을 조절하여 이 문제를 해결할 수 있다.","slug":"20240420-kubelet-imagegc"},"next":{"title":"OpenTelmetry로 auth.log와 syslog 수집하기","date":"2024-05-01T00:00:00.000Z","tags":["kubernetes","opentelemetry","devsecops"],"images":["/static/images/social-banner.png"],"summary":"Ubuntu 20.04 서버의 auth.log, syslog 로그 값들을 OpenTelemetry를 통해서 수집하고 싶었다. 처음에는 Filelog Receiver를 통해서 수집하려고 하였고, rsyslog의 설정값을 변경하여 Filelog로 수집하도록 구성했다. 그런데 이후에 Syslog Receiver가 존재하는 것을 확인하게 되었고, 훨씬 간단하게 syslog를 수집할 수 있었다.","slug":"20240501-opentelemetry-syslog"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["20240427-metastore-catalog-default"]},"buildId":"YVp8inUj3T3ALc6g3E6U4","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>