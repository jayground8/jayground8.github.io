{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var r=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var t=a=>l(a,\"__esModule\",{value:!0});var u=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),k=(a,s)=>{t(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},N=(a,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let n of p(s))!m.call(a,n)&&n!==\"default\"&&l(a,n,{get:()=>s[n],enumerable:!(c=d(s,n))||c.enumerable});return a},g=a=>N(t(l(a!=null?r(h(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=u((L,i)=>{i.exports=_jsx_runtime});var _={};k(_,{default:()=>f,frontmatter:()=>y});var e=g(o()),y={title:\"Loki multi-tenants\",date:\"2024-04-20\",tags:[\"kubernetes\"],images:[\"/static/images/social-banner.png\"],summary:\"Loki\\uB85C Log\\uB97C \\uC218\\uC9D1\\uD558\\uACE0, Grafana\\uB85C Log\\uB97C \\uBCF4\\uC5EC\\uC904 \\uB54C Grafana user\\uBCC4\\uB85C \\uBCFC \\uC218 \\uC788\\uB294 Log\\uB97C \\uC81C\\uD55C\\uD558\\uACE0 \\uC2F6\\uC5C8\\uB2E4. Grafana Enterpirse\\uC758 \\uACBD\\uC6B0\\uC5D0\\uB294 Label-based access control\\uC744 \\uC81C\\uACF5\\uD558\\uC5EC, Loki label\\uBCC4\\uB85C Query\\uD560 \\uC218 \\uC788\\uB294 \\uAD8C\\uD55C\\uC744 \\uC81C\\uD55C\\uD560 \\uC218 \\uC788\\uB294 \\uAC83\\uCC98\\uB7FC \\uBCF4\\uC778\\uB2E4. \\uD558\\uC9C0\\uB9CC \\uC544\\uC27D\\uAC8C \\uC624\\uD508\\uC18C\\uC2A4\\uC5D0\\uC11C\\uB294 \\uD574\\uB2F9 \\uAE30\\uB2A5\\uC744 \\uC81C\\uACF5\\uD558\\uC9C0 \\uC54A\\uB294\\uB2E4. \\uADF8\\uB798\\uC11C Loki multi tenant\\uB97C \\uD1B5\\uD574\\uC11C Log\\uB97C tenent\\uBCC4\\uB85C \\uADF8\\uB8F9\\uD551\\uD558\\uACE0, tenant\\uBCC4\\uB85C query\\uD558\\uB294 \\uBC29\\uBC95\\uC744 \\uC0AC\\uC6A9\\uD588\\uB2E4. \\uADF8\\uB9AC\\uACE0 Loki\\uB294 \\uC778\\uC99D layer\\uAC00 \\uC874\\uC7AC\\uD558\\uC9C0 \\uC54A\\uAE30 \\uB54C\\uBB38\\uC5D0 Nginx\\uB97C \\uD1B5\\uD574\\uC11C \\uC778\\uC99D\\uC744 \\uD558\\uC5EC query\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D \\uD558\\uC600\\uB2E4. \\uB9C8\\uC9C0\\uB9C9\\uC73C\\uB85C Network Policy\\uB85C Nginx \\uC778\\uC99D\\uC744 \\uD1B5\\uD574\\uC11C Loki\\uC5D0 \\uC811\\uADFC\\uD558\\uB3C4\\uB85D \\uAC15\\uC81C\\uD558\\uC5EC \\uC6D0\\uD558\\uB294 \\uAD6C\\uC131\\uC744 \\uD560 \\uC218 \\uC788\\uC5C8\\uB2E4.\"};function b(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",code:\"code\",blockquote:\"blockquote\",pre:\"pre\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"application-log\\uB97C-\\uBD84\\uB9AC\",children:[(0,e.jsx)(n.a,{href:\"#application-log\\uB97C-\\uBD84\\uB9AC\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Application Log\\uB97C \\uBD84\\uB9AC\"]}),(0,e.jsx)(n.p,{children:\"OpenTelemetry Collector\\uC640 Loki\\uB97C \\uD1B5\\uD574\\uC11C Application Log\\uB4E4\\uC744 \\uC218\\uC9D1\\uD558\\uACE0, Grafana Explore\\uB97C \\uD1B5\\uD574\\uC11C Application Log\\uB4E4\\uC744 \\uAC80\\uC0C9\\uD558\\uACE0 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. \\uADF8\\uB7F0\\uB370 Grafana Explore\\uB97C \\uBCFC \\uC218 \\uC788\\uB294 Application Log \\uC885\\uB958\\uB97C \\uC81C\\uD55C\\uD558\\uACE0 \\uC2F6\\uC740 \\uACBD\\uC6B0\\uC5D0\\uB294 \\uC5B4\\uB5BB\\uAC8C \\uD574\\uC57C \\uD560\\uAE4C? \\uC608\\uB97C \\uB4E4\\uC5B4\\uC11C Grafana Account A\\uB294 Kubernetes\\uC758 main namespace\\uC548\\uC758 Pod log\\uB4E4\\uB9CC \\uBCFC \\uC218 \\uC788\\uAC8C \\uC81C\\uD55C\\uD558\\uACE0, Grafana Account B\\uB294 Kubernetes\\uC758 test namespace\\uC5D0\\uC11C \\uC0DD\\uC131\\uB418\\uB294 log\\uB9CC \\uBCFC \\uC218 \\uC788\\uAC8C \\uC81C\\uD55C\\uD558\\uACE0 \\uC2F6\\uB2E4.\"}),(0,e.jsxs)(n.p,{children:[\"Grafana Enterprise\\uC758 \\uACBD\\uC6B0\\uC5D0\\uB294 \",(0,e.jsx)(n.a,{href:\"https://grafana.com/docs/enterprise-metrics/latest/tenant-management/lbac/\",children:\"Label-based access control\"}),\" \\uAE30\\uB2A5\\uC744 \\uC81C\\uACF5\\uD558\\uC5EC, \\uD2B9\\uC815\\uD55C Label\\uC774 \\uC788\\uB294 \\uACBD\\uC6B0\\uB9CC \\uBCFC \\uC218 \\uC788\\uB3C4\\uB85D \\uAD8C\\uD55C \\uC124\\uC815\\uC774 \\uAC00\\uB2A5\\uD55C \\uAC83\\uC73C\\uB85C \\uBCF4\\uC778\\uB2E4. \\uD558\\uC9C0\\uB9CC \\uC544\\uC27D\\uAC8C\\uB3C4 \\uC624\\uD508\\uC18C\\uC2A4\\uC5D0\\uC11C \\uD574\\uB2F9 \\uAE30\\uB2A5\\uC744 \\uC81C\\uACF5\\uD558\\uC9C0 \\uC54A\\uB294\\uB2E4.\"]}),(0,e.jsxs)(n.p,{children:[\"\\uC624\\uD508\\uC18C\\uC2A4\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 \\uACBD\\uC6B0\\uC5D0\\uB294 \",(0,e.jsx)(n.a,{href:\"https://grafana.com/docs/loki/latest/operations/multi-tenancy/\",children:\"Loki\\uC5D0\\uC11C Multi-tenancy\"}),\" \\uAE30\\uB2A5\\uC744 \\uC0AC\\uC6A9\\uD558\\uC5EC \\uBD84\\uB9AC\\uB97C \\uACE0\\uB824\\uD560 \\uC218 \\uC788\\uB2E4. Loki\\uC5D0\\uC11C Log\\uB97C \\uC218\\uC9D1\\uD560 \\uB54C tenant\\uBCC4\\uB85C \\uBB36\\uC5B4\\uC11C \\uC800\\uC7A5\\uD558\\uACE0, query\\uB97C \\uD560 \\uB54C \\uD574\\uB2F9 tenant \\uADF8\\uB8F9\\uC5D0 \\uC18D\\uD55C Log\\uB4E4\\uB9CC \\uAC00\\uC838\\uC62C \\uC218 \\uC788\\uB2E4. \\uADF8\\uB807\\uAC8C \\uD558\\uAE30 \\uC704\\uD574\\uC11C Loki HTTP endpoint \",(0,e.jsx)(n.code,{children:\"/loki/api/v1/push\"}),\"\\uB85C \\uC694\\uCCAD\\uD560 \\uB54C, Header \",(0,e.jsx)(n.code,{children:\"X-Scope-OrgID\"}),\" \\uAC12\\uC5D0 tenant \\uC2DD\\uBCC4\\uC815\\uBCF4\\uB97C \\uB2F4\\uC544\\uC11C \\uBCF4\\uB0B4\\uBA74 \\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"Grafana Loki is a multi-tenant system; requests and data for tenant A are isolated from tenant B. Requests to the Loki API should include an HTTP header (X-Scope-OrgID) that identifies the tenant for the request.\"})}),(0,e.jsxs)(n.h2,{id:\"loki-multi-tenant-system\",children:[(0,e.jsx)(n.a,{href:\"#loki-multi-tenant-system\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Loki Multi Tenant System\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"helm chart 5.42.2 \\uBC84\\uC804 \\uAE30\\uC900\"})}),(0,e.jsx)(n.p,{children:\"Loki\\uB97C Monolithic Mode\\uB85C \\uC124\\uCE58\\uD558\\uC5EC \\uD14C\\uC2A4\\uD2B8\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"values.yaml\"})}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"global\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"dnsService\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"coredns\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"loki\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"auth_enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"commonConfig\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"replication_factor\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"storage\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"type\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'filesystem'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"singleBinary\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"replicas\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"auth_enabled\"}),\"\\uB97C \",(0,e.jsx)(n.code,{children:\"false\"}),\"\\uB85C \\uC124\\uC815\\uD558\\uBA74, single tanant\\uB97C \\uC0AC\\uC6A9\\uD558\\uAC8C \\uB418\\uACE0, tenant \\uC2DD\\uBCC4\\uBA85\\uC740 \",(0,e.jsx)(n.code,{children:\"fake\"}),\"\\uAC00 \\uB41C\\uB2E4. \",(0,e.jsx)(n.code,{children:\"auth_enabled\"}),\"\\uC758 \\uAE30\\uBCF8\\uAC12\\uC740 \",(0,e.jsx)(n.code,{children:\"true\"}),\"\\uC774\\uC9C0\\uB9CC \\uBA85\\uC2DC\\uC801\\uC73C\\uB85C \\uC124\\uC815\\uD574\\uC8FC\\uC5C8\\uB2E4.\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"Loki defaults to running in multi-tenant mode. Multi-tenant mode is set in the configuration with auth_enabled: true.\"})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://github.com/grafana/loki/blob/main/production/helm/loki/values.yaml\",children:\"Helm chart\\uC758 value\\uAC12\\uC744 \\uD655\\uC778\"}),\"\\uD574\\uBCF4\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC124\\uC815\\uB418\\uC5B4 \\uC788\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. Loki\\uC5D0\\uC11C log data\\uB97C \\uC555\\uCD95\\uD574\\uC11C \\uC800\\uC7A5\\uD558\\uAC8C \\uB418\\uB294\\uB370, \\uD574\\uB2F9 chunk \\uD30C\\uC77C\\uB4E4\\uC774 filesystem\\uC758 \\uC544\\uB798 \\uACBD\\uB85C\\uB85C \\uC800\\uC7A5\\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"filesystem\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"chunks_directory\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` /var/loki/chunks\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"rules_directory\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` /var/loki/rules\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uC544\\uB798\\uC640 \\uAC19\\uC774 Pod\\uC5D0 \\uC811\\uADFC\\uD558\\uC5EC \\uD574\\uB2F9 \\uACBD\\uB85C\\uB97C \\uD655\\uC778\\uD574\\uBCF4\\uBA74, tenant \\uC774\\uB984\\uBCC4\\uB85C Directory\\uAC00 \\uC0DD\\uAE34 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. \\uB9CC\\uC57D \",(0,e.jsx)(n.code,{children:\"auth_enabled\"}),\"\\uB97C \",(0,e.jsx)(n.code,{children:\"false\"}),\"\\uB85C \\uD588\\uB2E4\\uBA74, \\uC5EC\\uAE30\\uC5D0 \",(0,e.jsx)(n.code,{children:\"fake\"}),\"\\uB77C\\uB294 Directory\\uBA85\\uC73C\\uB85C \\uD30C\\uC77C\\uB4E4\\uC774 \\uC0DD\\uC131\\uB420 \\uAC83\\uC774\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-bash\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"kubectl \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"exec\"}),` -it loki-0 -- /bin/sh\n`]})})}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-bash\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"ls\"}),` /var/loki/chunks\n`]})})}),(0,e.jsxs)(n.p,{children:[\"\\uC8FC\\uC758\\uD574\\uC57C\\uD560 \\uC810\\uC740 \",(0,e.jsx)(n.code,{children:\"auth_enabled\"}),\"\\uC740 \",(0,e.jsx)(n.code,{children:\"true\"}),\"\\uB85C \\uC124\\uC815\\uD588\\uAE30 \\uB54C\\uBB38\\uC5D0, Loki\\uC5D0 push \\uC694\\uCCAD\\uC744 \\uD560 \\uB54C \",(0,e.jsx)(n.code,{children:\"X-Scope-OrgID\"}),\" \\uD574\\uB354\\uAC12\\uC774 \\uC5C6\\uC73C\\uBA74 \\uC694\\uCCAD\\uC774 \\uC2E4\\uD328\\uD55C\\uB2E4.\"]}),(0,e.jsxs)(n.h2,{id:\"opentelmetry-loki-exporter-\\uC124\\uC815\",children:[(0,e.jsx)(n.a,{href:\"#opentelmetry-loki-exporter-\\uC124\\uC815\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"OpenTelmetry Loki Exporter \\uC124\\uC815\"]}),(0,e.jsxs)(n.p,{children:[\"OpenTelemetry Collector\\uC758 Exporter\\uB85C Loki\\uC5D0 Log \\uB370\\uC774\\uD130\\uB97C \\uC804\\uB2EC\\uD560 \\uACBD\\uC6B0, \",(0,e.jsx)(n.a,{href:\"https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/exporter/lokiexporter/README.md\",children:\"Loki Exporter \\uBB38\\uC11C\"}),\"\\uC5D0 \\uC124\\uBA85\\uB41C \\uAC83\\uCC98\\uB7FC tenant \\uC815\\uBCF4\\uB97C \\uBCF4\\uB0BC \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:\"\\uACE0\\uC815 tenant \\uAC12\\uC744 \\uC0AC\\uC6A9\\uD560 \\uB54C\\uB294 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC804\\uB2EC\\uD560 \\uC218 \\uC788\\uACE0,\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"exporters\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"loki\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"endpoint\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" http\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"//localhost\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`3100/loki/api/v1/push\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"headers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:'\"X-Scope-OrgID\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` staticTenant\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uBCC0\\uC218\\uAC12\\uC744 \\uBCF4\\uB0B4\\uC57C \\uD558\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \",(0,e.jsx)(n.code,{children:\"loki.tenant\"}),\" \\uC18D\\uC131\\uAC12\\uC744 \\uC815\\uC758\\uD560 \\uC218 \\uC788\\uB2E4. \\uC774\\uB807\\uAC8C \",(0,e.jsx)(n.code,{children:\"loki.tenant\"}),\"\\uB97C \\uC124\\uC815\\uD558\\uBA74, \",(0,e.jsx)(n.code,{children:\"X-Scope-OrgID\"}),\" header\\uB85C \\uD574\\uB2F9 \\uAC12\\uC744 \\uC804\\uB2EC\\uD558\\uAC8C \\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"processors\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"resource\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"attributes\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"action\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` insert\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` loki.tenant\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` host.name\n`]})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"opentelemetry-collector Helm chart 0.77.0 \\uBC84\\uC804 \\uAE30\\uC900\"})}),(0,e.jsxs)(n.p,{children:[\"opentelemetry-collector Helm chart\\uC758 value\\uC911\\uC5D0 service, processors, exporters\\uB97C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB2E4. \",(0,e.jsx)(n.code,{children:\"loki.tenant\"}),\" \\uC18D\\uC131\\uAC12\\uC5D0 container\\uBA85\\uC744 \\uC124\\uC815\\uD558\\uC600\\uB2E4. \",(0,e.jsxs)(n.a,{href:\"https://github.com/open-telemetry/opentelemetry-collector-contrib/pull/14930\",children:[\"PR\\uC744 \\uBCF4\\uBA74 Loki index\\uB97C \\uC124\\uC815\\uD558\\uB294 \",(0,e.jsx)(n.code,{children:\"loki.attribute.labels\"}),\", \",(0,e.jsx)(n.code,{children:\"loki.resource.labels\"}),\" hint\\uC640 \\uB354\\uBD88\\uC5B4\\uC11C \",(0,e.jsx)(n.code,{children:\"loki.tenant\"}),\"\\uB3C4 hint\\uB85C \\uC0AC\\uC6A9\\uD560\\uC218 \\uC788\\uB3C4\\uB85D \\uCD94\\uAC00\\uB418\\uC5C8\\uB2E4.\"]})]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"service\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"telemetry\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"logs\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"level\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` info\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"pipelines\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"traces\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"receivers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` otlp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"exporters\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` otlp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metrics\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"receivers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` otlp\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"logs\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"receivers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` filelog\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"processors\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` resource\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` attributes\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"exporters\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` loki\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"processors\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"attributes\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"actions\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"action\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` insert\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` loki.attribute.labels\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" level\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" context\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` traceID\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"action\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` insert\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` loki.tenant\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` container\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"resource\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"attributes\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"action\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` insert\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` loki.format\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` json\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"action\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` insert\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` loki.resource.labels\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" pod\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" namespace\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` container\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"exporters\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"loki\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"endpoint\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" http\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"//loki\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`3100/loki/api/v1/push\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uC774\\uB807\\uAC8C \\uC124\\uC815\\uD558\\uACE0 \\uB098\\uBA74, filelog\\uB85C \\uC218\\uC9D1\\uD55C container\\uBA85\\uC774 tenant\\uB85C \\uC124\\uC815\\uB420 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsxs)(n.h2,{id:\"grafana-datasource-\\uC124\\uC815\",children:[(0,e.jsx)(n.a,{href:\"#grafana-datasource-\\uC124\\uC815\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Grafana Datasource \\uC124\\uC815\"]}),(0,e.jsx)(n.p,{children:\"\\uC774\\uC81C Loki\\uC5D0\\uC11C multi tenant\\uB97C \\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uD558\\uC600\\uACE0, Loki\\uC5D0\\uAC8C log data\\uB97C \\uC804\\uB2EC\\uD558\\uB294 OpenTelemetry Collector\\uC5D0\\uC11C Tenant \\uC815\\uBCF4\\uB97C \\uBCF4\\uB0B4\\uB3C4\\uB85D \\uC124\\uC815\\uD558\\uC600\\uB2E4. \\uC774\\uC81C \\uB85C\\uADF8 \\uB370\\uC774\\uD130\\uB97C Query \\uC694\\uCCAD\\uC744 \\uD558\\uB294 Grafana\\uC758 \\uC124\\uC815\\uB3C4 \\uBCC0\\uACBD\\uC774 \\uD544\\uC694\\uD558\\uB2E4.\"}),(0,e.jsxs)(n.p,{children:[\"Log data\\uB97C Push\\uD558\\uB294 \\uAC83 \\uBFD0\\uB9CC \\uC544\\uB2C8\\uB77C, Query \\uC694\\uCCAD\\uD560 \\uB54C\\uB3C4 \",(0,e.jsx)(n.code,{children:\"X-Scope-OrgID\"}),\" \\uD574\\uB354 \\uC815\\uBCF4\\uB97C \\uAC19\\uC774 \\uBCF4\\uB0B4\\uC57C \\uD55C\\uB2E4. \\uD574\\uB2F9 \\uAC12\\uC744 \\uBCF4\\uB0B4\\uC9C0 \\uC54A\\uC73C\\uBA74 Grafana\\uC5D0\\uC11C \\uB85C\\uADF8\\uB97C \\uAC80\\uC0C9\\uD558\\uB824\\uACE0 \\uD560 \\uB54C, \",(0,e.jsx)(n.code,{children:\"no org id\"}),\" \\uC5D0\\uB7EC \\uBA54\\uC138\\uC9C0\\uAC00 \\uB72C\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:\"Datasource\\uB97C \\uC815\\uC758\\uD560 \\uB54C, \\uC544\\uB798\\uC640 \\uAC19\\uC774 Header \\uAC12\\uC744 \\uC124\\uC815\\uD574\\uC11C \\uBCF4\\uB0B4\\uC8FC\\uBA74 \\uB41C\\uB2E4. \\uC5EC\\uAE30 \\uC608\\uC81C\\uC5D0\\uC11C\\uB294 \\uD2B9\\uC815 container\\uC774\\uB984\\uC73C\\uB85C\\uB9CC Query\\uB97C \\uD560 \\uC218 \\uC788\\uAC8C \\uD558\\uC600\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"datasources.yaml\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"datasources\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Loki\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"type\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` loki\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"isDefault\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"access\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` proxy\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"url\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" http\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"//loki\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"3100\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"basicAuth\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"secureJsonData\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"httpHeaderValue1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"containerName\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"jsonData\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"httpHeaderName1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"X-Scope-OrgID\"'}),`\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"loki-authentication\",children:[(0,e.jsx)(n.a,{href:\"#loki-authentication\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Loki Authentication\"]}),(0,e.jsxs)(n.p,{children:[\"Grafana datasource\\uC5D0 Loki\\uB97C \\uCD94\\uAC00\\uD558\\uACE0, tenant\\uB85C \\uBB36\\uC5EC \\uC788\\uB294 \\uB85C\\uADF8\\uB4E4\\uC744 \\uBD88\\uB7EC\\uC640\\uC11C \\uBCF4\\uC558\\uB2E4. \\uC774\\uB807\\uAC8C Datasource\\uB97C Helm chart\\uB85C \\uC815\\uC758\\uD574\\uC11C \\uBC30\\uD3EC\\uD588\\uC744 \\uB54C\\uB294 \\uC544\\uB798\\uCC98\\uB7FC UI\\uC5D0\\uC11C \\uC9C1\\uC811 \\uC218\\uC815\\uD560 \\uC218\\uAC00 \\uC5C6\\uB2E4. \\uB530\\uB77C\\uC11C \\uB2E4\\uB978 tenant\\uB97C \\uBCF4\\uB3C4\\uB85D \",(0,e.jsx)(n.code,{children:\"X-Scope-OrgID\"}),\"\\uB97C \\uC218\\uC815\\uD560 \\uC218\\uAC00 \\uC5C6\\uB2E4.\"]}),(0,e.jsx)(\"img\",{src:\"/static/images/loki-multi-tenant-grafana-datasource.png\",alt:\"datasource in grafana settings\"}),(0,e.jsx)(n.p,{children:\"\\uD558\\uC9C0\\uB9CC Grafana\\uC5D0\\uC11C datasource\\uB97C \\uC0C8\\uB86D\\uAC8C \\uB9CC\\uB4E4 \\uC218 \\uC788\\uB294 Admin \\uAD8C\\uD55C\\uC744 \\uAC00\\uC9C0\\uACE0 \\uC788\\uC73C\\uBA74, \\uC0C8\\uB85C\\uC6B4 Loki connection\\uC744 \\uCD94\\uAC00\\uD558\\uC5EC \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB2E4. Config\\uD30C\\uC77C\\uB85C \\uC815\\uC758\\uD55C Datasource\\uB85C\\uB9CC Log Query\\uB97C \\uD560 \\uC218 \\uC788\\uAC8C \\uC81C\\uD55C\\uD558\\uACE0 \\uC2F6\\uC73C\\uBA74 \\uC5B4\\uB5BB\\uAC8C \\uD574\\uC57C \\uD560\\uAE4C?\"}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://grafana.com/docs/loki/latest/operations/authentication/\",children:\"Loki\\uC758 \\uBB38\\uC11C\\uC5D0 \\uC778\\uC99D \\uAD00\\uB828 \\uC124\\uBA85\\uC774 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC788\\uB2E4.\"}),\" Loki\\uC5D0\\uC11C\\uB294 \\uC790\\uCCB4\\uC801\\uC73C\\uB85C \\uC778\\uC99D layer\\uB97C \\uB450\\uACE0 \\uC788\\uC9C0 \\uC54A\\uACE0, Helm chart\\uB85C \\uC124\\uCE58\\uD558\\uAC8C \\uB418\\uBA74 Nginx\\uAC00 gateway\\uB85C \\uC778\\uC99D \\uC5ED\\uD560\\uC744 \\uD574\\uC904 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"Grafana Loki does not come with any included authentication layer.\"})}),(0,e.jsxs)(n.p,{children:[\"Loki\\uB97C Helm chart\\uC744 \\uC774\\uC6A9\\uD574 Monolithic mode\\uB85C \\uBC30\\uD3EC\\uB97C \\uD558\\uBA74, \",(0,e.jsx)(n.code,{children:\"loki-gateway-\"}),\" prefix\\uB85C \\uC2DC\\uC791\\uD558\\uB294 pod\\uAC00 \\uC0DD\\uC131\\uB418\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. Pod\\uC758 \\uC815\\uBCF4\\uB97C \\uBCF4\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 nginx\\uAC00 \\uC124\\uC815\\uB418\\uC5B4 \\uC788\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. (\\uBCF4\\uC548\\uC744 \\uC704\\uD574\\uC11C privileged \\uAD8C\\uD55C\\uC774 \\uD544\\uC694\\uC5C6\\uB294 \",(0,e.jsx)(n.code,{children:\"nginx-unpriviledged\"}),\"\\uB97C \\uC0AC\\uC6A9\\uD558\\uACE0 \\uC788\\uB2E4.\\u{1F44D})\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Containers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"nginx\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Container ID\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"   containerd\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`//0bea78d416e7138fe1e6037b5bfc728191c3951a254d21b4f5a278c381708198\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Image\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"          docker.io/nginxinc/nginx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"unprivileged\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"1.24\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`alpine\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Image ID\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"       docker.io/nginxinc/nginx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"unprivileged@sha256\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`7bef7e4c99edc6b53e55396fd181288320cfc422c8e3d0beb588c715f7bdc1b0\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Port\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`           8080/TCP\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB9AC\\uACE0 \",(0,e.jsx)(n.code,{children:\"kubectl get configmap loki-gateway -o yaml\"}),\"\\uB97C \\uD655\\uC778\\uD574\\uBCF4\\uBA74 configmap\\uC5D0 nginx \\uC124\\uC815\\uAC12\\uC774 \\uC815\\uC758\\uB41C \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsxs)(n.p,{children:[\"\\uC774\\uC81C \\uC6B0\\uB9AC\\uB294 Loki Gateway\\uB97C \\uC0AC\\uC6A9\\uD574\\uC11C \\uC778\\uC99D\\uC744 \\uCD94\\uAC00\\uD558\\uACE0, \\uC778\\uC99D\\uC744 \\uD1B5\\uD574\\uC11C\\uB9CC Loki \\uD574\\uB2F9 tenant \\uAD00\\uB828 Log \\uB370\\uC774\\uD130\\uB97C \\uAC00\\uC838\\uC62C \\uC218 \\uC788\\uAC8C \\uD560 \\uC218 \\uC788\\uB2E4. \\uBA3C\\uC800 Loki Helm chart value\\uC5D0 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uCD94\\uAC00\\uD55C\\uB2E4. \",(0,e.jsx)(n.code,{children:\"tenants\"}),\"\\uC5D0 tenant\\uC774\\uB984\\uACFC password\\uB97C \\uC124\\uC815\\uD558\\uACE0, gateway\\uC5D0\\uC11C Basic Authentication\\uC744 \\uD558\\uB3C4\\uB85D \",(0,e.jsx)(n.code,{children:\"basicAuth\"}),\"\\uB97C enabled\\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"language-yaml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"global\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"dnsService\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"coredns\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"loki\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"auth_enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"tenants\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` \n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` containerName\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"password\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` somethingPassword\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"commonConfig\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"replication_factor\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"storage\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"type\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'filesystem'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"gateway\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"basicAuth\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"singleBinary\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"replicas\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uC774\\uB807\\uAC8C \\uC124\\uC815\\uD558\\uBA74 \",(0,e.jsx)(n.code,{children:\"loki-gateway\"}),\" ConfigMap data\\uAC00 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC124\\uC815\\uB41C\\uB2E4. \",(0,e.jsx)(n.code,{children:\"auth_basic_user_file\"}),\"\\uC774 \\uC124\\uC815\\uB418\\uC5B4\\uC11C Basic Authentication\\uC73C\\uB85C \\uC778\\uC99D\\uC744 \\uD558\\uAC8C \\uB418\\uACE0, \",(0,e.jsx)(n.code,{children:\"proxy_set_header X-Scope-OrgID $remote_user;\"}),\" \\uC790\\uB3D9\\uC73C\\uB85C Header\\uAC12\\uC5D0 Basic Authentication\\uC744 \\uD558\\uB294 user\\uBA85\\uC744 \\uB123\\uC5B4\\uC11C \\uBCF4\\uB0B4\\uAC8C \\uB41C\\uB2E4. \\uC6B0\\uB9AC\\uB294 \\uC704\\uC5D0\\uC11C \",(0,e.jsx)(n.code,{children:\"containerName\"}),\" username\\uACFC \",(0,e.jsx)(n.code,{children:\"somethingPassword\"}),\"\\uB85C password\\uB97C \\uC815\\uC758\\uD588\\uACE0, \\uADF8\\uAC83\\uC774 \",(0,e.jsx)(n.code,{children:\"/etc/nginx/secrets/.htpasswd \"}),\"\\uC5D0 \\uC124\\uC815\\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"nginx.conf: \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tworker_processes  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"## Default: 1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\terror_log  /dev/stderr\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tpid        /tmp/nginx.pid\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tworker_rlimit_nofile \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8192\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\tevents \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tworker_connections  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"4096\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"## Default: 1024\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\thttp \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tclient_body_temp_path /tmp/client_temp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tproxy_temp_path       /tmp/proxy_temp_path\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tfastcgi_temp_path     /tmp/fastcgi_temp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tuwsgi_temp_path       /tmp/uwsgi_temp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tscgi_temp_path        /tmp/scgi_temp\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tclient_max_body_size  4M\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tproxy_read_timeout    \",(0,e.jsx)(n.span,{className:\"token number\",children:\"600\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"## 10 minutes\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tproxy_send_timeout    \",(0,e.jsx)(n.span,{className:\"token number\",children:\"600\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tproxy_connect_timeout \",(0,e.jsx)(n.span,{className:\"token number\",children:\"600\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tproxy_http_version    \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1.1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tdefault_type application/octet-stream\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tlog_format   main \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'$remote_addr - $remote_user [$time_local]  $status '\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\t\t\",(0,e.jsx)(n.span,{className:\"token string\",children:`'\"$request\" $body_bytes_sent \"$http_referer\" '`}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\t\t\",(0,e.jsx)(n.span,{className:\"token string\",children:`'\"$http_user_agent\" \"$http_x_forwarded_for\"'`}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\taccess_log   /dev/stderr  main\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tsendfile     on\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\ttcp_nopush   on\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tresolver coredns.kube-system.svc.cluster.local.\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tproxy_set_header X-Scope-OrgID \",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$remote_user\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\tserver \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\tlisten             \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8080\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\tlisten             \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"::\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\":8080\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\tauth_basic           \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Loki\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\tauth_basic_user_file /etc/nginx/secrets/.htpasswd\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"..\"}),`.\\uC0DD\\uB7B5\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uC774\\uB807\\uAC8C \\uC778\\uC99D\\uC744 \\uCD94\\uAC00\\uD588\\uAE30 \\uB54C\\uBB38\\uC5D0 \",(0,e.jsx)(n.code,{children:\"http://loki-gateway\"}),\"\\uB97C \\uD1B5\\uD574\\uC11C \\uC811\\uC18D\\uD560 \\uB54C \\uC544\\uB798\\uCC98\\uB7FC \\uC778\\uC99D \\uAD00\\uB828 \\uC815\\uBCF4\\uB97C \\uB123\\uC5B4\\uC57C \\uD55C\\uB2E4.\"]}),(0,e.jsx)(\"img\",{src:\"/static/images/loki-multi-tenant-grafana-authentication.png\",alt:\"datasource authentication in grafana settings\"}),(0,e.jsx)(n.p,{children:\"\\uC774\\uC81C Network Policy\\uB85C Grafana\\uC5D0\\uC11C \\uC778\\uC99D\\uC774 \\uC5C6\\uB294 Loki Service\\uB85C \\uC811\\uADFC\\uD558\\uC9C0 \\uBABB\\uD558\\uB3C4\\uB85D \\uB9C9\\uACE0, Loki Gateway\\uB97C \\uD1B5\\uD574\\uC11C \\uC811\\uADFC\\uD558\\uB3C4\\uB85D \\uD55C\\uB2E4. \\uADF8\\uB7EC\\uBA74 \\uD574\\uB2F9 tenant\\uC758 \\uC778\\uC99D \\uC815\\uBCF4\\uB97C \\uC54C\\uC9C0\\uBABB\\uD558\\uBA74 \\uC5F0\\uACB0\\uD560 \\uC218\\uAC00 \\uC5C6\\uB2E4. \\uB530\\uB77C\\uC11C Grafana\\uC5D0\\uC11C Admin \\uAD8C\\uD55C\\uC774 \\uC788\\uB354\\uB77C\\uB3C4 \\uC0C8\\uB85C\\uC6B4 connection\\uC744 \\uCD94\\uAC00\\uD574\\uC11C \\uB2E4\\uB978 tenant\\uC758 log\\uC5D0 \\uC811\\uADFC\\uD558\\uB294 \\uAC83\\uC744 \\uB9C9\\uC744 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsxs)(n.h2,{id:\"\\uACB0\\uB860\",children:[(0,e.jsx)(n.a,{href:\"#\\uACB0\\uB860\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uACB0\\uB860\"]}),(0,e.jsx)(n.p,{children:\"Loki\\uB97C \\uD1B5\\uD574\\uC11C Log \\uB370\\uC774\\uD130\\uB97C \\uC218\\uC9D1\\uD558\\uACE0 Query\\uD560 \\uB54C, \\uC0AC\\uC6A9\\uC790\\uC5D0 \\uB530\\uB77C\\uC11C \\uC5B4\\uB5A4 \\uB85C\\uADF8\\uC5D0 \\uC811\\uADFC\\uD560 \\uC218 \\uC788\\uB294\\uC9C0 \\uC81C\\uD55C\\uD558\\uACE0 \\uC2F6\\uC5C8\\uB2E4. Grafana\\uC758 Label-based access control\\uB97C \\uD1B5\\uD574\\uC11C \\uADF8 \\uBAA9\\uC801\\uC744 \\uB2EC\\uC131\\uD560 \\uC218 \\uC788\\uC744 \\uAC83 \\uAC19\\uC558\\uC9C0\\uB9CC, \\uD574\\uB2F9 \\uAE30\\uB2A5\\uC740 Grafana Enterprise \\uBC84\\uC804\\uC5D0\\uC11C\\uB9CC \\uC81C\\uACF5\\uD55C\\uB2E4. \\uB530\\uB77C\\uC11C Loki\\uC758 multi tenant mode\\uB97C \\uD1B5\\uD574\\uC11C log group\\uB97C \\uBD84\\uB9AC\\uD558\\uACE0, Query\\uD560 \\uB54C \\uD574\\uB2F9 log group\\uB9CC \\uD560 \\uC218 \\uC788\\uB3C4\\uB85D \\uD558\\uC600\\uB2E4. \\uADF8\\uB9AC\\uACE0 Nginx\\uC5D0\\uC11C \\uC778\\uC99D\\uC744 \\uD558\\uC5EC \\uD574\\uB2F9 tenant\\uC758 log group\\uC5D0 \\uC811\\uADFC\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D \\uD558\\uC600\\uB2E4.\"})]})}}var f=b;return _;})();\n;return Component;","toc":[{"value":"Application Log를 분리","url":"#application-log를-분리","depth":2},{"value":"Loki Multi Tenant System","url":"#loki-multi-tenant-system","depth":2},{"value":"OpenTelmetry Loki Exporter 설정","url":"#opentelmetry-loki-exporter-설정","depth":2},{"value":"Grafana Datasource 설정","url":"#grafana-datasource-설정","depth":2},{"value":"Loki Authentication","url":"#loki-authentication","depth":2},{"value":"결론","url":"#결론","depth":2}],"frontMatter":{"readingTime":{"text":"9 min read","minutes":8.375,"time":502500,"words":1675},"slug":"20240420-loki-multi-tenants","fileName":"20240420-loki-multi-tenants.md","title":"Loki multi-tenants","date":"2024-04-20T00:00:00.000Z","tags":["kubernetes"],"images":["/static/images/social-banner.png"],"summary":"Loki로 Log를 수집하고, Grafana로 Log를 보여줄 때 Grafana user별로 볼 수 있는 Log를 제한하고 싶었다. Grafana Enterpirse의 경우에는 Label-based access control을 제공하여, Loki label별로 Query할 수 있는 권한을 제한할 수 있는 것처럼 보인다. 하지만 아쉽게 오픈소스에서는 해당 기능을 제공하지 않는다. 그래서 Loki multi tenant를 통해서 Log를 tenent별로 그룹핑하고, tenant별로 query하는 방법을 사용했다. 그리고 Loki는 인증 layer가 존재하지 않기 때문에 Nginx를 통해서 인증을 하여 query할 수 있도록 하였다. 마지막으로 Network Policy로 Nginx 인증을 통해서 Loki에 접근하도록 강제하여 원하는 구성을 할 수 있었다."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.15,"time":9000,"words":30},"slug":["default"],"fileName":"default.md","name":"Jay","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"책 \"다른 몸들을 위한 디자인\"을 읽고...","date":"2024-03-24T00:00:00.000Z","tags":["Book"],"images":["/static/images/social-banner.png"],"summary":"내가 일상 생활에서 장애를 직접 경험하지 않기 때문에 장애인이 경험하는 우리의 사회에 대해서 진지하게 고민할 기회가 많지 않았다. 봉사활동과 여러가지 프로젝트 참여를 통해서 장애인에 대한 여러가지 생각을 했지만, 내 삶에서 당장 중요한 문제가 아니다보니 일시적인 생각으로만 끝났다. 이 책을 읽으면서 느낀 점이나 생각들도 반복된 일상속에서 그냥 증발해버릴 것 같다는 생각이 들었다. 하지만 이러한 작은 관심과 생각들이 나의 무의식에 있던 사고들에 변화를 조금씩 가져오고, 그것이 쌓여서 나중에는 내가 무언가 사회에 조금이나마 영향을 미칠 수 있는 역할을 할 수 있지 않을까? 조금은 긍정적인 마음으로 독후감을 작성해보았다.","slug":"20240324-book-review-what-can-a-body-do"},"next":{"title":"Kubelet imageGC","date":"2024-04-20T00:00:00.000Z","tags":["kubernetes","ncloud"],"images":["/static/images/social-banner.png"],"summary":"사이즈가 큰 컨테이너 이미지를 내려받기 위해서 Containerd의 설정값 root을 새로운 스토리지를 추가한 경로로 수정하였다. Kubelet은 imageGCHighThresholdPercent로 설정된 임계치보다 disk 사용량이 많으면, 컨테이너 이미지를 정리하여 disk 공간을 확보하려고 한다. imageGCHighThresholdPercent이 기본값으로 85로 설정되어 있고, disk의 85 퍼센트 이상 사용했을 때 정리 프로세스가 실행된다. 문제는 Containerd root 경로의 volume이 거의 꽉 차더라도, 전체 volume의 사용량은 85 퍼센트가 되지 않을 수 있다는 것이다. Containerd root 경로의 volume에 여유가 없어서 새로 스케쥴된 Pod의 컨테이너 이미지를 내려 받지 못하는 문제가 발생할 수 있다. imageGCHighThresholdPercent 설정값을 조절하여 이 문제를 해결할 수 있다.","slug":"20240420-kubelet-imagegc"}},"__N_SSG":true}