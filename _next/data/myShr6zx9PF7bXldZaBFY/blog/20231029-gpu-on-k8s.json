{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var t=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var i=a=>l(a,\"__esModule\",{value:!0});var N=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),u=(a,s)=>{i(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let n of p(s))!m.call(a,n)&&n!==\"default\"&&l(a,n,{get:()=>s[n],enumerable:!(c=d(s,n))||c.enumerable});return a},g=a=>k(i(l(a!=null?t(h(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var r=N((D,o)=>{o.exports=_jsx_runtime});var f={};u(f,{default:()=>y,frontmatter:()=>b});var e=g(r()),b={title:\"Kubernetes\\uC5D0\\uC11C GPU \\uC0AC\\uC6A9\\uD558\\uAE30\",date:\"2023-10-29\",tags:[\"kubernetes\"],images:[\"/static/images/social-banner.png\"],summary:\"Pytorch\\uB97C \\uCEE8\\uD14C\\uC774\\uB108\\uB85C \\uB744\\uC6B0\\uACE0 GPU\\uB97C \\uC0AC\\uC6A9\\uD558\\uACE0 \\uC2F6\\uC5C8\\uB2E4. \\uB530\\uB77C\\uC11C Docker container\\uC5D0\\uC11C NVIDIA GPU\\uB97C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D \\uC14B\\uD305\\uC744 \\uD574\\uBCF4\\uC558\\uB2E4. \\uADF8\\uB9AC\\uACE0 \\uCD5C\\uC885\\uC801\\uC73C\\uB85C Kubernetes\\uC5D0\\uC11C GPU hardware\\uB97C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D nvidia device plugin\\uC744 DaemonSet\\uC73C\\uB85C \\uB744\\uC6B0\\uACE0 Pod\\uB97C \\uC2E4\\uD589\\uD574\\uBCF4\\uC558\\uB2E4.\"};function v(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",pre:\"pre\",code:\"code\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"container\\uC5D0\\uC11C-gpu-\\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D-\\uC124\\uC815\",children:[(0,e.jsx)(n.a,{href:\"#container\\uC5D0\\uC11C-gpu-\\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D-\\uC124\\uC815\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"container\\uC5D0\\uC11C GPU \\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D \\uC124\\uC815\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-20-04\",children:\"digialocean\"}),\"\\uC5D0\\uC11C \\uC124\\uBA85\\uB41C \\uBC29\\uBC95\\uC73C\\uB85C Docker\\uB97C Ubuntu20.04\\uC5D0 \\uC124\\uCE58\\uB97C \\uD558\\uC600\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"apt\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"install\"}),\" -y apt-transport-https ca-certificates \",(0,e.jsx)(n.span,{className:\"token function\",children:\"curl\"}),` software-properties-common\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"curl\"}),\" -fsSL https://download.docker.com/linux/ubuntu/gpg \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" apt-key \",(0,e.jsx)(n.span,{className:\"token function\",children:\"add\"}),` -\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" add-apt-repository \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"deb [arch=amd64] https://download.docker.com/linux/ubuntu focal stable\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"apt-cache\"}),` policy docker-ce\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"apt\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"install\"}),` -y docker-ce\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uC774\\uC81C gpus\\uB97C \\uC0AC\\uC6A9\\uD574\\uC11C docker container\\uB97C \\uC544\\uB798\\uCC98\\uB7FC \\uC2E4\\uD589\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" docker run -it --runtime\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"nvidia --gpus all python:3.9 \",(0,e.jsx)(n.span,{className:\"token function\",children:\"bash\"}),`\n`]})})}),(0,e.jsx)(n.p,{children:\"\\uD558\\uC9C0\\uB9CC \\uC544\\uB798\\uC640 \\uAC19\\uC740 \\uC5D0\\uB7EC \\uBA54\\uC138\\uC9C0\\uC640 \\uD568\\uAED8 nvidia\\uB85C \\uC124\\uC815\\uD558\\uC5EC \\uC2E4\\uD589\\uD560 \\uC218\\uAC00 \\uC5C6\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`docker: Error response from daemon: unknown or invalid runtime name: nvidia.\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"See \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'docker run --help'\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"Container\\uC5D0\\uC11C nvida driver\\uB97C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D \",(0,e.jsx)(n.a,{href:\"https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html\",children:\"nvidia-container-toolkit\"}),\"\\uC744 \\uC124\\uCE58\\uD574\\uC57C \\uD55C\\uB2E4. \\uBB38\\uC11C\\uC5D0 \\uB098\\uC628 \\uAC83\\uCC98\\uB7FC \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC124\\uCE58\\uB97C \\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"curl\"}),\" -fsSL https://nvidia.github.io/libnvidia-container/gpgkey \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"&&\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"curl\"}),\" -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token function\",children:\"sed\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'s#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g'\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"tee\"}),\" /etc/apt/sources.list.d/nvidia-container-toolkit.list \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"&&\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"apt-get\"}),` update\n`]})]})}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"apt-get\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"install\"}),` -y nvidia-container-toolkit\n`]})})}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" nvidia-ctk runtime configure --runtime\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`docker\n`]})})}),(0,e.jsxs)(n.p,{children:[\"docker config \\uD30C\\uC77C\\uC774 \\uC544\\uB798\\uCC98\\uB7FC \",(0,e.jsx)(n.code,{children:\"nvidia-container-runtime\"}),\"\\uC744 \\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uB41C \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"cat\"}),` /etc/docker/daemon.json\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"runtimes\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"nvidia\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"args\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"path\"'}),(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"nvidia-container-runtime\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uD574\\uB2F9 config\\uAC00 \\uC801\\uC6A9\\uB420 \\uC218 \\uC788\\uB3C4\\uB85D docker daemon\\uC744 \\uC7AC\\uC2DC\\uC791\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),` systemctl restart docker\n`]})})}),(0,e.jsx)(n.p,{children:\"\\uC774\\uC81C runtime option\\uC744 nvidia\\uB85C \\uC124\\uC815\\uC744 \\uD574\\uB3C4 \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uC2E4\\uD589\\uC774 \\uB420 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" docker run -it --runtime\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"nvidia --gpus all python:3.9 \",(0,e.jsx)(n.span,{className:\"token function\",children:\"bash\"}),`\n`]})})}),(0,e.jsxs)(n.h2,{id:\"pytorch-\\uC0AC\\uC6A9\\uD574\\uBCF4\\uAE30\",children:[(0,e.jsx)(n.a,{href:\"#pytorch-\\uC0AC\\uC6A9\\uD574\\uBCF4\\uAE30\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"pytorch \\uC0AC\\uC6A9\\uD574\\uBCF4\\uAE30\"]}),(0,e.jsxs)(n.p,{children:[\"\\uC774\\uC81C pytorch\\uB97C containerization\\uC744 \\uD574\\uC11C \\uC0AC\\uC6A9\\uD574\\uBCF8\\uB2E4. \\uBA3C\\uC800 \",(0,e.jsx)(n.code,{children:\"nvidia-smi\"}),\"\\uB85C CUDA version\\uC744 \\uD655\\uC778\\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`$ nvidia-smi\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`+-----------------------------------------------------------------------------+\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" NVIDIA-SMI \",(0,e.jsx)(n.span,{className:\"token number\",children:\"470.199\"}),\".02   Driver Version: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"470.199\"}),\".02   CUDA Version: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"11.4\"}),\"     \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`-------------------------------+----------------------+----------------------+\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" GPU  Name        Persistence-M\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" Bus-Id        Disp.A \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" Volatile Uncorr. ECC \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" Fan  Temp  Perf  Pwr:Usage/Cap\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"         Memory-Usage \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" GPU-Util  Compute M. \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"                               \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"                      \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"               MIG M. \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\"  Tesla T4            On   \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" 00000000:00:05.0 Off \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"                  Off \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" N/A   27C    P8     8W /  70W \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"      0MiB / 16127MiB \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"      \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\"%      Default \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"                               \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"                      \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"                  N/A \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`+-------------------------------+----------------------+----------------------+\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`+-----------------------------------------------------------------------------+\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" Processes:                                                                  \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"  GPU   GI   CI        PID   Type   Process name                  GPU Memory \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"        ID   ID                                                   Usage      \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\"  No running processes found                                                 \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`+-----------------------------------------------------------------------------+\n`})]})}),(0,e.jsxs)(n.p,{children:[\"\\uC704\\uC5D0\\uC11C\\uCC98\\uB7FC CUDA version\\uC774 \",(0,e.jsx)(n.code,{children:\"11.4\"}),\"\\uB77C\\uACE0 \\uD558\\uBA74, torch\\uB97C \",(0,e.jsx)(n.code,{children:\"11.4\"}),\"\\uB97C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D \\uC124\\uCE58\\uB97C \\uD55C\\uB2E4. \\uBA3C\\uC800 python 3.9 image\\uB85C container\\uB97C \\uC2E4\\uD589\\uD558\\uACE0,\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" docker run -it --runtime\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"nvidia --gpus all python:3.9 \",(0,e.jsx)(n.span,{className:\"token function\",children:\"bash\"}),`\n`]})})}),(0,e.jsx)(n.p,{children:\"\\uC6D0\\uD558\\uB294 \\uBC84\\uC804\\uC758 package\\uB4E4\\uC744 \\uC124\\uCE58\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pip \",(0,e.jsx)(n.span,{className:\"token function\",children:\"install\"}),\" \",(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"torch\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"1.12\"}),\".1+cu113 \",(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"torchvision\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0.13\"}),\".1+cu113 \",(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"torchaudio\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0.12\"}),`.1+cu113 -f https://download.pytorch.org/whl/torch_stable.html\n`]})})}),(0,e.jsxs)(n.p,{children:[\"\\uC774\\uC81C torch\\uAC00 \\uC124\\uCE58\\uAC00 \\uC644\\uB8CC\\uB418\\uBA74 python interpreter\\uB97C \\uC2E4\\uD589\\uD574\\uC11C torch\\uAC00 \\uC0AC\\uC6A9\\uD558\\uB294 CUDA version\\uC744 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uD655\\uC778\\uD55C\\uB2E4. \\uC544\\uB798\\uCC98\\uB7FC \",(0,e.jsx)(n.code,{children:\"11.3\"}),\" \\uAC12\\uC744 \\uB9AC\\uD134\\uD558\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\">>\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"import\"}),` torch\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\">>\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),` torch.version.cuda\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:\"'11.3'\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB9AC\\uACE0 cuda\\uB97C \\uC0AC\\uC6A9\\uAC00\\uB2A5\\uD55C\\uC9C0 \\uD655\\uC778\\uD574\\uBCF4\\uBA74 \",(0,e.jsx)(n.code,{children:\"True\"}),\"\\uAC00 \\uB9AC\\uD134\\uB418\\uB294 \\uAC83\\uC744 \\uD655\\uC778 \\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\">>\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\" torch.cuda.is_available\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`True\n`})]})}),(0,e.jsx)(n.p,{children:\"CUDA version\\uC774 \\uC0C1\\uC704 \\uBC84\\uC804\\uC774\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC740 \\uC5D0\\uB7EC \\uBA54\\uC138\\uC9C0\\uAC00 \\uBC1C\\uC0DD\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"import\"}),` torch\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\">>\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\" torch.cuda.is_available\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"/usr/local/lib/python3.9/site-packages/torch/cuda/__init__.py:138: UserWarning: CUDA initialization: The NVIDIA driver on your system is too old \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"found version \",(0,e.jsx)(n.span,{className:\"token number\",children:\"11040\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\". Please update your GPU driver by downloading and installing a new version from the URL: http://www.nvidia.com/Download/index.aspx Alternatively, go to: https://pytorch.org to \",(0,e.jsx)(n.span,{className:\"token function\",children:\"install\"}),\" a PyTorch version that has been compiled with your version of the CUDA driver. \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"Triggered internally at \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"..\"}),\"/c10/cuda/CUDAFunctions.cpp:108.\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"return\"}),\" torch._C._cuda_getDeviceCount\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`False\n`})]})}),(0,e.jsxs)(n.h2,{id:\"kubernetes\\uC5D0\\uC11C-torch-application\\uC744-\\uC2E4\\uD589\\uD558\\uAE30\",children:[(0,e.jsx)(n.a,{href:\"#kubernetes\\uC5D0\\uC11C-torch-application\\uC744-\\uC2E4\\uD589\\uD558\\uAE30\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Kubernetes\\uC5D0\\uC11C torch application\\uC744 \\uC2E4\\uD589\\uD558\\uAE30\"]}),(0,e.jsxs)(n.p,{children:[\"\\uC774\\uC81C kubernetes\\uC5D0\\uC11C pod\\uB85C container\\uAC00 \\uC2E4\\uD589\\uD560 \\uB54C kubelet\\uC774 GPU\\uB97C \\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uC744 \\uD574\\uC57C \\uD55C\\uB2E4. Kubernetes\\uC5D0\\uC11C\\uB294 \",(0,e.jsx)(n.a,{href:\"https://kubernetes.io/docs/concepts/extend-kubernetes/compute-storage-net/device-plugins/\",children:\"device plugin\"}),\"\\uB97C \\uC81C\\uACF5\\uD558\\uC5EC kubelet\\uC774 \\uD2B9\\uC815 device\\uB97C \\uC778\\uC9C0\\uD558\\uACE0 \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D \\uD55C\\uB2E4. \\uB530\\uB77C\\uC11C NVIDIA\\uC5D0\\uC11C \",(0,e.jsx)(n.a,{href:\"https://github.com/NVIDIA/k8s-device-plugin\",children:\"k8s-device-plugin\"}),\"\\uC744 \\uC81C\\uACF5\\uD55C\\uB2E4.\"]}),(0,e.jsxs)(n.p,{children:[\"device plugin\\uC744 DaemonSet object\\uB85C Host\\uC758 \",(0,e.jsx)(n.code,{children:\"/var/lib/kubelet/device-plugins\"}),\" \\uACBD\\uB85C\\uC5D0 mount\\uD558\\uC5EC \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB2E4. \\uC124\\uCE58\\uD558\\uB294 \",(0,e.jsx)(n.a,{href:\"https://raw.githubusercontent.com/NVIDIA/k8s-device-plugin/v0.14.1/nvidia-device-plugin.yml\",children:\"DaemonSet\\uC758 manifest \\uD30C\\uC77C\"}),\"\\uC744 \\uD655\\uC778\\uD558\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` apps/v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` DaemonSet\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" nvidia\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"device\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"plugin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`daemonset\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"namespace\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" kube\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`system\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"selector\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"matchLabels\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" nvidia\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"device\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"plugin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`ds\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"updateStrategy\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"type\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` RollingUpdate\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"template\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"labels\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" nvidia\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"device\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"plugin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`ds\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"tolerations\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` nvidia.com/gpu\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"operator\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Exists\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"effect\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` NoSchedule\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Mark this pod as a critical add-on; when enabled, the critical add-on\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# scheduler reserves resources for critical add-on pods so that they can\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# be rescheduled after a failure.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# See https://kubernetes.io/docs/tasks/administer-cluster/guaranteed-scheduling-critical-addon-pods/\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"priorityClassName\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'system-node-critical'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"containers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"image\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" nvcr.io/nvidia/k8s\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"device\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"plugin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`v0.14.1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" nvidia\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"device\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"plugin\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`ctr\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` FAIL_ON_INIT_ERROR\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'false'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"securityContext\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"allowPrivilegeEscalation\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"capabilities\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"drop\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'ALL'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"volumeMounts\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" device\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`plugin\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"mountPath\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" /var/lib/kubelet/device\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`plugins\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"volumes\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" device\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`plugin\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"hostPath\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"path\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" /var/lib/kubelet/device\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`plugins\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uD14C\\uC2A4\\uD2B8\\uD558\\uB294 kubernetes cluster\\uC758 container runtime\\uC774 \",(0,e.jsx)(n.code,{children:\"containerd\"}),\"\\uB85C \\uB418\\uC5B4 \\uC788\\uAE30 \\uB54C\\uBB38\\uC5D0, Docker \\uC608\\uC81C\\uC5D0\\uC11C \\uD55C\\uAC83\\uCC98\\uB7FC \",(0,e.jsx)(n.a,{href:\"https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html\",children:\"\\uBB38\\uC11C\"}),\"\\uB97C \\uB530\\uB77C\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC124\\uC815\\uC744 \\uD574\\uC900\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" nvidia-ctk runtime configure --runtime\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`containerd\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),` systemctl restart containerd\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uADF8\\uB9AC\\uACE0 \\uB9C8\\uC9C0\\uB9C9\\uC73C\\uB85C \\uD14C\\uC2A4\\uD2B8\\uB85C \\uD574\\uB2F9 Pod\\uB97C \\uB744\\uC6B0\\uBA74\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"cat\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<<\"}),(0,e.jsxs)(n.span,{className:\"token string\",children:[\"EOF\",(0,e.jsxs)(n.span,{className:\"token punctuation bash\",children:[\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" kubectl apply -f -\"]}),`\n`]})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`apiVersion: v1\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`kind: Pod\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`metadata:\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  name: gpu-pod\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`spec:\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  restartPolicy: Never\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  containers:\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    - name: cuda-container\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`      image: nvcr.io/nvidia/k8s/cuda-sample:vectoradd-cuda10.2\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`      resources:\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`        limits:\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`          nvidia.com/gpu: 1 # requesting 1 GPU\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  tolerations:\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  - key: nvidia.com/gpu\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    operator: Exists\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    effect: NoSchedule\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:\"EOF\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uC544\\uB798\\uCC98\\uB7FC \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uD14C\\uC2A4\\uD2B8\\uB97C \\uD1B5\\uACFC\\uD55C Pod \\uB85C\\uADF8\\uB97C \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`Test PASSED\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Done\n`})]})}),(0,e.jsx)(n.p,{children:\"\\uC774\\uC81C kubernetes\\uC5D0\\uC11C \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uC14B\\uD305\\uC774 \\uB418\\uC5C8\\uC73C\\uB2C8, GPU\\uB97C \\uC0AC\\uC6A9\\uD558\\uC5EC torch application\\uC744 \\uC2E4\\uD589\\uD560 \\uC218 \\uC788\\uB2E4. \\uADF8\\uB7F0\\uB370 \\uC5EC\\uAE30\\uC11C \\uC8FC\\uC758\\uD560 \\uAC83\\uC740 kubeblet\\uC774 GPU hardware\\uB97C \\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D container\\uC744 \\uC2E4\\uD589\\uD560 \\uB54C \\uC544\\uB798\\uC640 \\uAC19\\uC774 resource request/limit\\uC774 \\uC5C6\\uC73C\\uBA74 \\uAE30\\uBCF8\\uC73C\\uB85C CPU\\uB97C \\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D \\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-yml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"resources\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"limits\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"nvidia.com/gpu\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# requesting 1 GPU\"}),`\n`]})]})})]})}}var y=v;return f;})();\n;return Component;","toc":[{"value":"container에서 GPU 사용하도록 설정","url":"#container에서-gpu-사용하도록-설정","depth":2},{"value":"pytorch 사용해보기","url":"#pytorch-사용해보기","depth":2},{"value":"Kubernetes에서 torch application을 실행하기","url":"#kubernetes에서-torch-application을-실행하기","depth":2}],"frontMatter":{"readingTime":{"text":"7 min read","minutes":6.47,"time":388200,"words":1294},"slug":"20231029-gpu-on-k8s","fileName":"20231029-gpu-on-k8s.md","title":"Kubernetes에서 GPU 사용하기","date":"2023-10-29T00:00:00.000Z","tags":["kubernetes"],"images":["/static/images/social-banner.png"],"summary":"Pytorch를 컨테이너로 띄우고 GPU를 사용하고 싶었다. 따라서 Docker container에서 NVIDIA GPU를 사용할 수 있도록 셋팅을 해보았다. 그리고 최종적으로 Kubernetes에서 GPU hardware를 사용할 수 있도록 nvidia device plugin을 DaemonSet으로 띄우고 Pod를 실행해보았다."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.155,"time":9300,"words":31},"slug":["default"],"fileName":"default.md","name":"Jaemyun Lee","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"aws-ebs-csi-driver 코드로 csi driver 이해하기","date":"2023-10-21T00:00:00.000Z","tags":["kubernetes"],"images":["/static/images/social-banner.png"],"summary":"aws-ebs-csi-driver 소스코드를 보고 csi driver가 하는 역할을 이해해보았다. 크게 Controller plugin과 Node plugin으로 구성되어 있고, 다양한 sidecar container들이 존재한다. 이 sidecar container들이 Volume을 생성하고, 노드에 부착하고, Host 혹은 container directory에 mount하는 것을 진행한다. 이과정에서 CSI driver로 cloud vendor마다 다른 로직으로 그들의 volume을 제어하게 된다. 네이버 클라우드에서 storage가 처음 생성될 때 서버에 부착이 되어야만 하는 제약사항이 있어서, PVC로 PV 동적 할당을 할 때 volumeBindingMode이 Immediate이면 자동으로 Node에 부착이 된다.","slug":"20231021-csi-driver"},"next":{"title":"CVE 취약점 확인하고 Ubuntu Kernel Update 해보기","date":"2023-11-11T00:00:00.000Z","tags":["ubuntu","security"],"images":["/static/images/social-banner.png"],"summary":"OpenSCAP으로 Ubuntu20.04 이미지를 사용하는 가상서버의 취약점 리포트를 만들어보고, 보고된 취약점이 패치된 커널 버전으로 업그레이드 하여 해당 이슈를 해결해보았다. 이렇게 업그레이드 된 커널과 패키지들이 정상적으로 작동하는지 확인하고 사용할 수 있는 파이프라인을 만드는 것도 나중에 고민해봐야겠다.","slug":"20231111-update-ubuntu-kernel"}},"__N_SSG":true}