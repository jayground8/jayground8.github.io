{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var d=Object.create;var c=Object.defineProperty;var t=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty;var i=a=>c(a,\"__esModule\",{value:!0});var N=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),u=(a,s)=>{i(a);for(var l in s)c(a,l,{get:s[l],enumerable:!0})},k=(a,s,l)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let n of h(s))!p.call(a,n)&&n!==\"default\"&&c(a,n,{get:()=>s[n],enumerable:!(l=t(s,n))||l.enumerable});return a},b=a=>k(i(c(a!=null?d(m(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=N((C,r)=>{r.exports=_jsx_runtime});var G={};u(G,{default:()=>f,frontmatter:()=>g});var e=b(o()),g={title:\"Kubelet imageGC\",date:\"2024-04-20\",tags:[\"kubernetes\",\"ncloud\"],images:[\"/static/images/social-banner.png\"],summary:\"\\uC0AC\\uC774\\uC988\\uAC00 \\uD070 \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uB97C \\uB0B4\\uB824\\uBC1B\\uAE30 \\uC704\\uD574\\uC11C Containerd\\uC758 \\uC124\\uC815\\uAC12 root\\uC744 \\uC0C8\\uB85C\\uC6B4 \\uC2A4\\uD1A0\\uB9AC\\uC9C0\\uB97C \\uCD94\\uAC00\\uD55C \\uACBD\\uB85C\\uB85C \\uC218\\uC815\\uD558\\uC600\\uB2E4. Kubelet\\uC740 imageGCHighThresholdPercent\\uB85C \\uC124\\uC815\\uB41C \\uC784\\uACC4\\uCE58\\uBCF4\\uB2E4 disk \\uC0AC\\uC6A9\\uB7C9\\uC774 \\uB9CE\\uC73C\\uBA74, \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uB97C \\uC815\\uB9AC\\uD558\\uC5EC disk \\uACF5\\uAC04\\uC744 \\uD655\\uBCF4\\uD558\\uB824\\uACE0 \\uD55C\\uB2E4. imageGCHighThresholdPercent\\uC774 \\uAE30\\uBCF8\\uAC12\\uC73C\\uB85C 85\\uB85C \\uC124\\uC815\\uB418\\uC5B4 \\uC788\\uACE0, disk\\uC758 85 \\uD37C\\uC13C\\uD2B8 \\uC774\\uC0C1 \\uC0AC\\uC6A9\\uD588\\uC744 \\uB54C \\uC815\\uB9AC \\uD504\\uB85C\\uC138\\uC2A4\\uAC00 \\uC2E4\\uD589\\uB41C\\uB2E4. \\uBB38\\uC81C\\uB294 Containerd root \\uACBD\\uB85C\\uC758 volume\\uC774 \\uAC70\\uC758 \\uAF49 \\uCC28\\uB354\\uB77C\\uB3C4, \\uC804\\uCCB4 volume\\uC758 \\uC0AC\\uC6A9\\uB7C9\\uC740 85 \\uD37C\\uC13C\\uD2B8\\uAC00 \\uB418\\uC9C0 \\uC54A\\uC744 \\uC218 \\uC788\\uB2E4\\uB294 \\uAC83\\uC774\\uB2E4. Containerd root \\uACBD\\uB85C\\uC758 volume\\uC5D0 \\uC5EC\\uC720\\uAC00 \\uC5C6\\uC5B4\\uC11C \\uC0C8\\uB85C \\uC2A4\\uCF00\\uC974\\uB41C Pod\\uC758 \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uB97C \\uB0B4\\uB824 \\uBC1B\\uC9C0 \\uBABB\\uD558\\uB294 \\uBB38\\uC81C\\uAC00 \\uBC1C\\uC0DD\\uD560 \\uC218 \\uC788\\uB2E4. imageGCHighThresholdPercent \\uC124\\uC815\\uAC12\\uC744 \\uC870\\uC808\\uD558\\uC5EC \\uC774 \\uBB38\\uC81C\\uB97C \\uD574\\uACB0\\uD560 \\uC218 \\uC788\\uB2E4.\"};function v(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(l,{})})):l();function l(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",blockquote:\"blockquote\",code:\"code\",pre:\"pre\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"\\uD06C\\uAE30\\uAC00-\\uD070-\\uCEE8\\uD14C\\uC774\\uB108-\\uC774\\uBBF8\\uC9C0\\uB97C-\\uC0AC\\uC6A9\",children:[(0,e.jsx)(n.a,{href:\"#\\uD06C\\uAE30\\uAC00-\\uD070-\\uCEE8\\uD14C\\uC774\\uB108-\\uC774\\uBBF8\\uC9C0\\uB97C-\\uC0AC\\uC6A9\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uD06C\\uAE30\\uAC00 \\uD070 \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uB97C \\uC0AC\\uC6A9\"]}),(0,e.jsx)(n.p,{children:\"\\uB124\\uC774\\uBC84 \\uD074\\uB77C\\uC6B0\\uB4DC\\uC758 \\uCFE0\\uBC84\\uB124\\uD2F0\\uC2A4 \\uC6CC\\uCEE4 \\uB178\\uB4DC\\uC758 \\uC2A4\\uD1A0\\uB9AC\\uC9C0 \\uD06C\\uAE30\\uAC00 50GB\\uB85C \\uC124\\uC815\\uB418\\uC5B4 \\uC788\\uB2E4. \\uADF8\\uB807\\uAE30 \\uB54C\\uBB38\\uC5D0 10~20GB \\uD06C\\uAE30\\uC758 \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uB97C \\uC2E4\\uD589\\uD558\\uB824\\uBA74 \\uB514\\uC2A4\\uD06C \\uC6A9\\uB7C9\\uC774 \\uBD80\\uC871\\uD558\\uAC8C \\uB41C\\uB2E4. \\uC6A9\\uB7C9 \\uBD80\\uC871\\uC744 \\uD574\\uACB0\\uD558\\uAE30 \\uC704\\uD574\\uC11C \\uBE14\\uB85D \\uC2A4\\uD1A0\\uB9AC\\uC9C0\\uB97C \\uC6CC\\uCEE4\\uB178\\uB4DC\\uC5D0 \\uCD94\\uAC00 \\uC0DD\\uC131\\uD558\\uACE0, \\uC0C8\\uB85C \\uC0DD\\uC131\\uD55C \\uC2A4\\uD1A0\\uB9AC\\uC9C0\\uB97C \\uB9C8\\uC6B4\\uD305\\uD55C \\uACBD\\uB85C\\uC5D0 \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uB97C \\uC800\\uC7A5\\uD558\\uB3C4\\uB85D Containerd \\uC124\\uC815\\uD30C\\uC77C\\uC744 \\uC218\\uC815\\uD558\\uC5EC \\uD574\\uACB0\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://github.com/containerd/containerd/blob/main/docs/ops.md\",children:\"containerd\\uC758 \\uBB38\\uC11C\"}),\"\\uB97C \\uD655\\uC778\\uD558\\uBA74 root \\uACBD\\uB85C \\uC635\\uC158\\uC740 \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uB97C \\uC800\\uC7A5\\uD558\\uB294 \\uACBD\\uB85C\\uB85C \\uC0AC\\uC6A9\\uB418\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"root will be used to store any type of persistent data for containerd. Snapshots, content, metadata for containers and image, as well as any plugin data will be kept in this location.\"})}),(0,e.jsxs)(n.p,{children:[\"\\uC6CC\\uCEE4\\uB178\\uB4DC\\uC758 containerd\\uC758 \\uC124\\uC815\\uD30C\\uC77C root\\uC744 \\uCD94\\uAC00\\uD55C Volume\\uC758 \\uACBD\\uB85C\\uB85C \\uC218\\uC815\\uD558\\uACE0, \",(0,e.jsx)(n.code,{children:\"systemctl restart containerd\"}),\"\\uB85C \\uC7AC\\uC2DC\\uC791\\uD558\\uC5EC \\uC801\\uC6A9\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"/etc/containerd/config.toml\"})}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"version \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"root \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"{\\uCD94\\uAC00\\uD55C \\uACBD\\uB85C}\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"state \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"/run/containerd\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"oom_score \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"..\"}),`.\\uC0DD\\uB7B5\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uC774\\uC81C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uB97C pull \\uBC1B\\uC73C\\uBA74, \",(0,e.jsx)(n.code,{children:\"root\"}),\"\\uC5D0 \\uC124\\uC815\\uB41C \\uACBD\\uB85C\\uB85C \\uC0AC\\uC6A9\\uB41C \\uC6A9\\uB7C9\\uC774 \\uC99D\\uAC00\\uD558\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"ctr -n k8s.io image pull --user \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"ncloud access key\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\":\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"ncloud secret key\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"conatiner registry \\uC8FC\\uC18C\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})})}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"df\"}),` -h\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Filesystem      Size  Used Avail Use% Mounted on\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"/dev/xvdb        98G   37G   57G  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"40\"}),\"% \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"\\uCD94\\uAC00\\uD55C \\uACBD\\uB85C\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"kubelet\\uC758-\\uCEE8\\uD14C\\uC774\\uB108-\\uC774\\uBBF8\\uC9C0-\\uC815\\uB9AC\",children:[(0,e.jsx)(n.a,{href:\"#kubelet\\uC758-\\uCEE8\\uD14C\\uC774\\uB108-\\uC774\\uBBF8\\uC9C0-\\uC815\\uB9AC\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Kubelet\\uC758 \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0 \\uC815\\uB9AC\"]}),(0,e.jsxs)(n.p,{children:[\"\\uCFE0\\uBC84\\uB124\\uD2F0\\uC2A4\\uC5D0\\uC11C Kubelet\\uC740 disk \\uC0AC\\uC6A9\\uB7C9\\uC744 \\uCCB4\\uD06C\\uD558\\uC5EC \\uBD88\\uD544\\uC694\\uD55C \\uB370\\uC774\\uD130\\uB97C \\uC81C\\uAC70\\uD55C\\uB2E4. \\uADF8 \\uC911\\uC5D0 \",(0,e.jsx)(n.code,{children:\"image manager\"}),\"\\uB294 disk\\uB97C \\uD2B9\\uC815 \\uD37C\\uC13C\\uD2B8 \\uB9CC\\uD07C \\uC0AC\\uC6A9\\uD558\\uBA74, \\uC815\\uB9AC \\uAC00\\uB2A5\\uD55C \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uB97C \\uC815\\uB9AC\\uD558\\uC5EC disk \\uACF5\\uAC04\\uC744 \\uD655\\uBCF4\\uD558\\uAC8C \\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:\"Systemd\\uB85C \\uC2E4\\uD589\\uC911\\uC778 Kubelet process\\uC758 \\uC124\\uC815\\uD30C\\uC77C\\uC744 \\uD655\\uC778\\uD574\\uBCF4\\uBA74, \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uB418\\uC5B4 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ systemctl \",(0,e.jsx)(n.span,{className:\"token function\",children:\"cat\"}),` kubelet\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# /etc/systemd/system/kubelet.service\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"Unit\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"Description\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`Kubernetes Kubelet Server\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"Documentation\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`https://github.com/GoogleCloudPlatform/kubernetes\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"After\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`containerd.service\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"Wants\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`containerd.service\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"Service\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"EnvironmentFile\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`-/etc/kubernetes/kubelet.env\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"ExecStart\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"/usr/local/bin/kubelet \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$KUBE_LOGTOSTDERR\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$KUBE_LOG_LEVEL\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$KUBELET_API_SERVER\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$KUBELET_ADDRESS\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$KUBELET_PORT\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$KUBELET_HOSTNAME\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$KUBELET_ARGS\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$DOCKER_SOCKET\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$KUBELET_NETWORK_PLUGIN\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$KUBELET_VOLUME_PLUGIN\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"                \",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$KUBELET_CLOUDPROVIDER\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"Restart\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`always\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"RestartSec\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`10s\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"Install\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"WantedBy\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`multi-user.target\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB9AC\\uACE0 \",(0,e.jsx)(n.code,{children:\"/etc/kubernetes/kubelet.env\"}),\"\\uB97C \\uD655\\uC778\\uD574\\uBCF4\\uBA74, \",(0,e.jsx)(n.code,{children:\"/etc/kubernetes/kubelet-config.yaml\"}),\"\\uB97C \\uC124\\uC815\\uAC12\\uC73C\\uB85C \\uC0AC\\uC6A9\\uD558\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"/etc/kubernetes/kubelet.env\"})}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"..\"}),`.\\uC0DD\\uB7B5\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"KUBELET_ARGS\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:`\"--bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf \\\\\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`--config=/etc/kubernetes/kubelet-config.yaml \\\\\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`--cloud-provider=external \\\\\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`--provider-id='navercloudplatform://2767456' \\\\\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`--kubeconfig=/etc/kubernetes/kubelet.conf \\\\\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`--container-runtime-endpoint=unix:///var/run/containerd/containerd.sock \\\\\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`--runtime-cgroups=/system.slice/containerd.service \\\\\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`--node-labels=ncloud.com/nks-nodepool=example \\\\\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:' --register-with-taints=nvidia.com/gpu=:NoSchedule  \"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"KUBELET_VOLUME_PLUGIN\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"--volume-plugin-dir=/usr/libexec/kubernetes/kubelet-plugins/volume/exec\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"KUBELET_CLOUDPROVIDER\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:(0,e.jsx)(n.span,{className:\"token constant environment\",children:\"PATH\"})}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"/etc/kubernetes/kubelet-config.yaml\"}),\"\\uB294 \",(0,e.jsx)(n.code,{children:\"KubeletConfiguration\"}),\" kind\\uB85C Kubelet\\uC758 \\uC124\\uC815 parameter \\uAC12\\uB4E4\\uC744 \\uC815\\uC758\\uD558\\uACE0 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"/etc/kubernetes/kubelet-config.yaml\"})}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`apiVersion: kubelet.config.k8s.io/v1beta1\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`kind: KubeletConfiguration\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"nodeStatusUpdateFrequency: \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"10s\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`failSwapOn: True\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`authentication:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  anonymous:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    enabled: \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"false\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  x509:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    clientCAFile: /etc/kubernetes/ssl/ca.crt\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  webhook:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    enabled: \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`authorization:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  mode: Webhook\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`staticPodPath: /etc/kubernetes/manifests\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`cgroupDriver: systemd\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"containerLogMaxFiles: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`containerLogMaxSize: 10Mi\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"maxPods: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"110\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`address: \n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"readOnlyPort: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"healthzPort: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10248\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"healthzBindAddress: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"127.0\"}),`.0.1\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`kubeletCgroups: /system.slice/kubelet.service\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`clusterDomain: cluster.local\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"protectKernelDefaults: \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"rotateCertificates: \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`tlsCertFile: /etc/kubernetes/kubelet-server.crt\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`tlsPrivateKeyFile: /etc/kubernetes/kubelet-server.key\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`clusterDNS:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`evictionHard:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  memory.available: 100Mi\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  nodefs.available: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),`%\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  nodefs.inodesFree: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),`%\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  pid.available: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),`%\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`kubeReserved:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  cpu: 80m\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  memory: 2877Mi\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"resolvConf: \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"/run/systemd/resolve/resolv.conf\"'}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`featureGates:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  CSIVolumeHealth: \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`tlsCipherSuites:\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"eventRecordQPS: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"5\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`shutdownGracePeriod: 60s\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`shutdownGracePeriodCriticalPods: 20s\n`})]})}),(0,e.jsxs)(n.p,{children:[\"\\uC704\\uC5D0 \\uBA85\\uC2DC\\uC801\\uC73C\\uB85C \\uC815\\uC758\\uB418\\uC5B4 \\uC788\\uC9C0 \\uC54A\\uC9C0\\uB9CC, \\uC5B8\\uC81C \",(0,e.jsx)(n.code,{children:\"image manager\"}),\"\\uAC00 \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uB97C \\uC815\\uB9AC\\uD560\\uC9C0 \\uC815\\uD558\\uB294 \\uD30C\\uB77C\\uBBF8\\uD130 \\uAC12\\uC778 \",(0,e.jsx)(n.code,{children:\"imageGCHighThresholdPercent\"}),\"\\uC640 \",(0,e.jsx)(n.code,{children:\"imageGCLowThresholdPercent\"}),\"\\uC774 \\uC874\\uC7AC\\uD55C\\uB2E4. \\uB514\\uC2A4\\uD06C \\uC0AC\\uC6A9\\uB7C9\\uC774 \",(0,e.jsx)(n.code,{children:\"imageGCHighThresholdPercent\"}),\" \\uD37C\\uC13C\\uD2B8\\uBCF4\\uB2E4 \\uB192\\uC544\\uC9C0\\uBA74, \",(0,e.jsx)(n.code,{children:\"imageGCLowThresholdPercent\"}),\" \\uD37C\\uC13C\\uD2B8\\uAE4C\\uC9C0 \\uB514\\uC2A4\\uD06C \\uC0AC\\uC6A9\\uB7C9\\uC744 \\uC904\\uC774\\uAE30 \\uC704\\uD574\\uC11C \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uB97C \\uC815\\uB9AC\\uD558\\uB824\\uACE0 \\uD55C\\uB2E4. \\uD574\\uB2F9 \\uC124\\uC815\\uAC12\\uC740 default\\uB85C \\uAC01\\uAC01 85, 80\\uC73C\\uB85C \\uC124\\uC815\\uB418\\uC5B4 \\uC788\\uB2E4. \\uB530\\uB77C\\uC11C disk \\uC0AC\\uC6A9\\uB7C9\\uC774 85 \\uD37C\\uC13C\\uD2B8\\uB97C \\uB118\\uC5B4\\uAC00\\uBA74 \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uB97C \\uC815\\uB9AC\\uD558\\uC5EC disk \\uC0AC\\uC6A9\\uB7C9\\uC744 \\uC904\\uC774\\uB294 \\uC791\\uC5C5\\uC744 \\uD558\\uAC8C \\uB41C\\uB2E4.\"]}),(0,e.jsxs)(n.h2,{id:\"\\uCEE8\\uD14C\\uC774\\uB108-\\uC774\\uBBF8\\uC9C0\\uAC00-\\uC815\\uB9AC\\uB418\\uC9C0-\\uC54A\\uACE0-\\uAF49-\\uCC28\\uB294-\\uBB38\\uC81C\",children:[(0,e.jsx)(n.a,{href:\"#\\uCEE8\\uD14C\\uC774\\uB108-\\uC774\\uBBF8\\uC9C0\\uAC00-\\uC815\\uB9AC\\uB418\\uC9C0-\\uC54A\\uACE0-\\uAF49-\\uCC28\\uB294-\\uBB38\\uC81C\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uAC00 \\uC815\\uB9AC\\uB418\\uC9C0 \\uC54A\\uACE0 \\uAF49 \\uCC28\\uB294 \\uBB38\\uC81C\"]}),(0,e.jsxs)(n.p,{children:[\"\\uC704\\uC5D0\\uC11C containerd\\uC758 \\uC124\\uC815\\uAC12 \",(0,e.jsx)(n.code,{children:\"root\"}),\"\\uB97C \\uBCC0\\uACBD\\uD558\\uC5EC, \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uAC00 \\uD574\\uB2F9 volume\\uC5D0 \\uC800\\uC7A5\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uD558\\uC600\\uB2E4. \\uC608\\uB97C \\uB4E4\\uC5B4\\uC11C \\uCD94\\uAC00 \\uC2A4\\uD1A0\\uB9AC\\uC9C0\\uB97C 100GB\\uB85C \\uC124\\uC815\\uD588\\uB2E4\\uBA74, \\uCD5C\\uC885 disk \\uC6A9\\uB7C9\\uC740 150GB(\\uAE30\\uBCF8 50GB + \\uCD94\\uAC00 100GB)\\uAC00 \\uB41C\\uB2E4. \",(0,e.jsx)(n.code,{children:\"imageGCHighThresholdPercent\"}),\"\\uC758 \\uAE30\\uBCF8 \\uC124\\uC815\\uAC12 85 \\uD37C\\uC13C\\uD2B8\\uAC00 \\uB418\\uB824\\uBA74, 128GB\\uC774\\uC0C1\\uC744 \\uC0AC\\uC6A9\\uD574\\uC57C \\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:\"\\uBB38\\uC81C\\uB294 \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uB97C \\uC800\\uC7A5\\uD558\\uB294 root \\uACBD\\uB85C\\uC758 100GB \\uC6A9\\uB7C9\\uC774 \\uAC70\\uC758 \\uAF49 \\uCC28\\uB354\\uB77C\\uB3C4, \\uAE30\\uBCF8 50GB volume\\uC5D0 \\uC5EC\\uC720\\uAC00 \\uC788\\uC73C\\uBA74 \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uB97C \\uC815\\uB9AC\\uD558\\uB824\\uB294 \\uD504\\uB85C\\uC138\\uC2A4\\uAC00 trigger\\uB418\\uC9C0 \\uC54A\\uB294\\uB2E4. \\uC608\\uB97C \\uB4E4\\uC5B4\\uC11C \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uAC00 \\uACC4\\uC18D \\uC313\\uC5EC\\uC11C 100GB\\uC911\\uC5D0 95GB\\uB97C \\uC0AC\\uC6A9\\uD558\\uAC8C \\uB418\\uC5C8\\uC9C0\\uB9CC, \\uAE30\\uBCF8 volume 50GB\\uC911\\uC5D0 15GB\\uB9CC \\uC4F0\\uACE0 \\uC788\\uB2E4\\uBA74 \\uC804\\uCCB4 disk \\uC0AC\\uC6A9\\uB7C9\\uC740 \\uC57D 73 \\uD37C\\uC13C\\uD2B8\\uAC00 \\uB41C\\uB2E4. \\uADF8\\uB798\\uC11C disk \\uACF5\\uAC04\\uC774 \\uBD80\\uC871\\uD574\\uC11C Pod\\uAC00 \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uC2E4\\uD589\\uB420 \\uC218 \\uC5C6\\uB294 \\uBB38\\uC81C\\uB97C \\uBC1C\\uC0DD\\uD558\\uAC8C \\uB41C\\uB2E4.\"}),(0,e.jsxs)(n.p,{children:[\"\\uB530\\uB77C\\uC11C \\uC774\\uB7F0 \\uACBD\\uC6B0\\uC5D0 \",(0,e.jsx)(n.code,{children:\"/etc/kubernetes/kubelet-config.yaml\"}),\"\\uC5D0 \\uC124\\uC815\\uAC12\\uC744 \\uBA85\\uC2DC\\uC801\\uC73C\\uB85C \\uC124\\uC815\\uD558\\uC5EC \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uAC00 \\uC815\\uB9AC \\uB420 \\uC218 \\uC788\\uB3C4\\uB85D \\uC870\\uC815\\uC774 \\uD544\\uC694\\uD558\\uB2E4. \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC124\\uC815\\uD558\\uACE0, systemd \\uBA85\\uB839\\uC5B4\\uB85C kubelet service\\uB97C \\uC7AC\\uC2DC\\uC791\\uD55C\\uB2E4. \",(0,e.jsx)(n.code,{children:\"systemctl restart kubelet\"})]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"imageGCHighThresholdPercent: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"60\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"imageGCLowThresholdPercent: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"40\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uC774\\uC81C Kubelet \\uB85C\\uADF8\\uB97C \\uD655\\uC778\\uD558\\uBA74, \\uC784\\uACC4\\uCE58\\uB97C \\uB118\\uC5B4\\uC11C image\\uB97C \\uC815\\uB9AC\\uD558\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" journalctl -u kubelet.service -n \",(0,e.jsx)(n.span,{className:\"token number\",children:\"100\"}),`\n`]})})}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Disk usage on image filesystem is over the high threshold, trying to \",(0,e.jsx)(n.span,{className:\"token function\",children:\"free\"}),' bytes down to the low threshold\" ',(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"usage\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"93\"}),\" \",(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"highThreshold\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"60\"}),\" \",(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"amountToFree\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"55522593996\"}),\" \",(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"lowThreshold\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"40\"}),`\n`]})})}),(0,e.jsxs)(n.h2,{id:\"\\uACB0\\uB860\",children:[(0,e.jsx)(n.a,{href:\"#\\uACB0\\uB860\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uACB0\\uB860\"]}),(0,e.jsxs)(n.p,{children:[\"Container Image\\uB97C \\uCD5C\\uB300\\uD55C \\uC791\\uAC8C \\uAD6C\\uC131\\uD558\\uB294 \\uAC83\\uC774 Best Practice\\uC774\\uB2E4. \\uD558\\uC9C0\\uB9CC \\uC5B4\\uCA54 \\uC218 \\uC5C6\\uC774 10GB\\uAC00 \\uB118\\uB294 Container Image\\uB97C \\uB124\\uC774\\uBC84 \\uD074\\uB77C\\uC6B0\\uB4DC \\uCFE0\\uBC84\\uB124\\uD2F0\\uC2A4 \\uC11C\\uBE44\\uC2A4\\uC5D0\\uC11C \\uB744\\uC6B8\\uB824\\uACE0 \\uD560 \\uB54C, Disk \\uD06C\\uAE30\\uAC00 \\uBB38\\uC81C\\uAC00 \\uB420 \\uC218 \\uC788\\uB2E4. \\uAE30\\uBCF8 Block Storage 50GB\\uB9CC \\uC81C\\uACF5\\uD558\\uAE30 \\uB54C\\uBB38\\uC5D0 Kubelet\\uC5D0 \\uC9C0\\uC815\\uB41C Disk \\uCD5C\\uB300\\uCE58\\uB97C \\uB118\\uC5B4\\uAC00\\uC11C Pod\\uAC00 \\uC2A4\\uCF00\\uC974\\uB9C1\\uC774 \\uC548\\uB418\\uB294 \\uBB38\\uC81C\\uAC00 \\uBC1C\\uC0DD\\uD560 \\uC218 \\uC788\\uAC70\\uB098, Container Image\\uB97C \\uC815\\uC0C1\\uC801\\uC73C\\uB85C pull \\uBC1B\\uC744 \\uC218 \\uC5C6\\uC5B4\\uC11C \\uC7A5\\uC560\\uAC00 \\uBC1C\\uC0DD\\uD560 \\uC218 \\uC788\\uB2E4. \\uB530\\uB77C\\uC11C Containerd\\uC758 \\uC124\\uC815\\uAC12\\uC744 \\uBCC0\\uACBD\\uD558\\uC5EC Container Image\\uAC00 \\uC800\\uC7A5\\uB418\\uB294 \\uACBD\\uB85C\\uB97C \\uC0C8\\uB85C Mount\\uD55C Volume\\uC73C\\uB85C \\uC9C0\\uC815\\uD558\\uC5EC \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB2E4. \\uADF8\\uB9AC\\uACE0 Image manager\\uAC00 disk \\uACF5\\uAC04\\uC744 \\uC720\\uC9C0\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D \",(0,e.jsx)(n.code,{children:\"imageGCHighThresholdPercent\"}),\", \",(0,e.jsx)(n.code,{children:\"imageGCLowThresholdPercent\"}),\"\\uB97C \\uC870\\uC808\\uD560 \\uC218 \\uC788\\uB2E4.\"]})]})}}var f=v;return G;})();\n;return Component;","toc":[{"value":"크기가 큰 컨테이너 이미지를 사용","url":"#크기가-큰-컨테이너-이미지를-사용","depth":2},{"value":"Kubelet의 컨테이너 이미지 정리","url":"#kubelet의-컨테이너-이미지-정리","depth":2},{"value":"컨테이너 이미지가 정리되지 않고 꽉 차는 문제","url":"#컨테이너-이미지가-정리되지-않고-꽉-차는-문제","depth":2},{"value":"결론","url":"#결론","depth":2}],"frontMatter":{"readingTime":{"text":"5 min read","minutes":4.825,"time":289500,"words":965},"slug":"20240420-kubelet-imagegc","fileName":"20240420-kubelet-imagegc.md","title":"Kubelet imageGC","date":"2024-04-20T00:00:00.000Z","tags":["kubernetes","ncloud"],"images":["/static/images/social-banner.png"],"summary":"사이즈가 큰 컨테이너 이미지를 내려받기 위해서 Containerd의 설정값 root을 새로운 스토리지를 추가한 경로로 수정하였다. Kubelet은 imageGCHighThresholdPercent로 설정된 임계치보다 disk 사용량이 많으면, 컨테이너 이미지를 정리하여 disk 공간을 확보하려고 한다. imageGCHighThresholdPercent이 기본값으로 85로 설정되어 있고, disk의 85 퍼센트 이상 사용했을 때 정리 프로세스가 실행된다. 문제는 Containerd root 경로의 volume이 거의 꽉 차더라도, 전체 volume의 사용량은 85 퍼센트가 되지 않을 수 있다는 것이다. Containerd root 경로의 volume에 여유가 없어서 새로 스케쥴된 Pod의 컨테이너 이미지를 내려 받지 못하는 문제가 발생할 수 있다. imageGCHighThresholdPercent 설정값을 조절하여 이 문제를 해결할 수 있다."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.15,"time":9000,"words":30},"slug":["default"],"fileName":"default.md","name":"Jay","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"Loki multi-tenants","date":"2024-04-20T00:00:00.000Z","tags":["kubernetes"],"images":["/static/images/social-banner.png"],"summary":"Loki로 Log를 수집하고, Grafana로 Log를 보여줄 때 Grafana user별로 볼 수 있는 Log를 제한하고 싶었다. Grafana Enterpirse의 경우에는 Label-based access control을 제공하여, Loki label별로 Query할 수 있는 권한을 제한할 수 있는 것처럼 보인다. 하지만 아쉽게 오픈소스에서는 해당 기능을 제공하지 않는다. 그래서 Loki multi tenant를 통해서 Log를 tenent별로 그룹핑하고, tenant별로 query하는 방법을 사용했다. 그리고 Loki는 인증 layer가 존재하지 않기 때문에 Nginx를 통해서 인증을 하여 query할 수 있도록 하였다. 마지막으로 Network Policy로 Nginx 인증을 통해서 Loki에 접근하도록 강제하여 원하는 구성을 할 수 있었다.","slug":"20240420-loki-multi-tenants"},"next":null},"__N_SSG":true}