{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var r=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var o=a=>l(a,\"__esModule\",{value:!0});var m=(a,c)=>()=>(c||a((c={exports:{}}).exports,c),c.exports),N=(a,c)=>{o(a);for(var s in c)l(a,s,{get:c[s],enumerable:!0})},k=(a,c,s)=>{if(c&&typeof c==\"object\"||typeof c==\"function\")for(let e of p(c))!u.call(a,e)&&e!==\"default\"&&l(a,e,{get:()=>c[e],enumerable:!(s=d(c,e))||s.enumerable});return a},g=a=>k(o(l(a!=null?r(h(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var i=m((C,t)=>{t.exports=_jsx_runtime});var y={};N(y,{default:()=>w,frontmatter:()=>f});var n=g(i()),f={title:\"Calico kube-controller \\uC774\\uD574\\uD558\\uAE30\",date:\"2023-07-22\",tags:[\"kubernetes\",\"calico\"],summary:\"Calico\\uC5D0\\uC11C \\uC5B4\\uB5BB\\uAC8C CRD\\uB97C \\uD65C\\uC6A9\\uD558\\uB294\\uC9C0 \\uC774\\uD574\\uD558\\uAE30 \\uC704\\uD574\\uC11C Calico Opensource \\uBC84\\uC804\\uC758 \\uAE43\\uD5D9 \\uC18C\\uC2A4\\uCF54\\uB4DC\\uB97C \\uC0B4\\uD3B4\\uBCF4\\uAC8C \\uB418\\uC5C8\\uB2E4. Calico archiecture\\uC5D0\\uC11C kube-controller \\uBD80\\uBD84\\uC774 \\uC5B4\\uB5A4 \\uC5ED\\uD560\\uC744 \\uD558\\uB294\\uC9C0 \\uC18C\\uC2A4 \\uCF54\\uB4DC\\uB97C \\uD1B5\\uD574\\uC11C \\uC774\\uD574\\uD560 \\uC218 \\uC788\\uAC8C \\uB418\\uC5C8\\uB2E4. kube-controller\\uB4E4\\uC740 kubernetes native resource\\uC5D0 \\uB300\\uD55C \\uBCC0\\uACBD\\uC744 calico data source\\uC640 sync\\uD574\\uC8FC\\uB294 \\uC5ED\\uD560\\uC744 \\uD558\\uACE0 \\uC788\\uC5C8\\uB2E4. \\uADF8\\uB7F0\\uB370 projectcalico.org custom resource\\uB4E4\\uC744 \\uC0DD\\uC131/\\uBCC0\\uACBD\\uD560 \\uB54C\\uB294 calico system\\uC5D0\\uC11C \\uC5B4\\uB5BB\\uAC8C detect\\uB97C \\uD558\\uACE0 business logic\\uC744 \\uC218\\uD589\\uD558\\uB294\\uC9C0\\uB294 \\uC774\\uD574\\uD560 \\uC218\\uAC00 \\uC5C6\\uC5C8\\uB2E4.\"};function b(a={}){let{wrapper:c}=a.components||{};return c?(0,n.jsx)(c,Object.assign({},a,{children:(0,n.jsx)(s,{})})):s();function s(){let e=Object.assign({p:\"p\",code:\"code\",a:\"a\",h2:\"h2\",span:\"span\",pre:\"pre\",ul:\"ul\",li:\"li\",h3:\"h3\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.p,{children:[\"\\uC774\\uC804\\uC5D0 \",(0,n.jsx)(e.code,{children:\"kubebuilder\"}),\"\\uB97C \\uD1B5\\uD574\\uC11C \",(0,n.jsx)(e.code,{children:\"Programming Kubernetes\"}),\"\\uC5D0\\uC11C \\uC124\\uBA85\\uD55C \",(0,n.jsx)(e.a,{href:\"https://jayground8.github.io/blog/20230715-k8s-controller\",children:\"At resource\\uB97C watch\\uD558\\uB294 Custom controller\\uB97C \\uC9C1\\uC811 \\uC791\\uC131\"}),\"\\uD588\\uB2E4. \\uADF8\\uB2E4\\uC74C\\uC5D0\\uB294 ifkakao(2022) \",(0,n.jsx)(e.code,{children:\"Testing Kubernetes Controller\"}),\" \\uBC1C\\uD45C\\uC5D0\\uC11C \\uC0AC\\uC6A9\\uB41C \",(0,n.jsx)(e.a,{href:\"https://jayground8.github.io/blog/20230716-if-kakao-2022-k8s-controller\",children:\"example\\uC778 BlueGreen resource\\uC5D0 \\uB300\\uD55C Custom controller\\uB97C kubebuilder\\uB85C \\uC791\\uC131\"}),\"\\uD588\\uB2E4. \\uC774\\uBC88\\uC5D0\\uB294 Calico\\uC5D0\\uC11C \\uC5B4\\uB5BB\\uAC8C CRD\\uC640 Custom contoller\\uB97C \\uD65C\\uC6A9\\uD558\\uACE0 \\uC788\\uB294\\uC9C0 \",(0,n.jsx)(e.a,{href:\"https://github.com/projectcalico/calico\",children:\"Source code\"}),\"\\uB97C \\uD655\\uC778\\uD574\\uBD24\\uB2E4. (\\uC774 \\uAE00\\uC744 \\uC791\\uC131\\uD558\\uB294 \\uC2DC\\uC810\\uC5D0\\uB294 Calico OpenSource Version 3.26\\uC744 \\uD655\\uC778\\uD558\\uC600\\uB2E4.)\"]}),(0,n.jsxs)(e.h2,{id:\"calico-kube-controllers\",children:[(0,n.jsx)(e.a,{href:\"#calico-kube-controllers\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Calico kube-controllers\"]}),(0,n.jsxs)(e.p,{children:[\"source code\\uB97C \\uBCF4\\uBA74 \",(0,n.jsx)(e.code,{children:\"kube-controllers\"}),\" \\uB514\\uB809\\uD130\\uB9AC \\uC548\\uC5D0 \\uC544\\uB798\\uCC98\\uB7FC controller \\uCF54\\uB4DC\\uAC00 \\uC788\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token builtin class-name\",children:\".\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u251C\\u2500\\u2500 controller\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u2514\\u2500\\u2500 controller.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u251C\\u2500\\u2500 flannelmigration\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 config.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 config_test.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 flannel_migration_fv_test.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 flannelmigration_suite_test.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 ipam_migrator.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 k8s_resources.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 migration_controller.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u2514\\u2500\\u2500 network_migrator.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u251C\\u2500\\u2500 namespace\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 namespace_controller.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 namespace_controller_fv_test.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u2514\\u2500\\u2500 namespace_suite_test.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u251C\\u2500\\u2500 networkpolicy\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 policy_controller.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 policy_controller_fv_test.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u2514\\u2500\\u2500 policy_suite_test.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u251C\\u2500\\u2500 node\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 auto_hep_fv_test.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 controller.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 errors.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 etcd_ipam_gc_fv_test.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 fake_client.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 hostendpoints.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 ipam.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 ipam_allocation.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 ipam_test.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 kdd_ipam_gc_fv_test.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 labels.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 metrics_fv_test.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 node_controller_fv_test.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 node_deleter.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 node_suite_test.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 pool_manager.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u2514\\u2500\\u2500 syncer.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u251C\\u2500\\u2500 pod\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 pod_controller.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u251C\\u2500\\u2500 pod_controller_fv_test.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2502   \\u2514\\u2500\\u2500 pod_suite_test.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2514\\u2500\\u2500 serviceaccount\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    \\u251C\\u2500\\u2500 serviceaccount_controller.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    \\u251C\\u2500\\u2500 serviceaccount_controller_fv_test.go\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    \\u2514\\u2500\\u2500 serviceaccount_suite_test.go\n`})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"Makefile\"}),\"\\uB97C \\uD655\\uC778\\uD574\\uBCF4\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 build\\uD658\\uACBD\\uC744 \\uAC16\\uCD98 Container Image\\uB97C \\uD1B5\\uD574\\uC11C compile\\uC744 \\uD558\\uAC8C \\uB41C\\uB2E4. (\\uAE30\\uD0C0 arguments \\uC0DD\\uB7B5)\"]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"code-highlight language-bash\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`go build -o bin/kube-controllers-linux-amd64 ./cmd/kube-controllers/\n`})})}),(0,n.jsxs)(e.p,{children:[\"build\\uD558\\uB294 \",(0,n.jsx)(e.code,{children:\"/cmd/kube-controllers\"}),\"\\uC758 \",(0,n.jsx)(e.code,{children:\"main.go\"}),\"\\uB97C \\uD655\\uC778\\uD574\\uBCF4\\uBA74, \",(0,n.jsx)(e.code,{children:\"controllerControl\"}),\"\\uC774\\uB77C\\uB294 struct type\\uC5D0 Controller instance\\uB4E4\\uC744 \\uC800\\uC7A5\\uD558\\uAC8C \\uB41C\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"language-go code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"controllerCtrl \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"controllerControl\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"         ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tcontrollers\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"make\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"map\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\"controller\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Controller\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tstop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"        stop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tinformers\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"   \",(0,n.jsx)(e.span,{className:\"token function\",children:\"make\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\"cache\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"SharedIndexInformer\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"InitControllers\"}),\" method\\uB97C \\uD655\\uC778\\uD558\\uBA74 \\uC124\\uC815\\uAC12\\uC5D0 \\uB530\\uB77C\\uC11C \",(0,n.jsx)(e.code,{children:\"Pod\"}),\", \",(0,n.jsx)(e.code,{children:\"Namespace\"}),\", \",(0,n.jsx)(e.code,{children:\"NetworkPolicy\"}),\", \",(0,n.jsx)(e.code,{children:\"Node\"}),\", \",(0,n.jsx)(e.code,{children:\"ServiceAccount\"}),\"\\uC5D0 \\uAD00\\uB828\\uB41C controller\\uB97C \\uC124\\uC815\\uD558\\uAC8C \\uB41C\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsx)(e.code,{className:\"language-go code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"controllerCtrl\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"InitControllers\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" runCfg\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" k8sClientset\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" calicoClient\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})})}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"language-go code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" cfg\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Controllers\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"WorkloadEndpoint \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  podController \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" pod\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NewPodController\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"...\"}),\"\\uC0DD\\uB7B5\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  cc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"controllers\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Pod\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),` podController\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  cc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"registerInformers\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"podInformer\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" cfg\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Controllers\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Namespace \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  namespaceController \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" namespace\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NewNamespaceController\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"...\"}),\"\\uC0DD\\uB7B5\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  cc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"controllers\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Namespace\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),` namespaceController\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"...\"}),`\\uC0DD\\uB7B5\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.a,{href:\"https://docs.tigera.io/calico/latest/reference/kube-controllers/configuration#the-calicokube-controllers-container\",children:\"kube-controller\\uC5D0 \\uB300\\uD55C \\uC124\\uC815\\uAC12\\uC744 \\uBB38\\uC11C\"}),\"\\uB97C \\uD655\\uC778\\uD574\\uBCF4\\uBA74 calico datasource\\uB85C Kubernetes\\uC758 etcd\\uB97C \\uACF5\\uC720\\uD574\\uC11C \\uC0AC\\uC6A9\\uD558\\uACE0 \\uC2F6\\uC73C\\uBA74 \\uD658\\uACBD \\uBCC0\\uC218 \",(0,n.jsx)(e.code,{children:\"DATASTORE_TYPE\"}),\" \\uAC12\\uC744 \",(0,n.jsx)(e.code,{children:\"kubernetes\"}),\"\\uB85C \\uC124\\uC815\\uD574\\uC918\\uC57C \\uD55C\\uB2E4. \\uADF8\\uB9AC\\uACE0 \",(0,n.jsx)(e.code,{children:\"node\"}),\"\\uC5D0 \\uAD00\\uD55C \",(0,n.jsx)(e.code,{children:\"kube-controller\"}),\"\\uB97C enable\\uD558\\uAE30 \\uC704\\uD574\\uC11C \",(0,n.jsx)(e.code,{children:\"ENABLED_CONTROLLERS\"}),\"\\uD658\\uACBD\\uBCC0\\uC218\\uB97C \",(0,n.jsx)(e.code,{children:\"node\"}),\"\\uB85C \\uC124\\uC815\\uD574\\uC57C \\uD55C\\uB2E4. \\uB098\\uBA38\\uC9C0 controller\\uB294 default\\uB85C enable\\uB418\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uC0AC\\uC6A9\\uD558\\uC9C0 \\uC54A\\uACE0 \\uC2F6\\uC744 \\uB54C\\uB9CC \\uBA85\\uC2DC\\uC801\\uC73C\\uB85C \\uD658\\uACBD\\uBCC0\\uC218\\uB85C disable \\uC2DC\\uCF1C\\uC918\\uC57C \\uD55C\\uB2E4.\"]}),(0,n.jsxs)(e.p,{children:[\"\\uB098\\uB294 Minikube\\uC5D0\\uC11C Addon\\uC73C\\uB85C Calico\\uB97C \\uCD94\\uAC00\\uD574\\uC11C Kubernetes cluster\\uB97C \\uC0AC\\uC6A9\\uD558\\uACE0 \\uC788\\uB2E4. \\uADF8\\uB798\\uC11C \",(0,n.jsx)(e.code,{children:\"calico-kube-controllers\"}),\"\\uC758 \\uD658\\uACBD\\uBCC0\\uC218 \\uC124\\uC815\\uAC12\\uC744 \\uD655\\uC778\\uD558\\uB2C8 \\uC544\\uB798\\uCC98\\uB7FC \\uC124\\uC815\\uB41C \\uAC83\\uC744 \\uD655\\uC778 \\uD560 \\uC218 \\uC788\\uC5C8\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"code-highlight language-bash\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`kubectl describe deployments calico-kube-controllers -n kube-system\n`})})}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`Environment:\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`  ENABLED_CONTROLLERS:  node\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`  DATASTORE_TYPE:       kubernetes\n`})]})}),(0,n.jsxs)(e.p,{children:[\"\\uADF8\\uB2E4\\uC74C\\uC5D0 \",(0,n.jsx)(e.code,{children:\"main.go\"}),\"\\uC5D0\\uC11C \\uCD5C\\uC885\\uC801\\uC73C\\uB85C \",(0,n.jsx)(e.code,{children:\"RunController\"}),\" method\\uB97C \\uD638\\uCD9C\\uD558\\uACE0, goroutine\\uC73C\\uB85C \",(0,n.jsx)(e.code,{children:\"controllerControl\"}),\" struct\\uC5D0 \\uCD94\\uAC00\\uD588\\uB358 \",(0,n.jsx)(e.code,{children:\"informer\"}),\"\\uC640 \",(0,n.jsx)(e.code,{children:\"controller\"}),\"\\uB4E4\\uC758 Run method\\uB97C \\uD638\\uCD9C\\uD574\\uC900\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"language-go code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"cc \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"controllerControl\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"RunControllers\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"_\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" inf \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"range\"}),\" cc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"informers \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tlog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"WithField\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"informer\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" inf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Info\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Starting informer\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"go\"}),\" inf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Run\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"cc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"stop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" controllerType\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" c \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"range\"}),\" cc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"controllers \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tlog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"WithField\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"ControllerType\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" controllerType\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Info\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Starting controller\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"go\"}),\" c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Run\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"cc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"stop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"select\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<-\"}),\"cc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Done\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tlog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Warn\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"context cancelled\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<-\"}),\"cc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"restart\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tlog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Warn\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"configuration changed; restarting\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"close\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"cc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"stop\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"c.Run(cc.stop)\"}),\"\\uC740 \\uC544\\uB798\\uCC98\\uB7FC work process\\uB97C groutine\\uC73C\\uB85C \\uC2E4\\uD589\\uD558\\uAC8C \\uB418\\uACE0, workqueue\\uC5D0 item\\uC774 \\uCD94\\uAC00\\uB420\\uB54C\\uAE4C\\uC9C0 \\uAE30\\uB2E4\\uB9AC\\uAC8C \\uB418\\uB294 \\uBB34\\uD55C loop\\uC73C\\uB85C \\uB3CC\\uC544\\uAC04\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"language-go code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<\"}),\" c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"cfg\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"NumberOfWorkers\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" i\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"++\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"go\"}),\" c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"runWorker\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"...\"}),`\\uC0DD\\uB7B5\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"c \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"namespaceController\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"runWorker\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"for\"}),\" c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"processNextItem\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"c \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"namespaceController\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"processNextItem\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"bool\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tworkqueue \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"resourceCache\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"GetQueue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"...\"}),` \\uC0DD\\uB7B5\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  workqueue\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Done\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"key\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\uAC01\\uAC01\\uC758 contoller\\uAC00 \\uD558\\uB294 \\uC77C\\uC740 \",(0,n.jsx)(e.a,{href:\"https://docs.tigera.io/calico/latest/reference/kube-controllers/configuration#the-calicokube-controllers-container\",children:\"\\uBB38\\uC11C\\uC5D0\\uC11C \\uC544\\uB798\\uCC98\\uB7FC \\uCE5C\\uC808\\uD558\\uAC8C \\uC124\\uBA85\\uB418\\uC5B4 \\uC788\\uB2E4\"}),\".\"]}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:\"policy controller: watches Kubernetes network policies in the Kubernetes API, and syncs the policies to the datastore (etcd) as Calico network policies. Felix implements network policies in the dataplane.\"}),(0,n.jsx)(e.li,{children:\"namespace controller: watches namespaces and programs Calico profiles.\"}),(0,n.jsx)(e.li,{children:\"serviceaccount controller: watches service accounts and programs Calico profiles.\"}),(0,n.jsx)(e.li,{children:\"workloadendpoint controller: watches for changes to pod labels and updates Calico workload endpoints.\"}),(0,n.jsx)(e.li,{children:\"node controller: watches for the removal of Kubernetes nodes and removes corresponding data from Calico, and optionally watches for node updates to create and sync host endpoints for each node.\"})]}),(0,n.jsxs)(e.p,{children:[\"\\uC774\\uC81C controller\\uC758 \\uCF54\\uB4DC\\uB97C \\uD655\\uC778\\uD574\\uBCF8\\uB2E4. \\uC774\\uC804\\uC5D0\\uB294 kubebuilder\\uB85C bootstrap\\uC744 \\uD574\\uC11C \\uC791\\uC131\\uC744 \\uD588\\uC5C8\\uB2E4. calico\\uC5D0\\uC11C\\uB294 kubebuilder\\uB97C \\uC4F0\\uB294 \\uAC83\\uC774 \\uC544\\uB2C8\\uAE30 \\uB54C\\uBB38\\uC5D0, \",(0,n.jsx)(e.a,{href:\"https://github.com/kubernetes/code-generator\",children:\"kubernetes code-generator\"}),\"\\uB97C \\uD65C\\uC6A9\\uD558\\uC5EC custom controller\\uB97C \\uC791\\uC131\\uD558\\uB294 \\uBC29\\uBC95\\uC744 \\uCC38\\uC870\\uD558\\uC5EC \\uCF54\\uB4DC\\uB97C \\uC774\\uD574\\uD588\\uB2E4.\"]}),(0,n.jsxs)(e.h3,{id:\"pod-controller\",children:[(0,n.jsx)(e.a,{href:\"#pod-controller\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"pod controller\"]}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"workloadendpoint controller\"}),\"\\uB294 Pod informer\\uB97C \\uC0AC\\uC6A9\\uD558\\uACE0 \\uC788\\uB2E4. \",(0,n.jsx)(e.code,{children:\"informer factory\"}),\"\\uB97C \\uD1B5\\uD574\\uC11C worker\\uB4E4\\uC774 \\uACF5\\uC720\\uD574\\uC11C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB294 \",(0,n.jsx)(e.code,{children:\"informer\"}),\"\\uB97C \\uC0DD\\uC131\\uD55C\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"language-go code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"factory \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" informers\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NewSharedInformerFactory\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"k8sClientset\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"podInformer \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" factory\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Core\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"V1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Pods\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Informer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"controller\"}),\"\\uC5D0\\uC11C\\uB294 \\uC778\\uC790\\uB85C \\uC804\\uB2EC\\uB41C informer\\uC5D0 \\uC774\\uC81C \",(0,n.jsx)(e.code,{children:\"ADD\"}),\", \",(0,n.jsx)(e.code,{children:\"UPDATE\"}),\", \",(0,n.jsx)(e.code,{children:\"DELETE\"}),\" event\\uB97C \\uCC98\\uB9AC\\uD560 event handler\\uB97C \\uCD94\\uAC00\\uD558\\uAC8C \\uB41C\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"language-go code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"_\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" informer\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"AddEventHandler\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"cache\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ResourceEventHandlerFuncs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tAddFunc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"obj \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"interface\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    UpdateFunc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"oldObj \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"interface\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" newObj \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"interface\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    DeleteFunc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"obj \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"interface\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"Informer\\uB294 cache\\uB97C \\uD1B5\\uD574\\uC11C \\uB9E4\\uBC88 API server\\uC5D0 \\uC694\\uCCAD\\uD560 \\uD544\\uC694\\uAC00 \\uC5C6\\uACE0, polling \\uB300\\uC2E0\\uC5D0 watch\\uB85C resource\\uC5D0 \\uB300\\uD55C \\uBCC0\\uD654 Event\\uC5D0 \\uC791\\uB3D9\\uB420 \\uC218 \\uC788\\uB294 Interface\\uB97C \\uC81C\\uACF5\\uD55C\\uB2E4. Controller\\uC5D0\\uC11C\\uB294 \\uC815\\uC758\\uB41C Informer\\uC5D0 event\\uC5D0 \\uB530\\uB77C \\uC2E4\\uD589\\uD560 \\uB85C\\uC9C1\\uC744 event handler\\uB97C \\uB4F1\\uB85D\\uD558\\uC5EC \\uCD94\\uAC00\\uD558\\uAC8C \\uB41C\\uB2E4. \\uC774\\uB807\\uAC8C \",(0,n.jsx)(e.code,{children:\"podInformer\"}),\"\\uB85C Pod object\\uAC00 \\uBCC0\\uD654\\uB420 \\uB54C\\uB9C8\\uB2E4 calico data source\\uC640 sync\\uB97C \\uB9DE\\uCDB0\\uC900\\uB2E4.\"]}),(0,n.jsx)(e.p,{children:\"calico custom resource\\uC5D0 \\uB300\\uD55C Interface\\uC81C\\uACF5\\uD558\\uB294 clientsets\\uC740 \\uC544\\uB798\\uCC98\\uB7FC WorkloadEndpoints\\uB97C \\uCC98\\uC74C \\uAC00\\uC838\\uC640\\uC11C cache\\uC5D0 \\uB2F4\\uB294\\uB370 \\uC0AC\\uC6A9\\uD55C\\uB2E4.\"}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsx)(e.code,{className:\"language-go code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"workloadEndpoints\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"WorkloadEndpoints\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"List\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" options\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ListOptions\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})})}),(0,n.jsxs)(e.h3,{id:\"networkpolicy-controller\",children:[(0,n.jsx)(e.a,{href:\"#networkpolicy-controller\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"networkpolicy controller\"]}),(0,n.jsxs)(e.p,{children:[\"Pod resource\\uC5D0 \\uB300\\uD55C informer\\uB294 \",(0,n.jsx)(e.code,{children:\"NewSharedInformerFactory\"}),\"\\uC744 \\uD1B5\\uD574\\uC11C \\uC774\\uC81C \\uC5EC\\uB7EC worker\\uC774 \\uACF5\\uC720\\uD574\\uC11C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D \\uD588\\uB294\\uB370, networkpolicy controller\\uC5D0\\uC11C\\uB294 \\uC544\\uB798\\uCC98\\uB7FC informer\\uB97C \\uC0DD\\uC131\\uD558\\uACE0 \\uC788\\uB2E4. \\uC774\\uB807\\uAC8C \\uD55C \\uC774\\uC720\\uB294 pod informer\\uC758 \\uACBD\\uC6B0\\uC5D0\\uB294 node controller\\uC640 pod controller\\uAC00 \\uB458\\uB2E4 \\uC0AC\\uC6A9\\uD558\\uACE0 \\uC788\\uAE30 \\uB54C\\uBB38\\uC774\\uACE0, networkpolicy resource\\uC5D0 \\uB300\\uD574\\uC11C\\uB294 \\uC5EC\\uB7EC worker\\uAC00 \\uC0AC\\uC6A9\\uD558\\uC9C0 \\uC54A\\uC73C\\uB2C8\\uAE50 \\uC774\\uB807\\uAC8C \\uC0DD\\uC131\\uD55C \\uAC83\\uC77C\\uAE4C? \\uADF8\\uB807\\uB2E4\\uBA74 node informer\\uB294 node controller\\uC5D0\\uC11C \\uBC16\\uC5D0 \\uC0AC\\uC6A9\\uD558\\uC9C0 \\uC54A\\uB294\\uB370, \\uC65C \",(0,n.jsx)(e.code,{children:\"NewSharedInformerFactory\"}),\"\\uB97C \\uC0AC\\uC6A9\\uD588\\uC744\\uAE4C?\"]}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"language-go code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"listWatcher \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" cache\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NewListWatchFromClient\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  clientset\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NetworkingV1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"RESTClient\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"networkpolicies\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  fields\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Everything\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token boolean\",children:\"_\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" informer \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" cache\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NewIndexerInformer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"listWatcher\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"networkingv1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"NetworkPolicy\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" cache\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ResourceEventHandlerFuncs\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tAddFunc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"obj \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"interface\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    UpdateFunc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"oldObj \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"interface\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" newObj \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"interface\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    DeleteFunc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"obj \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"interface\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" cache\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Indexers\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"pod Controller\"}),\"\\uC640 \\uB3D9\\uC77C\\uD558\\uAC8C Kubernetes NetworkPolicy resource\\uAC00 \",(0,n.jsx)(e.code,{children:\"ADD\"}),\", \",(0,n.jsx)(e.code,{children:\"UPDATE\"}),\", \",(0,n.jsx)(e.code,{children:\"DELETE\"}),\"\\uB418\\uC5C8\\uC744 \\uB54C, calico datastore\\uB97C \\uC5C5\\uB370\\uC774\\uD2B8 \\uD574\\uC8FC\\uB294 \\uC5ED\\uD560\\uC744 \\uD55C\\uB2E4. \\uADF8\\uB9AC\\uACE0 \\uC544\\uB798\\uCC98\\uB7FC calico clientsets\\uC73C\\uB85C \",(0,n.jsx)(e.code,{children:\"projectcalico.org\"}),\" Group \",(0,n.jsx)(e.code,{children:\"v3\"}),\" Version \",(0,n.jsx)(e.code,{children:\"NetworkPolicy\"}),\" Kind\\uB97C \\uAC00\\uC838\\uC624\\uACE0 \\uC788\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsx)(e.code,{className:\"language-go code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"calicoPolicies\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" c\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NetworkPolicies\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"List\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" options\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ListOptions\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})})}),(0,n.jsxs)(e.h3,{id:\"calico-crd\\uC640-\\uC5F0\\uACB0\\uC810\\uC740-\\uC5B4\\uB5BB\\uAC8C-\\uB418\\uB294\\uAC70\\uC9C0\",children:[(0,n.jsx)(e.a,{href:\"#calico-crd\\uC640-\\uC5F0\\uACB0\\uC810\\uC740-\\uC5B4\\uB5BB\\uAC8C-\\uB418\\uB294\\uAC70\\uC9C0\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Calico CRD\\uC640 \\uC5F0\\uACB0\\uC810\\uC740 \\uC5B4\\uB5BB\\uAC8C \\uB418\\uB294\\uAC70\\uC9C0?\"]}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.a,{href:\"https://github.com/programming-kubernetes/cnat/blob/master/cnat-client-go/main.go\",children:\"code-generator\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 At custom controller\\uC758 \\uC18C\\uC2A4 \\uCF54\\uB4DC\"}),\"\\uB97C \\uBCF4\\uBA74 \\uC544\\uB798\\uCC98\\uB7FC custom resource\\uC5D0 \\uB300\\uD574\\uC11C code-generator\\uB85C \\uC0DD\\uC131\\uB41C informer\\uB97C \\uC0AC\\uC6A9\\uD558\\uACE0 \\uC788\\uB2E4. At resource\\uAC00 \\uBCC0\\uACBD\\uB420 \\uB54C, Event\\uC5D0 \\uB530\\uB77C\\uC11C \\uB85C\\uC9C1\\uC744 \\uC218\\uD589\\uD558\\uAC8C \\uB41C\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"language-go code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"informers \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"github.com/programming-kubernetes/cnat/cnat-client-go/pkg/generated/informers/externalversions\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"...\"}),`\\uC0DD\\uB7B5\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"cnatInformerFactory \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" informers\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NewSharedInformerFactory\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"cnatClient\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" time\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Minute\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"10\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"Calico\"}),\"\\uB97C Addon\\uC73C\\uB85C \\uCD94\\uAC00\\uD55C Minikube\\uC5D0\\uC11C \",(0,n.jsx)(e.code,{children:\"kubectl get crds\"}),\"\\uB97C \\uC2E4\\uD589\\uD558\\uBA74 \\uC544\\uB798\\uCC98\\uB7FC \",(0,n.jsx)(e.code,{children:\"crd\"}),\"\\uAC00 \\uC788\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. \",(0,n.jsx)(e.code,{children:\"pod controller\"}),\", \",(0,n.jsx)(e.code,{children:\"network policy contoller\"}),\", \",(0,n.jsx)(e.code,{children:\"service account controller\"}),\"\\uB97C \\uBCF4\\uBA74, kubernetest\\uC758 native resource\\uAC00 \\uBCC0\\uD654\\uD560 \\uB54C informer\\uB97C \\uD1B5\\uD574\\uC11C calico data source\\uB97C sync\\uD558\\uACE0 \\uC788\\uB2E4. \\uADF8\\uB7F0\\uB370 \\uC544\\uB798\\uC758 CRD\\uC758 custom resource\\uAC00 \\uBCC0\\uACBD\\uB418\\uB294 \\uAC70\\uC5D0 \\uB300\\uD574\\uC11C \\uB85C\\uC9C1\\uC744 \\uC218\\uD589\\uD558\\uB294 \\uCF54\\uB4DC\\uB294 controller\\uC5D0 \\uC5C6\\uB2E4. \\uADF8\\uB7FC \\uADF8\\uBD80\\uBD84\\uC740 \\uC5B4\\uB514\\uC11C \\uB2F4\\uB2F9\\uD558\\uACE0 \\uC788\\uB294 \\uAC83\\uC77C\\uAE4C?\"]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`NAME                                                  CREATED AT\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"bgpconfigurations.crd.projectcalico.org               \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2023\"}),`-07-03T07:55:54Z\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"bgppeers.crd.projectcalico.org                        \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2023\"}),`-07-03T07:55:54Z\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"blockaffinities.crd.projectcalico.org                 \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2023\"}),`-07-03T07:55:54Z\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"caliconodestatuses.crd.projectcalico.org              \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2023\"}),`-07-03T07:55:54Z\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"clusterinformations.crd.projectcalico.org             \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2023\"}),`-07-03T07:55:54Z\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"felixconfigurations.crd.projectcalico.org             \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2023\"}),`-07-03T07:55:54Z\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"globalnetworkpolicies.crd.projectcalico.org           \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2023\"}),`-07-03T07:55:55Z\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"globalnetworksets.crd.projectcalico.org               \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2023\"}),`-07-03T07:55:55Z\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"hostendpoints.crd.projectcalico.org                   \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2023\"}),`-07-03T07:55:55Z\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"ipamblocks.crd.projectcalico.org                      \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2023\"}),`-07-03T07:55:55Z\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"ipamconfigs.crd.projectcalico.org                     \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2023\"}),`-07-03T07:55:55Z\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"ipamhandles.crd.projectcalico.org                     \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2023\"}),`-07-03T07:55:55Z\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"ippools.crd.projectcalico.org                         \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2023\"}),`-07-03T07:55:55Z\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"ipreservations.crd.projectcalico.org                  \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2023\"}),`-07-03T07:55:55Z\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"kubecontrollersconfigurations.crd.projectcalico.org   \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2023\"}),`-07-03T07:55:55Z\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"networkpolicies.crd.projectcalico.org                 \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2023\"}),`-07-03T07:55:55Z\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`networksets.crd.projectcalico.org\n`})]})}),(0,n.jsx)(e.p,{children:\"calicoctl\\uC744 \\uD1B5\\uD574\\uC11C custom resource\\uB97C \\uC0DD\\uC131\\uD574\\uBCF8\\uB2E4. (calicoctl\\uC744 \\uD1B5\\uD574\\uC11C calico\\uC5D0\\uC11C \\uD544\\uC694\\uD55C validation\\uACFC defaulting\\uC744 \\uC218\\uD589\\uD55C\\uB2E4. \\uADF8\\uB7F0\\uB370 calico apiserver\\uB97C \\uC124\\uCE58\\uD558\\uBA74 calicoctl\\uC5C6\\uC774 \\uADF8\\uB0E5 kubectl\\uC744 \\uC774\\uC6A9\\uD574\\uC11C \\uD560 \\uC218 \\uC788\\uB2E4.)\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"calicoctl create -f - \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"<<\"}),(0,n.jsx)(e.span,{className:\"token string\",children:`EOF\n`})]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`apiVersion: projectcalico.org/v3\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`kind: NetworkPolicy\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`metadata:\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`  name: allow-busybox-egress\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`  namespace: advanced-policy-demo\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`spec:\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`  selector: run == 'access'\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`  types:\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`  - Egress\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`  egress:\n`})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsx)(e.span,{className:\"token string\",children:`  - action: Allow\n`})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token string\",children:\"EOF\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"kubectl api-resources\"}),\"\\uB85C \\uD655\\uC778\\uD574\\uBCF4\\uBA74 NetworkPolicy\\uB85C \\uB3D9\\uC77C\\uD55C KIND\\uC778\\uB370 Group\\uACFC Version\\uC774 \\uB2E4\\uB978 \\uAC83\\uC774 \\uBCF4\\uC778\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`NAME                              SHORTNAMES   APIVERSION                             NAMESPACED   KIND\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"networkpolicies                                crd.projectcalico.org/v1               \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),`         NetworkPolicy\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"networkpolicies                   netpol       networking.k8s.io/v1                   \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),`         NetworkPolicy\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"kubectl get networkpolicy -A\"}),\"\\uB97C \\uD558\\uAC8C \\uB418\\uBA74, networking.k8s.io/v1\\uC758 NetworkPolicy\\uB9CC \\uBCF4\\uC5EC\\uC8FC\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uC544\\uB798\\uCC98\\uB7FC Group\\uACFC Version\\uC744 \\uBA85\\uC2DC\\uD574\\uC11C resource\\uB97C \\uAC00\\uC838\\uC654\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"code-highlight language-bash\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`kubectl get networkpolicy.v1.crd.projectcalico.org\n`})})}),(0,n.jsx)(e.p,{children:\"\\uC774\\uB807\\uAC8C Custom Resource\\uB97C \\uC0DD\\uC131\\uD588\\uC73C\\uBA74 \\uC774\\uAC83\\uC774 Calico\\uC758 data source\\uC640 sync\\uAC00 \\uB418\\uACE0, \\uADF8 \\uB370\\uC774\\uD130\\uB97C \\uD1B5\\uD574\\uC11C Felix\\uAC00 iptables rule\\uC774\\uB098 eBPF\\uB85C \\uD574\\uB2F9 \\uB0B4\\uC6A9\\uC744 \\uC801\\uC6A9\\uD560 \\uAC83\\uC774\\uB2E4. \\uADF8\\uB7F0\\uB370 Calico system\\uC5D0\\uC11C custom resource\\uAC00 \\uC0DD\\uC131\\uB418\\uACE0\\uB098 \\uBCC0\\uACBD\\uB41C \\uAC83\\uC744 \\uD0D0\\uC9C0\\uD574\\uC11C \\uADF8\\uAC83\\uC5D0 \\uB530\\uB77C\\uC11C \\uB85C\\uC9C1\\uC744 \\uC218\\uD589\\uD558\\uB294 \\uBD80\\uBD84\\uC740 \\uC5B4\\uB514\\uC5D0\\uC11C \\uCC3E\\uC744 \\uC218 \\uC788\\uB294\\uAC70\\uC9C0? \\u{1F914} \\uC774\\uAC83\\uC5D0 \\uB300\\uD55C \\uC2E4\\uB9C8\\uB9AC\\uAC00 \\uC548 \\uCC3E\\uC544\\uC838\\uC11C Calico Community Slack channel\\uC5D0 \\uB4E4\\uC5B4\\uAC00\\uC11C \\uC9C8\\uBB38\\uC744 \\uB0A8\\uACBC\\uB2E4.\"})]})}}var w=b;return y;})();\n;return Component;","toc":[{"value":"Calico kube-controllers","url":"#calico-kube-controllers","depth":2},{"value":"pod controller","url":"#pod-controller","depth":3},{"value":"networkpolicy controller","url":"#networkpolicy-controller","depth":3},{"value":"Calico CRD   ?","url":"#calico-crd---","depth":3}],"frontMatter":{"readingTime":{"text":"9 min read","minutes":8.49,"time":509400,"words":1698},"slug":"20230722-calico-kube-controller","fileName":"20230722-calico-kube-controller.md","title":"Calico kube-controller ","date":"2023-07-22T00:00:00.000Z","tags":["kubernetes","calico"],"summary":"Calico  CRD    Calico Opensource     . Calico archiecture kube-controller           . kube-controller kubernetes native resource   calico data source sync   .  projectcalico.org custom resource /  calico system  detect  business logic    ."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.155,"time":9300,"words":31},"slug":["default"],"fileName":"default.md","name":"Jaemyun Lee","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"   <>, <>","date":"2023-07-17T00:00:00.000Z","tags":["book"],"summary":"      <> .        <>  . <> 2014     ,          . , ,  ,                 .     PM .","slug":"20230717-book-review-indistractable-hooked"},"next":null},"__N_SSG":true}