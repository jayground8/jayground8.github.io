{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var o=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var i=n=>l(n,\"__esModule\",{value:!0});var g=(n,s)=>()=>(s||n((s={exports:{}}).exports,s),s.exports),N=(n,s)=>{i(n);for(var c in s)l(n,c,{get:s[c],enumerable:!0})},u=(n,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let a of p(s))!m.call(n,a)&&a!==\"default\"&&l(n,a,{get:()=>s[a],enumerable:!(c=d(s,a))||c.enumerable});return n},k=n=>u(i(l(n!=null?o(h(n)):{},\"default\",n&&n.__esModule&&\"default\"in n?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n);var t=g((D,r)=>{r.exports=_jsx_runtime});var C={};N(C,{default:()=>f,frontmatter:()=>y});var e=k(t()),y={title:\"Argo CD Notification\\uC73C\\uB85C \\uAC04\\uB2E8\\uD558\\uAC8C Slack \\uC54C\\uB9BC \\uBCF4\\uB0B4\\uAE30\",date:\"2023-12-14\",tags:[\"Kubernetes\",\"ArgoCD\"],images:[\"/static/images/social-banner.png\"],summary:\"Argo CD Notification\\uAC00 \\uC774\\uBBF8 \\uC788\\uC5B4\\uC11C \\uC27D\\uAC8C Slack \\uC54C\\uB9BC\\uC744 \\uC5F0\\uB3D9\\uD560 \\uC218 \\uC788\\uB2E4. \\uBA54\\uB274\\uC5BC\\uC5D0\\uC11C \\uCE5C\\uC808\\uD558\\uAC8C \\uC14B\\uD305 \\uBC29\\uBC95\\uC744 \\uC124\\uBA85\\uD558\\uACE0 \\uC788\\uC9C0\\uB9CC, \\uCC98\\uC74C \\uBCF4\\uACE0 \\uC14B\\uD305\\uD560 \\uB54C \\uB193\\uCE60 \\uC218 \\uC788\\uB294 \\uBD80\\uBD84\\uC744 \\uAE30\\uB85D\\uC73C\\uB85C \\uB0A8\\uAE34\\uB2E4.\"};function b(n={}){let{wrapper:s}=n.components||{};return s?(0,e.jsx)(s,Object.assign({},n,{children:(0,e.jsx)(c,{})})):c();function c(){let a=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",code:\"code\",pre:\"pre\"},n.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(a.h2,{id:\"20240515-updated\",children:[(0,e.jsx)(a.a,{href:\"#20240515-updated\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(a.span,{className:\"icon icon-link\"})}),\"2024.05.15 Updated\"]}),(0,e.jsxs)(a.p,{children:[(0,e.jsx)(a.a,{href:\"https://github.com/argoproj-labs/argocd-notifications?tab=readme-ov-file\",children:\"Argo CD Notification\"}),\"\\uD504\\uB85C\\uC81D\\uD2B8\\uAC00 \",(0,e.jsx)(a.code,{children:\"ArgoCD\"}),\"\\uC5D0 merge\\uB418\\uC5C8\\uB2E4. \\uB530\\uB77C\\uC11C ArgoCD\\uB97C \\uC124\\uCE58\\uD558\\uBA74 Notification Controller\\uAC00 \\uAC19\\uC774 \\uC2E4\\uD589\\uB41C\\uB2E4. cli\\uB3C4 \\uC544\\uAC19\\uC774 \\uD1B5\\uD569\\uB418\\uC5C8\\uB2E4. \\uB530\\uB77C\\uC11C template\\uC744 \\uD1B5\\uD574\\uC11C Slack message\\uB97C \\uBCF4\\uB0BC \\uB54C, \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC2E4\\uD589\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(a.pre,{className:\"language-bash\",children:(0,e.jsxs)(a.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"argocd admin notifications \",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"template notify app-deployed-custom \",(0,e.jsx)(a.span,{className:\"token variable\",children:\"${argocd_app_name}\"}),\" \",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"--recipient slack:\",(0,e.jsx)(a.span,{className:\"token variable\",children:\"${channel_name}\"}),`\n`]})]})}),(0,e.jsxs)(a.p,{children:[(0,e.jsx)(a.a,{href:\"https://argocd-image-updater.readthedocs.io/en/stable/\",children:\"ArgoCD Image Updater\"}),\"\\uB97C \\uD1B5\\uD574\\uC11C Container Repository\\uC5D0 \\uC0C8\\uB85C\\uC6B4 Image\\uAC00 \\uCD94\\uAC00\\uB418\\uC5C8\\uC744 \\uB54C, \\uC790\\uB3D9\\uC73C\\uB85C Argocd Application\\uB97C Sync\\uD558\\uC5EC \\uBC30\\uD3EC \\uD560 \\uC218 \\uC788\\uB2E4. ArgoCD\\uB97C Kustomize\\uC640 \",(0,e.jsx)(a.code,{children:\"ArgoCD Image Updater\"}),\"\\uB97C \\uAC19\\uC774 \\uC0AC\\uC6A9\\uD560 \\uB54C\\uB294 \",(0,e.jsx)(a.code,{children:\"ArgoCD CD Notification\"}),\"\\uC758 trigger \\uAE30\\uBCF8 \\uC870\\uAC74\\uC758 \",(0,e.jsx)(a.code,{children:\"revision\"}),\" \\uAC12\\uC744 \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC5C6\\uB2E4. \",(0,e.jsx)(a.code,{children:\"ArgoCD Image Updater\"}),\"\\uB97C \\uC0AC\\uC6A9\\uD558\\uBA74 \",(0,e.jsx)(a.code,{children:\"revision\"}),\"\\uC740 \\uC720\\uC9C0\\uB418\\uACE0, Kustomize\\uB85C Image\\uB9CC \\uBCC0\\uACBD\\uB41C\\uB2E4.\"]}),(0,e.jsx)(a.pre,{className:\"language-yaml\",children:(0,e.jsxs)(a.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token atrule key\",children:\"trigger.on-deployed\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"|\"}),(0,e.jsx)(a.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`  - description: Application is synced and healthy. Triggered once per commit.\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`    oncePer: app.status.sync.revision\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`    send:\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`    - app-deployed-custom\n`})}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token string scalar\",children:\"    when: app.status.operationState.phase in ['Succeeded'] and app.status.health.status == 'Healthy'\"}),`\n`]})]})}),(0,e.jsxs)(a.p,{children:[\"\\uB530\\uB77C\\uC11C oncePer \\uC870\\uAC74\\uC744 \\uC544\\uB798\\uC640 \\uAC19\\uC774 Kustomize\\uC758 \\uAC12\\uC744 \\uCC38\\uC870\\uD558\\uC5EC \\uC791\\uC131\\uD560 \\uC218 \\uC788\\uB2E4. \",(0,e.jsx)(a.code,{children:\"ArgoCD Image Updater\"}),\"\\uAC00 \\uC5C5\\uB370\\uC774\\uD2B8\\uD558\\uB294 \\uAC12\\uC744 \\uCC38\\uC870\\uD558\\uC5EC \\uC54C\\uB9BC\\uC744 \\uBCF4\\uB0B4\\uAC8C \\uB41C\\uB2E4.\"]}),(0,e.jsx)(a.pre,{className:\"language-bash\",children:(0,e.jsx)(a.code,{className:\"language-bash code-highlight\",children:(0,e.jsx)(a.span,{className:\"code-line\",children:`oncePer: app.status.operationState?.syncResult?.source?.kustomize?.images\n`})})}),(0,e.jsxs)(a.h2,{id:\"slack-permission\",children:[(0,e.jsx)(a.a,{href:\"#slack-permission\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(a.span,{className:\"icon icon-link\"})}),\"Slack Permission\"]}),(0,e.jsxs)(a.p,{children:[\"Bot Token Scopes\\uC5D0\\uC11C Bot User\\uB85C \\uBCF4\\uB0B4\\uAE30 \\uC704\\uD574\\uC11C \",(0,e.jsx)(a.code,{children:\"chat:write.public\"}),\" permission\\uB3C4 \\uAC19\\uC774 \\uBD80\\uC5EC \\uD55C\\uB2E4.\"]}),(0,e.jsx)(\"img\",{src:\"/static/images/argocd-notification-slack-permission.png\",alt:\"argocd notification slack permission\"}),(0,e.jsx)(a.p,{children:\"\\uADF8\\uB9AC\\uACE0 \\uC544\\uB798\\uCC98\\uB7FC Bot User Oauth Token\\uC744 \\uC0AC\\uC6A9\\uD558\\uC5EC, App\\uC774 \\uCC44\\uB110\\uC5D0 message\\uB97C \\uBCF4\\uB0BC \\uC218 \\uC788\\uB3C4\\uB85D \\uD55C\\uB2E4.\"}),(0,e.jsx)(\"img\",{src:\"/static/images/argocd-notification-slack-token.png\",alt:\"argocd notification slack token\"}),(0,e.jsxs)(a.h2,{id:\"kubernetes-\\uC124\\uCE58\",children:[(0,e.jsx)(a.a,{href:\"#kubernetes-\\uC124\\uCE58\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(a.span,{className:\"icon icon-link\"})}),\"Kubernetes \\uC124\\uCE58\"]}),(0,e.jsx)(a.p,{children:\"Argo CD notifcation controller\\uC744 \\uC544\\uB798\\uCC98\\uB7FC \\uC124\\uCE58\\uD55C\\uB2E4.\"}),(0,e.jsx)(a.pre,{className:\"language-bash\",children:(0,e.jsx)(a.code,{className:\"language-bash code-highlight\",children:(0,e.jsx)(a.span,{className:\"code-line\",children:`kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj-labs/argocd-notifications/release-1.0/manifests/install.yaml\n`})})}),(0,e.jsxs)(a.p,{children:[\"\\uADF8\\uB9AC\\uACE0 \\uC544\\uB798\\uCC98\\uB7FC ConfigMap\\uC744 \\uC124\\uCE58\\uD55C\\uB2E4. \",(0,e.jsx)(a.code,{children:\"argocd-notifications-cm\"}),\" ConfigMap\\uC5D0 \\uC54C\\uB9BC\\uC744 \\uBCF4\\uB0B8 message template\\uB4E4\\uC774 \\uC124\\uC815\\uB41C\\uB2E4.\"]}),(0,e.jsx)(a.pre,{className:\"language-bash\",children:(0,e.jsx)(a.code,{className:\"language-bash code-highlight\",children:(0,e.jsx)(a.span,{className:\"code-line\",children:`kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj-labs/argocd-notifications/release-1.0/catalog/install.yaml\n`})})}),(0,e.jsxs)(a.p,{children:[\"\\uC704\\uC5D0\\uC11C \\uC124\\uC815\\uD55C \",(0,e.jsx)(a.code,{children:\"Bot User Oauth Token\"}),\"\\uC744 \",(0,e.jsx)(a.code,{children:\"<auth-token>\"}),\"\\uC5D0 \\uB123\\uC5B4\\uC11C \\uC0DD\\uC131\\uD55C\\uB2E4.\"]}),(0,e.jsx)(a.pre,{className:\"language-yaml\",children:(0,e.jsxs)(a.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),` v1\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),` Secret\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(a.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),\" argocd\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"-\"}),\"notifications\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"-\"}),`secret\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token atrule key\",children:\"stringData\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(a.span,{className:\"token atrule key\",children:\"slack-token\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),\" <auth\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"-\"}),\"token\",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\">\"}),`\n`]})]})}),(0,e.jsx)(a.p,{children:\"\\uADF8\\uB9AC\\uACE0 \\uC774\\uBBF8 ConfigMap\\uC774 \\uB9CC\\uB4E4\\uC5B4\\uC838 \\uC788\\uAE30 \\uB54C\\uBB38\\uC5D0, patch\\uB97C \\uD1B5\\uD574\\uC11C slack \\uC124\\uC815\\uC744 \\uCD94\\uAC00\\uD55C\\uB2E4.\"}),(0,e.jsx)(a.pre,{className:\"language-bash\",children:(0,e.jsx)(a.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"kubectl patch cm argocd-notifications-cm -n argocd --type merge -p \",(0,e.jsx)(a.span,{className:\"token string\",children:`'{\"data\": {\"service.slack\": \"{ token: $slack-token }\" }}'`}),`\n`]})})}),(0,e.jsx)(a.p,{children:\"\\uB9C8\\uC9C0\\uB9C9\\uC73C\\uB85C \\uC774\\uBBF8 ArgoCD\\uC5D0\\uC11C \\uB9CC\\uB4E4\\uC5B4\\uC9C4 App\\uC5D0 notification\\uC744 \\uC801\\uC6A9\\uD558\\uACE0 \\uC2F6\\uC73C\\uBA74, Annotation\\uC744 \\uCD94\\uAC00\\uD558\\uBA74 \\uB41C\\uB2E4. \\uC544\\uB798\\uCC98\\uB7FC ArgoCD CRD\\uB97C \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(a.pre,{className:\"language-bash\",children:(0,e.jsxs)(a.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(a.span,{className:\"code-line\",children:`$ kubectl get app\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`NAME           SYNC STATUS   HEALTH STATUS\n`}),(0,e.jsx)(a.span,{className:\"code-line\",children:`sample         Synced        Healthy\n`})]})}),(0,e.jsx)(a.p,{children:\"sync\\uAC00 \\uC131\\uACF5\\uC801\\uC73C\\uB85C \\uB418\\uC5C8\\uC744 \\uB54C, Slack notification\\uC744 \\uBCF4\\uB0B4\\uACE0 \\uC2F6\\uC73C\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 annotation\\uC744 \\uB123\\uC73C\\uBA74 \\uB41C\\uB2E4.\"}),(0,e.jsx)(a.pre,{className:\"language-bash\",children:(0,e.jsx)(a.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"kubectl patch app sample -p \",(0,e.jsx)(a.span,{className:\"token string\",children:`'{\"metadata\": {\"annotations\": {\"notifications.argoproj.io/subscribe.on-sync-succeeded.slack\":\"channel_name\"}}}'`}),` --type merge\n`]})})}),(0,e.jsx)(a.p,{children:\"\\uC774\\uC81C Argo CD\\uC5D0\\uC11C \\uD574\\uB2F9 Application\\uC5D0\\uC11C Sync\\uAC00 \\uC131\\uACF5\\uC801\\uC73C\\uB85C \\uC9C4\\uD589\\uB418\\uBA74 \\uD574\\uB2F9 \\uC2AC\\uB799 \\uCC44\\uB110\\uB85C \\uBA54\\uC138\\uC9C0\\uAC00 \\uAC00\\uAC8C \\uB41C\\uB2E4.\"}),(0,e.jsxs)(a.h2,{id:\"cli\",children:[(0,e.jsx)(a.a,{href:\"#cli\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(a.span,{className:\"icon icon-link\"})}),\"CLI\"]}),(0,e.jsxs)(a.p,{children:[(0,e.jsx)(a.code,{children:\"argocd-notification\"}),\" binary\\uB85C CLI\\uB97C \\uC81C\\uACF5\\uD55C\\uB2E4. Kubernetes container\\uC5D0\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uBA85\\uB839\\uC5B4\\uB85C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB2E4. \\uC774\\uB807\\uAC8C \",(0,e.jsx)(a.code,{children:\"applicaion_name\"}),\"\\uC5D0 Argo CD application \\uC774\\uB984\\uC744 \\uC124\\uC815\\uD558\\uACE0, \",(0,e.jsx)(a.code,{children:\"channel_name\"}),\"\\uC740 \\uBCF4\\uB0B4\\uACE0 \\uC2F6\\uC740 \\uCC44\\uB110\\uC744 \\uC801\\uC73C\\uBA74 \\uD14C\\uC2A4\\uD2B8\\uB85C \\uBA54\\uC138\\uC9C0\\uB97C \\uBCF4\\uB0B4\\uBCFC \\uC218 \\uC788\\uB2E4. \\uC704\\uC758 \\uACFC\\uC815\\uC5D0\\uC11C \\uC2AC\\uB799 \\uBA54\\uC138\\uC9C0\\uAC00 \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uC624\\uC9C0 \\uC54A\\uC73C\\uBA74 \\uC774 CLI\\uB85C \\uC694\\uCCAD\\uD574\\uC11C slack\\uC5D0\\uC11C \\uC5B4\\uB5A4 \\uC751\\uB2F5\\uC774 \\uC624\\uB294\\uC9C0 \\uD655\\uC778\\uD558\\uC5EC \\uB514\\uBC84\\uAE45 \\uD560 \\uC218 \\uC788\\uB2E4. \",(0,e.jsx)(a.code,{children:\"channel_name\"}),\"\\uC5D0 \",(0,e.jsx)(a.code,{children:\"@slack_username\"}),\"\\uC73C\\uB85C \\uBCF4\\uB0B4\\uBA74 user conversation\\uC5D0 \\uBA54\\uC138\\uC9C0\\uB97C \\uBCF4\\uB0B4\\uC11C \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(a.pre,{className:\"language-bash\",children:(0,e.jsx)(a.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"kubectl \",(0,e.jsx)(a.span,{className:\"token builtin class-name\",children:\"exec\"}),` -it argocd-notifications-controller-5d78489bc8-fkb2x -- /app/argocd-notifications template notify app-deployed application_name --recipient slack:channel_name\n`]})})}),(0,e.jsxs)(a.h2,{id:\"custom-template\",children:[(0,e.jsx)(a.a,{href:\"#custom-template\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(a.span,{className:\"icon icon-link\"})}),\"Custom Template\"]}),(0,e.jsxs)(a.p,{children:[\"Slack\\uC5D0 \\uC624\\uB294 message\\uC758 \\uB0B4\\uC6A9\\uACFC format\\uC744 \\uBCC0\\uACBD\\uD558\\uACE0 \\uC2F6\\uC73C\\uBA74, \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uB0B4\\uAC00 \\uC815\\uC758\\uD55C template\\uB97C \",(0,e.jsx)(a.code,{children:\"argocd-notifications-cm\"}),\" ConfigMap\\uC5D0 \\uCD94\\uAC00\\uD558\\uBA74 \\uB41C\\uB2E4.\"]}),(0,e.jsx)(a.pre,{className:\"language-yaml\",children:(0,e.jsxs)(a.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token atrule key\",children:\"template.app-deployed-custom\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"|\"}),(0,e.jsx)(a.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`  message: |\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`      {{if eq .app.metadata.name \"sample\"}}[test]{{end}}{{.app.metadata.name}} \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uBC30\\uD3EC\\uAC00 \\uC644\\uB8CC\\uB418\\uC5C7\\uC2B5\\uB2C8\\uB2E4.\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`  slack:\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`    attachments: |\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`      [{\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`        \"title\": \"{{ .app.metadata.name}}\",\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`        \"color\": \"#18be52\",\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`        \"fields\": [\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`        {\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`          \"title\": \"Sync Status\",\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`          \"value\": \"{{.app.status.sync.status}}\",\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`          \"short\": true\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`        },\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`        {\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`          \"title\": \"Repository\",\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`          \"value\": \"{{.app.spec.source.repoURL}}\",\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`          \"short\": true\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`        },\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`        {\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`          \"title\": \"Revision\",\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`          \"value\": \"{{.app.status.sync.revision}}\",\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`          \"short\": true\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`        }\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`        {{range $index, $c := .app.status.conditions}}\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`        {{if not $index}},{{end}}\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`        {{if $index}},{{end}}\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`        {\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`          \"title\": \"{{$c.type}}\",\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`          \"value\": \"{{$c.message}}\",\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`          \"short\": true\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`        }\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`        {{end}}\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`        ]\n`})}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token string scalar\",children:\"      }]\"}),`\n`]})]})}),(0,e.jsx)(a.p,{children:\"CLI\\uB97C \\uD1B5\\uD574\\uC11C \\uB0B4\\uAC00 \\uBCC0\\uACBD\\uD55C \\uC2AC\\uB799 \\uBA54\\uC138\\uC9C0 template\\uC774 \\uC5B4\\uB5BB\\uAC8C \\uBCF4\\uC774\\uB294\\uC9C0 \\uD655\\uC778\\uD558\\uACE0\"}),(0,e.jsx)(a.pre,{className:\"language-bash\",children:(0,e.jsx)(a.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(a.span,{className:\"code-line\",children:[\"kubectl \",(0,e.jsx)(a.span,{className:\"token builtin class-name\",children:\"exec\"}),` -it argocd-notifications-controller-5d78489bc8-fkb2x -- /app/argocd-notifications template notify app-deployed-custom application_name --recipient slack:channel_name\n`]})})}),(0,e.jsxs)(a.p,{children:[\"\\uADF8\\uB9AC\\uACE0 \\uB9C8\\uC9C0\\uB9C9\\uC73C\\uB85C trigger \\uC870\\uAC74\\uC5D0\\uC11C \\uB0B4\\uAC00 \\uB9CC\\uB4E0 \",(0,e.jsx)(a.code,{children:\"app-deployed-custom\"}),\"\\uC744 \\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D \\uC218\\uC815\\uD55C\\uB2E4.\"]}),(0,e.jsx)(a.pre,{className:\"language-yaml\",children:(0,e.jsxs)(a.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token atrule key\",children:\"trigger.on-deployed\"}),(0,e.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(a.span,{className:\"token punctuation\",children:\"|\"}),(0,e.jsx)(a.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`  - description: Application is synced and healthy. Triggered once per commit.\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`    oncePer: app.status.sync.revision\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`    send:\n`})}),(0,e.jsx)(a.span,{className:\"code-line\",children:(0,e.jsx)(a.span,{className:\"token string scalar\",children:`    - app-deployed-custom\n`})}),(0,e.jsxs)(a.span,{className:\"code-line\",children:[(0,e.jsx)(a.span,{className:\"token string scalar\",children:\"    when: app.status.operationState.phase in ['Succeeded'] and app.status.health.status == 'Healthy'\"}),`\n`]})]})}),(0,e.jsx)(a.p,{children:\"\\uC774\\uC81C ArgoCD\\uC5D0\\uC11C \\uC0C8\\uB85C\\uC6B4 revision\\uC73C\\uB85C sync\\uAC00 \\uB9DE\\uC558\\uC744 \\uB54C \\uC2AC\\uB799 \\uC54C\\uB9BC\\uC774 \\uAC00\\uAC8C \\uB41C\\uB2E4.\"})]})}}var f=b;return C;})();\n;return Component;","toc":[{"value":"2024.05.15 Updated","url":"#20240515-updated","depth":2},{"value":"Slack Permission","url":"#slack-permission","depth":2},{"value":"Kubernetes ì„¤ì¹˜","url":"#kubernetes-ì„¤ì¹˜","depth":2},{"value":"CLI","url":"#cli","depth":2},{"value":"Custom Template","url":"#custom-template","depth":2}],"frontMatter":{"readingTime":{"text":"4 min read","minutes":3.895,"time":233700,"words":779},"slug":"20231214-argocd-notification","fileName":"20231214-argocd-notification.md","title":"Argo CD Notificationìœ¼ë¡œ ê°„ë‹¨í•˜ê²Œ Slack ì•Œë¦¼ ë³´ë‚´ê¸°","date":"2023-12-14T00:00:00.000Z","tags":["Kubernetes","ArgoCD"],"images":["/static/images/social-banner.png"],"summary":"Argo CD Notificationê°€ ì´ë¯¸ ìˆì–´ì„œ ì‰½ê²Œ Slack ì•Œë¦¼ì„ ì—°ë™í•  ìˆ˜ ìˆë‹¤. ë©”ë‰´ì–¼ì—ì„œ ì¹œì ˆí•˜ê²Œ ì…‹íŒ… ë°©ë²•ì„ ì„¤ëª…í•˜ê³  ìˆì§€ë§Œ, ì²˜ìŒ ë³´ê³  ì…‹íŒ…í•  ë•Œ ë†“ì¹  ìˆ˜ ìˆëŠ” ë¶€ë¶„ì„ ê¸°ë¡ìœ¼ë¡œ ë‚¨ê¸´ë‹¤."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.15,"time":9000,"words":30},"slug":["default"],"fileName":"default.md","name":"Jay","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"Kubernetesì—ì„œ Nginxë¡œ IP allow list ì œì–´","date":"2023-12-05T00:00:00.000Z","tags":["Kubernetes","Nginx"],"images":["/static/images/social-banner.png"],"summary":"Kubernetes clusterì—ì„œ Nginxë¡œ í—ˆìš© ê°€ëŠ¥í•œ IPë¥¼ ì„¤ì •í•˜ê³  ì‹¶ì—ˆë‹¤. ê°„ë‹¨í•˜ê²Œ ëë‚  ì¤„ ì•Œì•˜ë˜ ì‘ì—…ì€ ë˜ë‹¤ë¥¸ ì‚½ì§ˆê¸°ê°€ ë˜ì—ˆë‹¤.ğŸ˜­ Kubernetesì—ì„œ SNATì´ ë˜ëŠ” ê³¼ì •ì„ ì´í•´í•˜ê³  externalTrafficPolicyë¥¼ Localë¡œ ì„¤ì •í–ˆë‹¤. ê·¸ë¦¬ê³  External Load balancerì—ì„œëŠ” client IPë¥¼ ì „ë‹¬í•˜ê¸° ìœ„í•´ì„œ Proxy Protocolì™€ ê°™ì€ ê²ƒì„ ì„¤ì •í•˜ê³ , Nginxì—ì„œ ê·¸ Proxy protocolë¡œ ì „ë‹¬ëœ IP addressë¡œ Access controlì„ í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•˜ì˜€ë‹¤.","slug":"20231205-nginx-allow-ip"},"next":{"title":"AWS SAMìœ¼ë¡œ ë°°í¬í•œ Lambdaì˜ í™˜ê²½ë³€ìˆ˜ê°€ ë³€ê²½ëœ Secret Manager ê°’ìœ¼ë¡œ ë°˜ì˜ì´ ì•ˆë˜ëŠ” ë¬¸ì œ","date":"2023-12-17T00:00:00.000Z","tags":["AWS"],"images":["/static/images/social-banner.png"],"summary":"AWS Cloudformationì—ì„œ Secret Managerì˜ ê°’ì„ ì°¸ì¡°í•˜ë„ë¡ í•  ìˆ˜ ìˆë‹¤. AWS SAMì„ ì‚¬ìš©í•˜ì—¬ ë°°í¬ëœ Lambdaì˜ í™˜ê²½ë³€ìˆ˜ê°€ Secret Managerì˜ ê°’ì„ ì°¸ì¡°í•˜ëŠ” ê²½ìš°ê°€ ìˆì—ˆë‹¤. ê·¸ëŸ°ë° Secret managerì˜ ê°’ì„ ë³€ê²½í•˜ì—¬ ë‹¤ì‹œ ë°°í¬í•˜ì—¬ë„ ë³€ê²½ëœ ê°’ì´ Lambda í™˜ê²½ë³€ìˆ˜ì— ë°˜ì˜ì´ ë˜ì§€ ì•Šì•˜ë‹¤.ğŸ§ AWS SAMì˜ ë¦¬í¬ì— ê´€ë ¨ëœ Issueê°€ ìˆì—ˆê³ , ì œì•ˆí•œ í•´ê²°ë°©ë²•ì„ ì ìš©í•˜ì˜€ë‹¤. ì‚´ì§ ì‚½ì§ˆì„ í–ˆê¸° ë•Œë¬¸ì— ê¸°ë¡ì„ ë‚¨ê²¨ ë³¸ë‹¤.ğŸ¤ª","slug":"20231217-aws-sam-resolve-issue"}},"__N_SSG":true}