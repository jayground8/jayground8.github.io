{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var o=Object.create;var l=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var t=a=>l(a,\"__esModule\",{value:!0});var N=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),u=(a,s)=>{t(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let n of d(s))!m.call(a,n)&&n!==\"default\"&&l(a,n,{get:()=>s[n],enumerable:!(c=p(s,n))||c.enumerable});return a},g=a=>k(t(l(a!=null?o(h(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var r=N((v,i)=>{i.exports=_jsx_runtime});var b={};u(b,{default:()=>_,frontmatter:()=>y});var e=g(r()),y={title:\"Falco\\uB97C \\uD65C\\uC6A9\\uD558\\uC5EC Terminal Shell \\uBA85\\uB839\\uC5B4 \\uB85C\\uADF8 \\uC218\\uC9D1\\uD558\\uAE30\",date:\"2024-05-04\",tags:[\"kubernetes\",\"falco\",\"devsecops\"],images:[\"/static/images/social-banner.png\"],summary:\"Kubernetes Worker Node\\uC640 Pod Container\\uC5D0 Terminal shell\\uB85C \\uC811\\uADFC\\uD558\\uC5EC \\uBA85\\uB839\\uC5B4\\uB97C \\uC785\\uB825\\uD558\\uBA74 \\uB85C\\uADF8\\uB97C \\uB0A8\\uAE30\\uACE0, \\uACBD\\uC6B0\\uC5D0 \\uB530\\uB77C\\uC11C \\uC54C\\uB9BC\\uC744 \\uBCF4\\uB0B4\\uACE0 \\uC2F6\\uC5C8\\uB2E4. CNCF \\uC878\\uC5C5\\uD55C Project\\uC778 Falco\\uB97C \\uD65C\\uC6A9\\uD558\\uBA74 \\uC774\\uB97C \\uAD6C\\uD604\\uD560 \\uC218 \\uC788\\uC9C0 \\uC54A\\uC744\\uAE4C \\uD558\\uC5EC \\uD14C\\uC2A4\\uD2B8\\uB97C \\uD574\\uBCF4\\uAC8C \\uB418\\uC5C8\\uB2E4. Falco\\uB294 kernel module\\uC774\\uB098 eBPF probe\\uB4F1\\uC744 \\uD1B5\\uD574\\uC11C kernel event\\uB97C \\uC800\\uC7A5\\uD558\\uACE0, \\uC124\\uC815\\uB41C rule\\uC5D0 \\uB530\\uB77C\\uC11C \\uD574\\uB2F9 event\\uB97C filter\\uD558\\uC5EC \\uC6D0\\uD558\\uB294 output \\uD615\\uD0DC\\uB85C \\uC800\\uC7A5\\uD55C\\uB2E4. Falco\\uB294 \\uBAA8\\uB4E0 \\uB85C\\uADF8\\uB97C \\uC800\\uC7A5\\uD558\\uAE30\\uBCF4\\uB2E4\\uB294 Rule\\uC5D0 \\uB530\\uB77C \\uC120\\uD0DD\\uC801\\uC73C\\uB85C \\uBCF4\\uC548 \\uC704\\uD611\\uC774 \\uC788\\uB294 \\uC774\\uBCA4\\uD2B8\\uB97C \\uC218\\uC9D1\\uD558\\uACE0 \\uC2E4\\uC2DC\\uAC04\\uC73C\\uB85C \\uC54C\\uB9BC\\uD558\\uB294 \\uAC83\\uC774 \\uBAA9\\uC801\\uC774\\uB2E4. \\uB530\\uB77C\\uC11C Falco\\uB97C \\uD1B5\\uD574\\uC11C \\uC6D0\\uD558\\uB358 \\uAE30\\uB2A5\\uC744 \\uAD6C\\uD604\\uD558\\uB294 \\uAC83\\uC740 \\uD569\\uB9AC\\uC801\\uC778 \\uBC29\\uBC95\\uC774 \\uC544\\uB2CC \\uAC83\\uC73C\\uB85C \\uD310\\uB2E8 \\uB41C\\uB2E4.\"};function f(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({p:\"p\",a:\"a\",blockquote:\"blockquote\",h2:\"h2\",span:\"span\",pre:\"pre\",code:\"code\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.p,{children:[\"Kubernetes\\uC5D0\\uC11C Worker Node\\uB098 Pod\\uC5D0 Shell\\uB85C \\uC811\\uADFC\\uD558\\uBA74 \\uAE30\\uB85D\\uC744 \\uB0A8\\uAE30\\uACE0, \\uC6D0\\uD558\\uB294 \\uACBD\\uC6B0\\uC5D0\\uB294 \\uC54C\\uB9BC\\uC744 \\uBC1B\\uACE0 \\uC2F6\\uC5C8\\uB2E4. \\uADF8\\uB798\\uC11C \",(0,e.jsx)(n.a,{href:\"https://falco.org/\",children:\"CNCF \\uC878\\uC5C5\\uD55C \\uD504\\uB85C\\uC81D\\uD2B8\\uC778 Falco\"}),\"\\uB97C \\uD1B5\\uD574\\uC11C \\uC6D0\\uD558\\uB294 \\uC2DC\\uC2A4\\uD15C\\uC744 \\uB9CC\\uB4E4 \\uC218 \\uC788\\uC744\\uC9C0 \\uD655\\uC778\\uD574\\uBCF4\\uC558\\uB2E4. \",(0,e.jsx)(n.a,{href:\"https://falco.org/docs/getting-started/\",children:\"Falco Architecture\\uAC00 \\uBB38\\uC11C\"}),\"\\uC5D0 \\uC544\\uB798 \\uADF8\\uB9BC\\uACFC \\uD568\\uAED8 \\uCE5C\\uC808\\uD788 \\uC124\\uBA85\\uB418\\uC5B4 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"Falco operates in both kernel and user space. In kernel space, Linux system calls (syscalls) are collected by a driver, for example, the Falco kernel module or Falco eBPF probe. Next, syscalls are placed in a ring buffer from which they are moved into user space for processing. The events are filtered using a rules engine with a Falco rule set.\"})}),(0,e.jsx)(\"img\",{src:\"/static/images/falco-architecture-v2.png\",alt:\"Falco architecture\"}),(0,e.jsxs)(n.p,{children:[\"Falco\\uB294 Rule\\uC744 \\uD1B5\\uD574\\uC11C \\uC120\\uD0DD\\uC801\\uC73C\\uB85C \\uC774\\uBCA4\\uD2B8\\uB97C \\uC800\\uC7A5\\uD558\\uB294 \\uAD6C\\uC870\\uB85C \\uB418\\uC5B4 \\uC788\\uB2E4. \\uC815\\uC758\\uB41C Falco Rule\\uB85C filter\\uB41C \\uC774\\uBCA4\\uD2B8\\uB97C Standard Output, File Output, Syslog Output, Program Output, HTTP/HTTPS Output, JSON Output\\uB4F1\\uC744 \\uD1B5\\uD574\\uC11C \\uC6D0\\uD558\\uB294 Output \\uD615\\uC2DD\\uC744 \\uC815\\uC758\\uD560 \\uC218 \\uC788\\uB2E4. \",(0,e.jsx)(n.a,{href:\"https://github.com/falcosecurity/falco/issues/1983#issuecomment-1126171645\",children:\"Syslog Output\\uC758 \\uACBD\\uC6B0\\uC5D0\\uB294 Falco\\uB97C Host\\uC5D0 \\uC9C1\\uC811 \\uC124\\uCE58\\uD558\\uC600\\uC744 \\uB54C, Syslog Service\\uB97C \\uD1B5\\uD574\\uC11C \\uB0A8\\uAE30\\uB294 \\uAC83\\uC73C\\uB85C \\uBCF4\\uC778\\uB2E4.\"}),\". Kubernetes\\uC5D0\\uC11C Pod\\uB85C Falco\\uB97C \\uC2E4\\uD589\\uD560 \\uB54C\\uB294 Standard Output\\uC744 \\uC0AC\\uC6A9\\uD558\\uACE0, Fluentbit\\uC774\\uB098 Opentelemetry Filelog Receiver\\uB4F1\\uC73C\\uB85C file\\uC744 tail\\uD574\\uC11C \\uC800\\uC7A5\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsxs)(n.p,{children:[\"\\uB610\\uD55C \",(0,e.jsx)(n.a,{href:\"https://falco.org/docs/outputs/forwarding/\",children:\"Falcosidekick\\uC744 \\uD1B5\\uD574\\uC11C Forwarding\"}),\"\\uC744 \\uD1B5\\uD574\\uC11C \\uC6D0\\uD558\\uB294 \\uACF3\\uC5D0 Falco Alert\\uB97C \\uC804\\uB2EC\\uD560 \\uC218 \\uC788\\uB2E4. \\uC544\\uB798\\uB294 \\uACF5\\uC2DD\\uBB38\\uC11C\\uC5D0 \\uC788\\uB294 \\uADF8\\uB9BC\\uC73C\\uB85C Falcosidekick\\uC744 \\uD1B5\\uD574\\uC11C \\uD3B8\\uD558\\uAC8C \\uB2E4\\uC591\\uD55C \\uC2DC\\uC2A4\\uD15C\\uC5D0 \\uC804\\uB2EC\\uD560 \\uC218 \\uC788\\uB2E4. Loki\\uC5D0 push\\uD558\\uC5EC log\\uB97C \\uC800\\uC7A5\\uD560 \\uC218\\uB3C4 \\uC788\\uACE0, Slack\\uC5D0 \\uBA54\\uC138\\uC9C0\\uB97C \\uBCF4\\uB0BC \\uC218\\uB3C4 \\uC788\\uB2E4. \\uC774 \\uBC29\\uBC95\\uC740 Falco HTTP/HTTPS Output\\uC744 \\uD1B5\\uD574\\uC11C Falcosidekick\\uC5D0\\uAC8C Alert\\uB97C \\uC804\\uC1A1\\uD558\\uB294 \\uAC83\\uC774\\uB2E4.\"]}),(0,e.jsx)(\"img\",{src:\"/static/images/falcosidekick_forwarding.png\",alt:\"falcosidekick forwarding\"}),(0,e.jsxs)(n.h2,{id:\"helm\\uC73C\\uB85C-\\uC124\\uCE58\",children:[(0,e.jsx)(n.a,{href:\"#helm\\uC73C\\uB85C-\\uC124\\uCE58\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Helm\\uC73C\\uB85C \\uC124\\uCE58\"]}),(0,e.jsx)(n.p,{children:\"Helm Chart\\uB97C \\uC774\\uC6A9\\uD558\\uC5EC Falco\\uB97C \\uC124\\uCE58\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"helm repo \",(0,e.jsx)(n.span,{className:\"token function\",children:\"add\"}),` falcosecurity https://falcosecurity.github.io/charts\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`helm repo update\n`})]})}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`$ helm search repo falcosecurity\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`NAME                            CHART VERSION   APP VERSION\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"falcosecurity/event-generator   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0.3\"}),\".3           \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0.10\"}),`.0\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"falcosecurity/falco             \",(0,e.jsx)(n.span,{className:\"token number\",children:\"4.3\"}),\".0           \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0.37\"}),`.1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"falcosecurity/falco-exporter    \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0.10\"}),\".0          \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0.8\"}),`.3\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"falcosecurity/falcosidekick     \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0.7\"}),\".17          \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2.28\"}),`.0\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"falcosecurity/k8s-metacollector \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0.1\"}),\".7           \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0.1\"}),`.0\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"Kernel module\\uB300\\uC2E0\\uC5D0 performance\\uC801\\uC73C\\uB85C \\uC720\\uB9AC\\uD55C ebpf\\uB97C \\uC0AC\\uC6A9\\uD574\\uC11C syscall\\uC744 probe\\uD558\\uB3C4\\uB85D \\uD55C\\uB2E4. \\uADF8\\uB9AC\\uACE0 falcosidekick\\uC744 \\uAC19\\uC774 \\uC124\\uCE58\\uD558\\uAE30 \\uC704\\uD574\\uC11C enabled\\uC744 true\\uB85C \\uC124\\uC815\\uD574\\uC8FC\\uACE0, loki\\uC640 slack\\uC5D0 Falco alert\\uB97C \\uC804\\uB2EC\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uD558\\uC600\\uB2E4. Falco\\uC5D0\\uC11C\\uB294 EMERGENCY, ALERT, CRITICAL, ERROR, WARNING, NOTICE, INFORMATIONAL, DEBUG \\uC21C\\uC73C\\uB85C \\uC6B0\\uC120\\uC21C\\uC704 \\uC815\\uBCF4\\uB97C \\uC815\\uC758\\uD560 \\uC218 \\uC788\\uB2E4. \",(0,e.jsx)(n.code,{children:\"minimumpriority\"}),\"\\uB97C \\uD1B5\\uD574\\uC11C \\uC5B4\\uB290 \\uC6B0\\uC120\\uC21C\\uC704\\uAE4C\\uC9C0 \\uBCF4\\uB0BC\\uAC83\\uC778\\uC9C0 \\uC815\\uC758\\uB97C \\uD560 \\uC218 \\uC788\\uB294\\uB370, \\uC544\\uB798\\uC5D0\\uC11C\\uB294 \",(0,e.jsx)(n.code,{children:\"alert\"}),\"\\uB85C \\uC124\\uC815\\uD588\\uAE30 \\uB54C\\uBB38\\uC5D0 EMERGENCY\\uC640 ALERT\\uC5D0 \\uB300\\uD574\\uC11C \\uBA54\\uC138\\uC9C0\\uB97C \\uC804\\uB2EC\\uBC1B\\uAC8C \\uB41C\\uB2E4. falcosidekick\\uC758 slack \\uC124\\uC815\\uC740 \",(0,e.jsx)(n.a,{href:\"https://github.com/falcosecurity/falcosidekick/blob/master/docs/outputs/slack.md\",children:\"\\uC774 \\uBB38\\uC11C\"}),\"\\uC5D0\\uC11C \\uD655\\uC778 \\uAC00\\uB2A5\\uD558\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"values.yaml\"})}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"driver\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` ebpf\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"falcosidekick\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"config\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"loki\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"hostport\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" http\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"//loki\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"3100\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"tenant\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` falco\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"slack\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"webhookurl\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" https\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"//hooks.slack.com/services/\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"something\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"minimumpriority\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` alert\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\t\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"outputformat\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` fields\n`]})]})}),(0,e.jsx)(n.p,{children:\"Helm Chart\\uC758 value\\uB294 \\uAE30\\uBCF8\\uAC12\\uC73C\\uB85C \\uC544\\uB798\\uC640 \\uAC19\\uC774 stdout_output\\uC774 enable\\uB418\\uC5B4 \\uC788\\uB2E4. \\uB530\\uB77C\\uC11C Daemonset\\uC73C\\uB85C \\uC124\\uCE58\\uB418\\uB294 Falco\\uC758 container log\\uB97C \\uBCF4\\uBA74 Falco rule\\uC5D0 \\uB530\\uB978 event\\uB4E4\\uC774 \\uB0A8\\uC544 \\uC788\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"stdout_output\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uC815\\uC758\\uD55C \",(0,e.jsx)(n.code,{children:\"values.yaml\"}),\"\\uC744 \\uD1B5\\uD574\\uC11C Helm Chart\\uB97C \\uBC30\\uD3EC\\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"helm \",(0,e.jsx)(n.span,{className:\"token function\",children:\"install\"}),\" falco falcosecurity/falco \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--create-namespace \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--namespace falco \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`--values values.yaml\n`})]})}),(0,e.jsx)(n.p,{children:\"\\uC124\\uCE58\\uACFC \\uC644\\uB8CC\\uB418\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 falco\\uC758 \\uC124\\uC815\\uAC12\\uB4E4\\uC774 ConfigMap\\uC5D0 \\uC815\\uC758\\uB41C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`$ kubectl get cm -n falco\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`NAME               DATA   AGE\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"falco              \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`      1d\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"falco-falcoctl     \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`      1d\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"falco-rules        \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`      1d\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"kubectl get cm falco -o yaml\"}),\"\\uC73C\\uB85C \\uD655\\uC778\\uD574\\uBCF4\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 json \\uD615\\uC2DD\\uC758 output\\uC774 \\uC124\\uC815\\uB418\\uAC8C \\uB41C\\uB2E4. \\uADF8\\uB9AC\\uACE0 falco-facosidekick ClusterIP \\uC11C\\uBE44\\uC2A4\\uB85C \\uC694\\uCCAD\\uD558\\uB3C4\\uB85D http_output\\uC774 \\uC124\\uC815\\uB418\\uACE0, stdout_output\\uB3C4 \\uB3D9\\uC77C\\uD558\\uAC8C true\\uB85C \\uC124\\uC815\\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"json_output\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"http_output\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"ca_bundle\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"ca_cert\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"ca_path\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` /etc/falco/certs/\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"client_cert\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` /etc/falco/certs/client/client.crt\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"client_key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` /etc/falco/certs/client/client.key\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"compress_uploads\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"echo\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"insecure\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"keep_alive\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"mtls\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"false\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"url\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" http\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"//falco\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"falcosidekick\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2801\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"user_agent\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` falcosecurity/falco\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"stdout_output\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enabled\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"falco-rule\",children:[(0,e.jsx)(n.a,{href:\"#falco-rule\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Falco Rule\"]}),(0,e.jsxs)(n.p,{children:[\"Falco rules\\uC744 \\uAE30\\uBCF8\\uC801\\uC73C\\uB85C \",(0,e.jsx)(n.code,{children:\"stable\"}),\" \\uC0C1\\uD0DC\\uC5D0 \\uC788\\uB294 rule\\uB4E4 \\uC790\\uB3D9\\uC73C\\uB85C \\uC124\\uC815\\uC774 \\uB41C\\uB2E4. \",(0,e.jsx)(n.a,{href:\"https://falco.org/docs/reference/rules/default-rules/\",children:\"Community\\uC5D0\\uC11C \\uAD00\\uB9AC\\uB418\\uB294 rule\\uB4E4\\uC740 \\uC5EC\\uAE30\"}),\"\\uC5D0\\uC11C \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. \",(0,e.jsx)(n.code,{children:\"incubating\"}),\", \",(0,e.jsx)(n.code,{children:\"sandbox\"}),\" \\uC0C1\\uD0DC\\uC758 rule\\uB3C4 \\uCD94\\uAC00\\uD558\\uACE0 \\uC2F6\\uC73C\\uBA74 Helm Chart Value\\uC5D0 \\uC815\\uC758\\uD558\\uC5EC \\uCD94\\uAC00\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsxs)(n.p,{children:[\"stable \\uC0C1\\uD0DC\\uC758 rule\\uB4E4\\uC740 \",(0,e.jsx)(n.a,{href:\"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml\",children:\"Github Repo\\uC758 falco_rules.yaml\"}),\"\\uC5D0\\uC11C\\uB3C4 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. \\uC608\\uB97C \\uB4E4\\uC5B4\\uC11C \",(0,e.jsx)(n.code,{children:\"falco_rules.yaml\"}),\"\\uC5D0\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC740 Rule\\uC774 \\uC815\\uC758\\uB418\\uC5B4 \\uC788\\uB2E4. \",(0,e.jsx)(n.code,{children:\"macro\"}),\"\\uB294 \\uB2E4\\uC2DC \\uC7AC\\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D \\uD2B9\\uC815\\uD55C \\uC870\\uAC74\\uB4E4\\uC744 \\uC815\\uC758\\uD574 \\uB193\\uB294 \\uAC83\\uC774\\uACE0, \",(0,e.jsx)(n.code,{children:\"list\"}),\"\\uB97C \\uD1B5\\uD574\\uC11C \\uC5EC\\uB7EC \\uAC1C\\uC758 \\uAC12\\uC744 \\uBB36\\uC5B4\\uC11C \\uC815\\uC758\\uD560 \\uC218 \\uC788\\uB2E4. \",(0,e.jsx)(n.code,{children:\"Terminal shell in container\"}),\"\\uC5D0\\uC11C \",(0,e.jsx)(n.code,{children:\"macro\"}),\"\\uC640 \",(0,e.jsx)(n.code,{children:\"list\"}),\"\\uB97C \\uC0AC\\uC6A9\\uD574\\uC11C \\uC815\\uC758\\uD558\\uACE0 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"macro\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` spawned_process\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"condition\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" (evt.type in (execve\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` execveat) and evt.dir=<)\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"macro\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` container\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"condition\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" (container.id \",(0,e.jsx)(n.span,{className:\"token tag\",children:\"!=\"}),` host)\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"macro\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` container_entrypoint\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"condition\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" (not proc.pname exists or proc.pname in (runc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"PARENT\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" runc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"1\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"CHILD\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" runc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" docker\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"runc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" exe\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" docker\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"runc\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"cur\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" containerd\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"shim\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" systemd\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` crio))\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"macro\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` user_expected_terminal_shell_in_container_conditions\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"condition\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` (never_true)\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"list\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` shell_binaries\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"items\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"ash\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" bash\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" csh\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" ksh\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" sh\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" tcsh\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" zsh\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" dash\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"macro\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` shell_procs\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"condition\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` (proc.name in (shell_binaries))\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"rule\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Terminal shell in container\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"desc\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"}),(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`    A shell was used as the entrypoint/exec point into a container with an attached terminal. Parent process may have \n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`    legitimately already exited and be null (read container_entrypoint macro). Common when using \"kubectl exec\" in Kubernetes. \n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`    Correlate with k8saudit exec logs if possible to find user or serviceaccount token used (fuzzy correlation by namespace and pod name). \n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`    Rather than considering it a standalone rule, it may be best used as generic auditing rule while examining other triggered \n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string scalar\",children:\"    rules in this container/tty.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"condition\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"}),(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`    spawned_process \n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`    and container\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`    and shell_procs \n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`    and proc.tty != 0\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`    and container_entrypoint\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string scalar\",children:\"    and not user_expected_terminal_shell_in_container_conditions\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"output\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` A shell was spawned in a container with an attached terminal (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"priority\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` NOTICE\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"tags\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"maturity_stable\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" container\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" shell\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" mitre_execution\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" T1059\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uC774\\uC81C Pod\\uC5D0 \\uC811\\uADFC\\uD558\\uBA74\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-bash\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"kubectl \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"exec\"}),` -it nginx-pod -- /bin/sh\n`]})})}),(0,e.jsx)(n.p,{children:\"\\uC544\\uB798\\uC640 \\uAC19\\uC740 log\\uAC00 \\uB0A8\\uAC8C \\uB41C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-json\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-json\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"hostname\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"node-name\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"output\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"10:31:35.913486795: Notice A shell was spawned in a container with an attached terminal (evt_type=execve user=root user_uid=0 user_loginuid=-1 process=sh proc_exepath=/usr/bin/dash parent=containerd-shim command=sh terminal=34816 exe_flags=EXE_WRITABLE container_id=6fec6323ae4c container_image=docker.io/library/nginx container_image_tag=latest container_name=nginx k8s_ns=default k8s_pod_name=pod-name)\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"priority\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Notice\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"rule\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Terminal shell in container\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"source\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"syscall\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"tags\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"T1059\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"container\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"maturity_stable\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"mitre_execution\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"shell\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"time\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"2024-05-03T10:31:35.913486795Z\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"output_fields\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.id\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"6fec6323ae4c\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.image.repository\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"docker.io/library/nginx\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.image.tag\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"latest\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"nginx\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"evt.arg.flags\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"EXE_WRITABLE\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"evt.time\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1714732295913486795\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"evt.type\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"execve\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"k8s.ns.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"default\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"k8s.pod.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"pod-name\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"proc.cmdline\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"sh\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"proc.exepath\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"/usr/bin/dash\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"proc.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"sh\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"proc.pname\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"containerd-shim\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"proc.tty\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"34816\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"user.loginuid\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"-1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"user.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"root\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"user.uid\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uD14C\\uC2A4\\uD2B8\\uB97C \\uD55C \\uD658\\uACBD\\uC758 Container Runtime\\uC774 containerd\\uC774\\uAE30 \\uB54C\\uBB38\\uC5D0, parent process\\uBA85\\uC740 \",(0,e.jsx)(n.code,{children:\"containerd-shim\"}),\"\\uC73C\\uB85C \\uD45C\\uC2DC\\uAC00 \\uB41C\\uB2E4. \",(0,e.jsx)(n.code,{children:\"evt.type\"}),\"\\uB294 syscall event\\uC744 \\uAC00\\uC9C0\\uB294\\uB370, \",(0,e.jsx)(n.a,{href:\"https://falco.org/docs/reference/rules/supported-events/\",children:\"\\uACF5\\uC2DD\\uBB38\\uC11C\\uC758 \\uC9C0\\uC6D0\\uD558\\uB294 events \\uC885\\uB958\"}),\"\\uB97C \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. \",(0,e.jsx)(n.a,{href:\"https://man7.org/linux/man-pages/man2/execve.2.html\",children:\"execve\\uB294 \\uD504\\uB85C\\uADF8\\uB7A8\\uC744 \\uC2E4\\uD589\\uD560 \\uB54C\\uC758 syscall\"}),\"\\uC778\\uB370, \",(0,e.jsx)(n.code,{children:\"/usr/bin/dash\"}),\" binary file\\uC774 \\uC2E4\\uD589\\uB418\\uC5C8\\uAE30 \\uB54C\\uBB38\\uC5D0 evt.type\\uC740 \",(0,e.jsx)(n.code,{children:\"execve\"}),\"\\uAC00 \\uB418\\uACE0 proc.exepath\\uAC00 \",(0,e.jsx)(n.code,{children:\"usr/bin/dah\"}),\"\\uAC00 \\uB41C\\uB2E4. \\uADF8\\uB9AC\\uACE0 \\uC544\\uB798\\uCC98\\uB7FC \\uBB38\\uC11C\\uC5D0 syscall\\uC774 \\uBD88\\uB838\\uC744 \\uB54C \",(0,e.jsx)(n.code,{children:\">\"}),\", \\uB05D\\uB0AC\\uC744 \\uB54C \",(0,e.jsx)(n.code,{children:\"<\"}),\"\\uB85C \\uD45C\\uC2DC\\uD558\\uAC8C \\uB41C\\uB2E4. \",(0,e.jsx)(n.code,{children:\">\"}),\"\\uB294 filepath\\uB85C \\uC2E4\\uD589\\uD558\\uACE0, \",(0,e.jsx)(n.code,{children:\"<\"}),\"\\uB294 systemcall\\uC774 \\uB05D\\uB098\\uACE0 \\uAE30\\uD0C0 \\uC815\\uBCF4\\uB4E4\\uC744 \\uBC18\\uD658\\uD55C\\uB2E4.\"]}),(0,e.jsx)(\"img\",{src:\"/static/images/falco-execve.png\",alt:\"falco execve event\"}),(0,e.jsxs)(n.h2,{id:\"custom-rule\",children:[(0,e.jsx)(n.a,{href:\"#custom-rule\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Custom Rule\"]}),(0,e.jsxs)(n.p,{children:[\"\\uAE30\\uBCF8\\uC73C\\uB85C \\uC124\\uC815\\uB418\\uC5B4 \\uC788\\uB294 Rule\\uC744 \\uC0B4\\uD3B4\\uBCF4\\uC558\\uACE0, \",(0,e.jsx)(n.code,{children:\"marcro\"}),\", \",(0,e.jsx)(n.code,{children:\"list\"}),\", \",(0,e.jsx)(n.code,{children:\"rule\"}),\" Syntax\\uB85C \\uC6D0\\uD558\\uB294 custom rule\\uC744 \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB2E4. accept, listen\\uC740 \",(0,e.jsx)(n.code,{children:\"<\"}),\" \\uC5D0\\uC11C fd params\\uC744 \\uAC00\\uC9C0\\uACE0, recvfrom, recvmsg\\uB294 \",(0,e.jsx)(n.code,{children:\">\"}),\"\\uC5D0\\uC11C fd params\\uB97C \\uAC00\\uC9C0\\uACE0 \\uC788\\uB2E4. (dir\\uC744 \\uBA85\\uC2DC\\uC801\\uC73C\\uB85C \\uC815\\uC758\\uD558\\uC9C0 \\uC54A\\uC73C\\uBA74 \",(0,e.jsx)(n.code,{children:\">\"}),\"\\uAC00 default\\uB85C \\uB418\\uB294 \\uAC83 \\uAC19\\uB2E4.) \\uC774\\uC81C params \",(0,e.jsx)(n.code,{children:\"fd\"}),\"\\uB97C \\uD1B5\\uD574\\uC11C \",(0,e.jsx)(n.code,{children:\"fd.sport\"}),\" Server Port\\uAC00 22\\uC778\\uC9C0 \\uD655\\uC778\\uD55C\\uB2E4. \\uC774 \\uC870\\uAC74\\uC744 \\uB9CC\\uC871\\uD558\\uBA74 output\\uC73C\\uB85C \",(0,e.jsx)(n.code,{children:\"fd.cip\"}),\" client IP address\\uC640 \",(0,e.jsx)(n.code,{children:\"fd.cport\"}),\" client Port \\uAC12\\uC744 \\uB0A8\\uAE30\\uB3C4\\uB85D \\uD558\\uC600\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"custom-rules.yaml\"})}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"customRules\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"rules-ssh.yaml\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"|\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"list\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` ssh_standard_ports\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"items\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"22\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"macro\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` ssh_standard_ports_network\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"condition\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` (fd.sport in (ssh_standard_ports))\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"rule\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Inbound SSH Connection\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"desc\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Detect Inbound SSH Connection\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"condition\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"}),(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`        ((evt.type in (accept,listen) and evt.dir=<) or\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string scalar\",children:\"          (evt.type in (recvfrom,recvmsg))) and ssh_standard_ports_network\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"output\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"}),(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string scalar\",children:\"        Inbound SSH connection (user=%user.name client_ip=%fd.cip client_port=%fd.cport server_ip=%fd.sip)\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"priority\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` ALERT\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"tags\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"network\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uC815\\uC758\\uD55C costom rule\\uC744 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC801\\uC6A9\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"helm upgrade falco falcosecurity/falco \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"-f ./custom-rules.yaml \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--namespace falco \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`--values values.yaml\n`})]})}),(0,e.jsxs)(n.p,{children:[\"custom rule\\uC5D0 \\uC758\\uD574\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC774 log\\uAC00 \\uB0A8\\uB294\\uB2E4. \\uADF8\\uB9AC\\uACE0 \",(0,e.jsx)(n.code,{children:\"container.id\"}),\"\\uAC00 \",(0,e.jsx)(n.code,{children:\"host\"}),\"\\uC774\\uAE30 \\uB54C\\uBB38\\uC5D0 Kubernetes \\uAD00\\uB828\\uB41C \\uC815\\uBCF4\\uB294 \",(0,e.jsx)(n.code,{children:\"<NA>\"}),\"\\uB85C \\uD45C\\uC2DC\\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-json\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-json\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"hostname\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"node-name\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"output\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"11:37:53.059395044: Alert Inbound SSH connection (user=root client_ip=x.x.x.x client_port=56483 server_ip=x.x.x.x) container_id=host container_image=<NA> container_image_tag=<NA> container_name=host k8s_ns=<NA> k8s_pod_name=<NA>\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"priority\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Alert\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"rule\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Inbound SSH Connection\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"source\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"syscall\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"tags\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"network\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"time\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"2024-05-03T11:37:53.059395044Z\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"output_fields\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.id\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"host\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.image.repository\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword null\",children:\"null\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.image.tag\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword null\",children:\"null\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"host\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"evt.time\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1714736273059395044\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"fd.cip\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"x.x.x.x\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"fd.cport\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"56483\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"fd.sip\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"x.x.x.x\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"k8s.ns.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword null\",children:\"null\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"k8s.pod.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword null\",children:\"null\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"user.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"root\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB9AC\\uACE0 \\uC704\\uC5D0\\uC11C \",(0,e.jsx)(n.code,{children:\"falcosidekick\"}),\"\\uC5D0\\uC11C slack\\uB3C4 \\uC124\\uC815\\uC744 \\uD588\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uC544\\uB798\\uCC98\\uB7FC \\uC2AC\\uB799 \\uBA54\\uC138\\uC9C0\\uAC00 \\uC624\\uAC8C \\uB41C\\uB2E4.\"]}),(0,e.jsx)(\"img\",{src:\"/static/images/falco-slack.png\",alt:\"falco slack message\"}),(0,e.jsxs)(n.h2,{id:\"\\uC6D0\\uD558\\uB294-\\uACB0\\uACFC\",children:[(0,e.jsx)(n.a,{href:\"#\\uC6D0\\uD558\\uB294-\\uACB0\\uACFC\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uC6D0\\uD558\\uB294 \\uACB0\\uACFC\"]}),(0,e.jsx)(n.p,{children:\"\\uCD5C\\uC885\\uC801\\uC73C\\uB85C Falco\\uB85C \\uAD6C\\uD604\\uD558\\uACE0 \\uC2F6\\uC740 \\uAC83\\uC740 Worker Node\\uB098 Pod\\uC758 Container\\uC5D0 Terminal shell\\uB85C \\uC5F0\\uACB0\\uD588\\uC744 \\uB54C, \\uBAA8\\uB4E0 \\uBA85\\uB839\\uC5B4\\uB4E4\\uC744 \\uC800\\uC7A5\\uD558\\uACE0 \\uC54C\\uB9BC\\uC744 \\uD544\\uC694\\uC2DC\\uC5D0 \\uBC1B\\uACE0 \\uC2F6\\uB2E4.\"}),(0,e.jsx)(n.p,{children:\"Falco\\uB294 Rule\\uC744 \\uD1B5\\uD574\\uC11C \\uD2B9\\uC815 \\uC870\\uAC74\\uC5D0 \\uD574\\uB2F9\\uB418\\uB294 Event\\uB97C \\uC800\\uC7A5\\uD558\\uB294 \\uAD6C\\uC870\\uB85C \\uB418\\uC5B4\\uC788\\uB2E4. \\uB530\\uB77C\\uC11C \\uC774\\uB807\\uAC8C \\uBAA8\\uB4E0 \\uBA85\\uB839\\uC5B4\\uB4E4\\uC744 \\uC800\\uC7A5\\uD558\\uACE0 \\uC2F6\\uB2E4\\uBA74, \\uADF8\\uB807\\uAC8C \\uD560 \\uC218 \\uC788\\uB3C4\\uB85D Custom Rule\\uC744 \\uC815\\uC758\\uD574\\uC57C \\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"rule\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` shell_in_container\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"desc\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` notice shell activity within a container\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"condition\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"}),(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\tevt.type = execve and\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\tevt.dir = < and\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\tcontainer.id != host and\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string scalar\",children:\"\t\tproc.pname = sh\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"output\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"}),(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\tshell in a container\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\t(user=%user.name container_id=%container.id container_name=%container.name\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string scalar\",children:\"\t\tshell=%proc.name parent=%proc.pname cmdline=%proc.cmdline)\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"priority\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` WARNING\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"ls\"}),\"\\uC758 \\uACBD\\uC6B0\\uC5D0\\uB294 \",(0,e.jsx)(n.code,{children:\"execve\"}),\"\\uAC00 \\uC0AC\\uC6A9\\uB418\\uACE0 \\uC544\\uB798\\uCC98\\uB7FC log\\uAC00 \\uB0A8\\uAC8C \\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ kubectl \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"exec\"}),` -it nginx-pod -- /bin/sh\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# ls\"}),`\n`]})]})}),(0,e.jsx)(n.pre,{className:\"language-json\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-json\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"hostname\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"node-name\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"output\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"12:03:52.176355678: Warning shell in a container (user=root container_id=6fec6323ae4c container_name=nginx  shell=ls parent=sh cmdline=ls /bin) container_id=6fec6323ae4c container_image=docker.io/library/nginx container_image_tag=latest container_name=nginx k8s_ns=default k8s_pod_name=pod-name\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"priority\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Warning\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"rule\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"shell_in_container\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"source\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"syscall\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"tags\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"time\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"2024-05-03T12:03:52.176355678Z\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"output_fields\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.id\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"6fec6323ae4c\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.image.repository\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"docker.io/library/nginx\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.image.tag\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"latest\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"nginx\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"evt.time\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1714737832176355678\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"k8s.ns.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"default\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"k8s.pod.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"pod-name\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"proc.cmdline\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"ls /bin\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"proc.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"ls\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"proc.pname\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"sh\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"user.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"root\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"Pod container\\uB9D0\\uACE0 host\\uB97C \\uD558\\uACE0 \\uC2F6\\uB2E4\\uBA74 Condition\\uC5D0\\uC11C \",(0,e.jsx)(n.code,{children:\"container.id = host\"}),\"\\uB85C \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB2E4. \\uB3D9\\uC77C\\uD55C \\uBC29\\uC2DD\\uC73C\\uB85C rule\\uC744 \\uCD94\\uAC00\\uD558\\uBA74 \\uB2E4\\uC591\\uD55C \\uBA85\\uB839\\uC5B4\\uB4E4\\uC774 Shell\\uC744 \\uD1B5\\uD574\\uC11C \\uC2E4\\uD589\\uB418\\uACE0 \\uC788\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"rule\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` shell_in host\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"desc\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` notice shell activity within a host\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"condition\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"}),(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\tevt.type = execve and\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\tevt.dir = < and\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\tcontainer.id = host and\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string scalar\",children:\"\t\tproc.pname = sh\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"output\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"}),(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\tshell in a host\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string scalar\",children:\"\t\t(user=%user.name shell=%proc.name parent=%proc.pname cmdline=%proc.cmdline)\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"priority\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` WARNING\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB7F0\\uB370 \",(0,e.jsx)(n.a,{href:\"https://man7.org/linux/man-pages/man2/mkdir.2.html\",children:(0,e.jsx)(n.code,{children:\"mkdir\"})}),\"\\uC758 \\uACBD\\uC6B0\\uC5D0\\uB294 \",(0,e.jsx)(n.code,{children:\"evt.type = mkdir\"}),\"\\uB85C \\uCD94\\uAC00\\uD574\\uC918\\uC57C\\uD55C\\uB2E4. \\uB530\\uB77C\\uC11C condition\\uC5D0\\uC11C \",(0,e.jsx)(n.code,{children:\"in\"}),\"\\uC73C\\uB85C \",(0,e.jsx)(n.code,{children:\"mkdir\"}),\"\\uB3C4 \\uCD94\\uAC00\\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"rule\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` shell_in_container\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"desc\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` notice shell activity within a container\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"condition\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"}),(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\tevt.type in (execve, mkdir) and\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\tevt.dir = < and\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\tcontainer.id != host and\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string scalar\",children:\"\t\tproc.pname = sh\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"output\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"}),(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\tshell in a container\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\t(user=%user.name container_id=%container.id container_name=%container.name\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string scalar\",children:\"\t\tshell=%proc.name parent=%proc.pname cmdline=%proc.cmdline)\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"priority\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` WARNING\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB7EC\\uBA74 \\uC774\\uC81C \",(0,e.jsx)(n.code,{children:\"mkdir\"}),\"\\uB3C4 \\uC544\\uB798\\uCC98\\uB7FC \\uB85C\\uADF8\\uAC00 \\uB0A8\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ kubectl \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"exec\"}),` -it nginx-pod -- /bin/sh\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# mkdir /hellofalco\"}),`\n`]})]})}),(0,e.jsx)(n.pre,{className:\"language-json\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-json\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"hostname\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"node-name\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"output\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"20:29:06.389110693: Warning shell in a container (user=root container_id=6fec6323ae4c container_name=nginx  shell=mkdir parent=sh cmdline=mkdir /hellofalco) container_id=6fec6323ae4c container_image=docker.io/library/nginx container_image_tag=latest container_name=nginx k8s_ns=default k8s_pod_name=pod-name\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"priority\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Warning\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"rule\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"shell_in_container\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"source\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"syscall\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"tags\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"time\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"2024-05-03T20:29:06.389110693Z\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"output_fields\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.id\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"6fec6323ae4c\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.image.repository\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"docker.io/library/nginx\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.image.tag\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"latest\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"nginx\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"evt.time\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1714768146389110693\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"k8s.ns.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"default\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"k8s.pod.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"pod-name\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"proc.cmdline\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"mkdir /hellofalco\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"proc.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"mkdir\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"proc.pname\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"sh\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"user.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"root\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uD558\\uC9C0\\uB9CC \",(0,e.jsx)(n.code,{children:'echo \"hello world\" > example.txt'}),\" \\uBA85\\uB839\\uC5B4\\uB97C \\uD588\\uC744 \\uB54C\\uB294 \\uC704\\uC758 Rule\\uC5D0 \\uD3EC\\uD568\\uB418\\uC9C0 \\uC54A\\uB294\\uB2E4. \\uB530\\uB77C\\uC11C \\uC544\\uB798\\uCC98\\uB7FC \\uCD94\\uAC00\\uD574\\uBCF8\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"rule\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` shell_in_container\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"desc\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` notice shell activity within a container\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"condition\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"}),(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\tevt.type in (open, openat, openat2) and\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\tevt.dir = < and\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\tfd.filename in (example.txt) and\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string scalar\",children:\"\t\tcontainer.id != host\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"output\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"}),(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\tshell in a container\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\t\t(file=%fd.name evt_type=%evt.type user=%user.name container_id=%container.id container_name=%container.name\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string scalar\",children:\"\t\tshell=%proc.name parent=%proc.pname cmdline=%proc.cmdline)\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"\t\",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"priority\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` WARNING\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uC774\\uC81C \",(0,e.jsx)(n.code,{children:\"example.txt\"}),\"\\uB97C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \",(0,e.jsx)(n.code,{children:\"echo\"}),\"\\uB85C \\uC0DD\\uC131\\uD574\\uBCF8\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ kubectl \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"exec\"}),` -it nginx-pod -- /bin/sh\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:'# echo \"hello world\" > example.txt'}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB7EC\\uBA74 \",(0,e.jsx)(n.code,{children:\"fd.name\"}),\"\\uC744 \\uD1B5\\uD574\\uC11C \\uC218\\uC815\\uB41C \\uD30C\\uC77C\\uBA85\\uC744 \\uC54C \\uC218 \\uC788\\uB2E4. \\uD558\\uC9C0\\uB9CC \",(0,e.jsx)(n.code,{children:'echo \"hello world\" > example.txt'}),\" \\uC804\\uCCB4 \\uBA85\\uB839\\uC5B4\\uB97C \\uB0A8\\uAE38 \\uBC29\\uBC95\\uC774 \\uBCF4\\uC774\\uC9C0 \\uC54A\\uB294\\uB2E4. \\u{1F914} \\uADF8\\uB9AC\\uACE0 \",(0,e.jsx)(n.code,{children:\"open\"}),\"\\uC758 \\uACBD\\uC6B0\\uC5D0\\uB294 \\uB108\\uBB34\\uB098 \\uB9CE\\uC740 \\uD504\\uB85C\\uC138\\uC2A4\\uC5D0\\uC11C call\\uD558\\uACE0 \\uC788\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uC880\\uB354 \\uAD6C\\uCCB4\\uC801\\uC778 \\uC870\\uAC74\\uC744 \\uC791\\uC131\\uD558\\uC9C0 \\uC54A\\uC73C\\uBA74 \\uBD88\\uD544\\uC694\\uD558\\uAC8C \\uB108\\uBB34 \\uB9CE\\uC740 \\uC774\\uBCA4\\uD2B8 \\uB85C\\uADF8\\uAC00 \\uB0A8\\uAC8C \\uB41C\\uB2E4. Falco stable Rule \\uC911\\uC5D0 \",(0,e.jsx)(n.code,{children:\"/var/log/auth.log\"}),\"\\uB098 \",(0,e.jsx)(n.code,{children:\"/var/log/syslog\"}),\"\\uCC98\\uB7FC \\uC2DC\\uC2A4\\uD15C \\uB85C\\uADF8\\uB4E4\\uC744 \\uC218\\uC815\\uD558\\uBA74 \\uC54C\\uB9BC\\uC774 \\uC624\\uB3C4\\uB85D \\uC124\\uC815\\uB418\\uC5B4 \\uC788\\uB2E4. \\uC774\\uCC98\\uB7FC \\uAD6C\\uCCB4\\uC801\\uC778 \\uC870\\uAC74\\uC744 \\uD1B5\\uD574\\uC11C \\uD2B9\\uC815 \\uD589\\uC704\\uC5D0 \\uB300\\uD55C \\uC774\\uBCA4\\uD2B8\\uB97C \\uBC1C\\uC0DD\\uC2DC\\uD0A8\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-json\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-json\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"hostname\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"node-name\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"output\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"21:41:34.978625505: Warning shell in a container (file=/example.txt evt_type=openat user=root container_id=6fec6323ae4c container_name=nginx  shell=sh parent=containerd-shim cmdline=sh) container_id=6fec6323ae4c container_image=docker.io/library/nginx container_image_tag=latest container_name=nginx k8s_ns=default k8s_pod_name=pod-name\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"priority\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Warning\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"rule\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"shell_in_container\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"source\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"syscall\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"tags\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"time\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"2024-05-03T21:41:34.978625505Z\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"output_fields\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.id\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"6fec6323ae4c\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.image.repository\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"docker.io/library/nginx\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.image.tag\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"latest\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"container.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"nginx\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"evt.time\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1714772494978625505\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"evt.type\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"openat\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"fd.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"/example.txt\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"k8s.ns.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"default\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"k8s.pod.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"pod-name\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"proc.cmdline\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"sh\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"proc.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"sh\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"proc.pname\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"containerd-shim\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"user.name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"root\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"\\uACB0\\uB860\",children:[(0,e.jsx)(n.a,{href:\"#\\uACB0\\uB860\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uACB0\\uB860\"]}),(0,e.jsxs)(n.p,{children:[\"Kubernetes Worker Node\\uC640 Pod Container\\uC5D0 \\uC9C1\\uC811 Terminal shell\\uC744 \\uD1B5\\uD574\\uC11C \\uC5B4\\uB5A0\\uD55C \\uBA85\\uB839\\uC5B4\\uB4E4\\uC744 \\uC2E4\\uD589\\uD588\\uC744 \\uB54C, \\uADF8\\uAC83\\uB4E4\\uC744 \\uBAA8\\uB450 \\uC800\\uC7A5\\uD558\\uACE0 \\uD2B9\\uC815\\uD55C \\uC870\\uAC74\\uC5D0 \\uB530\\uB77C \\uC2E4\\uC2DC\\uAC04 \\uC54C\\uB9BC\\uC744 \\uBCF4\\uB0B4\\uACE0 \\uC2F6\\uC5C8\\uB2E4. Falco\\uB294 Rule \\uC815\\uC758\\uB97C \\uD1B5\\uD574\\uC11C \\uC120\\uD0DD\\uC801\\uC73C\\uB85C Kernel event\\uB97C \\uBCF4\\uC548 \\uC704\\uD611\\uC774 \\uB418\\uB294 \\uC774\\uBCA4\\uD2B8\\uB97C \\uC800\\uC7A5\\uD558\\uACE0 \\uC2E4\\uC2DC\\uAC04\\uC131\\uC73C\\uB85C \\uC54C\\uB9BC\\uC744 \\uBCF4\\uB0BC \\uC218 \\uC788\\uB2E4. \\uB530\\uB77C\\uC11C Falco Rule\\uC744 \\uC815\\uC758\\uD558\\uC5EC sh, bash\\uB4F1\\uC774 Parent Process\\uB85C \\uC788\\uC73C\\uBA74\\uC11C \",(0,e.jsx)(n.code,{children:\"ls\"}),\", \",(0,e.jsx)(n.code,{children:\"cat\"}),\"\\uB4F1\\uC744 execve syscall\\uB85C \\uC2E4\\uD589\\uD560 \\uB54C event\\uB97C \\uC218\\uC9D1\\uD558\\uB3C4\\uB85D \\uD558\\uC600\\uB2E4. \\uD558\\uC9C0\\uB9CC \",(0,e.jsx)(n.code,{children:\"mkdir\"}),\" \\uBA85\\uB839\\uC5B4\\uC5D0 \\uB300\\uD574\\uC11C \",(0,e.jsx)(n.code,{children:\"mkdir\"}),\"\\uC774\\uB098 \",(0,e.jsx)(n.code,{children:\"mkdirat\"}),\" \\uC870\\uAC74\\uC744 \\uCD94\\uAC00 \\uD574\\uC918\\uC57C \\uD55C\\uB2E4. \",(0,e.jsx)(n.code,{children:'echo \"hello world\" > example.txt'}),\"\\uC758 \\uACBD\\uC6B0\\uC5D0\\uB294 example.txt\\uB97C \\uC218\\uC815/\\uC0AD\\uC81C\\uD560 \\uB54C \\uC774\\uBCA4\\uD2B8\\uB97C \\uB0A8\\uAE38 \\uC218 \\uC788\\uC9C0\\uB9CC, \\uC804\\uCCB4 shell\\uC5D0\\uC11C \\uC2E4\\uD589\\uD55C \\uC804\\uCCB4 \\uBA85\\uB839\\uC5B4\\uB97C \\uB0A8\\uAE30\\uB294 \\uBC29\\uBC95\\uC774 \\uBCF4\\uC774\\uC9C0 \\uC54A\\uC558\\uB2E4. \\uADF8\\uB9AC\\uACE0 \\uB108\\uBB34 \\uB9CE\\uC740 \\uACF3\\uC5D0\\uC11C \\uD30C\\uC77C\\uC744 \\uC77D\\uACE0 \\uC4F0\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uD544\\uD130 \\uC870\\uAC74\\uC744 \\uAD6C\\uCCB4\\uC801\\uC73C\\uB85C \\uC124\\uC815\\uD558\\uC9C0 \\uC54A\\uC73C\\uBA74 \\uC6D0\\uD558\\uC9C0 \\uC54A\\uC740 \\uC774\\uBCA4\\uD2B8\\uB4E4\\uC774 \\uB108\\uBB34 \\uB9CE\\uC774 \\uB0A8\\uAC8C \\uB41C\\uB2E4. \\uB530\\uB77C\\uC11C \\uB0B4\\uAC00 \\uC6D0\\uD558\\uB358 \\uAD6C\\uD604\\uC744 \\uC704\\uD574\\uC11C Falco\\uB294 \\uC801\\uD569\\uD558\\uC9C0 \\uC54A\\uB2E4\\uB294 \\uACB0\\uB860\\uC744 \\uB0B4\\uB9AC\\uAC8C \\uB418\\uC5C8\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:\"\\uADF8\\uB7EC\\uBA74 \\uC6D0\\uD558\\uB294 \\uAD6C\\uD604\\uC5D0 \\uB354 \\uC801\\uD569\\uD55C \\uB2E4\\uB978 \\uC624\\uD508\\uC18C\\uC2A4 \\uC18C\\uD504\\uD2B8\\uC6E8\\uC5B4\\uAC00 \\uC788\\uC744\\uAE4C? \\u{1F9D0}\"})]})}}var _=f;return b;})();\n;return Component;","toc":[{"value":"Helm으로 설치","url":"#helm으로-설치","depth":2},{"value":"Falco Rule","url":"#falco-rule","depth":2},{"value":"Custom Rule","url":"#custom-rule","depth":2},{"value":"원하는 결과","url":"#원하는-결과","depth":2},{"value":"결론","url":"#결론","depth":2}],"frontMatter":{"readingTime":{"text":"16 min read","minutes":15.315,"time":918900,"words":3063},"slug":"20240505-falco","fileName":"20240505-falco.md","title":"Falco를 활용하여 Terminal Shell 명령어 로그 수집하기","date":"2024-05-04T00:00:00.000Z","tags":["kubernetes","falco","devsecops"],"images":["/static/images/social-banner.png"],"summary":"Kubernetes Worker Node와 Pod Container에 Terminal shell로 접근하여 명령어를 입력하면 로그를 남기고, 경우에 따라서 알림을 보내고 싶었다. CNCF 졸업한 Project인 Falco를 활용하면 이를 구현할 수 있지 않을까 하여 테스트를 해보게 되었다. Falco는 kernel module이나 eBPF probe등을 통해서 kernel event를 저장하고, 설정된 rule에 따라서 해당 event를 filter하여 원하는 output 형태로 저장한다. Falco는 모든 로그를 저장하기보다는 Rule에 따라 선택적으로 보안 위협이 있는 이벤트를 수집하고 실시간으로 알림하는 것이 목적이다. 따라서 Falco를 통해서 원하던 기능을 구현하는 것은 합리적인 방법이 아닌 것으로 판단 된다."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.15,"time":9000,"words":30},"slug":["default"],"fileName":"default.md","name":"Jay","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"OpenTelmetry로 auth.log와 syslog 수집하기","date":"2024-05-01T00:00:00.000Z","tags":["kubernetes","opentelemetry","devsecops"],"images":["/static/images/social-banner.png"],"summary":"Ubuntu 20.04 서버의 auth.log, syslog 로그 값들을 OpenTelemetry를 통해서 수집하고 싶었다. 처음에는 Filelog Receiver를 통해서 수집하려고 하였고, rsyslog의 설정값을 변경하여 Filelog로 수집하도록 구성했다. 그런데 이후에 Syslog Receiver가 존재하는 것을 확인하게 되었고, 훨씬 간단하게 syslog를 수집할 수 있었다.","slug":"20240501-opentelemetry-syslog"},"next":null},"__N_SSG":true}