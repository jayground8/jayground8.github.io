{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var r=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var i=a=>l(a,\"__esModule\",{value:!0});var N=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),u=(a,s)=>{i(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let n of h(s))!m.call(a,n)&&n!==\"default\"&&l(a,n,{get:()=>s[n],enumerable:!(c=d(s,n))||c.enumerable});return a},g=a=>k(i(l(a!=null?r(p(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=N((L,t)=>{t.exports=_jsx_runtime});var w={};u(w,{default:()=>y,frontmatter:()=>_});var e=g(o()),_={title:\"GPTCache\",date:\"2024-01-06\",tags:[\"GPTCache\",\"ai\"],images:[\"/static/images/social-banner.png\"],summary:\"\"};function b(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",blockquote:\"blockquote\",code:\"code\",pre:\"pre\",ul:\"ul\",li:\"li\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"semantic-caching\",children:[(0,e.jsx)(n.a,{href:\"#semantic-caching\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Semantic Caching\"]}),(0,e.jsxs)(n.p,{children:[\"\\uC0DD\\uC131\\uD615 AI\\uC5D0\\uAC8C \\uC9C8\\uBB38\\uC744 \\uD560 \\uB54C, \\uBB38\\uC790\\uC5F4 \\uADF8\\uB300\\uB85C \\uB3D9\\uC77C\\uD55C \\uC9C8\\uBB38\\uC5D0 \\uB300\\uD574\\uC11C cache\\uB97C \\uD55C\\uB2E4\\uBA74 cache hit rate\\uC774 \\uC0C1\\uB2F9\\uD788 \\uB5A8\\uC5B4\\uC838\\uC11C \\uBE44\\uD6A8\\uC728\\uC801\\uC778 \\uAC83\\uC774 \\uC790\\uBA85\\uD588\\uB2E4. \\uADF8\\uB798\\uC11C chatGPT\\uB098 Llama 2 \\uAC19\\uC740 LLM\\uC744 \\uC0AC\\uC6A9\\uD560 \\uB54C, \\uC5B4\\uB5BB\\uAC8C cache\\uB97C \\uD560 \\uC218 \\uC788\\uC744\\uC9C0 \\uAD81\\uAE08\\uD574\\uC84C\\uB2E4. \\uCC3E\\uC544\\uBCF4\\uB2C8 \\uC624\\uD508\\uC18C\\uC2A4 \\uD504\\uB85C\\uC81D\\uD2B8\\uC778 \",(0,e.jsx)(n.a,{href:\"https://github.com/zilliztech/GPTCache\",children:\"GPTCache\"}),\"\\uAC00 \\uC788\\uC5C8\\uACE0, \\uC544\\uB798\\uCC98\\uB7FC \\uC124\\uBA85\\uD558\\uACE0 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"However, using an exact match approach for LLM caches is less effective due to the complexity and variability of LLM queries, resulting in a low cache hit rate. To address this issue, GPTCache adopt alternative strategies like semantic caching. Semantic caching identifies and stores similar or related queries, thereby increasing cache hit probability and enhancing overall caching efficiency.\"})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"Semantic caching\"}),\"\\uC774\\uB77C\\uB294 \\uC6A9\\uC5B4\\uAC00 \\uB098\\uC624\\uB294\\uB370, \\uC758\\uBBF8\\uC801\\uC73C\\uB85C \\uAC19\\uC740 \\uAC83\\uC744 cache\\uD560 \\uC218 \\uC788\\uB2E4\\uB294 \\uAC83\\uC744 \\uC758\\uBBF8\\uD55C\\uB2E4. \\uC5B4\\uB5BB\\uAC8C \",(0,e.jsx)(n.code,{children:\"Semantic caching\"}),\"\\uC774 \\uB418\\uB294\\uC9C0\\uB294 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC124\\uBA85\\uB418\\uC5B4 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"GPTCache employs embedding algorithms to convert queries into embeddings and uses a vector store for similarity search on these embeddings.\"})}),(0,e.jsx)(n.p,{children:\"LLM\\uC5D0\\uAC8C \\uC9C8\\uBB38\\uC744 \\uD558\\uBA74(Query) \\uADF8 \\uC9C8\\uBB38\\uC744 \\uCEF4\\uD4E8\\uD130\\uAC00 \\uC774\\uD574\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D vector \\uD615\\uC2DD\\uC758 \\uB370\\uC774\\uD130\\uB85C \\uB9CC\\uB4E4\\uACE0(Embeddings), \\uADF8\\uAC83\\uC744 \\uC800\\uC7A5\\uC18C\\uC5D0 \\uC800\\uC7A5\\uD55C\\uB2E4. \\uC774\\uC81C \\uB2E4\\uB978 \\uC9C8\\uBB38\\uC744 \\uD588\\uC744 \\uB54C \\uC774\\uBBF8 \\uC720\\uC0AC\\uD55C \\uC9C8\\uBB38\\uC744 \\uD588\\uB294\\uC9C0\\uB97C \\uD310\\uB2E8\\uD558\\uAC8C \\uB418\\uB294\\uB370, \\uC774\\uAC83\\uC740 \\uC720\\uC0AC\\uD55C Embedding\\uC774 \\uC788\\uB294\\uC9C0 \\uD655\\uC778\\uD558\\uB294 \\uC791\\uC5C5\\uC774 \\uC9C4\\uD589\\uB41C\\uB2E4. \\uCD5C\\uC885\\uC801\\uC73C\\uB85C \\uC720\\uC0AC\\uD55C Embedding \\uC788\\uB2E4\\uBA74 cache\\uB41C \\uB370\\uC774\\uD130\\uB97C \\uC0AC\\uC6A9\\uD558\\uACE0, \\uC5C6\\uB2E4\\uBA74 LLM\\uC5D0\\uC11C \\uC0C8\\uB85C\\uC6B4 \\uB2F5\\uBCC0\\uC744 \\uC0DD\\uC131\\uD558\\uAC8C \\uB41C\\uB2E4.\"}),(0,e.jsxs)(n.h2,{id:\"testing-with-langchain\",children:[(0,e.jsx)(n.a,{href:\"#testing-with-langchain\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Testing with Langchain\"]}),(0,e.jsxs)(n.p,{children:[\"GPTCache\\uB294 \",(0,e.jsx)(n.code,{children:\"Langchain\"}),\"\\uC744 \\uC9C0\\uC6D0\\uD558\\uACE0, \",(0,e.jsx)(n.a,{href:\"https://python.langchain.com/docs/integrations/llms/llm_caching#gptcache\",children:\"\\uBB38\\uC11C\\uC5D0\\uC11C \\uC27D\\uAC8C GPTCache\\uB97C \\uC5F0\\uB3D9\\uD558\\uB294 \\uBC29\\uBC95\"}),\"\\uC744 \\uC124\\uBA85\\uD558\\uACE0 \\uC788\\uB2E4. \\uADF8\\uB798\\uC11C \",(0,e.jsx)(n.code,{children:\"Langchain\"}),\"\\uC73C\\uB85C \\uC0AC\\uC6A9\\uD558\\uC5EC \\uD14C\\uC2A4\\uD2B8\\uB97C \\uD558\\uAC8C \\uB418\\uC5C8\\uB2E4. \",(0,e.jsx)(n.a,{href:\"https://python.langchain.com/docs/get_started/quickstart\",children:\"Langchain \\uACF5\\uC2DD \\uBB38\\uC11C\\uC758 Quickstart\"}),\"\\uB97C \\uB530\\uB77C\\uC11C \\uC9C4\\uD589\\uD558\\uC600\\uACE0, Mac\\uC5D0\\uC11C \",(0,e.jsx)(n.a,{href:\"https://ollama.ai/download\",children:\"Ollama\"}),\"\\uB97C \\uC124\\uCE58\\uD558\\uC5EC \\uB85C\\uCEEC\\uC5D0\\uC11C \",(0,e.jsx)(n.code,{children:\"llama2\"}),\" \\uBAA8\\uB378\\uC744 \\uC0AC\\uC6A9\\uD558\\uC600\\uB2E4. \",(0,e.jsx)(n.code,{children:\"langserve\"}),\" \\uB77C\\uC774\\uBE0C\\uB7EC\\uB9AC\\uB97C \\uD1B5\\uD574\\uC11C FastAPI framework\\uB85C API server\\uB97C \\uB9CC\\uB4E4 \\uC218 \\uC788\\uC5C8\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:\"\\uD544\\uC694\\uD55C \\uBAA8\\uB4C8\\uB4E4\\uC744 virtualenv\\uC5D0 \\uC124\\uCE58\\uB97C \\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pyenv virtualenv \",(0,e.jsx)(n.span,{className:\"token number\",children:\"3.9\"}),` langchain\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`pyenv activate langchain\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pip \",(0,e.jsx)(n.span,{className:\"token function\",children:\"install\"}),` langchain\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pip \",(0,e.jsx)(n.span,{className:\"token function\",children:\"install\"}),` gptcache\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pip \",(0,e.jsx)(n.span,{className:\"token function\",children:\"install\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"langserve[server]\"'}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uADF8\\uB9AC\\uACE0 \\uC544\\uB798\\uCC98\\uB7FC \\uCF54\\uB4DC\\uB97C \\uC791\\uC131\\uD558\\uC5EC \\uC2E4\\uD589\\uC744 \\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-py\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-py\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` hashlib\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" fastapi \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` FastAPI\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" langserve \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` add_routes\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" gptcache \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` Cache\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" gptcache\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"adapter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"api \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` init_similar_cache\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" langchain\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"cache \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` GPTCache\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" langchain_community\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"llms \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` Ollama\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" langchain\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"prompts \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` ChatPromptTemplate\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" langchain_core\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"output_parsers \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` StrOutputParser\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" langchain\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token builtin\",children:\"globals\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` set_llm_cache\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"app \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" FastAPI\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    title\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"LangChain Server\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    version\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"1.0\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    description\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:`\"A simple api server using Langchain's Runnable interfaces\"`}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"get_hashed_name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"name\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"return\"}),\" hashlib\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"sha256\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"name\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"encode\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"hexdigest\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"def\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"init_gptcache\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cache_obj\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" Cache\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" llm\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token builtin\",children:\"str\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    hashed_llm \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" get_hashed_name\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"llm\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    init_similar_cache\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"cache_obj\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"cache_obj\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" data_dir\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsxs)(n.span,{className:\"token string-interpolation\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:'f\"similar_cache_'}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"hashed_llm\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"'})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"set_llm_cache\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"GPTCache\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"init_gptcache\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"prompt \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" ChatPromptTemplate\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"from_messages\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"system\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"You are world class technical documentation writer.\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"user\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"{input}\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"llm \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" Ollama\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"model\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"llama2\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"output_parser \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" StrOutputParser\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"chain \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" prompt \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" llm \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),` output_parser\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"add_routes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    chain\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    path\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"/myllm\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" __name__ \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"__main__\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` uvicorn\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    uvicorn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"run\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"app\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" host\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"localhost\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" port\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"8000\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uC774\\uC81C localhost\\uC5D0 \\uC2E4\\uD589\\uC911\\uC778 API \\uC11C\\uBC84\\uC5D0 curl \\uC9C8\\uC758\\uB97C \\uD574\\uBCF8\\uB2E4. \\uCC98\\uC74C\\uC5D0\\uB294 \\uC2DC\\uAC04\\uC774 \\uC880 \\uAC78\\uB9AC\\uC9C0\\uB9CC, \\uB450\\uBC88 \\uC9F8 \\uC694\\uCCAD\\uBD80\\uD130\\uB294 \\uB530\\uB974\\uAC8C \\uC751\\uB2F5\\uC774 \\uC624\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"curl\"}),\" --location --request POST \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'http://localhost:8000/myllm/invoke'\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    --header \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'Content-Type: application/json'\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    --data-raw \",(0,e.jsx)(n.span,{className:\"token string\",children:`'{\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`        \"input\": {\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"input\": \"what is the best way to learn new languages?\"\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`        }\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:\"    }'\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uADF8\\uB9AC\\uACE0 \\uC774\\uC81C \\uC544\\uB798\\uC640 \\uAC19\\uC740 query \\uBB38\\uC7A5\\uC744 \\uD574\\uB3C4 Cache \\uAC12\\uC73C\\uB85C \\uBC14\\uB85C \\uC751\\uB2F5\\uD558\\uB294 \\uAC83\\uB3C4 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`what is the best way to learn new languages?\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`what is best way to learn new languages?\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`what is best way to run new languages?\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`what is best way to learn languages?\n`})]})}),(0,e.jsx)(n.p,{children:\"\\uADF8\\uB7F0\\uB370 \\uB2E4\\uB978 \\uB2F5\\uBCC0\\uC744 \\uAE30\\uB300\\uD560 \\uB9CC\\uD55C \\uC9C8\\uBB38\\uC5D0\\uC11C\\uB3C4 \\uB3D9\\uC77C\\uD55C Cache \\uAC12\\uC73C\\uB85C \\uC751\\uB2F5\\uD55C\\uB2E4. False positive \\uACB0\\uACFC\\uB3C4 \\uC27D\\uAC8C \\uD655\\uC778\\uC774 \\uB418\\uC5C8\\uB2E4.\"}),(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`what is the best way to learn Korean?\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Where is the best place to study?\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`How do you study math?\n`})]})}),(0,e.jsx)(n.p,{children:\"\\uC774\\uC81C \\uC644\\uC804 \\uB2E4\\uB978 \\uC9C8\\uBB38\\uC744 \\uD558\\uBA74 LLM\\uC73C\\uB85C\\uBD80\\uD130 \\uC0C8\\uB86D\\uAC8C \\uB2F5\\uBCC0\\uC744 \\uC0DD\\uC131\\uD558\\uACE0, \\uADF8\\uB2E4\\uC74C\\uC5D0 \\uC720\\uC0AC\\uD55C \\uC9C8\\uBB38\\uC5D0\\uB294 Cache \\uAC12\\uC744 \\uB2E4\\uC2DC \\uC0AC\\uC6A9\\uD558\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uC5C8\\uB2E4.\"}),(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`what is embeddings?\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`please explain embeddings?\n`})]})}),(0,e.jsxs)(n.h2,{id:\"init_similar_cache\\uC758-default-\\uC124\\uC815\",children:[(0,e.jsx)(n.a,{href:\"#init_similar_cache\\uC758-default-\\uC124\\uC815\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"init_similar_cache\\uC758 default \\uC124\\uC815\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"similar_cache_{hash\\uAC12}\"}),\" \\uB514\\uB809\\uD130\\uB9AC \\uC548\\uC5D0\\uB294 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uB450\\uAC1C\\uC758 \\uD30C\\uC77C\\uC774 \\uC0DD\\uAE34\\uB2E4.\"]}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:\"sqlite.db\"}),(0,e.jsx)(n.li,{children:\"faiss.index\"})]}),(0,e.jsx)(n.p,{children:\"\\uBA3C\\uC800 sqlite database\\uC5D0 data\\uB97C \\uC0B4\\uD3B4\\uBCF4\\uAE30 \\uC704\\uD574\\uC11C sqlite3 \\uBA85\\uB839\\uC5B4\\uB85C \\uC0DD\\uC131\\uB41C table\\uACFC schema\\uB97C \\uC0B4\\uD3B4\\uBCF4\\uC790.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`sqlite3 sqlite.db\n`})})}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"sqlite\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),` .tables\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`gptcache_answer        gptcache_question_dep  gptcache_session\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`gptcache_question      gptcache_report\n`})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"gptcache_question\"}),\" \\uD14C\\uC774\\uBE14\\uC5D0 \",(0,e.jsx)(n.code,{children:\"embedding_data\"}),\"\\uB77C\\uB294 column\\uC774 \\uC788\\uACE0, \\uC774\\uC81C Query\\uAC00 Embedding\\uC73C\\uB85C \\uBCC0\\uD658\\uB418\\uC5B4\\uC11C binary\\uB85C \\uC800\\uC7A5\\uB418\\uACE0 \\uC788\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"sqlite\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),` .schema gptcache_question\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"CREATE TABLE gptcache_question \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token function\",children:\"id\"}),` INTEGER NOT NULL,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        question VARCHAR\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"3000\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),` NOT NULL,\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`        create_on DATETIME,\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`        last_access DATETIME,\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`        embedding_data BLOB,\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`        deleted INTEGER,\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        PRIMARY KEY \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"id\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB9AC\\uACE0 \",(0,e.jsx)(n.code,{children:\"gptcache_report\"}),\" \\uD14C\\uC774\\uBE14\\uC5D0\\uC11C\\uB294 \",(0,e.jsx)(n.code,{children:\"similarity\"}),\"\\uB77C\\uB294 column\\uC774 \\uC788\\uACE0, \\uC774\\uAC83\\uC740 \\uC720\\uC0AC\\uB3C4 \\uAC12\\uC744 \\uB2F4\\uACE0 \\uC788\\uB2E4. \\uC704\\uC5D0\\uC11C \",(0,e.jsx)(n.code,{children:\"How do you study math?\"}),\"\\uB3C4 \\uB3D9\\uC77C\\uD55C \\uB2F5\\uBCC0\\uC744 \\uC5BB\\uC5C8\\uB294\\uB370, \\uC774 \",(0,e.jsx)(n.code,{children:\"similarity\"}),\" \\uAC12\\uC774 3.2\\uC774\\uB2E4. \",(0,e.jsx)(n.code,{children:\"what is best way to run new languages?\"}),\" learn\\uC744 run\\uC73C\\uB85C \\uC798\\uBABB \\uC801\\uC740 \\uACBD\\uC6B0\\uC5D0\\uB294 \\uC774 \\uAC12\\uC774 3.98\\uC774\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"sqlite\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),` .schema gptcache_report\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"CREATE TABLE gptcache_report \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token function\",children:\"id\"}),` INTEGER NOT NULL,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        user_question VARCHAR\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"3000\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),` NOT NULL,\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`        cache_question_id INTEGER NOT NULL,\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        cache_question VARCHAR\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"3000\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),` NOT NULL,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        cache_answer VARCHAR\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"3000\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),` NOT NULL,\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`        similarity FLOAT NOT NULL,\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`        cache_delta_time FLOAT NOT NULL,\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`        cache_time DATETIME,\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        extra VARCHAR\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"3000\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        PRIMARY KEY \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"id\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://gptcache.readthedocs.io/en/latest/configure_it.html#introduction-to-gptcache-initialization\",children:\"GPTCache \\uBB38\\uC11C\\uC5D0\\uC11C init_similar_cache method\\uC758 \\uC778\\uC790 \\uAC12\\uC744 \\uC5B4\\uB5BB\\uAC8C \\uC904 \\uC218 \\uC788\\uB294\\uC9C0 \\uC124\\uBA85\"}),\"\\uC774 \\uB418\\uC5B4 \\uC788\\uB2E4. embedding \\uD30C\\uB77C\\uBBF8\\uD130\\uB97C \\uC124\\uC815\\uD558\\uC9C0 \\uC54A\\uC73C\\uBA74, default\\uB85C onnx+sqlite+faiss\\uB97C \\uC0AC\\uC6A9\\uD558\\uAC8C \\uB41C\\uB2E4. Embedding\\uC744 \\uC0DD\\uC131\\uD560 \\uB54C ONNX\\uB97C \\uC0AC\\uC6A9\\uD558\\uACE0, \\uC800\\uC7A5\\uC18C\\uB294 Sqlite\\uB97C \\uC0AC\\uC6A9\\uD558\\uACE0, \\uBE60\\uB978 Similarity \\uAC80\\uC0C9\\uC744 \\uC704\\uD574\\uC11C Faiss\\uB97C \\uC0AC\\uC6A9\\uD558\\uAC8C \\uB41C\\uB2E4. \\uADF8\\uB798\\uC11C \",(0,e.jsx)(n.code,{children:\"faiss.index\"}),\" \\uD30C\\uC77C\\uC774 \\uC0DD\\uAE30\\uACE0, \",(0,e.jsx)(n.code,{children:\"pip list\"}),\"\\uB85C \\uBCF4\\uBA74 \",(0,e.jsx)(n.code,{children:\"faiss-cpu\"}),\"\\uB3C4 \\uC124\\uCE58 \\uB418\\uC5B4 \\uC788\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]})]})}}var y=b;return w;})();\n;return Component;","toc":[{"value":"Semantic Caching","url":"#semantic-caching","depth":2},{"value":"Testing with Langchain","url":"#testing-with-langchain","depth":2},{"value":"init_similar_cache의 default 설정","url":"#init_similar_cache의-default-설정","depth":2}],"frontMatter":{"readingTime":{"text":"5 min read","minutes":4.865,"time":291900,"words":973},"slug":"20240106-gptcache","fileName":"20240106-gptcache.md","title":"GPTCache","date":"2024-01-06T00:00:00.000Z","tags":["GPTCache","ai"],"images":["/static/images/social-banner.png"],"summary":""}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.15,"time":9000,"words":30},"slug":["default"],"fileName":"default.md","name":"Jay","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"OpenTelemetry with Minikube","date":"2023-12-31T00:00:00.000Z","tags":["opentelemetry","kubernetes"],"images":["/static/images/social-banner.png"],"summary":"OpenTelemetry collector를 사용하여 tracing과 logging을 같이 하는 것을 검토하였다. Kubernetes와 멀어져 있던 사이에 OpenTelemetry 커뮤니티가 엄청나게 성장한 것을 깨닫게 되었다. Log에 traceID를 남기고 그걸로 Tracing 정보를 볼 수 있도록 구성했고, Grafana 하나에서 통합적으로 볼 수 있도록 Loki와 Tempo를 Exporter로 사용했다. 아직 Python과 Nodejs에서는 Log쪽의 상태는 Development나 Experimental이기 때문에, receiver에서 filelog를 사용하여 Kubernetes log file을 fluentbit처럼 tail해서 가져오고 traceId를 log에 넣어주는 instrument libary를 사용했다.","slug":"20231231-open-telemetry"},"next":null},"__N_SSG":true}