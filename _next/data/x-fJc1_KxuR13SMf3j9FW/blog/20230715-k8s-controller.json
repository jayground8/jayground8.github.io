{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var r=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var t=a=>l(a,\"__esModule\",{value:!0});var h=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=>{t(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let e of p(s))!m.call(a,e)&&e!==\"default\"&&l(a,e,{get:()=>s[e],enumerable:!(c=d(s,e))||c.enumerable});return a},g=a=>k(t(l(a!=null?r(u(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=h((R,i)=>{i.exports=_jsx_runtime});var v={};N(v,{default:()=>f,frontmatter:()=>y});var n=g(o()),y={title:\"Kubernetes custom controller \\uC791\\uC131\\uD574\\uBCF4\\uAE30\",date:\"2023-07-15\",tags:[\"kubernetes\"],summary:\"Programming Kubernetes \\uCC45\\uC5D0\\uC11C \\uB098\\uC628 \\uC608\\uC81C\\uB97C \\uB530\\uB77C\\uC11C custom controller\\uB97C \\uC791\\uC131\\uD574\\uBCF4\\uC558\\uB2E4. CustomResourceDefinition\\uB97C \\uC5B4\\uB5BB\\uAC8C \\uC815\\uC758\\uD558\\uACE0, kubebuilder\\uB85C \\uC5B4\\uB5BB\\uAC8C \\uB098\\uB9CC\\uC758 business logic\\uC744 \\uC791\\uC131\\uD560 \\uC218 \\uC788\\uB294\\uC9C0 \\uC608\\uC81C\\uB97C \\uD1B5\\uD574\\uC11C \\uC774\\uD574\\uD588\\uB2E4.\"};function b(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({p:\"p\",code:\"code\",pre:\"pre\",span:\"span\",a:\"a\",ul:\"ul\",li:\"li\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"Programming Kubernetes\"}),\" \\uCC45\\uC5D0\\uC11C \\uB098\\uC628 \\uC608\\uC81C\\uB97C \\uB530\\uB77C\\uC11C custom controller\\uB97C \\uC791\\uC131\\uD574\\uBCF4\\uC558\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"curl\"}),\" -L -o kubebuilder \",(0,n.jsxs)(e.span,{className:\"token string\",children:['\"https://go.kubebuilder.io/dl/latest/',(0,n.jsxs)(e.span,{className:\"token variable\",children:[(0,n.jsx)(e.span,{className:\"token variable\",children:\"$(\"}),\"go \",(0,n.jsx)(e.span,{className:\"token function\",children:\"env\"}),\" GOOS\",(0,n.jsx)(e.span,{className:\"token variable\",children:\")\"})]}),\"/\",(0,n.jsxs)(e.span,{className:\"token variable\",children:[(0,n.jsx)(e.span,{className:\"token variable\",children:\"$(\"}),\"go \",(0,n.jsx)(e.span,{className:\"token function\",children:\"env\"}),\" GOARCH\",(0,n.jsx)(e.span,{className:\"token variable\",children:\")\"})]}),'\"']}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\\\\\"}),`n\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"chmod\"}),\" +x kubebuilder \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"&&\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"mv\"}),` kubebuilder /usr/local/bin/\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`kubebuilder init --domain study.jayground8\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`kubebuilder create api --group cnat --version v1alpha1 --kind At\n`})]})}),(0,n.jsx)(e.p,{children:\"\\uC774\\uC81C Kind At\\uC758 Spec\\uC5D0 \\uC5B8\\uC81C \\uC2E4\\uD589\\uB420\\uC9C0 Schdule\\uACFC \\uC5B4\\uB5A4 \\uBA85\\uB839\\uC5B4\\uAC00 \\uC2E4\\uD589\\uB420\\uC9C0 Command \\uD504\\uB85C\\uD37C\\uD2F0\\uB4E4\\uC744 \\uAC00\\uC9C0\\uB3C4\\uB85D \\uC815\\uC758\\uD55C\\uB2E4. \\uADF8\\uB9AC\\uACE0 Kind At\\uC758 Status\\uB294 Phase \\uD504\\uB85C\\uD37C\\uD2F0\\uB97C \\uAC00\\uC9C0\\uACE0, PENDING, RUNNING, DONE \\uAC12\\uC744 \\uAC00\\uC9C0\\uB3C4\\uB85D \\uD560 \\uAC83\\uC774\\uB2E4.\"}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.code,{children:\"api/v1alpha1/at_types.go\"})}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-go\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tPhasePending \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"PENDING\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tPhaseRunning \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"RUNNING\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tPhaseDone    \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"DONE\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" AtSpec \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tSchedule \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'`json:\"schedule,omitempty\"`'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tCommand  \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'`json:\"command,omitempty\"`'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" AtStatus \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tPhase \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'`json:\"phase,omitempty\"`'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"make manifest\"}),\" \\uBA85\\uB839\\uC5B4\\uB97C \\uC2E4\\uD589\\uD558\\uBA74 \",(0,n.jsx)(e.code,{children:\"/config/crd/bases/cnat.study.jayground8_ats.yaml\"}),\" \\uD30C\\uC77C\\uC774 \\uC544\\uB798\\uCC98\\uB7FC \\uC0DD\\uC131\\uB41C\\uB2E4. \",(0,n.jsx)(e.code,{children:\"at_types.go\"}),\"\\uC5D0 \\uC815\\uC758\\uD55C \\uB0B4\\uC6A9\\uB300\\uB85C \",(0,n.jsx)(e.code,{children:\"CustomResourceDefinition\"}),\" \\uC815\\uC758\\uAC00 \\uB418\\uC5C8\\uB2E4. \\uB0B4\\uAC00 \\uCC38\\uACE0\\uD55C \",(0,n.jsx)(e.code,{children:\"Programming Kubernetes\"}),\" \\uCC45\\uC740 2019\\uB144\\uC5D0 \\uBC1C\\uAC04\\uB418\\uC5C8\\uACE0, \",(0,n.jsx)(e.code,{children:\"apiextensions.k8s.io/v1beta1\"}),\" \\uBC84\\uC804\\uC744 \\uC0AC\\uC6A9\\uD558\\uACE0 \\uC788\\uB2E4. \\uD558\\uC9C0\\uB9CC \",(0,n.jsx)(e.a,{href:\"https://kubernetes.io/blog/2021/07/14/upcoming-changes-in-kubernetes-1-22/\",children:\"Kubernetes v1.22\\uC5D0\\uC11C apiextensions.k8s.io/v1beta1\\uB294 \\uC81C\\uAC70 \\uB418\\uC5C8\\uB2E4.\"}),\" \\uB098\\uB294 Minikube\\uB85C Local\\uC5D0\\uC11C Kubernetes v1.26.3\\uC73C\\uB85C \\uD14C\\uC2A4\\uD2B8\\uB97C \\uD574\\uBCF4\\uACE0 \\uC788\\uB2E4. \",(0,n.jsx)(e.a,{href:\"https://kubernetes.io/docs/reference/using-api/deprecation-guide/#customresourcedefinition-v122\",children:\"v1\\uC5D0\\uC11C \\uBCC0\\uACBD\\uB41C \\uC810\\uC744 \\uBB38\\uC11C\\uB85C \\uD655\\uC778\"}),\"\\uD558\\uC600\\uACE0, \\uCC45\\uC5D0\\uC11C \\uC0AC\\uC6A9\\uB41C \\uC608\\uC81C\\uC5D0\\uC11C\\uB294 \\uC544\\uB798\\uC640 \\uAC19\\uC740 \\uC810\\uC774 \\uBCC0\\uACBD\\uC774 \\uB418\\uC5C8\\uB2E4.\"]}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:\"spec.version is removed in v1; use spec.versions instead\"}),(0,n.jsx)(e.li,{children:\"spec.subresources is removed in v1; use spec.versions[*].subresources instead\"}),(0,n.jsx)(e.li,{children:\"spec.versions[*].schema.openAPIV3Schema is now required when creating v1 CustomResourceDefinition objects, and must be a structural schema\"})]}),(0,n.jsx)(e.pre,{className:\"language-yaml\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-yaml\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"---\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` apiextensions.k8s.io/v1\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"kind\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` CustomResourceDefinition\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"metadata\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"annotations\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"controller-gen.kubebuilder.io/version\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` v0.12.0\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` ats.cnat.study.jayground8\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"spec\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"group\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` cnat.study.jayground8\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"names\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"kind\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` At\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"listKind\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` AtList\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"plural\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` ats\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"singular\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` at\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"scope\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` Namespaced\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"versions\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` v1alpha1\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"schema\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"openAPIV3Schema\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"description\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` At is the Schema for the ats API\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"properties\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` string\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"kind\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` string\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"metadata\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` object\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"spec\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"properties\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"command\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` string\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"schedule\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` string\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` object\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"status\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"properties\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"phase\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` string\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` object\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` object\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"served\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"storage\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"subresources\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"status\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"OpenAPI V3 schema\\uB97C \\uC815\\uC758\\uD558\\uBA74 apiextensions-apiserver\\uC5D0\\uC11C validation\\uC744 \\uD558\\uAC8C \\uB41C\\uB2E4. \\uADF8\\uB9AC\\uACE0 kubectl\\uB97C \\uC0AC\\uC6A9\\uD560 \\uB54C \\uD574\\uB2F9 \\uC815\\uBCF4\\uB97C \\uD1B5\\uD574\\uC11C client-side validation\\uC744 \\uD55C\\uB2E4. \",(0,n.jsx)(e.code,{children:\"required\"}),\" field\\uB97C \\uC124\\uC815\\uD558\\uB824\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uCD94\\uAC00\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-go\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// AtSpec defines the desired state of At\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" AtSpec \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// +kubebuilder:validation:Required\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tSchedule \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'`json:\"schedule\"`'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// +kubebuilder:validation:Required\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tCommand  \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'`json:\"command\"`'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\uB2E4\\uC2DC \",(0,n.jsx)(e.code,{children:\"make manifest\"}),\"\\uB97C \\uD574\\uBCF4\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \",(0,n.jsx)(e.code,{children:\"required\"}),\"\\uAC00 \\uCD94\\uAC00\\uB41C \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-yaml\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-yaml\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"spec\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"description\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` AtSpec defines the desired state of At\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"properties\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"command\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` string\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"schedule\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` string\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"required\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` command\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` schedule\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` object\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"make install\"}),\"\\uB85C \\uBCC0\\uACBD\\uB41C CRD\\uB97C \\uC801\\uC6A9\\uD558\\uACE0, \\uC544\\uB798\\uCC98\\uB7FC required\\uB85C \\uC815\\uC758\\uB41C command property\\uAC00 \\uBE60\\uC9C0\\uBA74 \",(0,n.jsx)(e.code,{children:'The At \"example-at\" is invalid: spec.command: Required value'}),\" \\uBA54\\uC138\\uC9C0\\uB97C \\uBCF4\\uC5EC\\uC8FC\\uAC8C \\uB41C\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-yaml\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-yaml\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` cnat.study.jayground8/v1alpha1\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"kind\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` At\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"metadata\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"labels\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"controller-tools.k8s.io\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'1.0'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" example\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`at\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"spec\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"schedule\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'2023-07-14T10:12:00Z'\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\uC774\\uC81C \\uD2B9\\uC815 Regex\\uB85C validation\\uC744 \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB294\\uB370, kubebuilder\\uC5D0\\uC11C \\uC544\\uB798\\uCC98\\uB7FC \\uC815\\uC758\\uD558\\uC5EC \",(0,n.jsx)(e.code,{children:\"make manifest\"}),\"\\uB97C \\uD560 \\uC218 \\uC788\\uB2E4. schedule property\\uB294 regex pattern\\uC744 \\uC815\\uC758\\uD574\\uB1A8\\uAE30 \\uB54C\\uBB38\\uC5D0,regex\\uAC00 \\uB9DE\\uC9C0 \\uC54A\\uC73C\\uBA74 \",(0,n.jsx)(e.code,{children:`The At \"example-at\" is invalid: spec.schedule: Invalid value: \"2019-04-12T10:12Z\": spec.schedule in body should match '^\\\\d{4}-[01]\\\\d-[0-3]\\\\dT[0-2]\\\\d:[0-5]\\\\d:[0-5]\\\\d'`}),\" \\uBA54\\uC138\\uC9C0\\uB97C \\uBCF4\\uC5EC\\uC8FC\\uAC8C \\uB41C\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-go\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// AtSpec defines the desired state of At\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" AtSpec \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// +kubebuilder:validation:Required\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// +kubebuilder:validation:Pattern=`^\\\\d{4}-[01]\\\\d-[0-3]\\\\dT[0-2]\\\\d:[0-5]\\\\d:[0-5]\\\\d`\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tSchedule \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'`json:\"schedule\"`'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// +kubebuilder:validation:Required\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tCommand  \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'`json:\"command\"`'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\uAE30\\uBCF8 \\uC124\\uC815\\uC5D0\\uC11C \",(0,n.jsx)(e.code,{children:\"kubectl\"}),\"\\uB85C Kind At\\uC744 \\uAC00\\uC838\\uC654\\uC744 \\uB54C \\uC544\\uB798\\uCC98\\uB7FC \\uBCF4\\uC774\\uAC8C \\uB41C\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`$ kubectl get ats\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`NAME         AGE\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`example-at   4s\n`})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"additionalPrinterColumns\"}),\"\\uB97C \\uC544\\uB798\\uC640 \\uAC19\\uC774 Kubebuilder\\uC5D0\\uC11C \\uC815\\uC758\\uD574\\uC8FC\\uBA74\"]}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-go\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:'//+kubebuilder:printcolumn:name=\"schedule\",type=string,JSONPath=`.spec.schedule`'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:'//+kubebuilder:printcolumn:name=\"command\",type=string,JSONPath=`.spec.command`'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:'//+kubebuilder:printcolumn:name=\"phase\",type=string,JSONPath=`.status.phase`'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// At is the Schema for the ats API\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" At \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tmetav1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"TypeMeta   \",(0,n.jsx)(e.span,{className:\"token string\",children:'`json:\",inline\"`'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tmetav1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ObjectMeta \",(0,n.jsx)(e.span,{className:\"token string\",children:'`json:\"metadata,omitempty\"`'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tSpec   AtSpec   \",(0,n.jsx)(e.span,{className:\"token string\",children:'`json:\"spec,omitempty\"`'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tStatus AtStatus \",(0,n.jsx)(e.span,{className:\"token string\",children:'`json:\"status,omitempty\"`'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"\\uC774\\uC81C\\uB294 \\uC544\\uB798\\uCC98\\uB7FC \\uC815\\uC758\\uB41C \\uCD94\\uAC00 \\uC815\\uBCF4\\uAC00 \\uBCF4\\uC774\\uAC8C \\uB41C\\uB2E4.\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`$ kubectl get ats\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`NAME         SCHEDULE               COMMAND    PHASE\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"example-at   \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2023\"}),\"-07-14T10:12:00Z   \",(0,n.jsx)(e.span,{className:\"token builtin class-name\",children:\"echo\"}),` YAY   DONE\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.a,{href:\"https://kubernetes.io/docs/tasks/extend-kubernetes/custom-resources/custom-resource-definitions/#subresources\",children:\"Custom Resource\\uB294 subresource\\uB85C /status\\uC640 /scale\\uC774 \\uC9C0\\uC6D0\\uB41C\\uB2E4.\"}),\" kubebuilder\\uC5D0\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC774 subresource status\\uB97C enable\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uD588\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsx)(e.code,{className:\"code-highlight language-go\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"//+kubebuilder:subresource:status\"}),`\n`]})})}),(0,n.jsx)(e.p,{children:\"\\uB530\\uB77C\\uC11C subresource\\uB97C \\uD1B5\\uD574\\uC11C RBAC\\uB97C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uBD84\\uB9AC\\uD560 \\uC218 \\uC788\\uB2E4. metadata\\uB098 spec \\uB370\\uC774\\uD130\\uB97C \\uAC19\\uC774 \\uBCF4\\uB0B4\\uB3C4 \\uADF8\\uAC83\\uB4E4\\uC740 \\uBB34\\uC2DC\\uD558\\uACE0 status\\uB9CC \\uC5C5\\uB370\\uC774\\uD2B8 \\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,n.jsx)(e.pre,{className:\"language-yaml\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-yaml\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"apiGroups\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` cnat.study.jayground8\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"resources\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` ats/status\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"verbs\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` get\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` patch\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` update\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\uC774\\uC81C \",(0,n.jsx)(e.code,{children:\"internal/controller/at_controller.go\"}),\"\\uC5D0 business logic\\uC744 \\uCD94\\uAC00\\uD55C\\uB2E4. At resource\\uB97C \\uAC00\\uC838\\uC624\\uACE0 \\uC0C1\\uD0DC\\uAC12\\uC5D0 \\uB530\\uB77C\\uC11C \\uB85C\\uC9C1\\uC744 \\uC218\\uD589\\uD55C\\uB2E4. CRD\\uC758 schedule\\uC758 \\uC2DC\\uAC04\\uC774 \\uC9C0\\uB098\\uBA74 \\uC774\\uC81C phase\\uB97C RUNNING\\uC73C\\uB85C \\uBCC0\\uACBD\\uD558\\uACE0, busybox\\uC5D0 CRD\\uC758 command \\uBA85\\uB839\\uC5B4\\uB97C \\uC2E4\\uD589\\uD558\\uAE30 \\uC704\\uD55C pod\\uB97C name\\uACFC namespace\\uB85C \\uAC00\\uC838\\uC640\\uC11C \\uC5C6\\uC73C\\uBA74 \\uC774\\uC81C pod\\uB97C \\uC0DD\\uC131\\uD558\\uAC8C \\uB41C\\uB2E4. pod\\uC758 \\uC0C1\\uD0DC\\uAC12\\uC774 failed\\uB098 succeeded\\uC774\\uBA74 \\uC774\\uC81C phase\\uB294 DONE\\uC774 \\uB41C\\uB2E4.\"]}),(0,n.jsx)(e.p,{children:\"return \\uB418\\uB294 \\uAC83\\uC5D0 \\uB530\\uB77C\\uC11C \\uB2E4\\uC2DC reconcilation\\uC744 \\uD558\\uAC8C \\uB41C\\uB2E4.\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"return reconcile.Result{}, nil\"}),\" : \\uC774\\uC81C reconcilation\\uC774 \\uC131\\uACF5\\uD574\\uC11C retry\\uB97C \\uD560 \\uD544\\uC694\\uAC00 \\uC5C6\\uB2E4.\"]}),(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"return reconcile.Result{}, err\"}),\" : error\\uAC00 \\uBC1C\\uC0DD\\uD574\\uC11C retry\\uAC00 \\uD544\\uC694\\uD558\\uB2E4.\"]}),(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"return reconcile.Result{RequeueAfter: d}, nil\"}),\" : d\\uB9CC\\uD07C \\uAE30\\uB2E4\\uB838\\uB2E4\\uAC00 \\uB2E4\\uC2DC work queue\\uC5D0 \\uB4E4\\uC5B4\\uAC00\\uC11C \\uB2E4\\uC2DC reconcilation\\uC744 \\uD558\\uAC8C \\uB41C\\uB2E4.\"]})]}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"err := controllerutil.SetControllerReference(instance, pod, r.Scheme)\"}),\"\\uB294 \\uC774\\uC81C Custom resource\\uC5D0 pod\\uAC00 \\uC790\\uC2DD \\uAD00\\uACC4\\uB97C \\uB9FA\\uAC8C \\uB418\\uC5B4\\uC11C custom resource\\uAC00 delete\\uB418\\uBA74 \\uAD00\\uACC4\\uAC00 \\uC788\\uB294 pod\\uB3C4 GC\\uB418\\uB3C4\\uB85D \\uD558\\uB824\\uACE0 \\uC124\\uC815\\uD55C\\uB2E4.\"]}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"err = r.Status().Update(context.TODO(), instance)\"}),\"\\uB294 subresource status\\uB97C enable\\uD588\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uC774\\uB807\\uAC8C Status\\uB9CC \\uC5C5\\uB370\\uC774\\uD2B8 \\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-go\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"package\"}),` controller\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"context\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"strings\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"time\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tcorev1 \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"k8s.io/api/core/v1\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"k8s.io/apimachinery/pkg/api/errors\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tmetav1 \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"k8s.io/apimachinery/pkg/apis/meta/v1\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"k8s.io/apimachinery/pkg/runtime\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"k8s.io/apimachinery/pkg/types\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tctrl \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"sigs.k8s.io/controller-runtime\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"sigs.k8s.io/controller-runtime/pkg/client\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"sigs.k8s.io/controller-runtime/pkg/controller/controllerutil\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tlogf \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"sigs.k8s.io/controller-runtime/pkg/log\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"sigs.k8s.io/controller-runtime/pkg/reconcile\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tcnatv1alpha1 \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"my_controller/api/v1alpha1\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" globalLog \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" logf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Log\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"WithName\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"global\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// AtReconciler reconciles a At object\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" AtReconciler \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tclient\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`Client\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tScheme \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"runtime\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`Scheme\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:'//+kubebuilder:rbac:groups=\"\",resources=pods,verbs=get;list;create;watch;'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"//+kubebuilder:rbac:groups=cnat.study.jayground8,resources=ats,verbs=get;list;watch;create;update;patch;delete\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"//+kubebuilder:rbac:groups=cnat.study.jayground8,resources=ats/status,verbs=get;update;patch\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"//+kubebuilder:rbac:groups=cnat.study.jayground8,resources=ats/finalizers,verbs=update\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Reconcile is part of the main kubernetes reconciliation loop which aims to\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// move the current state of the cluster closer to the desired state.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// TODO(user): Modify the Reconcile function to compare the state specified by\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// the At object against the actual cluster state, and then\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// perform operations to make the cluster state reflect the state specified by\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// the user.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"//\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// For more details, check Reconcile and its Result here:\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// - https://pkg.go.dev/sigs.k8s.io/controller-runtime@v0.15.0/pkg/reconcile\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"r \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"AtReconciler\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"Reconcile\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctx context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" req ctrl\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Request\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ctrl\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"error\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\treqLogger \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" globalLog\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"WithValues\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"namespace\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" req\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Namespace\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"at\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" req\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Name\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\treqLogger\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Info\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"=== Reconciling At\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// TODO(user): your logic here\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tinstance \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"cnatv1alpha1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"At\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\terr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Get\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"TODO\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" req\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"NamespacedName\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" instance\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" errors\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"IsNotFound\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" reconcile\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" reconcile\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` err\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" instance\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Status\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Phase \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\"'}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tinstance\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Status\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Phase \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" cnatv1alpha1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`PhasePending\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"switch\"}),\" instance\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Status\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Phase \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" cnatv1alpha1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"PhasePending\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\td\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"timeUntilSchedule\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"instance\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Schedule\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" reconcile\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` err\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" d \",(0,n.jsx)(e.span,{className:\"token operator\",children:\">\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" reconcile\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"RequeueAfter\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" d\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tinstance\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Status\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Phase \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" cnatv1alpha1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`PhaseRunning\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" cnatv1alpha1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"PhaseRunning\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tpod \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"newPodForCR\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"instance\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\terr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" controllerutil\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"SetControllerReference\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"instance\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" pod\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Scheme\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" reconcile\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` err\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tfound \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"corev1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Pod\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tnsName \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" types\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"NamespacedName\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"Name\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" pod\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Name\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" Namespace\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" pod\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Namespace\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\terr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Get\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"TODO\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" nsName\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" found\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"&&\"}),\" errors\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"IsNotFound\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\terr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Create\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"TODO\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" pod\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" reconcile\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` err\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" reconcile\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` err\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" found\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Status\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Phase \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" corev1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"PodFailed \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"||\"}),\" found\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Status\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Phase \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" corev1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"PodSucceeded \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tinstance\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Status\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Phase \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" cnatv1alpha1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`PhaseDone\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" reconcile\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"case\"}),\" cnatv1alpha1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"PhaseDone\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" reconcile\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"default\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" reconcile\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\terr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Status\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Update\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"TODO\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" instance\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" reconcile\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" reconcile\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// SetupWithManager sets up the controller with the Manager.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"r \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"AtReconciler\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"SetupWithManager\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"mgr ctrl\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Manager\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"error\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" ctrl\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NewControllerManagedBy\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"mgr\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"For\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"cnatv1alpha1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"At\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"Complete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"r\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"timeUntilSchedule\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"schedule \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"time\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Duration\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"error\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tnow \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" time\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Now\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"UTC\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tlayout \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"2006-01-02T15:04:05Z\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ts\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" time\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Parse\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"layout\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" schedule\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" time\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Duration\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),` err\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" s\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Sub\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"now\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"newPodForCR\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"cr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"cnatv1alpha1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"At\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"corev1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Pod \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tlabels \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"map\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"app\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" cr\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Name\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"&\"}),\"corev1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Pod\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tObjectMeta\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" metav1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ObjectMeta\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tName\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"      cr\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Name \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"-pod\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tNamespace\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" cr\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Namespace\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tLabels\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"    labels\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tSpec\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" corev1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"PodSpec\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tContainers\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\"corev1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Container\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\t\tName\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"    \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"busybox\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\t\tImage\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\"   \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"busybox\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\t\tCommand\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" strings\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Split\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"cr\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Spec\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Command\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\" \"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tRestartPolicy\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" corev1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"RestartPolicyOnFailure\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"\\uC544\\uB798\\uC640 \\uAC19\\uC774 image\\uB97C \\uC0DD\\uC131\\uD558\\uACE0, minikube\\uC5D0 \\uD574\\uB2F9 image\\uB97C load\\uD55C\\uB2E4.\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"make\"}),\" docker-build \",(0,n.jsx)(e.span,{className:\"token variable assign-left\",children:\"IMG\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`controller:latest\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`minikube image load controller:latest\n`})]})}),(0,n.jsxs)(e.p,{children:[\"\\uADF8\\uB9AC\\uACE0 local\\uC5D0 \\uC788\\uB294 image\\uB97C \\uC0AC\\uC6A9\\uB3C4\\uB85D \\uC544\\uB798\\uCC98\\uB7FC \",(0,n.jsx)(e.code,{children:\"imagePullPolicy\"}),\"\\uB97C \\uBCC0\\uACBD\\uD574\\uC92C\\uB2E4.\"]}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.code,{children:\"/config/manager/manager.yaml\"})}),(0,n.jsx)(e.pre,{className:\"language-yaml\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-yaml\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"image\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" controller\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`latest\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"imagePullPolicy\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` Never\n`]})]})}),(0,n.jsx)(e.p,{children:\"\\uB9C8\\uC9C0\\uB9C9\\uC73C\\uB85C Minikube cluster\\uC5D0 \\uBC30\\uD3EC\\uB97C \\uD55C\\uB2E4.\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"code-highlight language-bash\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"make\"}),` deploy\n`]})})}),(0,n.jsxs)(e.p,{children:[\"controller business logic\\uC911\\uC5D0 pod\\uC5D0 \\uB300\\uD574\\uC11C get\\uD558\\uACE0 create\\uD558\\uB294\\uAC8C \\uC788\\uAE30 \\uB54C\\uBB38\\uC5D0, \",(0,n.jsx)(e.code,{children:\"internal/controller/at_controller.go\"}),\"\\uC5D0 \\uC544\\uB798\\uCC98\\uB7FC \\uC124\\uC815\\uD574\\uB1A8\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsx)(e.code,{className:\"code-highlight language-go\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:'//+kubebuilder:rbac:groups=\"\",resources=pods,verbs=get;list;create;watch;'}),`\n`]})})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"kubectl apply -f config/crd/samples/cnat.study.jayground8_ats.yaml\"}),\"\\uC73C\\uB85C custom resource At\\uC744 \\uC0DD\\uC131\\uD558\\uBA74, informer\\uAC00 event\\uB97C \\uBC1B\\uC544\\uC11C busybox container\\uB97C \\uC0DD\\uC131\\uD558\\uC5EC command\\uB97C \\uC218\\uD589\\uD558\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]})]})}}var f=b;return v;})();\n;return Component;","toc":[],"frontMatter":{"readingTime":{"text":"12 min read","minutes":11.01,"time":660600,"words":2202},"slug":"20230715-k8s-controller","fileName":"20230715-k8s-controller.mdx","title":"Kubernetes custom controller 작성해보기","date":"2023-07-15T00:00:00.000Z","tags":["kubernetes"],"summary":"Programming Kubernetes 책에서 나온 예제를 따라서 custom controller를 작성해보았다. CustomResourceDefinition를 어떻게 정의하고, kubebuilder로 어떻게 나만의 business logic을 작성할 수 있는지 예제를 통해서 이해했다."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.155,"time":9300,"words":31},"slug":["default"],"fileName":"default.md","name":"Jaemyun Lee","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"흑역사 하나 더 만들기","date":"2023-07-03T00:00:00.000Z","tags":["kubernetes","presentation"],"summary":"오늘 대왕 흑역사를 생산했다. Kubernetes Community Days에서 발표를 하게 되었는데, 30분 발표시간에 맞춰서 발표자료를 잘 준비하지 못해서 부끄러웠다. 30분에 너무 많은 내용을 담을려고 했고, 라이브코딩 형식으로 해서 시간도 많이 걸렸다. 나는 발표를 왜 할까?","slug":"20230703-k8s-community-days"},"next":null},"__N_SSG":true}