{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var o=Object.create;var l=Object.defineProperty;var t=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var i=a=>l(a,\"__esModule\",{value:!0});var u=(a,c)=>()=>(c||a((c={exports:{}}).exports,c),c.exports),N=(a,c)=>{i(a);for(var s in c)l(a,s,{get:c[s],enumerable:!0})},k=(a,c,s)=>{if(c&&typeof c==\"object\"||typeof c==\"function\")for(let n of p(c))!m.call(a,n)&&n!==\"default\"&&l(a,n,{get:()=>c[n],enumerable:!(s=t(c,n))||s.enumerable});return a},g=a=>k(i(l(a!=null?o(h(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var r=u((f,d)=>{d.exports=_jsx_runtime});var y={};N(y,{default:()=>P,frontmatter:()=>v});var e=g(r()),v={title:\"k8s-device-plugin\\uC73C\\uB85C NVIDIA GPU Multi-Process Service \\uC0AC\\uC6A9\\uD558\\uAE30\",date:\"2024-03-24\",tags:[\"kubernetes\",\"ncloud\"],images:[\"/static/images/social-banner.png\"],summary:\"Kubernetes\\uC5D0\\uC11C k8s-device-plugin\\uC744 \\uD1B5\\uD574\\uC11C NVIDIA GPU \\uC790\\uC6D0\\uC744 \\uC27D\\uAC8C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB2E4. \\uD558\\uB098\\uC758 \\uC5B4\\uD50C\\uB9AC\\uCF00\\uC774\\uC158\\uC5D0\\uC11C GPU \\uC790\\uC6D0\\uC744 \\uC628\\uC804\\uD788 \\uC0AC\\uC6A9\\uD558\\uC9C0 \\uBABB\\uD558\\uACE0 \\uB0AD\\uBE44\\uB420 \\uB54C, Time slicing, MPS, MIG \\uB4F1\\uC744 \\uC0AC\\uC6A9\\uD558\\uC5EC \\uC5EC\\uB7EC \\uD504\\uB85C\\uC138\\uC2A4\\uAC00 GPU \\uC790\\uC6D0\\uC744 \\uACF5\\uC720\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB2E4. \\uB124\\uC774\\uBC84 \\uACF5\\uACF5 \\uD074\\uB77C\\uC6B0\\uB4DC\\uC5D0\\uC11C Tesla T4\\uC640 Telsa V100\\uC744 \\uC81C\\uACF5\\uD55C\\uB2E4. \\uD574\\uB2F9 GPU \\uC544\\uD0A4\\uD14D\\uCCD0\\uAC00 MIG\\uC744 \\uC9C0\\uC6D0\\uD788\\uC9C0 \\uC54A\\uAE30 \\uB54C\\uBB38\\uC5D0, MPS\\uB97C \\uC801\\uC6A9\\uD558\\uC5EC GPU \\uC790\\uC6D0\\uC744 \\uACF5\\uC720\\uD558\\uB294 \\uAC83\\uC744 \\uACE0\\uB824\\uD558\\uC600\\uB2E4. \\uCD5C\\uADFC\\uC5D0 release\\uB41C k8s-device-plugin v0.15.0-rc.1\\uBD80\\uD130 MPS\\uAC00 \\uC9C0\\uC6D0\\uB418\\uAE30 \\uC2DC\\uC791\\uB418\\uC5B4 \\uD574\\uB2F9 \\uBC84\\uC804\\uC73C\\uB85C MPS\\uB97C \\uC124\\uC815\\uD574\\uBCF4\\uC558\\uB2E4.\"};function b(a={}){let{wrapper:c}=a.components||{};return c?(0,e.jsx)(c,Object.assign({},a,{children:(0,e.jsx)(s,{})})):s();function s(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",ul:\"ul\",li:\"li\",code:\"code\",pre:\"pre\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"\\uB124\\uC774\\uBC84-\\uACF5\\uACF5-\\uD074\\uB77C\\uC6B0\\uB4DC\\uC5D0\\uC11C-\\uC0AC\\uC6A9\\uD560-\\uC218-\\uC788\\uB294-\\uC635\\uC158\",children:[(0,e.jsx)(n.a,{href:\"#\\uB124\\uC774\\uBC84-\\uACF5\\uACF5-\\uD074\\uB77C\\uC6B0\\uB4DC\\uC5D0\\uC11C-\\uC0AC\\uC6A9\\uD560-\\uC218-\\uC788\\uB294-\\uC635\\uC158\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uB124\\uC774\\uBC84 \\uACF5\\uACF5 \\uD074\\uB77C\\uC6B0\\uB4DC\\uC5D0\\uC11C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB294 \\uC635\\uC158\"]}),(0,e.jsx)(n.p,{children:\"NVIDIA GPU\\uB294 \\uC790\\uC6D0\\uC744 \\uACF5\\uC720\\uD558\\uAE30 \\uC704\\uD55C \\uBC29\\uBC95\\uC73C\\uB85C \\uC544\\uB798\\uC640 \\uAC19\\uC740 \\uBC29\\uBC95\\uB4E4\\uC744 \\uC81C\\uACF5\\uD55C\\uB2E4.\"}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:\"Time slicing\"}),(0,e.jsx)(n.li,{children:\"Multi-Process Service\"}),(0,e.jsx)(n.li,{children:\"Multi-instance GPU\"})]}),(0,e.jsxs)(n.p,{children:[\"\\uB124\\uC774\\uBC84 \\uACF5\\uACF5 \\uD074\\uB77C\\uC6B0\\uB4DC\\uC5D0\\uC11C \\uC0AC\\uC6A9\\uD55C \\uAC00\\uB2A5\\uD55C GPU\\uC5D0\\uB294 Tesla V100(arch: Volta)\\uACFC Tesla T4(arch: Turing)\\uAC00 \\uC788\\uB2E4. Hardware\\uB2E8\\uC5D0\\uC11C Partition\\uC744 \\uD558\\uC5EC \\uACA9\\uB9AC\\uD560 \\uC218 \\uC788\\uB294 \",(0,e.jsx)(n.code,{children:\"MIG(Multi-instance GPU)\"}),\"\\uB294 \",(0,e.jsx)(n.code,{children:\"A100\"}),\"\\uACFC \\uAC19\\uC740 \",(0,e.jsx)(n.code,{children:\"Ampere\"}),\" \\uC544\\uD0A4\\uD14D\\uCCD0\\uC5D0\\uC11C \\uAC00\\uB2A5\\uD558\\uB2E4. \\uB530\\uB77C\\uC11C T4\\uC640 V100\\uC5D0\\uC11C\\uB294 \",(0,e.jsx)(n.code,{children:\"MIG\"}),\"\\uB97C \\uC0AC\\uC6A9\\uD560 \\uC218\\uAC00 \\uC5C6\\uB2E4. \\uB300\\uC2E0\\uC5D0 \",(0,e.jsx)(n.code,{children:\"MPS(Multi-Process Service)\"}),\"\\uB294 T4\\uC640 V100 \\uBAA8\\uB450\\uC5D0\\uC11C \\uC0AC\\uC6A9\\uC774 \\uAC00\\uB2A5\\uD558\\uB2E4. \",(0,e.jsx)(n.code,{children:\"Time slicing\"}),\" \\uBC29\\uC2DD\\uC740 GPU\\uB97C \\uB9CE\\uC774 \\uC0AC\\uC6A9\\uD558\\uB294 \\uB2E4\\uC218\\uC758 \\uD504\\uB85C\\uC138\\uC2A4\\uAC00 \\uACF5\\uC720\\uD574\\uC11C \\uC0AC\\uC6A9\\uD560 \\uB54C, Context Switch\\uC5D0 \\uC758\\uD55C overload\\uAC00 \\uC0C1\\uB2F9\\uD788 \\uBC1C\\uC0DD\\uD560 \\uC218 \\uC788\\uB2E4. \\uBC18\\uBA74\\uC5D0 \",(0,e.jsx)(n.code,{children:\"MPS\"}),\"\\uB294 \\uD558\\uB098\\uC758 Cuda Context\\uB97C \\uACF5\\uC720\\uD558\\uAE30 \\uB54C\\uBB38\\uC5D0, \",(0,e.jsx)(n.code,{children:\"Time slicing\"}),\"\\uBCF4\\uB2E4 Context switch\\uC5D0 \\uB300\\uD55C overload\\uB97C \\uC904\\uC77C \\uC218 \\uC788\\uB2E4. \\uD558\\uC9C0\\uB9CC \\uC774\\uB807\\uAC8C \\uD558\\uB098\\uC758 Cuda Context\\uB97C \\uACF5\\uC720\\uD558\\uAE30 \\uB54C\\uBB38\\uC5D0 error\\uAC00 \\uBC1C\\uC0DD\\uD588\\uC744 \\uB54C \\uBAA8\\uB4E0 MPS client\\uC5D0 \\uC601\\uD5A5\\uC744 \\uBBF8\\uCE60 \\uC218 \\uC788\\uB2E4. (\",(0,e.jsx)(n.a,{href:\"https://docs.nvidia.com/deploy/mps/index.html#topic_3_3_3_2\",children:\"Volta MPS\\uC5D0\\uC11C\\uB294 \\uC880 \\uC81C\\uD55C\\uC801\\uC778 \\uC601\\uD5A5\\uC744 \\uBBF8\\uCE58\\uB294 \\uAC83 \\uAC19\\uB2E4.\"}),\")\"]}),(0,e.jsxs)(n.h2,{id:\"k8s-device-plugin\",children:[(0,e.jsx)(n.a,{href:\"#k8s-device-plugin\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"k8s-device-plugin\"]}),(0,e.jsxs)(n.p,{children:[\"Kubernetes\\uC5D0\\uC11C GPU\\uB97C kubelet\\uC774 \\uC778\\uC9C0\\uD558\\uACE0 \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D, \",(0,e.jsx)(n.a,{href:\"https://www.youtube.com/watch?v=Q2GuTUO170w&t=922s\",children:\"NVIDIA\\uC5D0\\uC11C \\uACF5\\uC2DD\\uC801\\uC73C\\uB85C device plugin\"}),\"\\uC744 \\uC81C\\uACF5\\uD558\\uACE0 \\uC788\\uB2E4. \\uADF8\\uB9AC\\uACE0 Helm chart\\uB97C \\uAC19\\uC774 \\uC81C\\uACF5\\uD55C\\uB2E4. \\uB530\\uB77C\\uC11C Helm\\uC73C\\uB85C \",(0,e.jsx)(n.code,{children:\"k8s-device-plugin\"}),\"\\uC744 \\uC124\\uCE58\\uB97C \\uD588\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"helm repo \",(0,e.jsx)(n.span,{className:\"token function\",children:\"add\"}),` nvdp https://nvidia.github.io/k8s-device-plugin\n`]})})}),(0,e.jsxs)(n.p,{children:[\"\\uC6D0\\uD558\\uB294 Worker node\\uC5D0 Daemonset\\uC774 \\uC2E4\\uD589\\uB420 \\uC218 \\uC788\\uB3C4\\uB85D \",(0,e.jsx)(n.code,{children:\"affinity\"}),\"\\uC640 \",(0,e.jsx)(n.code,{children:\"tolerations\"}),\" \\uC124\\uC815\\uC744 \\uCD94\\uAC00\\uD558\\uC600\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"values.yml\"})}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"affinity\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"nodeAffinity\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"requiredDuringSchedulingIgnoredDuringExecution\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"nodeSelectorTerms\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"matchExpressions\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` serverType\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"operator\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` In\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"values\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` gpu\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"tolerations\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` nvidia.com/gpu\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"operator\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Exists\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"effect\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` NoSchedule\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uADF8\\uB9AC\\uACE0 device plugin \\uC124\\uC815\\uD30C\\uC77C\\uC5D0 MPS \\uC124\\uC815\\uC744 \\uCD94\\uAC00\\uD558\\uC600\\uB2E4.\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"config.yaml\"})}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"version\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"sharing\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"mps\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"resources\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` nvidia.com/gpu\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"replicas\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"NVIDIA\\uC758 k8s-device-plugin\\uC5D0\\uC11C \",(0,e.jsx)(n.code,{children:\"v0.15.0\"}),\"\\uBD80\\uD130 MPS\\uB97C \\uC9C0\\uC6D0\\uD558\\uAE30 \\uC2DC\\uC791\\uD588\\uB2E4. \\uC9C0\\uAE08 \\uC774 \\uAE00\\uC744 \\uC4F0\\uB294 \\uC2DC\\uC810\\uC5D0 \",(0,e.jsx)(n.code,{children:\"v0.15.0-rc.2\"}),\"\\uAC00 \\uCD5C\\uC2E0 \\uBC84\\uC804\\uC774\\uACE0, \\uC544\\uC9C1 \",(0,e.jsx)(n.code,{children:\"rc\"}),\" \\uD658\\uACBD\\uC73C\\uB85C \\uC81C\\uACF5\\uB418\\uACE0 \\uC788\\uB2E4. \\uB530\\uB77C\\uC11C Helm\\uC73C\\uB85C \\uC124\\uCE58\\uB97C \\uD560 \\uB54C \\uC544\\uB798\\uC640 \\uAC19\\uC774 version flag\\uB97C \\uD1B5\\uD574\\uC11C 0.15.0-rc.2\\uB97C \\uC124\\uC815\\uD574\\uC900\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"helm \",(0,e.jsx)(n.span,{className:\"token function\",children:\"install\"}),\" k8s-device-plugin nvdp/nvidia-device-plugin \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--version \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0.15\"}),\".0-rc.2 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--namespace nvidia-device-plugin \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--create-namespace \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--values values.yaml \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"\\\\\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"--set-file config.map.config\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`config.yaml\n`]})]})}),(0,e.jsx)(n.p,{children:\"Helm\\uC73C\\uB85C \\uC124\\uCE58\\uD558\\uACE0 \\uB098\\uBA74 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uB450\\uAC1C\\uC758 Daemonset Object\\uAC00 \\uB9CC\\uB4E4\\uC5B4\\uC9C4 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4. Deamonset k8s-device-plugin-nvidia-device-plugin-mps-control-daemon\\uAC00 \\uC2E4\\uD589\\uB418\\uAE30 \\uC704\\uD574\\uC11C\\uB294 Worker Node\\uC5D0 nvidia.com/mps.capable=true\\uAC00 \\uC124\\uC815\\uB418\\uC5B4\\uC57C \\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`$ kubectl get ds -n nvidia-device-plugin\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`NAMESPACE              NAME                                                        DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"nvidia-device-plugin   k8s-device-plugin-nvidia-device-plugin                      \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\"         \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\"         \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\"       \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\"            \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\"           \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\"none\",(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),`                        5s\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"nvidia-device-plugin   k8s-device-plugin-nvidia-device-plugin-mps-control-daemon   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\"         \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\"         \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\"       \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\"            \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\"           nvidia.com/mps.capable\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`true   5s\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uD574\\uB2F9 Label\\uB54C\\uBB38\\uC5D0 MPS daemon\\uC774 \\uC2E4\\uD589\\uB418\\uC9C0 \\uBABB\\uD588\\uACE0, \\uADF8\\uB798\\uC11C k8s-device-plugin-nvidia-device-plugin Pod\\uC5D0 \\uC544\\uB798\\uC640 \\uAC19\\uC740 \\uC5D0\\uB7EC \\uB85C\\uADF8\\uAC00 \\uB0A8\\uAC8C \\uB418\\uC5C8\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"Failed to start plugin: error waiting \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" MPS daemon: error checking MPS daemon health: failed to send \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"command\"}),\" to MPS daemon: \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"exit\"}),\" status \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]})})}),(0,e.jsx)(n.p,{children:\"\\uC774\\uC81C GPU worker node\\uC5D0 label\\uC744 \\uCD94\\uAC00\\uD574\\uC8FC\\uBA74 MPS daemon\\uC774 \\uC2E4\\uD589\\uB418\\uACE0, \\uC815\\uC0C1\\uC801\\uC73C\\uB85C MPS\\uAC00 \\uC801\\uC6A9\\uB41C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"kubectl label node gpu-node nvidia.com/mps.capable\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`true\n`]})})}),(0,e.jsx)(n.p,{children:\"MPS\\uC5D0\\uC11C replica\\uB97C 10\\uC73C\\uB85C \\uC124\\uC815\\uD588\\uAE30 \\uB54C\\uBB38\\uC5D0, Node\\uC758 nvida.com/gpu \\uC790\\uC6D0\\uC744 \\uD655\\uC778\\uD558\\uBA74 1\\uC5D0\\uC11C 10\\uC73C\\uB85C \\uC99D\\uAC00\\uD55C \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`$ kubectl describe node gpu-node\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`Allocatable:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  cpu:                3920m\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  ephemeral-storage:  \",(0,e.jsx)(n.span,{className:\"token number\",children:\"47267522073\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  hugepages-1Gi:      \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  hugepages-2Mi:      \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  memory:             17413608Ki\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  nvidia.com/gpu:     \",(0,e.jsx)(n.span,{className:\"token number\",children:\"10\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  pods:               \",(0,e.jsx)(n.span,{className:\"token number\",children:\"110\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uD574\\uB2F9 \\uB178\\uB4DC\\uC5D0 \",(0,e.jsx)(n.code,{children:\"nvida.com/gpu\"}),\" resource request\\uAC00 1\\uC778 Pod \\uD558\\uB098\\uB9CC \\uC2A4\\uCF00\\uC974\\uB9C1\\uC774 \\uB420 \\uC218 \\uC788\\uC5C8\\uB294\\uB370, \\uC774\\uC81C 10\\uC73C\\uB85C \\uB298\\uC5B4\\uB098\\uC11C \\uB2E4\\uC218\\uC758 Pod\\uB97C \\uD574\\uB2F9 \\uB178\\uB4DC\\uC5D0\\uC11C \\uC2E4\\uD589\\uD560 \\uC218 \\uC788\\uAC8C \\uB418\\uC5C8\\uB2E4.\"]})]})}}var P=b;return y;})();\n;return Component;","toc":[{"value":"네이버 공공 클라우드에서 사용할 수 있는 옵션","url":"#네이버-공공-클라우드에서-사용할-수-있는-옵션","depth":2},{"value":"k8s-device-plugin","url":"#k8s-device-plugin","depth":2}],"frontMatter":{"readingTime":{"text":"4 min read","minutes":3.16,"time":189600,"words":632},"slug":"20240324-k8s-device-plugin","fileName":"20240324-k8s-device-plugin.md","title":"k8s-device-plugin으로 NVIDIA GPU Multi-Process Service 사용하기","date":"2024-03-24T00:00:00.000Z","tags":["kubernetes","ncloud"],"images":["/static/images/social-banner.png"],"summary":"Kubernetes에서 k8s-device-plugin을 통해서 NVIDIA GPU 자원을 쉽게 사용할 수 있다. 하나의 어플리케이션에서 GPU 자원을 온전히 사용하지 못하고 낭비될 때, Time slicing, MPS, MIG 등을 사용하여 여러 프로세스가 GPU 자원을 공유하도록 설정할 수 있다. 네이버 공공 클라우드에서 Tesla T4와 Telsa V100을 제공한다. 해당 GPU 아키텍쳐가 MIG을 지원히지 않기 때문에, MPS를 적용하여 GPU 자원을 공유하는 것을 고려하였다. 최근에 release된 k8s-device-plugin v0.15.0-rc.1부터 MPS가 지원되기 시작되어 해당 버전으로 MPS를 설정해보았다."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.15,"time":9000,"words":30},"slug":["default"],"fileName":"default.md","name":"Jay","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"containerd nofile default 설정값","date":"2024-02-14T00:00:00.000Z","tags":["kubernetes","containerd"],"images":["/static/images/social-banner.png"],"summary":"Kubernetes에서 pod가 실행될 때, 해당 process의 open file 갯수 limit이 어떻게 되는지 궁금하였다. Containerd가 systemd service로 동작하는 상황에서 systemd에서 LimitNOFILE이 inifinity로 설정되어 있는 것을 확인하였다. infinity가 Ubuntu systemd 240 버전 이상에서는 process에 최대로 할당할 수 있는 File 갯수인 fs.nr_open 값으로 설정된다. 실제로 test용 pod를 띄어서 containerd에 의해서 실행되는 process의 nofile limit이 LimitNOFILE에 설정된 값으로 동일하게 설정되는 것을 확인하였다.","slug":"20240214-containerd-LimitNOFILE"},"next":{"title":"책 \"다른 몸들을 위한 디자인\"을 읽고...","date":"2024-03-24T00:00:00.000Z","tags":["Book"],"images":["/static/images/social-banner.png"],"summary":"내가 일상 생활에서 장애를 직접 경험하지 않기 때문에 장애인이 경험하는 우리의 사회에 대해서 진지하게 고민할 기회가 많지 않았다. 봉사활동과 여러가지 프로젝트 참여를 통해서 장애인에 대한 여러가지 생각을 했지만, 내 삶에서 당장 중요한 문제가 아니다보니 일시적인 생각으로만 끝났다. 이 책을 읽으면서 느낀 점이나 생각들도 반복된 일상속에서 그냥 증발해버릴 것 같다는 생각이 들었다. 하지만 이러한 작은 관심과 생각들이 나의 무의식에 있던 사고들에 변화를 조금씩 가져오고, 그것이 쌓여서 나중에는 내가 무언가 사회에 조금이나마 영향을 미칠 수 있는 역할을 할 수 있지 않을까? 조금은 긍정적인 마음으로 독후감을 작성해보았다.","slug":"20240324-book-review-what-can-a-body-do"}},"__N_SSG":true}