{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var t=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var i=a=>l(a,\"__esModule\",{value:!0});var N=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),u=(a,s)=>{i(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let n of p(s))!m.call(a,n)&&n!==\"default\"&&l(a,n,{get:()=>s[n],enumerable:!(c=d(s,n))||c.enumerable});return a},g=a=>k(i(l(a!=null?t(h(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=N((I,r)=>{r.exports=_jsx_runtime});var A={};u(A,{default:()=>y,frontmatter:()=>v});var e=g(o()),v={title:\"\\uAD6C\\uAE00 \\uACC4\\uC815\\uC73C\\uB85C Vault \\uB85C\\uADF8\\uC778\\uD558\\uAE30\",date:\"2024-07-14\",tags:[\"vault\",\"devsecops\"],images:[\"/static/images/social-banner.png\"],summary:\"Vault\\uB97C \\uAD6C\\uAE00 \\uC778\\uC99D\\uC744 \\uD1B5\\uD574\\uC11C \\uB85C\\uADF8\\uC778\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uD574\\uBCF8\\uB2E4. Admin Directory API\\uB97C \\uD1B5\\uD574\\uC11C workspace\\uC758 user\\uC640 group\\uC758 \\uC815\\uBCF4\\uB97C \\uAC00\\uC838\\uC62C \\uC218 \\uC788\\uACE0, \\uD574\\uB2F9 \\uC815\\uBCF4\\uB97C \\uD1B5\\uD574\\uC11C \\uC778\\uC99D \\uC870\\uAC74\\uC744 \\uCD94\\uAC00\\uD560 \\uC218 \\uC788\\uB2E4. \\uC608\\uB85C \\uD2B9\\uC815 workspace group\\uC5D0 \\uC18D\\uD55C \\uACC4\\uC815\\uB9CC \\uC778\\uC99D\\uC5D0 \\uC131\\uACF5\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D \\uC870\\uAC74\\uC744 \\uCD94\\uAC00\\uD560 \\uC218 \\uC788\\uB2E4. Admin Directory API\\uC5D0 \\uC694\\uCCAD\\uD558\\uAE30 \\uC704\\uD574\\uC11C \\uD544\\uC694\\uD55C \\uAD8C\\uD55C\\uC744 \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB294\\uB370, Service Account\\uC758 key \\uD30C\\uC77C\\uC744 \\uC0DD\\uC131\\uD558\\uB294 \\uB300\\uC2E0\\uC5D0, Application Default Credentials\\uB97C \\uD65C\\uC6A9\\uD574\\uBCF4\\uC558\\uB2E4. Application Default Credentials\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 \\uACFC\\uC815\\uC5D0\\uC11C \\uC0BD\\uC9C8\\uC744 \\uB9CE\\uC774 \\uD588\\uB294\\uB370, \\uD639\\uC2DC\\uB098 \\uB3D9\\uC77C\\uD55C \\uC791\\uC5C5\\uC744 \\uD558\\uB294 \\uBD84\\uB4E4\\uC740 \\uB098\\uCC98\\uB7FC \\uC2DC\\uAC04\\uC744 \\uD5C8\\uBE44\\uD558\\uC9C0 \\uC54A\\uAE30\\uB97C \\uBC14\\uB77C\\uBA70 \\uAE00\\uC744 \\uC791\\uC131\\uD55C\\uB2E4.\\u{1F979}\"};function _(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({p:\"p\",a:\"a\",h2:\"h2\",span:\"span\",code:\"code\",pre:\"pre\",ol:\"ol\",li:\"li\",h3:\"h3\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.p,{children:[\"Google Workspace\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 \\uACBD\\uC6B0 Google \\uACC4\\uC815\\uC73C\\uB85C \\uD1B5\\uD569\\uD574\\uC11C \\uC778\\uC99D\\uC744 \\uD558\\uB294 \\uAC83\\uC744 \\uACE0\\uBBFC\\uD574\\uBCFC \\uC218 \\uC788\\uB2E4. Vault\\uC5D0\\uC11C\\uB3C4 \\uC778\\uC99D\\uBC29\\uBC95\\uC73C\\uB85C OIDC\\uB97C \\uC81C\\uACF5\\uD558\\uACE0 \\uC788\\uAE30 \\uB54C\\uBB38\\uC5D0, Google \\uACC4\\uC815\\uC73C\\uB85C \\uC778\\uC99D\\uD558\\uC5EC \\uAD8C\\uD55C\\uC744 \\uBC1B\\uC744 \\uC218 \\uC788\\uB2E4. \",(0,e.jsx)(n.a,{href:\"https://developer.hashicorp.com/vault/docs/auth/jwt/oidc-providers/google\",children:\"Vault \\uBB38\\uC11C\\uC5D0\\uC11C \\uC124\\uC815\\uC744 \\uC5B4\\uB5BB\\uAC8C \\uD558\\uB294\\uC9C0 \\uCE5C\\uC808\\uD558\\uAC8C \\uC124\\uBA85\"}),\"\\uD558\\uACE0 \\uC788\\uB2E4. \\uB530\\uB77C\\uC11C \\uAC04\\uB2E8\\uD558\\uAC8C \\uC124\\uC815\\uC774 \\uC644\\uB8CC\\uB420 \\uAC83\\uC774\\uB77C \\uC608\\uC0C1\\uD588\\uC9C0\\uB9CC, \\uC774\\uB7F0 \\uC800\\uB7F0 \\uC0BD\\uC9C8\\uC744 \\uD558\\uBA74\\uC11C \\uB610 \\uB2E4\\uB978 \\uC0BD\\uC9C8\\uAE30\\uAC00 \\uB418\\uC5C8\\uB2E4. \\uD639\\uC2DC\\uAC00 \\uB3D9\\uC77C\\uD55C \\uC791\\uC5C5\\uC744 \\uD560 \\uB54C, \\uB2E4\\uB978 \\uC0AC\\uB78C\\uB4E4\\uC740 \\uC2DC\\uAC04\\uC744 \\uB35C \\uD5C8\\uBE44\\uD558\\uAE38 \\uBC14\\uB77C\\uBA74\\uC11C \\uC815\\uB9AC\\uD574\\uC11C \\uAE00\\uC744 \\uC62C\\uB824\\uBCF8\\uB2E4.\"]}),(0,e.jsxs)(n.p,{children:[\"Oauth2\\uB85C \\uC778\\uC99D\\uC744 \\uD558\\uACE0, \",(0,e.jsx)(n.a,{href:\"https://developers.google.com/admin-sdk/directory/reference/rest\",children:\"Google Workspace Directory API\"}),\"\\uB97C \\uD1B5\\uD574\\uC11C user\\uC815\\uBCF4\\uC640 group\\uC815\\uBCF4\\uB97C \\uAC00\\uC838\\uC640\\uC11C \\uCD94\\uAC00\\uC801\\uC778 \\uC870\\uAC74\\uC744 \\uC904 \\uC218\\uAC00 \\uC788\\uB2E4. \\uC608\\uB97C \\uB4E4\\uC5B4\\uC11C Google workspace\\uC758 vault group\\uC5D0 \\uC788\\uB294 \\uACC4\\uC815\\uB9CC \\uC778\\uC99D\\uC5D0 \\uC131\\uACF5\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsxs)(n.h2,{id:\"oauth-20-client-\\uC0DD\\uC131\",children:[(0,e.jsx)(n.a,{href:\"#oauth-20-client-\\uC0DD\\uC131\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Oauth 2.0 Client \\uC0DD\\uC131\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"GCP \\uCF58\\uC194\"}),\"\\uC5D0\\uC11C \\uC544\\uB798 \\uADF8\\uB9BC\\uCC98\\uB7FC \",(0,e.jsx)(n.code,{children:\"Web application\"}),\" \\uD0C0\\uC785\\uC73C\\uB85C \\uC0DD\\uC131\\uD55C\\uB2E4.\"]}),(0,e.jsx)(\"img\",{src:\"/static/images/vault-oidc-oauth2.png\",alt:\"add Oauth2.0 Client\"}),(0,e.jsx)(n.p,{children:\"redirect url\\uB97C \\uC544\\uB798\\uC640 \\uAC19\\uC740 path\\uB85C \\uB4F1\\uB85D\\uC744 \\uD574\\uC900\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`http://localhost:8000/ui/vault/auth/oidc/oidc/callback\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`http://localhost:8000/oidc/callback\n`})]})}),(0,e.jsxs)(n.h2,{id:\"service-account-\\uC0DD\\uC131\",children:[(0,e.jsx)(n.a,{href:\"#service-account-\\uC0DD\\uC131\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Service Account \\uC0DD\\uC131\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"GCP \\uCF58\\uC194\"}),\"\\uC5D0\\uC11C Service Account\\uB97C \\uC0DD\\uC131\\uD55C\\uB2E4.\"]}),(0,e.jsx)(\"img\",{src:\"/static/images/vault-oidc-service-account.png\",alt:\"create new service account\"}),(0,e.jsxs)(n.h2,{id:\"\\uC124\\uC815-\\uC635\\uC158\",children:[(0,e.jsx)(n.a,{href:\"#\\uC124\\uC815-\\uC635\\uC158\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uC124\\uC815 \\uC635\\uC158\"]}),(0,e.jsx)(n.p,{children:\"\\uC138 \\uAC00\\uC9C0 \\uBC29\\uBC95\\uC73C\\uB85C Google Workspace\\uC758 User\\uC640 Group \\uC815\\uBCF4\\uB97C \\uAC00\\uC838\\uC624\\uB294 \\uAC83\\uC744 \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB2E4.Role\\uC744 \\uC5F0\\uACB0\\uD558\\uB294 \\uB300\\uC2E0\\uC5D0 domain-wide delegation\\uC73C\\uB85C \\uAD8C\\uD55C\\uC744 \\uC8FC\\uB294 \\uAC83\\uC774 \\uAD00\\uB9AC \\uCE21\\uBA74\\uC5D0\\uC11C \\uD3B8\\uD558\\uB2E4. \\uADF8\\uB9AC\\uACE0 static\\uD558\\uAC8C service account key \\uD30C\\uC77C\\uC744 \\uC0DD\\uC131\\uD558\\uB294 \\uAC83\\uBCF4\\uB2E4, Refresh Token\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 Application Default Credentials\\uC774 \\uC870\\uAE08 \\uB354 \\uBCF4\\uC548\\uC801\\uC73C\\uB85C \\uC720\\uB9AC\\uD558\\uB2E4\\uACE0 \\uBCF8\\uB2E4. \\uB530\\uB77C\\uC11C \\uC138 \\uBC88\\uC9F8 \\uBC29\\uBC95\\uC73C\\uB85C \\uC124\\uC815\\uD558\\uB294 \\uAC83\\uC744 \\uC124\\uBA85\\uD55C\\uB2E4.\"}),(0,e.jsxs)(n.ol,{children:[(0,e.jsx)(n.li,{children:\"service account key\\uB97C \\uC0DD\\uC131 + \\uD574\\uB2F9 service account\\uC5D0 Role\\uC744 \\uBD80\\uC5EC\"}),(0,e.jsx)(n.li,{children:\"service account key\\uB97C \\uC0DD\\uC131 + domain-wide delegation \\uC124\\uC815\"}),(0,e.jsx)(n.li,{children:\"service account key\\uB97C \\uC0DD\\uC131\\uD558\\uB294 \\uB300\\uC2E0\\uC5D0 ADC\\uB97C \\uC774\\uC6A9 + domain-wide delegation \\uC124\\uC815\"})]}),(0,e.jsxs)(n.h2,{id:\"\\uBC29\\uBC95-3\",children:[(0,e.jsx)(n.a,{href:\"#\\uBC29\\uBC95-3\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uBC29\\uBC95 3\"]}),(0,e.jsxs)(n.h3,{id:\"directory-api-\\uAD8C\\uD55C-\\uBD80\\uC5EC\",children:[(0,e.jsx)(n.a,{href:\"#directory-api-\\uAD8C\\uD55C-\\uBD80\\uC5EC\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Directory API \\uAD8C\\uD55C \\uBD80\\uC5EC\"]}),(0,e.jsx)(n.p,{children:\"Directory API\\uB97C \\uD1B5\\uD574\\uC11C user\\uC640 group\\uC815\\uBCF4\\uB97C \\uAC00\\uC838\\uC624\\uAE30 \\uC704\\uD574\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC740 scope\\uC774 \\uC124\\uC815\\uB418\\uC5B4\\uC57C \\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`https://www.googleapis.com/auth/admin.directory.group.readonly\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`https://www.googleapis.com/auth/admin.directory.user.readonly\n`})]})}),(0,e.jsx)(n.p,{children:\"Domain wide delegation \\uBC29\\uC2DD\\uC73C\\uB85C \\uAD8C\\uD55C\\uC744 \\uBD80\\uC5EC\\uD558\\uAE30 \\uC704\\uD574\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC774 Workspace Admin \\uCF58\\uC194\\uC5D0\\uC11C \\uBD80\\uC5EC\\uD55C\\uB2E4. \\uC704\\uC758 \\uB450\\uAC00\\uC9C0 scope\\uB97C \\uC0AC\\uC6A9\\uD560 Service Account ID\\uC5D0 \\uCD94\\uAC00\\uD574\\uC900\\uB2E4.\"}),(0,e.jsx)(\"img\",{src:\"/static/images/vault-oidc-domain-wide-delegation.png\",alt:\"Domain Wide Delegation\"}),(0,e.jsxs)(n.h3,{id:\"\\uD544\\uC694\\uD55C-service-\\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D-\\uC124\\uC815\",children:[(0,e.jsx)(n.a,{href:\"#\\uD544\\uC694\\uD55C-service-\\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D-\\uC124\\uC815\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uD544\\uC694\\uD55C Service \\uC0AC\\uC6A9\\uD558\\uB3C4\\uB85D \\uC124\\uC815\"]}),(0,e.jsxs)(n.p,{children:[\"ADC(Application Default Credentials)\\uC5D0\\uC11C \\uC0AC\\uC6A9\\uD560 \\uC11C\\uBE44\\uC2A4\\uB97C \",(0,e.jsx)(n.code,{children:\"enable\"}),\" \\uD574\\uC900\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gcloud services \",(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"enable\"}),` iamcredentials.googleapis.com\n`]})})}),(0,e.jsxs)(n.h3,{id:\"service-account\\uC5D0-\\uD544\\uC694\\uD55C-\\uAD8C\\uD55C-\\uBD80\\uC5EC\",children:[(0,e.jsx)(n.a,{href:\"#service-account\\uC5D0-\\uD544\\uC694\\uD55C-\\uAD8C\\uD55C-\\uBD80\\uC5EC\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Service Account\\uC5D0 \\uD544\\uC694\\uD55C \\uAD8C\\uD55C \\uBD80\\uC5EC\"]}),(0,e.jsx)(n.p,{children:\"ADC(Application Default Credentials) \\uBC29\\uBC95\\uC73C\\uB85C accessToken\\uC744 \\uBC1B\\uC544\\uC624\\uAE30 \\uC704\\uD574\\uC11C\\uB294 Service Account\\uC5D0 \\uD544\\uC694\\uD55C \\uAD8C\\uD55C\\uC744 \\uC124\\uC815\\uD574\\uC57C \\uD55C\\uB2E4. \\uB530\\uB77C\\uC11C \\uC774\\uBBF8 GCP\\uC5D0 \\uB9CC\\uB4E4\\uC5B4\\uC9C4 Role\\uC744 Service Account\\uC5D0 \\uBD80\\uC5EC\\uD574\\uC900\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gcloud projects add-iam-policy-binding \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"project ID\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" --member\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"serviceAccount:\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"service account\\uBA85\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\"@\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"proejct ID\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\".iam.gserviceaccount.com --role\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`roles/iam.serviceAccountTokenCreator\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gcloud projects add-iam-policy-binding \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"project ID\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" --member\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"serviceAccount:\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"service account\\uBA85\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\"@\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"proejct ID\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\".iam.gserviceaccount.com --role\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`roles/iam.serviceAccountUser\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"ADC\\uB97C \\uC0AC\\uC6A9\\uD560 \\uB54C roles/iam.serviceAccountUser\\uB97C \\uBD80\\uC5EC\\uD558\\uC9C0 \\uC54A\\uC544\\uC11C \\uACC4\\uC18D \\uAD8C\\uD55C \\uC5D0\\uB7EC\\uAC00 \\uBC1C\\uC0DD\\uD588\\uC5C8\\uB2E4. \",(0,e.jsx)(n.a,{href:\"https://cloud.google.com/iam/docs/service-account-permissions#roles\",children:\"Service Account\\uB97C \\uC0AC\\uC6A9\\uD560 \\uB54C \\uD574\\uB2F9 Role\\uC774 \\uBD80\\uC5EC\\uB418\\uC5B4\\uC57C\\uC9C0 \\uD574\\uB2F9 Service Account\\uAC00 \\uB9AC\\uC18C\\uC2A4\\uC5D0 \\uC811\\uADFC\\uD560 \\uC218 \\uC788\\uB2E4.\"})]}),(0,e.jsxs)(n.h3,{id:\"local-adc-\\uD30C\\uC77C-\\uC0DD\\uC131\",children:[(0,e.jsx)(n.a,{href:\"#local-adc-\\uD30C\\uC77C-\\uC0DD\\uC131\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"local ADC \\uD30C\\uC77C \\uC0DD\\uC131\"]}),(0,e.jsx)(n.p,{children:\"\\uC544\\uB798\\uC640 \\uAC19\\uC740 \\uBA85\\uB839\\uC5B4\\uB85C local ADC \\uD30C\\uC77C\\uC744 \\uC0DD\\uC131\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"gcloud auth application-default login --impersonate-service-account \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"service account\\uBA85\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\"@\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"proejct ID\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`.iam.gserviceaccount.com\n`]})})}),(0,e.jsx)(n.p,{children:\"\\uC544\\uB798\\uC640 \\uAC19\\uC740 \\uACBD\\uB85C\\uC5D0 \\uD30C\\uC77C\\uC774 \\uC0DD\\uC131\\uB41C \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"cat\"}),` ~/.config/gcloud/application_default_credentials.json\n`]})})}),(0,e.jsxs)(n.p,{children:[\"\\uD30C\\uC77C\\uC740 \\uC544\\uB798\\uC640 \\uAC19\\uC740 \\uAC12\\uC744 \\uAC00\\uC9C0\\uACE0 \\uC788\\uB2E4. \",(0,e.jsx)(n.code,{children:\"https://iamcredentials\"}),\" \\uACBD\\uB85C\\uB85C url\\uC774 \\uC124\\uC815\\uB41C \\uAC83\\uC744 \\uBCFC\\uC218\\uAC00 \\uC788\\uACE0, refresh_token \\uAC12\\uB3C4 \\uC788\\uB294 \\uAC83\\uC744 \\uBCFC \\uC218\\uAC00 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-json\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-json\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"delegates\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"service_account_impersonation_url\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"https://iamcredentials.googleapis.com/v1/projects/-/serviceAccounts/{service account\\uBA85}@{proejct ID}.iam.gserviceaccount.com:generateAccessToken\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"source_credentials\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"account\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"client_id\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"{client ID}\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"client_secret\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"{client secret}\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"refresh_token\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"{refresh Token}\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"type\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"authorized_user\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"universe_domain\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"googleapis.com\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"type\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"impersonated_service_account\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"vault-\\uC124\\uC815\",children:[(0,e.jsx)(n.a,{href:\"#vault-\\uC124\\uC815\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Vault \\uC124\\uC815\"]}),(0,e.jsx)(n.p,{children:\"Vault\\uB97C kubernetes\\uC5D0\\uC11C \\uC6B4\\uC601\\uD558\\uACE0 \\uC788\\uB2E4\\uBA74 Vault pod\\uC5D0 \\uC811\\uADFC\\uD558\\uC5EC \\uC704\\uC5D0\\uC11C \\uB9CC\\uB4E0 Local ADC \\uD30C\\uC77C\\uC744 \\uB3D9\\uC77C\\uD55C \\uACBD\\uB85C\\uB85C \\uC800\\uC7A5\\uD574\\uC900\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"mkdir\"}),` -p ~/.config/gcloud\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"vi\"}),` ~/.config/gcloud/application_default_credentials.json\n`]})]})}),(0,e.jsx)(n.p,{children:\"oidc \\uC124\\uC815\\uAC12\\uC744 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC124\\uC815\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"vault \",(0,e.jsx)(n.span,{className:\"token function\",children:\"write\"}),\" auth/oidc/config -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<<\"}),(0,e.jsx)(n.span,{className:\"token string\",children:`EOF\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`{\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"oidc_discovery_url\": \"https://accounts.google.com\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"oidc_client_id\": \"{\\uC0DD\\uC131\\uD55C oauth2 client ID}\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"oidc_client_secret\": \"{\\uC0DD\\uC131\\uD55C oauth2 client secret}\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"default_role\": \"sample\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"provider_config\": {\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"provider\": \"gsuite\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"fetch_groups\": true,\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"groups_recurse_max_depth\": 5,\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"domain\": \"{workspace domain \\uC774\\uB984}\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"gsuite_admin_impersonate\": \"{\\uAD6C\\uAE00 \\uACC4\\uC815}\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"impersonate_principal\": \"{service account \\uC774\\uB984}@{project ID}.iam.gserviceaccount.com\"\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    }\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`}\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:\"EOF\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB9AC\\uACE0 role\\uC5D0 \\uB300\\uD574\\uC11C \\uD2B9\\uC815 workspace group\\uC5D0 \\uC18D\\uD55C \\uACBD\\uC6B0\\uB9CC \\uC778\\uC99D\\uC774 \\uB418\\uB3C4\\uB85D \\uC124\\uC815\\uD55C\\uB2E4. \",(0,e.jsx)(n.code,{children:\"user_claim\"}),\"\\uC744 email\\uB85C \\uD558\\uAE30 \\uC704\\uD574\\uC11C\\uB294 \",(0,e.jsx)(n.code,{children:\"oidc_scopes\"}),\"\\uC5D0 \",(0,e.jsx)(n.code,{children:\"email\"}),\"\\uB97C \\uCD94\\uAC00\\uD574\\uC918\\uC57C \\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"vault \",(0,e.jsx)(n.span,{className:\"token function\",children:\"write\"}),\" auth/oidc/role/sample -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<<\"}),(0,e.jsx)(n.span,{className:\"token string\",children:`EOF\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`{\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  \"allowed_redirect_uris\": \"http://localhost:8000/ui/vault/auth/oidc/oidc/callback,http://localhost:8000/oidc/callback\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  \"oidc_scopes\": [\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"openid\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"email\"\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  ],\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  \"user_claim\": \"email\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  \"groups_claim\": \"groups\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  \"bound_claims\": {\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"groups\": [\"{group\\uBA85}@{workspace \\uB3C4\\uBA54\\uC778\\uBA85}\"]\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`  }\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`}\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:\"EOF\"}),`\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"vault-oidc-login\",children:[(0,e.jsx)(n.a,{href:\"#vault-oidc-login\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Vault OIDC Login\"]}),(0,e.jsx)(n.p,{children:\"\\uC124\\uC815\\uC774 \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uB418\\uC5C8\\uB2E4\\uBA74 \\uC544\\uB798\\uC758 \\uD654\\uBA74\\uC5D0\\uC11C \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uB85C\\uADF8\\uC778\\uC774 \\uB41C\\uB2E4.\"}),(0,e.jsx)(\"img\",{src:\"/static/images/vault-oidc-ui.png\",alt:\"vault oidc login page\"}),(0,e.jsxs)(n.h2,{id:\"\\uBC29\\uBC95-1\",children:[(0,e.jsx)(n.a,{href:\"#\\uBC29\\uBC95-1\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uBC29\\uBC95 1\"]}),(0,e.jsxs)(n.h3,{id:\"service-account-key-\\uD30C\\uC77C-\\uC0AC\\uC6A9\",children:[(0,e.jsx)(n.a,{href:\"#service-account-key-\\uD30C\\uC77C-\\uC0AC\\uC6A9\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Service Account key \\uD30C\\uC77C \\uC0AC\\uC6A9\"]}),(0,e.jsxs)(n.p,{children:[\"GCP \\uCF58\\uC194\\uC5D0\\uC11C Service Account Key\\uB97C \\uBC1C\\uAE09\\uD558\\uC5EC \\uC0AC\\uC6A9\\uD55C\\uB2E4\\uACE0 \\uD558\\uBA74 \\uBA3C\\uC800 \\uC6D0\\uD558\\uB294 \\uACBD\\uB85C\\uC5D0 \\uD574\\uB2F9 \\uD30C\\uC77C\\uC744 \\uBCF5\\uC0AC\\uD55C\\uB2E4. \\uC608\\uB97C \\uB4E4\\uC5B4\\uC11C Home Directory\\uC5D0 service-account.json \\uD30C\\uC77C\\uB85C \\uC0DD\\uC131\\uD588\\uB2E4\\uBA74, \",(0,e.jsx)(n.code,{children:\"gsuite_service_account\"}),\"\\uC5D0 \\uD574\\uB2F9 \\uACBD\\uB85C\\uB97C \\uC124\\uC815\\uD55C\\uB2E4. \\uADF8\\uB7EC\\uBA74 \\uC774\\uC81C service account key file\\uC744 \\uD1B5\\uD574\\uC11C Directory API\\uC5D0 \\uC811\\uADFC\\uD55C\\uB2E4. \\uC774\\uBC88\\uC5D0\\uB294 domain wide delegation \\uBC29\\uC2DD\\uC73C\\uB85C \\uAD8C\\uD55C\\uC744 \\uC8FC\\uC9C0 \\uC54A\\uB3C4\\uB85D \",(0,e.jsx)(n.code,{children:\"impersonate_principal\"}),\"\\uC640 \",(0,e.jsx)(n.code,{children:\"gsuite_admin_impersonate\"}),\" \\uC124\\uC815\\uC740 \\uD558\\uC9C0 \\uC54A\\uC558\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"vault \",(0,e.jsx)(n.span,{className:\"token function\",children:\"write\"}),\" auth/oidc/config -\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<<\"}),(0,e.jsx)(n.span,{className:\"token string\",children:`EOF\n`})]}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`{\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"oidc_discovery_url\": \"https://accounts.google.com\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"oidc_client_id\": \"{\\uC0DD\\uC131\\uD55C oauth2 client ID}\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"oidc_client_secret\": \"{\\uC0DD\\uC131\\uD55C oauth2 client secret}\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"default_role\": \"sample\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    \"provider_config\": {\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"provider\": \"gsuite\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"gsuite_service_account\": \"/home/vault/service-account.json\",\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"fetch_groups\": true,\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"groups_recurse_max_depth\": 5,\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`            \"domain\": \"{workspace domain \\uC774\\uB984}\"\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`    }\n`})}),(0,e.jsx)(n.span,{className:\"code-line\",children:(0,e.jsx)(n.span,{className:\"token string\",children:`}\n`})}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string\",children:\"EOF\"}),`\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"role-\\uBD80\\uC5EC\",children:[(0,e.jsx)(n.a,{href:\"#role-\\uBD80\\uC5EC\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Role \\uBD80\\uC5EC\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.a,{href:\"https://developers.google.com/admin-sdk/directory/reference/rest/v1/roles/list\",children:\"\\uC544\\uB798\\uCC98\\uB7FC \\uC6F9 \\uD398\\uC774\\uC9C0\\uC758 \\uC624\\uB978\\uCABD\\uC5D0 \\uC788\\uB294 \\uCC3D\\uC73C\\uB85C API \\uC694\\uCCAD\\uC744 \\uBC14\\uB85C \\uD14C\\uC2A4\\uD2B8 \\uD560 \\uC218 \\uC788\\uB2E4.\"})}),(0,e.jsx)(\"img\",{src:\"/static/images/vault-oidc-role.png\",alt:\"Request Role List On Web\"}),(0,e.jsxs)(n.p,{children:[\"\\uC694\\uCCAD\\uC744 \\uD574\\uBCF4\\uBA74 Admin Directory Role\\uB4E4\\uC774 \\uBCF4\\uC774\\uACE0, \\uADF8\\uC911\\uC5D0\\uC11C \\uD544\\uC694\\uD55C \\uAD8C\\uD55C\\uC774 \\uC788\\uB294 \",(0,e.jsx)(n.code,{children:\"_GROUPS_ADMIN_ROLE\"}),\"\\uB97C \\uC0AC\\uC6A9\\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-json\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-json\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"kind\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"admin#directory#role\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"etag\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\\\\\"d9aT4dOLOjokkvLTmm9XBfjJDibmEEBPEGlwx1-6rsA/iUlV2qBguyme9hsqIzEaTwZJ7J8\\\\\"\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"roleId\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"39020349843721106\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"roleName\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"_GROUPS_ADMIN_ROLE\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"roleDescription\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"Groups Administrator\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"rolePrivileges\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"privilegeName\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"GROUPS_ALL\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"serviceId\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"-\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"privilegeName\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"GROUPS_MANAGE_LOCKED_LABEL\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"serviceId\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"-\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"privilegeName\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"GROUPS_MANAGE_SECURITY_LABEL\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"serviceId\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"-\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"privilegeName\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"ORGANIZATION_UNITS_RETRIEVE\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"serviceId\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"-\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"privilegeName\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"USERS_RETRIEVE\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"serviceId\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"-\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"privilegeName\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"ADMIN_DASHBOARD\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"serviceId\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"-\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"isSystemRole\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"isSuperAdminRole\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"false\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.a,{href:\"https://developers.google.com/admin-sdk/directory/reference/rest/v1/roleAssignments/insert\",children:\"\\uB3D9\\uC77C\\uD55C \\uBC29\\uC2DD\\uC73C\\uB85C \\uC774\\uC81C RoleAssignment API\\uB97C \\uC6F9 \\uD654\\uBA74\\uC5D0\\uC11C \\uBC14\\uB85C \\uC694\\uCCAD \\uD55C\\uB2E4.\"}),\" \",(0,e.jsx)(n.code,{children:\"assignedTo\"}),\"\\uB97C service account\\uC758 cleint ID\\uB97C \\uC124\\uC815\\uD558\\uC5EC \\uD574\\uB2F9 Role\\uC774 \\uBD80\\uC5EC\\uB418\\uB3C4\\uB85D \\uC694\\uCCAD\\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-json\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-json\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"assignedTo\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"{service account client ID}\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"roleId\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"39020349843721106\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"scopeType\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"CUSTOMER\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"kind\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"admin#directory#roleAssignment\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"\\uACB0\\uB860\",children:[(0,e.jsx)(n.a,{href:\"#\\uACB0\\uB860\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uACB0\\uB860\"]}),(0,e.jsx)(n.p,{children:\"Google Workspace\\uB97C \\uC0AC\\uC6A9\\uD55C\\uB2E4\\uBA74 Vault OIDC \\uC778\\uC99D \\uBC29\\uC2DD\\uC744 \\uC0AC\\uC6A9\\uD558\\uB294 \\uAC83\\uC774 \\uC88B\\uACA0\\uB2E4. Application Default Credentials\\uBC29\\uC2DD\\uC5D0\\uC11C \\uC0AC\\uC6A9\\uB418\\uB294 RefreshToken\\uC758 \\uB9CC\\uB8CC\\uAE30\\uAC04\\uC774\\uB098 \\uD68C\\uC218\\uC870\\uAC74\\uC5D0 \\uB300\\uD574\\uC11C\\uB294 \\uB354 \\uC54C\\uC544\\uBD10\\uC57C\\uACA0\\uC9C0\\uB9CC, Static\\uD558\\uAC8C Service Account Key\\uB97C \\uBC1C\\uAE09\\uBC1B\\uB294 \\uAC83\\uBCF4\\uB2E4\\uB294 \\uB354 \\uC88B\\uC740 \\uBC29\\uBC95\\uC774\\uB77C\\uACE0 \\uC0DD\\uAC01\\uC774 \\uB4E0\\uB2E4. \\uB530\\uB77C\\uC11C ADC\\uB97C \\uD65C\\uC6A9\\uD574\\uC11C \\uC124\\uC815\\uC744 \\uD574\\uBCF4\\uACE0 \\uC2F6\\uC5C8\\uB2E4. \\uD558\\uC9C0\\uB9CC \\uADF8 \\uACFC\\uC815\\uC5D0\\uC11C \\uD544\\uC694\\uD55C \\uAD8C\\uD55C\\uB4E4\\uC744 \\uBD80\\uC5EC\\uD558\\uC9C0 \\uC54A\\uC544\\uC11C Workspace\\uC758 User\\uC640 Group \\uC815\\uBCF4\\uB97C \\uAC00\\uC838\\uC624\\uB294\\uB370 \\uAD8C\\uD55C\\uBB38\\uC81C\\uAC00 \\uBC1C\\uC0DD\\uD588\\uB2E4. \\uB610 \\uD55C\\uBC88 \\uC0BD\\uC9C8\\uC744 \\uD1B5\\uD574\\uC11C \\uC62C\\uBC14\\uB978 \\uC124\\uC815 \\uBC29\\uBC95\\uC744 \\uC54C\\uAC8C \\uB418\\uC5C8\\uB2E4.\\u{1F62D}\"})]})}}var y=_;return A;})();\n;return Component;","toc":[{"value":"Oauth 2.0 Client 생성","url":"#oauth-20-client-생성","depth":2},{"value":"Service Account 생성","url":"#service-account-생성","depth":2},{"value":"설정 옵션","url":"#설정-옵션","depth":2},{"value":"방법 3","url":"#방법-3","depth":2},{"value":"Directory API 권한 부여","url":"#directory-api-권한-부여","depth":3},{"value":"필요한 Service 사용하도록 설정","url":"#필요한-service-사용하도록-설정","depth":3},{"value":"Service Account에 필요한 권한 부여","url":"#service-account에-필요한-권한-부여","depth":3},{"value":"local ADC 파일 생성","url":"#local-adc-파일-생성","depth":3},{"value":"Vault 설정","url":"#vault-설정","depth":3},{"value":"Vault OIDC Login","url":"#vault-oidc-login","depth":3},{"value":"방법 1","url":"#방법-1","depth":2},{"value":"Service Account key 파일 사용","url":"#service-account-key-파일-사용","depth":3},{"value":"Role 부여","url":"#role-부여","depth":3},{"value":"결론","url":"#결론","depth":2}],"frontMatter":{"readingTime":{"text":"7 min read","minutes":6.08,"time":364800,"words":1216},"slug":"20240714-vault-oidc","fileName":"20240714-vault-oidc.md","title":"구글 계정으로 Vault 로그인하기","date":"2024-07-14T00:00:00.000Z","tags":["vault","devsecops"],"images":["/static/images/social-banner.png"],"summary":"Vault를 구글 인증을 통해서 로그인하도록 설정해본다. Admin Directory API를 통해서 workspace의 user와 group의 정보를 가져올 수 있고, 해당 정보를 통해서 인증 조건을 추가할 수 있다. 예로 특정 workspace group에 속한 계정만 인증에 성공할 수 있도록 조건을 추가할 수 있다. Admin Directory API에 요청하기 위해서 필요한 권한을 설정할 수 있는데, Service Account의 key 파일을 생성하는 대신에, Application Default Credentials를 활용해보았다. Application Default Credentials를 사용하는 과정에서 삽질을 많이 했는데, 혹시나 동일한 작업을 하는 분들은 나처럼 시간을 허비하지 않기를 바라며 글을 작성한다.🥹"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.15,"time":9000,"words":30},"slug":["default"],"fileName":"default.md","name":"Jay","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"Distroless Image에 Package 추가하기","date":"2024-07-13T00:00:00.000Z","tags":["kubernetes","distroless","devsecops"],"images":["/static/images/social-banner.png"],"summary":"컨테이너 이미지에 최소한으로 필요한 software만 포함하는 것이 보안적으로 모범사례이다. 이러한 모범사례를 따르는 가장 쉽고 합리적인 방법은 구글에서 제공하는 Distroless Image를 활용하는 것이다. Distroless Image는 nonroot, debug, debug-nonroot Tag를 가지고 있다. nonroot은 conatiner에게 root 권한을 주지않고, shell도 없어서 Terminal로 접속이 불가능하다. 그런데 Distroless Image에 추가로 필요한 debian package를 설치하면 어떻게 해야할까? 이번 글에서는 bazel로 빌드할 때 원하는 debian package를 추가하는 방법을 알아 본다.","slug":"20240713-add-package-to-distroless-image"},"next":null},"__N_SSG":true}