{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var o=Object.create;var c=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var i=a=>c(a,\"__esModule\",{value:!0});var u=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=>{i(a);for(var l in s)c(a,l,{get:s[l],enumerable:!0})},k=(a,s,l)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let n of p(s))!m.call(a,n)&&n!==\"default\"&&c(a,n,{get:()=>s[n],enumerable:!(l=d(s,n))||l.enumerable});return a},g=a=>k(i(c(a!=null?o(h(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var r=u((C,t)=>{t.exports=_jsx_runtime});var f={};N(f,{default:()=>P,frontmatter:()=>b});var e=g(r()),b={title:\"Cilium CNI\\uC640 HostPort\",date:\"2024-02-07\",tags:[\"kubernetes\",\"cilium\"],images:[\"/static/images/social-banner.png\"],summary:\"\\uB124\\uC774\\uBC84 \\uD074\\uB77C\\uC6B0\\uB4DC \\uCFE0\\uBC84\\uB124\\uD2F0\\uC2A4 \\uC11C\\uBE44\\uC2A4\\uC5D0\\uC11C HostPort\\uB97C \\uC124\\uC815\\uD558\\uC600\\uB294\\uB370, \\uC815\\uC0C1\\uC801\\uC73C\\uB85C Node Port\\uB97C \\uD1B5\\uD574\\uC11C Container\\uC5D0 \\uC811\\uADFC\\uD560 \\uC218\\uAC00 \\uC5C6\\uC5C8\\uB2E4. \\uCC98\\uC74C\\uC5D0\\uB294 CNI plugin portmap\\uC744 \\uC124\\uC815\\uD558\\uC5EC HostPort\\uB97C Iptables Rule\\uB85C \\uC801\\uC6A9\\uD558\\uB3C4\\uB85D \\uD558\\uC600\\uB2E4. \\uD558\\uC9C0\\uB9CC \\uD604\\uC7AC \\uC6B4\\uC601\\uD558\\uB294 Kernel \\uBC84\\uC804\\uC774 kube proxy\\uB97C \\uB300\\uCCB4\\uD560 \\uC218 \\uC788\\uB294 \\uAC83\\uC744 \\uD30C\\uC545\\uD558\\uC600\\uACE0, default\\uB85C \\uC124\\uC815\\uB41C KubeProxyReplacement=disabled\\uC744 KubeProxyReplacement=strict\\uC73C\\uB85C \\uC124\\uC815\\uD558\\uC5EC Cilium eBPF\\uB85C \\uB300\\uCCB4\\uD558\\uC5EC \\uC0AC\\uC6A9\\uD558\\uC600\\uB2E4.\"};function y(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(l,{})})):l();function l(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",ul:\"ul\",li:\"li\",p:\"p\",code:\"code\",pre:\"pre\",blockquote:\"blockquote\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"\\uD14C\\uC2A4\\uD2B8-\\uD658\\uACBD\",children:[(0,e.jsx)(n.a,{href:\"#\\uD14C\\uC2A4\\uD2B8-\\uD658\\uACBD\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uD14C\\uC2A4\\uD2B8 \\uD658\\uACBD\"]}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:\"\\uB124\\uC774\\uBC84 \\uD074\\uB77C\\uC6B0\\uB4DC \\uCFE0\\uBC84\\uB124\\uD2F0\\uC2A4 \\uC11C\\uBE44\\uC2A4 \\uBC84\\uC804: 1.26\"}),(0,e.jsx)(n.li,{children:\"Cilium \\uBC84\\uC804: 1.10.16\"}),(0,e.jsx)(n.li,{children:\"\\uCEE4\\uB110 \\uBC84\\uC804: 5.4.0-163-generic\"})]}),(0,e.jsxs)(n.h2,{id:\"\\uC774\\uC288-\\uC0AC\\uD56D\",children:[(0,e.jsx)(n.a,{href:\"#\\uC774\\uC288-\\uC0AC\\uD56D\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uC774\\uC288 \\uC0AC\\uD56D\"]}),(0,e.jsx)(n.p,{children:\"OpenTelemetry collector\\uB97C DaemonSet\\uC73C\\uB85C \\uC124\\uCE58\\uB97C \\uD558\\uC600\\uB2E4. \\uADF8\\uB9AC\\uACE0 Web server\\uAC00 \\uB3CC\\uACE0 \\uC788\\uB294 Pod\\uAC00 Trace \\uC815\\uBCF4\\uB97C Collector\\uC5D0 \\uBCF4\\uB0B4\\uACE0\\uC790 \\uD588\\uB2E4. OpenTelemetry Collector\\uAC00 HostPort\\uB85C \\uC124\\uC815\\uC774 \\uB418\\uC5B4 \\uC788\\uC5C8\\uACE0, Pod\\uB294 \\uC774 HostPort\\uB85C \\uC5F0\\uACB0\\uC744 \\uC2DC\\uB3C4\\uD588\\uB2E4.\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"opentelemetry collector \\uC124\\uC815\"})}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Ports\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" 4317/TCP\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` 4318/TCP\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"Host Ports\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" 4317/TCP\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),` 4318/TCP\n`]})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"Web server\\uAC00 \\uB3CC\\uACE0 \\uC788\\uB294 Pod\\uC758 Deployment \\uC124\\uC815\"})}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` NODE_IP\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"valueFrom\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"fieldRef\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"fieldPath\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` status.hostIP\n`]})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"OpenTelemetry SDK\\uB97C \\uD1B5\\uD574\\uC11C Trace\\uB97C \\uC804\\uC1A1\"})}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-js\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"traceExporter\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"OTLPTraceExporter\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  url\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsxs)(n.span,{className:\"token template-string\",children:[(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"http://\"}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"${\"}),\"process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"NODE_IP\"}),(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:\":4318/v1/traces\"}),(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uD558\\uC9C0\\uB9CC OpenTelemetry Collector\\uAC00 \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uC2E4\\uD589\\uB418\\uACE0 \\uC788\\uC5C8\\uC9C0\\uB9CC, Node\\uC5D0\\uC11C \\uD574\\uB2F9 collector\\uB85C \\uC5F0\\uACB0\\uD558\\uC9C0 \\uBABB\\uD558\\uACE0 Connection refused\\uAC00 \\uBC1C\\uC0DD\\uD558\\uC600\\uB2E4. \\uB124\\uC774\\uBC84 \\uD074\\uB77C\\uC6B0\\uB4DC \\uCFE0\\uBC84\\uB124\\uD2F0\\uC2A4\\uC5D0\\uC11C Cilium\\uC774 CNI\\uB85C \\uC124\\uC815\\uC774 \\uB418\\uC5B4 \\uC788\\uC5C8\\uACE0, \\uC544\\uB798\\uC640 \\uAC19\\uC774 cilium cli\\uB97C \\uD1B5\\uD574\\uC11C service \\uBAA9\\uB85D\\uC744 \\uD655\\uC778\\uD558\\uC600\\uB2E4. \\uD558\\uC9C0\\uB9CC \",(0,e.jsx)(n.code,{children:\"HostPort\"}),\" Service Type\\uC740 \\uBAA9\\uB85D\\uC5D0\\uC11C \\uBCF4\\uC774\\uC9C0 \\uC54A\\uC558\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"kubectl \",(0,e.jsx)(n.span,{className:\"token class-name builtin\",children:\"exec\"}),\" -it cilium-4d93a -n kube-system -- cilium \",(0,e.jsx)(n.span,{className:\"token function\",children:\"service\"}),` list\n`]})})}),(0,e.jsxs)(n.h2,{id:\"hostport\",children:[(0,e.jsx)(n.a,{href:\"#hostport\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"HostPort\"]}),(0,e.jsxs)(n.p,{children:[\"Kubernetes\\uC5D0\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \",(0,e.jsx)(n.code,{children:\"HostPort\"}),\"\\uB97C \\uC124\\uC815\\uD558\\uBA74, Pod\\uAC00 Node\\uC758 Port\\uC5D0\\uC11C listening\\uD560 \\uC218 \\uC788\\uB2E4. \\uC544\\uB798\\uC758 \\uACBD\\uC6B0\\uB294 Node\\uC758 8080 Port\\uC5D0 \\uC694\\uCCAD\\uD558\\uBA74 Container\\uC758 80 Port\\uC5D0 \\uC5F0\\uACB0\\uD560 \\uC218 \\uC788\\uB2E4. \\uC77C\\uBC18\\uC801\\uC73C\\uB85C Iptable\\uC758 nat table\\uC5D0 Rule\\uB4E4\\uC774 \\uC0DD\\uC131\\uB418\\uC5B4 \\uC774\\uB807\\uAC8C \\uC791\\uB3D9\\uB41C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` apps/v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Deployment\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" my\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`nginx\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"selector\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"matchLabels\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"run\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" my\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`nginx\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"replicas\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"template\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"labels\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"run\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" my\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`nginx\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"containers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" my\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`nginx\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"image\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` nginx\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"ports\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"containerPort\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"80\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"hostPort\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8080\"}),`\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"hostport-with-ciliums-ebpf\",children:[(0,e.jsx)(n.a,{href:\"#hostport-with-ciliums-ebpf\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"HostPort with Cilium's eBPF\"]}),(0,e.jsxs)(n.p,{children:[\"Cilium\\uC740 eBPF\\uB85C Kube Proxy\\uB97C \\uB300\\uCCB4\\uD560 \\uC218 \\uC788\\uB2E4. \",(0,e.jsx)(n.a,{href:\"https://docs.cilium.io/en/v1.11/operations/system_requirements/\",children:\"Cilium v1.11\\uC758 \\uBB38\\uC11C\"}),\"\\uB97C \\uBCF4\\uBA74, kube proxy\\uB97C \\uB300\\uCCB4\\uD558\\uAE30 \\uC704\\uD574\\uC11C kernel version\\uC774 5.2\\uC774\\uC0C1\\uC5D0\\uC11C \\uAC00\\uB2A5\\uD558\\uB2E4. \\uD14C\\uC2A4\\uD2B8\\uD558\\uB294 \\uD658\\uACBD\\uC740 \\uCEE4\\uB110 \\uBC84\\uC804\\uC774 5.4\\uC774\\uC0C1\\uC774\\uB2C8\\uAE50 cilium\\uC774 eBPF\\uB85C kube proxy\\uB97C \\uB300\\uCCB4\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(\"img\",{src:\"/static/images/cilium-required-kernel-version-1.11.png\",alt:\"cilium required kernel version\"}),(0,e.jsxs)(n.p,{children:[\"BPF-based host routing\\uC740 kernel version 5.10 \\uC774\\uC0C1\\uC774\\uC5B4\\uC57C \\uD558\\uB294\\uB370, \\uB530\\uB77C\\uC11C \\uD574\\uB2F9 \\uC124\\uC815\\uC740 cilium agent log\\uB97C \\uD655\\uC778\\uD574\\uBCF4\\uBA74 \\uC544\\uB798\\uCC98\\uB7FC 5.10\\uC774 \\uC544\\uB2C8\\uB77C\\uC11C \",(0,e.jsx)(n.code,{children:\"enable-host-legacy-routing\"}),\"\\uC774 \\uC790\\uB3D9\\uC73C\\uB85C true\\uB85C \\uC14B\\uD305\\uB418\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"level\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`info\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"msg\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"BPF host routing requires kernel 5.10 or newer. Falling back to legacy host routing (enable-host-legacy-routing=true).\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:\"subsys\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`daemon\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"Helm chart\\uB85C Cilium\\uC744 \\uC124\\uCE58\\uD558\\uBA74 \",(0,e.jsx)(n.code,{children:\"cilium-config\"}),\"\\uAC00 ConfigMap object\\uB85C \\uC0DD\\uC131\\uB418\\uB294\\uB370, \",(0,e.jsx)(n.a,{href:\"https://github.com/cilium/cilium/blob/v1.10.16/install/kubernetes/cilium/templates/cilium-configmap.yaml\",children:\"ConfigMap\\uC758 \\uAC12\\uC73C\\uB85C Cilium\\uC758 \\uC124\\uC815\\uC774 \\uACB0\\uC815\\uB41C\\uB2E4.\"}),\". \\uC5EC\\uAE30\\uC11C \\uAD00\\uC2EC\\uC788\\uAC8C \\uBD10\\uC57C\\uD560 \\uC124\\uC815\\uAC12\\uC740 \",(0,e.jsx)(n.code,{children:\"kube-proxy-relacement\"}),\"\\uC774\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.a,{href:\"https://docs.cilium.io/en/v1.11/gettingstarted/kubeproxy-free/#kube-proxy-hybrid-modes\",children:\"cilium v1.11\\uC5D0\\uC11C kubeProxyReplacement\\uC744 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uB124 \\uAC00\\uC9C0\\uC911\\uC5D0 \\uD558\\uB098\\uB85C \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB2E4.\"})}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:\"strict: eBPF\\uB85C \\uB2E4 \\uB300\\uCCB4\"}),(0,e.jsx)(n.li,{children:\"probe: \\uB300\\uCCB4\\uD560 \\uC218 \\uC788\\uB294\\uAC83\\uB9CC eBPF\\uB85C \\uB300\\uCCB4\\uD558\\uACE0 \\uB098\\uBA38\\uC9C0\\uB294 kube proxy\\uB791 \\uAC19\\uC774 \\uACF5\\uC874\"}),(0,e.jsx)(n.li,{children:\"partial: \\uC6D0\\uD558\\uB294 \\uBD80\\uBD84\\uB9CC enable\\uD574\\uC11C eBPF\\uB85C \\uB300\\uCCB4\"}),(0,e.jsx)(n.li,{children:\"disabled\"})]}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB7F0\\uB370 \\uB124\\uC774\\uBC84 \\uD074\\uB77C\\uC6B0\\uB4DC \\uCFE0\\uBC84\\uB124\\uD2F0\\uC2A4 \\uC11C\\uBE44\\uC2A4\\uC758 \",(0,e.jsx)(n.code,{children:\"cilium-config\"}),\"\\uC758 \",(0,e.jsx)(n.code,{children:\"kube-proxy-replacement\"}),\"\\uAC00 \\uAE30\\uBCF8\\uC73C\\uB85C disabled\\uB85C \\uB418\\uC5B4 \\uC788\\uC5C8\\uB2E4.\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"kubeProxyReplacement=disabled: This option disables any Kubernetes service handling by fully relying on kube-proxy instead, except for ClusterIP services accessed from pods (pre-v1.6 behavior).\"})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"cilium status\"}),\" CLI \\uBA85\\uB839\\uC5B4\\uB85C \\uD655\\uC778\\uC744 \\uD558\\uBA74, HostPort\\uAC00 Disabled\\uB85C \\uB098\\uC628\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ kubectl \",(0,e.jsx)(n.span,{className:\"token class-name builtin\",children:\"exec\"}),` -it cilium-4d93a -n kube-system -- cilium status --verbose\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"..\"}),`.\\uC0DD\\uB7B5\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`KubeProxyReplacement Details:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  Services:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    - ClusterIP:      Enabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    - NodePort:       Disabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    - LoadBalancer:   Disabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    - externalIPs:    Disabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    - HostPort:       Disabled\n`})]})}),(0,e.jsxs)(n.h2,{id:\"cni-plugin-portmap\",children:[(0,e.jsx)(n.a,{href:\"#cni-plugin-portmap\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"CNI plugin portmap\"]}),(0,e.jsxs)(n.p,{children:[\"\\uCC98\\uC74C\\uC5D0 \",(0,e.jsx)(n.code,{children:\"partial\"}),\" \\uC124\\uC815\\uC73C\\uB85C \",(0,e.jsx)(n.code,{children:\"HostPort\"}),\"\\uB9CC Enabled\\uC744 \\uD574\\uBCFC\\uB824\\uACE0 \\uD558\\uB294\\uB370 \\uC548\\uB418\\uC5C8\\uB2E4. \\uADF8\\uB798\\uC11C eBPF\\uB85C HostPort\\uAC00 \\uB300\\uCCB4\\uB418\\uC9C0 \\uBABB\\uD558\\uB294 \\uC904 \\uC54C\\uC558\\uB2E4. \\uADF8\\uB807\\uAC8C \\uB610 \\uD55C\\uBC88 \\uC4F8\\uB370 \\uC5C6\\uB294 \\uC0BD\\uC9C8\\uC744 \\uD558\\uAC8C \\uB418\\uC5C8\\uB2E4.\\u{1F979} \",(0,e.jsx)(n.code,{children:\"KubeProxyReplacement\"}),\"\\uB97C \",(0,e.jsx)(n.code,{children:\"disabld\"}),\"\\uB85C \\uC720\\uC9C0\\uD558\\uACE0, \",(0,e.jsx)(n.a,{href:\"https://docs.cilium.io/en/latest/installation/cni-chaining-portmap/#portmap-hostport\",children:\"CNI chaining\\uC73C\\uB85C PortMap\\uC744 \\uC0AC\\uC6A9\"}),\"\\uD558\\uB294 \\uBC29\\uBC95\\uC744 \\uC801\\uC6A9\\uD588\\uB2E4.\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"cilium-config\"}),\" ConfigMap\\uC5D0\\uC11C \",(0,e.jsx)(n.code,{children:\"cni-chaining-mode\"}),\"\\uB97C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC124\\uC815\\uD558\\uACE0, Opentelemetry Collector\\uB97C restart\\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` ConfigMap\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"...\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"data\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"...\"}),`\\uC0DD\\uB7B5\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"cni-chaining-mode\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` portmap\n`]})]})}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`kubectl rollout restart daemonset/cilium -n kube-system\n`})})}),(0,e.jsxs)(n.p,{children:[\"\\uC774\\uB807\\uAC8C \\uC801\\uC6A9\\uD558\\uACE0 \\uB098\\uBA74 \",(0,e.jsx)(n.code,{children:\"/etc/cni/net.d/05-cilium.conflist\"}),\"\\uC5D0 cni \\uC124\\uC815 \\uD30C\\uC77C\\uC774 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uC0DD\\uC131\\uB41C\\uB2E4. \",(0,e.jsx)(n.code,{children:\"portmap\"}),\"\\uC774 plugin\\uC5D0 \\uCD94\\uAC00\\uB41C \\uAC83\\uC744 \\uD655\\uC778 \\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-json\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-json\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"cniVersion\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"0.3.1\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"portmap\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"plugins\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"name\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"cilium\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"type\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"cilium-cni\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"enable-debug\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"false\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"type\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"portmap\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"capabilities\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,e.jsx)(n.span,{className:\"token property\",children:'\"portMappings\"'}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uC774\\uC81C \\uB2E4\\uC2DC HostPort\\uAC00 \\uC124\\uC815\\uB41C Deployment Object\\uC744 \\uC0DD\\uC131\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Deployment\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" my\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`nginx\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"selector\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"matchLabels\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"run\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" my\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`nginx\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"replicas\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"template\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"labels\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"run\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" my\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`nginx\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"containers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" my\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`nginx\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"image\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` nginx\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"ports\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"containerPort\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"80\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"hostPort\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8080\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\uC774\\uBC88\\uC5D0\\uB294 \\uC544\\uB798\\uC640 \\uAC19\\uC774 cni plugin \",(0,e.jsx)(n.code,{children:\"portmap\"}),\" binary \\uD30C\\uC77C\\uC774 \\uC5C6\\uC5B4\\uC11C Pod\\uAC00 \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uC2E4\\uD589\\uB418\\uC9C0 \\uBABB \\uD588\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-log\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-log\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token property\",children:\"error killing pod:\"}),\" failed to \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"KillPodSandbox\"'}),\" for \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"1055faa0-7449-49ba-9e25-b6e46de342b1\"'}),\" \",(0,e.jsx)(n.span,{className:\"token property\",children:\"with KillPodSandboxError:\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:['\"rpc error',(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" code \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" Unknown desc \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),' failed to destroy network for sandbox \\\\\"',(0,e.jsx)(n.span,{className:\"token constant hash\",children:\"79eade222dddaff28fcb79d001a47e581acfc501fe4b1c220c9f99b1415cfae3\"}),'\\\\\"',(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"plugin type\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"\\\\\",(0,e.jsx)(n.span,{className:\"token string\",children:'\"portmap\\\\\" failed (delete): failed to find plugin \\\\\"portmap\\\\\" in path [/opt/cni/bin]\"'}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"Worker Node\\uC5D0 \\uB4E4\\uC5B4\\uAC00\\uC11C cni plugin binary\\uB97C \\uD655\\uC778\\uD558\\uB2C8 \\uC544\\uB798\\uCC98\\uB7FC \\uB450 \\uAC1C\\uB9CC \\uC874\\uC7AC\\uD558\\uC600\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ \",(0,e.jsx)(n.span,{className:\"token function\",children:\"ls\"}),` /opt/cni/bin\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`cilium-cni\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`loopback\n`})]})}),(0,e.jsxs)(n.p,{children:[\"\\uADF8\\uB798\\uC11C Go\\uB97C \\uC124\\uCE58\\uD558\\uACE0 cni plugin \\uC18C\\uC2A4\\uCF54\\uB4DC\\uB97C clone\\uD558\\uC5EC\\uC11C build\\uD558\\uC5EC\\uC11C \",(0,e.jsx)(n.code,{children:\"/opt/cni/bin\"}),\"\\uC5D0 \\uCD94\\uAC00\\uD574\\uC8FC\\uC5C8\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"curl\"}),` -OL https://golang.org/dl/go1.20.4.linux-amd64.tar.gz\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"tar\"}),` -C /usr/local -xvf go1.20.4.linux-amd64.tar.gz\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token class-name builtin\",children:\"export\"}),\" \",(0,e.jsx)(n.span,{className:\"token assign-left variable\",children:(0,e.jsx)(n.span,{className:\"token constant environment\",children:\"PATH\"})}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token constant environment\",children:\"$PATH\"}),`:/usr/local/go/bin\n`]})]})}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"git\"}),` clone https://github.com/containernetworking/plugins.git\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token class-name builtin\",children:\"cd\"}),` plugins\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`./build_linux.sh\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"cp\"}),` bin/portmap /opt/cni/bin/\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\uC774\\uC81C Pod\\uAC00 \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uC791\\uB3D9\\uD558\\uACE0, Iptable\\uC5D0 \\uC544\\uB798\\uC640 \\uAC19\\uC774 Rule\\uC774 \\uCD94\\uAC00\\uB41C \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\\u{1F979} \\uC774\\uC81C \\uC815\\uC0C1\\uC801\\uC73C\\uB85C Node\\uC5D0\\uC11C 8080 \\uD3EC\\uD2B8\\uB85C \\uD574\\uB2F9 \\uCEE8\\uD14C\\uC774\\uB108\\uC5D0 \\uC811\\uADFC\\uD560 \\uC218 \\uC788\\uAC8C \\uB418\\uC5C8\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ iptables-save \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"grep\"}),` HOSTPORT\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\":CNI-HOSTPORT-DNAT - \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\":0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\":CNI-HOSTPORT-MASQ - \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\":0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\":CNI-HOSTPORT-SETMARK - \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\":0\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`-A PREROUTING -m addrtype --dst-type LOCAL -j CNI-HOSTPORT-DNAT\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`-A OUTPUT -m addrtype --dst-type LOCAL -j CNI-HOSTPORT-DNAT\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"-A POSTROUTING -m comment --comment \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"CNI portfwd requiring masquerade\"'}),` -j CNI-HOSTPORT-MASQ\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"-A CNI-DN-dae2e2caa00ed8d022728 -s \",(0,e.jsx)(n.span,{className:\"token number\",children:\"198.18\"}),\".2.27/32 -p tcp -m tcp --dport \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8080\"}),` -j CNI-HOSTPORT-SETMARK\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"-A CNI-DN-dae2e2caa00ed8d022728 -s \",(0,e.jsx)(n.span,{className:\"token number\",children:\"127.0\"}),\".0.1/32 -p tcp -m tcp --dport \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8080\"}),` -j CNI-HOSTPORT-SETMARK\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"-A CNI-HOSTPORT-DNAT -p tcp -m comment --comment \",(0,e.jsxs)(n.span,{className:\"token string\",children:['\"dnat name: ',(0,e.jsx)(n.span,{className:\"token entity\",title:'\\\\\"',children:'\\\\\"'}),\"portmap\",(0,e.jsx)(n.span,{className:\"token entity\",title:'\\\\\"',children:'\\\\\"'}),\" id: \",(0,e.jsx)(n.span,{className:\"token entity\",title:'\\\\\"',children:'\\\\\"'}),\"d629b42b837dcb40bc6a45f2486e76616c72ca15a3dc5cefe2f881ebd0d8222c\",(0,e.jsx)(n.span,{className:\"token entity\",title:'\\\\\"',children:'\\\\\"'}),'\"']}),\" -m multiport --dports \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8080\"}),` -j CNI-DN-dae2e2caa00ed8d022728\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`-A CNI-HOSTPORT-MASQ -m mark --mark 0x2000/0x2000 -j MASQUERADE\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"-A CNI-HOSTPORT-SETMARK -m comment --comment \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"CNI portfwd masquerade mark\"'}),` -j MARK --set-xmark 0x2000/0x2000\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"ebpf\\uB85C-\\uB300\\uCCB4\",children:[(0,e.jsx)(n.a,{href:\"#ebpf\\uB85C-\\uB300\\uCCB4\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"eBPF\\uB85C \\uB300\\uCCB4\"]}),(0,e.jsxs)(n.p,{children:[\"\\uB4A4\\uB2A6\\uAC8C cilium\\uC73C\\uB85C kube proxy\\uB97C \\uC644\\uC804 \\uB300\\uCCB4\\uD560 \\uC218 \\uC788\\uB294 \\uD658\\uACBD\\uC774\\uB77C\\uB294 \\uAC83\\uC774 \\uD30C\\uC545\\uC774 \\uB418\\uC5C8\\uB2E4. \\uADF8\\uB798\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \",(0,e.jsx)(n.code,{children:\"cilium-config\"}),\"\\uB97C \\uBCC0\\uACBD\\uD558\\uACE0, cilium agent\\uB97C \\uC7AC\\uC2DC\\uC791\\uD558\\uC600\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` ConfigMap\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"...\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"data\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"...\"}),`\\uC0DD\\uB7B5\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kube-proxy-replacement\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` strict\n`]})]})}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`kubectl rollout restart daemonset/cilium -n kube-system\n`})})}),(0,e.jsx)(n.p,{children:\"\\uC7AC\\uC2DC\\uC791\\uD558\\uACE0 cilium status\\uB97C \\uD655\\uC778\\uD558\\uBA74 \\uC774\\uC81C Service\\uB4E4\\uC774 \\uB2E4 Enabled\\uB41C \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ kubectl \",(0,e.jsx)(n.span,{className:\"token class-name builtin\",children:\"exec\"}),` -it cilium-tpxvv -- cilium status --verbose\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"..\"}),`.\\uC0DD\\uB7B5\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`KubeProxyReplacement Details:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  Status:                Strict\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  Socket LB Protocols:   TCP, UDP\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  Devices:               eth0 \",(0,e.jsx)(n.span,{className:\"token number\",children:\"192.168\"}),\".1.10 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"Direct Routing\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  Mode:                  SNAT\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  Backend Selection:     Random\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  Session Affinity:      Enabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  XDP Acceleration:      Disabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  Services:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  - ClusterIP:      Enabled\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  - NodePort:       Enabled \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"Range: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"30000\"}),\"-32767\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  - LoadBalancer:   Enabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  - externalIPs:    Enabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  - HostPort:       Enabled\n`})]})}),(0,e.jsx)(n.p,{children:\"\\uC774\\uC81C \\uB2E4\\uC2DC HostPort\\uAC00 \\uC124\\uC815\\uB41C Deployment Object\\uB97C \\uBC30\\uD3EC\\uD558\\uACE0, \\uC544\\uB798\\uC640 \\uAC19\\uC774 Cilium service \\uBAA9\\uB85D\\uC744 \\uD655\\uC778\\uD574\\uBCF8\\uB2E4. \\uADF8\\uB7EC\\uBA74 \\uC6B0\\uB9AC\\uAC00 hostPort 8080, container 80 \\uC124\\uC815\\uD588\\uB358 \\uAC83\\uC774 \\uB4F1\\uB85D\\uB418\\uB294 \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"$ kubectl \",(0,e.jsx)(n.span,{className:\"token class-name builtin\",children:\"exec\"}),\" -it cilium-tpxvv -n kube-system -- cilium \",(0,e.jsx)(n.span,{className:\"token function\",children:\"service\"}),` list\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"159\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"192.168\"}),\".1.10:8080      HostPort       \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"198.18\"}),`.0.24:80\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"160\"}),\"   \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0.0\"}),\".0.0:8080           HostPort       \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\">\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"198.18\"}),`.0.24:80\n`]})]})}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"partial\"}),\"\\uC758 \\uACBD\\uC6B0\\uC5D0\\uB294 \\uC544\\uB798\\uCC98\\uB7FC \",(0,e.jsx)(n.code,{children:\"externalIPs\"}),\"\\uB9CC false\\uB85C \\uC124\\uC815\\uD558\\uBA74 \\uADF8\\uAC83\\uB9CC Disabled\\uD560 \\uC218\\uB3C4 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.pre,{className:\"language-yml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` ConfigMap\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"...\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"data\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"...\"}),`\\uC0DD\\uB7B5\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kube-proxy-replacement\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` partial\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enable-remote-node-identity\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"true\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enable-external-ips\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"false\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enable-host-port\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"true\"'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enable-health-check-nodeport\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"false\"'}),`\n`]})]})}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`KubeProxyReplacement Details:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  Status:              Partial\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  Devices:             eth0 \",(0,e.jsx)(n.span,{className:\"token number\",children:\"192.168\"}),\".1.10 \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"Direct Routing\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  Mode:                SNAT\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  Backend Selection:   Random\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  Session Affinity:    Enabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  XDP Acceleration:    Disabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  Services:\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  - ClusterIP:      Enabled\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  - NodePort:       Enabled \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"Range: \",(0,e.jsx)(n.span,{className:\"token number\",children:\"30000\"}),\"-32767\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  - LoadBalancer:   Enabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  - externalIPs:    Disabled\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  - HostPort:       Enabled\n`})]})}),(0,e.jsx)(n.p,{children:\"\\uADF8\\uB7F0\\uB370 \\uCC98\\uC74C\\uC5D0 portmap\\uC744 \\uC0AC\\uC6A9\\uD574\\uC11C Iptabls rule\\uC774 \\uC0DD\\uACBC\\uACE0, HostPort\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 Pod\\uAC00 \\uC788\\uB294 \\uC0C1\\uD0DC\\uC5D0\\uC11C Cilium\\uC758 eBPF\\uB85C \\uB300\\uCCB4\\uD558\\uB3C4\\uB85D \\uC218\\uC815\\uD558\\uC600\\uB2E4. \\uADF8\\uB798\\uC11C \\uAE30\\uC874 Iptables rule\\uC774 Pod\\uAC00 \\uC0AD\\uC81C\\uB420 \\uB54C \\uAC19\\uC774 \\uC0AD\\uC81C\\uB418\\uC9C0 \\uC54A\\uC558\\uB2E4. \\uADF8\\uB798\\uC11C HostPort \\uC124\\uC815\\uAD00\\uB828 Iptable rule\\uB4E4\\uC774 \\uB0A8\\uC544 \\uC788\\uC5C8\\uB2E4. eBPF\\uB85C \\uC0AC\\uC6A9\\uD560 \\uB54C\\uB294 Iptable rule\\uC774 \\uC788\\uC5B4\\uB3C4 \\uC0C1\\uAD00\\uC5C6\\uC5C8\\uC9C0\\uB9CC, \\uD14C\\uC2A4\\uD2B8\\uB97C \\uC704\\uD574\\uC11C \\uB2E4\\uC2DC portmap\\uC744 \\uC0AC\\uC6A9\\uD558\\uC5EC Iptables\\uC744 \\uC4F8\\uB824\\uACE0 \\uD560 \\uB54C \\uAE30\\uC874 Iptables rule\\uACFC \\uCDA9\\uB3CC\\uC774 \\uC0DD\\uACBC\\uB2E4.\"}),(0,e.jsxs)(n.h2,{id:\"\\uACB0\\uB860\",children:[(0,e.jsx)(n.a,{href:\"#\\uACB0\\uB860\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uACB0\\uB860\"]}),(0,e.jsxs)(n.p,{children:[\"\\uCC98\\uC74C\\uC5D0 \",(0,e.jsx)(n.code,{children:\"HostPort\"}),\" \\uAE30\\uB2A5\\uB9CC \\uC0AC\\uC6A9\\uD558\\uB824\\uACE0 \",(0,e.jsx)(n.code,{children:\"kube-proxy-replacement\"}),\"\\uB97C \",(0,e.jsx)(n.code,{children:\"partial\"}),\"\\uB85C \\uD558\\uACE0 \",(0,e.jsx)(n.code,{children:\"enable-host-port\"}),\"\\uB97C \",(0,e.jsx)(n.code,{children:\"true\"}),\"\\uB85C \\uC124\\uC815\\uD588\\uB2E4. \\uD558\\uC9C0\\uB9CC cilium\\uC758 status\\uC5D0\\uC11C HostPort\\uAC00 Enabled\\uB85C \\uBCC0\\uACBD\\uB418\\uC9C0 \\uC54A\\uACE0 \\uACC4\\uC18D Disabled \\uC0C1\\uD0DC\\uB85C \\uB0A8\\uC544 \\uC788\\uC5C8\\uB2E4. \\uBB38\\uC11C\\uB97C \\uC798 \\uBABB \\uC77D\\uACE0 \\uCEE4\\uB110 \\uBC84\\uC804\\uC774 \\uB0AE\\uC544\\uC11C \\uC9C0\\uC6D0\\uC744 \\uC548\\uD558\\uB294 \\uC904 \\uCC29\\uAC01\\uD588\\uB2E4. \\uADF8\\uB798\\uC11C \",(0,e.jsx)(n.code,{children:\"chainMode\"}),\"\\uB85C \",(0,e.jsx)(n.code,{children:\"portmap\"}),\"\\uC744 \\uC0AC\\uC6A9\\uD558\\uC5EC \\uD14C\\uC2A4\\uD2B8\\uB97C \\uD558\\uAC8C \\uB418\\uC5C8\\uB294\\uB370, \",(0,e.jsx)(n.code,{children:\"cilium-config\"}),\" ConfigMap\\uC744 \\uC218\\uC815\\uD558\\uB294 \\uAC83\\uBFD0\\uB9CC \\uC544\\uB2C8\\uB77C, portmap plugin binary\\uB294 Worker node\\uC5D0 \\uC5C6\\uC5B4\\uC11C \\uD574\\uB2F9 source code\\uB97C build\\uD574\\uC11C binary \\uD30C\\uC77C\\uC744 \\uC801\\uC808\\uD55C \\uACBD\\uB85C\\uC5D0 \\uB123\\uC5B4\\uC8FC\\uB294 \\uC791\\uC5C5\\uAE4C\\uC9C0 \\uD574\\uC918\\uC57C\\uD588\\uB2E4. \\uB124\\uC774\\uBC84 \\uD074\\uB77C\\uC6B0\\uB4DC \\uCFE0\\uBC84\\uB124\\uD2F0\\uC2A4 \\uC11C\\uBE44\\uC2A4\\uC5D0\\uC11C\\uB294 Custom Image\\uB97C \\uC81C\\uACF5\\uD558\\uC9C0 \\uC54A\\uAE30 \\uB54C\\uBB38\\uC5D0, \\uC774\\uB807\\uAC8C \\uD574\\uC57C \\uB418\\uB294 \\uAC83\\uC774 \\uB108\\uBB34 \\uBD88\\uD3B8\\uD558\\uB2E4\\uACE0 \\uC0DD\\uAC01\\uD588\\uB2E4. \\uD558\\uC9C0\\uB9CC \\uB0B4\\uAC00 \\uBB38\\uC11C\\uB97C \\uC798 \\uBABB \\uC77D\\uC5C8\\uB358 \\uAC83\\uC774\\uACE0, \",(0,e.jsx)(n.code,{children:\"enable-host-port\"}),\"\\uAC00 \",(0,e.jsx)(n.code,{children:\"enable-node-port\"}),\"\\uC640 \\uD568\\uAED8 \\uC124\\uC815\\uB420 \\uB54C Enabled\\uC774 \\uB418\\uC5C8\\uB2E4. \\uD574\\uB2F9 Worker Node \\uD658\\uACBD\\uC5D0\\uC11C \",(0,e.jsx)(n.code,{children:\"strict\"}),\" \\uC124\\uC815\\uC73C\\uB85C kube proxy\\uB97C Cilium eBPF\\uB85C \\uB300\\uCCB4\\uD574\\uB3C4 \\uBB38\\uC81C\\uAC00 \\uC5C6\\uC5C8\\uB2E4. \",(0,e.jsx)(n.code,{children:\"cilium-config\"}),\"\\uC758 \",(0,e.jsx)(n.code,{children:\"kube-proxy-replacement\"}),\"\\uC744 \",(0,e.jsx)(n.code,{children:\"probe\"}),\" \\uD639\\uC740 \",(0,e.jsx)(n.code,{children:\"strict\"}),\"\\uB85C \\uC124\\uC815\\uD558\\uBA74 \\uAC04\\uB2E8\\uD558\\uAC8C \\uD574\\uACB0\\uB420 \\uC218 \\uC788\\uB294 \\uBB38\\uC81C\\uC600\\uB2E4. \\u{1F92A}\"]})]})}}var P=y;return f;})();\n;return Component;","toc":[{"value":" ","url":"#-","depth":2},{"value":" ","url":"#-","depth":2},{"value":"HostPort","url":"#hostport","depth":2},{"value":"HostPort with Cilium's eBPF","url":"#hostport-with-ciliums-ebpf","depth":2},{"value":"CNI plugin portmap","url":"#cni-plugin-portmap","depth":2},{"value":"eBPF ","url":"#ebpf-","depth":2},{"value":"","url":"#","depth":2}],"frontMatter":{"readingTime":{"text":"9 min read","minutes":8.43,"time":505800,"words":1686},"slug":"20240207-cilium-host-port","fileName":"20240207-cilium-host-port.md","title":"Cilium CNI HostPort","date":"2024-02-07T00:00:00.000Z","tags":["kubernetes","cilium"],"images":["/static/images/social-banner.png"],"summary":"    HostPort ,  Node Port  Container   .  CNI plugin portmap  HostPort Iptables Rule  .    Kernel  kube proxy     , default  KubeProxyReplacement=disabled KubeProxyReplacement=strict  Cilium eBPF  ."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.15,"time":9000,"words":30},"slug":["default"],"fileName":"default.md","name":"Jay","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"Cert Manager Webhook  Naver Cloud DNS-01 challeng Lets Encrypt  ","date":"2024-01-24T00:00:00.000Z","tags":["kubernetes","ncloud"],"images":["/static/images/social-banner.png"],"summary":"Cert Manager DNS provider  Naver Cloud DNS .  Cert Manager  DNS provider      webhook solver  .  Naver Cloud API  webhook  , Github Action  Image Helm chart  . Cert Manager Boilerplate code test framework       .","slug":"20240124-cert-manager-webhook"},"next":{"title":"Tekton Chain","date":"2024-02-11T00:00:00.000Z","tags":["kubernetes","tekton","devsecops"],"images":["/static/images/social-banner.png"],"summary":"Kubernetes Tekton Chain   Software Supply Chain Security    . Tekton Pipeline git clone , container image build,  OCI registry push .  Tekton Chain  in-toto spec Attestation   .","slug":"20240208-tekton-chain"}},"__N_SSG":true}