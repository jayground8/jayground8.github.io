{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var r=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var i=a=>l(a,\"__esModule\",{value:!0});var u=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=>{i(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let e of p(s))!m.call(a,e)&&e!==\"default\"&&l(a,e,{get:()=>s[e],enumerable:!(c=d(s,e))||c.enumerable});return a},g=a=>k(i(l(a!=null?r(h(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=u((v,t)=>{t.exports=_jsx_runtime});var _={};N(_,{default:()=>f,frontmatter:()=>b});var n=g(o()),b={title:\"Distroless Image\\uC5D0 Package \\uCD94\\uAC00\\uD558\\uAE30\",date:\"2024-07-13\",tags:[\"kubernetes\",\"distroless\",\"devsecops\"],images:[\"/static/images/social-banner.png\"],summary:\"\\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uC5D0 \\uCD5C\\uC18C\\uD55C\\uC73C\\uB85C \\uD544\\uC694\\uD55C software\\uB9CC \\uD3EC\\uD568\\uD558\\uB294 \\uAC83\\uC774 \\uBCF4\\uC548\\uC801\\uC73C\\uB85C \\uBAA8\\uBC94\\uC0AC\\uB840\\uC774\\uB2E4. \\uC774\\uB7EC\\uD55C \\uBAA8\\uBC94\\uC0AC\\uB840\\uB97C \\uB530\\uB974\\uB294 \\uAC00\\uC7A5 \\uC27D\\uACE0 \\uD569\\uB9AC\\uC801\\uC778 \\uBC29\\uBC95\\uC740 \\uAD6C\\uAE00\\uC5D0\\uC11C \\uC81C\\uACF5\\uD558\\uB294 Distroless Image\\uB97C \\uD65C\\uC6A9\\uD558\\uB294 \\uAC83\\uC774\\uB2E4. Distroless Image\\uB294 nonroot, debug, debug-nonroot Tag\\uB97C \\uAC00\\uC9C0\\uACE0 \\uC788\\uB2E4. nonroot\\uC740 conatiner\\uC5D0\\uAC8C root \\uAD8C\\uD55C\\uC744 \\uC8FC\\uC9C0\\uC54A\\uACE0, shell\\uB3C4 \\uC5C6\\uC5B4\\uC11C Terminal\\uB85C \\uC811\\uC18D\\uC774 \\uBD88\\uAC00\\uB2A5\\uD558\\uB2E4. \\uADF8\\uB7F0\\uB370 Distroless Image\\uC5D0 \\uCD94\\uAC00\\uB85C \\uD544\\uC694\\uD55C debian package\\uB97C \\uC124\\uCE58\\uD558\\uBA74 \\uC5B4\\uB5BB\\uAC8C \\uD574\\uC57C\\uD560\\uAE4C? \\uC774\\uBC88 \\uAE00\\uC5D0\\uC11C\\uB294 bazel\\uB85C \\uBE4C\\uB4DC\\uD560 \\uB54C \\uC6D0\\uD558\\uB294 debian package\\uB97C \\uCD94\\uAC00\\uD558\\uB294 \\uBC29\\uBC95\\uC744 \\uC54C\\uC544 \\uBCF8\\uB2E4.\"};function y(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({p:\"p\",a:\"a\",pre:\"pre\",code:\"code\",span:\"span\",h2:\"h2\",blockquote:\"blockquote\",strong:\"strong\",ul:\"ul\",li:\"li\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.p,{children:[\"\\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uC5D0\\uB294 \\uCD5C\\uC18C\\uD55C\\uC73C\\uB85C \\uD544\\uC694\\uD55C \\uAD6C\\uC131\\uC694\\uC18C\\uB9CC \\uB123\\uB294 \\uAC83\\uC774 \\uBAA8\\uBC94 \\uC0AC\\uB840\\uC774\\uB2E4. \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0 \\uD06C\\uAE30\\uAC00 \\uC791\\uC544\\uC838\\uC11C \\uC774\\uBBF8\\uC9C0\\uB97C \\uBCF4\\uAD00\\uD558\\uACE0 \\uC2E4\\uD589\\uD560 \\uB54C \\uC720\\uB9AC\\uD558\\uB2E4. \\uADF8\\uB9AC\\uACE0 \\uBCF4\\uC548 \\uAD00\\uC810\\uC5D0\\uC11C\\uB294 \\uBD88\\uD544\\uC694\\uD55C \\uC18C\\uD504\\uD2B8\\uC6E8\\uC5B4\\uC5D0 \\uC758\\uD574\\uC11C \\uCDE8\\uC57D\\uC810\\uC744 \\uB178\\uCD9C\\uD558\\uB294 \\uAC83\\uC744 \\uBC29\\uC9C0\\uD560 \\uC218 \\uC788\\uB2E4. \\uC774\\uB7EC\\uD55C \\uBAA8\\uBC94 \\uC0AC\\uB840\\uB97C \\uB530\\uB974\\uB294 \\uAC00\\uC7A5 \\uC27D\\uACE0 \\uD569\\uB9AC\\uC801\\uC778 \\uBC29\\uBC95\\uC740 \",(0,n.jsx)(e.a,{href:\"https://github.com/GoogleContainerTools/distroless\",children:\"\\uAD6C\\uAE00\\uC5D0\\uC11C \\uACF5\\uC720\\uD558\\uB294 Distroless Image\"}),\"\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 \\uAC83\\uC774\\uB2E4.\"]}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.a,{href:\"https://github.com/GoogleContainerTools/distroless/blob/main/examples/python3-requirements/Dockerfile\",children:\"Github\\uC5D0\\uC11C \\uC5B4\\uB5BB\\uAC8C Python3 \\uC5B4\\uD50C\\uB9AC\\uCF00\\uC774\\uC158\\uC744 Distroless Image\\uB85C \\uBE4C\\uB4DC\\uD558\\uB294\\uC9C0 \\uC608\\uC81C\"}),\"\\uB97C \\uC81C\\uACF5\\uD55C\\uB2E4. Docker Multi-Stage \\uBE4C\\uB4DC\\uBC29\\uC2DD\\uC744 \\uD1B5\\uD574\\uC11C \\uD544\\uC694\\uD55C python package\\uB97C \\uAE54\\uACE0 \\uCD5C\\uC885\\uC801\\uC73C\\uB85C Distroless Image\\uB97C \\uC0AC\\uC6A9\\uD55C\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-dockerfile\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-Dockerfile\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token instruction\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"FROM\"}),\" debian:11-slim \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"AS\"}),\" build\"]}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token instruction\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"RUN\"}),\" apt-get update && \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\\\\\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token instruction\",children:[\"    apt-get install --no-install-suggests --no-install-recommends --yes python3-venv gcc libpython3-dev && \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\\\\\"}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token instruction\",children:[\"    python3 -m venv /venv && \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\\\\\"}),`\n`]})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token instruction\",children:\"    /venv/bin/pip install --upgrade pip setuptools wheel\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Build the virtualenv as a separate step: Only re-execute this step when requirements.txt changes\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token instruction\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"FROM\"}),\" build \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"AS\"}),\" build-venv\"]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token instruction\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"COPY\"}),\" requirements.txt /requirements.txt\"]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token instruction\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"RUN\"}),\" /venv/bin/pip install --disable-pip-version-check -r /requirements.txt\"]}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Copy the virtualenv into a distroless image\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token instruction\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"FROM\"}),\" gcr.io/distroless/python3-debian11\"]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token instruction\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"COPY\"}),\" \",(0,n.jsxs)(e.span,{className:\"token options\",children:[(0,n.jsx)(e.span,{className:\"token property\",children:\"--from\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"build-venv\"})]}),\" /venv /venv\"]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token instruction\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"COPY\"}),\" . /app\"]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token instruction\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"WORKDIR\"}),\" /app\"]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token instruction\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"ENTRYPOINT\"}),\" [\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"/venv/bin/python3\"'}),\", \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"psutil_example.py\"'}),\"]\"]}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"Distroless Image\\uC5D0\\uC11C\\uB294 nonroot, debug, debug-nonroot Tag\\uB97C \\uC81C\\uACF5\\uD55C\\uB2E4. \\uBB3C\\uB860 Container\\uC5D0 root \\uAD8C\\uD55C\\uC744 \\uC8FC\\uC9C0 \\uC54A\\uB294 \\uAC83\\uC774 \\uBAA8\\uBC94\\uC0AC\\uB840\\uC774\\uAE30 \\uB54C\\uBB38\\uC5D0, nonroot\\uB97C \\uC0AC\\uC6A9\\uD558\\uB294 \\uAC83\\uC774 \\uBC14\\uB78C\\uC9C1\\uD558\\uB2E4. \\uAE30\\uBCF8\\uC801\\uC73C\\uB85C shell\\uC744 \\uC81C\\uACF5\\uD558\\uC9C0 \\uD558\\uC9C0 \\uC54A\\uAE30 \\uB54C\\uBB38\\uC5D0 Container\\uC5D0 Terminal\\uB85C \\uC811\\uADFC\\uC744 \\uD558\\uC9C0 \\uBABB\\uD55C\\uB2E4. \\uB530\\uB77C\\uC11C \\uAC1C\\uBC1C\\uD658\\uACBD\\uC5D0\\uC11C \\uD130\\uBBF8\\uB110\\uB85C \\uC811\\uADFC\\uD558\\uC5EC \\uB514\\uBC84\\uAE45\\uB97C \\uD574\\uC57C\\uD560 \\uB54C, debug tag\\uB97C \\uC0AC\\uC6A9\\uD574\\uC11C \\uC811\\uADFC\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,n.jsxs)(e.h2,{id:\"distroless-image-repo-\\uD655\\uC778\",children:[(0,n.jsx)(e.a,{href:\"#distroless-image-repo-\\uD655\\uC778\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Distroless Image Repo \\uD655\\uC778\"]}),(0,n.jsx)(e.p,{children:\"Distroless Image\\uB294 \\uCD5C\\uC18C\\uD55C\\uC73C\\uB85C \\uD544\\uC694\\uD55C package\\uC640 binary\\uB4E4\\uC774 \\uC124\\uCE58\\uB418\\uC5B4 \\uC788\\uB2E4. \\uC2EC\\uC9C0\\uC5B4 shell \\uBA85\\uB839\\uC5B4\\uB85C \\uC81C\\uACF5\\uB418\\uC9C0 \\uC54A\\uC544\\uC11C Terminal \\uC811\\uADFC\\uC744 \\uD560 \\uC218 \\uC5C6\\uB2E4.\"}),(0,n.jsxs)(e.p,{children:[\"\\uADF8\\uB7F0\\uB370 \\uC5B4\\uD50C\\uB9AC\\uCF00\\uC774\\uC158\\uC5D0\\uC11C \\uD544\\uC694\\uD55C Debian package\\uB97C Distroless Image\\uC5D0 \\uCD94\\uAC00\\uD558\\uACE0 \\uC2F6\\uC73C\\uBA74 \\uC5B4\\uB5BB\\uAC8C \\uD574\\uC57C\\uD560\\uAE4C? \\u{1F914} \\uAD6C\\uAE00\\uB9C1\\uC744 \\uD574\\uBCF4\\uB2C8 \",(0,n.jsx)(e.a,{href:\"https://github.com/GoogleContainerTools/distroless/issues/1321\",children:\"\\uB611\\uAC19\\uC740 \\uC9C8\\uBB38\\uC774 Github issue\"}),\"\\uC5D0 \\uC788\\uC5C8\\uB2E4. \\uB9C8\\uC9C0\\uB9C9 \\uB2F5\\uBCC0\\uC740 Bazel \\uC124\\uC815\\uAC12\\uC5D0\\uC11C \\uC6D0\\uD558\\uB294 debian package\\uB97C \\uCD94\\uAC00\\uD558\\uC5EC distroless image\\uB97C \\uBE4C\\uB4DC\\uD558\\uB294 \\uAC83\\uC774\\uB2E4.\"]}),(0,n.jsx)(e.blockquote,{children:(0,n.jsx)(e.p,{children:\"Bazel is an open-source build and test tool similar to Make, Maven, and Gradle. It uses a human-readable, high-level build language. Bazel supports projects in multiple languages and builds outputs for multiple platforms. Bazel supports large codebases across multiple repositories, and large numbers of users.\"})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.a,{href:\"https://github.com/GoogleContainerTools/distroless/tree/main/python3\",children:\"Distroless Image Github Repository\"}),\"\\uC5D0\\uC11C \\uBCF4\\uBA74, Python3\\uC758 \\uACBD\\uC6B0\\uC5D0 \\uC544\\uB798\\uC640 \\uAC19\\uC774 \",(0,n.jsx)(e.code,{children:\"BUILD\"}),\"\\uB77C\\uB294 \\uD30C\\uC77C\\uC774 \\uBCF4\\uC778\\uB2E4. \",(0,n.jsx)(e.code,{children:\"BUILD\"}),\" \\uD30C\\uC77C\\uC5D0 \\uC5B4\\uB5BB\\uAC8C bazel\\uC774 \\uBE4C\\uB4DC\\uD574\\uC57C\\uD560\\uC9C0 \\uBA85\\uB839\\uC5B4\\uAC00 \\uC124\\uC815\\uB418\\uC5B4 \\uC788\\uB2E4.\"]}),(0,n.jsx)(\"img\",{src:\"/static/images/distroless-image-python3.png\",alt:\"Python3 Distroless Image\"}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"BUILD\"}),\" \\uD30C\\uC77C\\uC744 \\uD655\\uC778\\uD574\\uBCF4\\uB2C8, oci_image\\uC5D0 \\uC6D0\\uD558\\uB294 package\\uB97C \\uCD94\\uAC00\\uD558\\uBA74 \\uAC04\\uB2E8\\uD558\\uAC8C \\uD574\\uACB0\\uB420 \\uAC83\\uCC98\\uB7FC \\uBCF4\\uC600\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"language-bash code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"oci_image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    name \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"python3\"'}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"not mode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" mode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),\":\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" + \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"_\"'}),\" + user + \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"_\"'}),\" + arch + \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"_\"'}),` + distro,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Based on //cc so that C extensions work properly.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    base \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"//cc\"'}),\" + \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"mode \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" mode \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\":cc\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" + \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"_\"'}),\" + user + \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"_\"'}),\" + arch + \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"_\"'}),` + distro,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    entrypoint \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"/usr/bin/python\"'}),\" + DISTRO_VERSION\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"distro\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Use UTF-8 encoding for file system: match modern Linux\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"env\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"LANG\"'}),(0,n.jsx)(e.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"C.UTF-8\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    tars \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"libbz2-1.0\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"libdb5.3\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"libexpat1\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"liblzma5\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"libsqlite3-0\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"libuuid1\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"libncursesw6\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"libtinfo6\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"python3-distutils\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"zlib1g\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"libcom-err2\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"libcrypt1\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"libgssapi-krb5-2\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"libk5crypto3\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"libkeyutils1\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"libkrb5-3\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"libkrb5support0\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"libnsl2\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"libreadline8\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"python3.11-minimal\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token string\",children:'\":python_aliases_%s\"'}),` % distro,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,n.jsxs)(e.h2,{id:\"bazel-build\",children:[(0,n.jsx)(e.a,{href:\"#bazel-build\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Bazel Build\"]}),(0,n.jsx)(e.p,{children:\"bazel\\uC744 \\uC124\\uCE58\\uD558\\uACE0,\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"language-bash code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"brew \",(0,n.jsx)(e.span,{className:\"token function\",children:\"install\"}),` bazel\n`]})})}),(0,n.jsx)(e.p,{children:\"Distroless Image Github Repository\\uB97C \\uD074\\uB860\\uD55C\\uB2E4.\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"language-bash code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"git\"}),` clone https://github.com/GoogleContainerTools/distroless.git\n`]})})}),(0,n.jsxs)(e.p,{children:[\"\\uC704\\uC5D0\\uC11C \",(0,n.jsx)(e.code,{children:\"BUILD\"}),\" \\uD30C\\uC77C\\uC5D0\\uB294 name\\uC774 \\uC774\\uB807\\uAC8C \\uC815\\uC758\\uB418\\uC5B4 \\uC788\\uC5C8\\uB2E4. bazel build \\uBA85\\uB839\\uC5B4\\uB97C \\uC0AC\\uC6A9\\uD560 \\uB54C, \",(0,n.jsx)(e.code,{children:\"//{path}\"}),\"\\uB294 BUILD \\uD30C\\uC77C\\uC774 \\uC788\\uB294 \\uACBD\\uB85C\\uB97C \\uC758\\uBBF8\\uD558\\uB294 \\uAC83\\uAC19\\uB2E4. \\uADF8\\uB9AC\\uACE0 \",(0,n.jsx)(e.code,{children:\"//{path}:{name}\"}),\" \\uC138\\uBBF8\\uCF5C\\uB860 \\uB4A4\\uC5D0\\uB294 \\uC815\\uC758\\uB41C name\\uC744 \\uB123\\uB294 \\uAC83\\uC73C\\uB85C \\uBCF4\\uC778\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"language-bash code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"name \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"python3\"'}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"not mode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" mode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),\":\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" + \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"_\"'}),\" + user + \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"_\"'}),\" + arch + \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"_\"'}),` + distro,\n`]})})}),(0,n.jsx)(e.p,{children:\"\\uCD5C\\uC885\\uC801\\uC73C\\uB85C root \\uAD8C\\uD55C\\uC774 \\uC5C6\\uACE0, debian12\\uB97C base image\\uB85C \\uC0AC\\uC6A9\\uD558\\uB294 amd64 \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0\\uB97C \\uC0DD\\uC131\\uD558\\uAE30 \\uC704\\uD574\\uC11C \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uBA85\\uB839\\uC5B4\\uB97C \\uC0AC\\uC6A9\\uD55C\\uB2E4.\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"language-bash code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`bazel build //python3:python3_nonroot_amd64_debian12\n`})})}),(0,n.jsxs)(e.p,{children:[\"Bazel \\uBE4C\\uB4DC\\uAC00 \\uC815\\uC0C1\\uC801\\uC73C\\uB85C \\uC644\\uB8CC\\uB418\\uBA74, \\uC544\\uB798\\uC640 \\uAC19\\uC774 \\uD30C\\uC77C\\uB4E4\\uC774 \\uC0DD\\uC131\\uB41C\\uB2E4. \",(0,n.jsx)(e.code,{children:\"bazel-bin\"}),\" \\uB514\\uB809\\uD130\\uB9AC \\uC548\\uC744 \\uBCF4\\uBA74 \\uCD5C\\uC885\\uC801\\uC73C\\uB85C \",(0,n.jsx)(e.a,{href:\"https://github.com/opencontainers/image-spec/blob/main/image-layout.md\",children:\"oci \\uADDC\\uACA9\\uC5D0 \\uB9DE\\uCDB0\\uC11C Image\\uAC00 \\uC0DD\\uC131\"}),\"\\uB41C \\uAC83\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,n.jsx)(\"img\",{src:\"/static/images/distroless-image-bazel-build-output.png\",alt:\"Bazel Build Output files\"}),(0,n.jsxs)(e.h2,{id:\"debian-package-\\uCD94\\uAC00\",children:[(0,n.jsx)(e.a,{href:\"#debian-package-\\uCD94\\uAC00\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Debian package \\uCD94\\uAC00\"]}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"ffmpeg\"}),\"\\uB97C \\uCD94\\uAC00\\uD574\\uC57C \\uD55C\\uB2E4\\uACE0 \\uAC00\\uC815\\uD574\\uBCF4\\uC790. \\uADF8\\uB7FC \\uBA3C\\uC800 \",(0,n.jsx)(e.code,{children:\"BUILD\"}),\" \\uD30C\\uC77C\\uC5D0 \\uC544\\uB798\\uC640 \\uAC19\\uC774 ffmpeg\\uB97C \\uCD94\\uAC00\\uD55C\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"language-bash code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"oci_image\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    name \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"python3\"'}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"not mode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" mode\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),\":\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" + \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"_\"'}),\" + user + \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"_\"'}),\" + arch + \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"_\"'}),` + distro,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Based on //cc so that C extensions work properly.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    base \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"//cc\"'}),\" + \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"mode \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" mode \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\":cc\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" + \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"_\"'}),\" + user + \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"_\"'}),\" + arch + \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"_\"'}),` + distro,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    entrypoint \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"/usr/bin/python\"'}),\" + DISTRO_VERSION\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"distro\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# Use UTF-8 encoding for file system: match modern Linux\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"env\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"LANG\"'}),(0,n.jsx)(e.span,{className:\"token builtin class-name\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"C.UTF-8\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    tars \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"..\"}),`.\\uC0DD\\uB7B5\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        deb.package\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arch, distro, \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"ffmpeg\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\", \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# \\uCD94\\uAC00\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token string\",children:'\":python_aliases_%s\"'}),` % distro,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`,\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\uADF8\\uB9AC\\uACE0 \",(0,n.jsx)(e.code,{children:\"private/repos/deb\"}),\" \\uACBD\\uB85C\\uC5D0 \\uC788\\uB294 \\uB450\\uAC00\\uC9C0 \\uD30C\\uC77C\\uB3C4 \\uAC19\\uC774 \\uC218\\uC815\\uD574\\uC918\\uC57C \\uD55C\\uB2E4. (\",(0,n.jsxs)(e.strong,{children:[\"\\uC544\\uC9C1 bazel\\uC774 \\uC775\\uC219\\uD558\\uC9C0 \\uC54A\\uC544\\uC11C \\uC774\\uB807\\uAC8C \\uC218\\uB3D9\\uC73C\\uB85C \\uC218\\uC815\\uD558\\uB294 \\uAC83\\uC774 \\uB9DE\\uB294\\uC9C0\\uB294 \\uC758\\uBB38\\uC774\\uB2E4. \",(0,n.jsx)(e.code,{children:\"_lock\"}),\"\\uC774\\uB77C\\uB294 suffix\\uAC00 \\uC788\\uB294 \\uAC83\\uC73C\\uB85C \\uBD10\\uC11C\\uB294 package manager\\uB85C \\uB2E4\\uC6B4\\uB85C\\uB4DC \\uBC1B\\uACE0 \\uADF8\\uAC83\\uC5D0 \\uB300\\uD55C \\uC815\\uBCF4\\uB97C \\uB0A8\\uACA8 \\uB193\\uB294 \\uAC83 \\uAC19\\uB2E4\\uB294 \\uB290\\uB08C\\uC774 \\uB4E0\\uB2E4. bazel\\uC744 \\uC798 \\uBAA8\\uB974\\uB294 \\uC0C1\\uD0DC\\uC5D0\\uC11C \\uC774\\uB807\\uAC8C \\uD574\\uACB0\\uD588\\uB2E4.\"]}),\")\"]}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:\"bookworm_python.yaml\"}),(0,n.jsx)(e.li,{children:\"bookworm_python_lock.json\"})]}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.code,{children:\"bookworm_python.yaml\"})}),(0,n.jsx)(e.pre,{className:\"language-yaml\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-yaml\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"packages\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` dash\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" libbz2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1.0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" libcom\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),`err2\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" libcrypt1 \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# TODO: glibc library for -lcrypt; maybe should be in cc?\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` libdb5.3\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` libexpat1\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` libffi8\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" ffmpeg \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"# \\uCD94\\uAC00\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.code,{children:\"bookworm_python_lock.json\"})}),(0,n.jsx)(e.pre,{className:\"language-yaml\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-yaml\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token atrule key\",children:'\"packages\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\\uC0DD\\uB7B5\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"...\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token atrule key\",children:'\"arch\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"amd64\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token atrule key\",children:'\"dependencies\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token atrule key\",children:'\"key\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"libffi8_3.4.4-1_amd64\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token atrule key\",children:'\"name\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"libffi8\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token atrule key\",children:'\"sha256\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"6d9f6c25c30efccce6d4bceaa48ea86c329a3432abb360a141f76ac223a4c34a\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token atrule key\",children:'\"url\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"https://snapshot.debian.org/archive/debian/20240706T203757Z/pool/main/libf/libffi/libffi8_3.4.4-1_amd64.deb\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token atrule key\",children:'\"version\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"3.4.4-1\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token atrule key\",children:'\"arch\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"amd64\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token atrule key\",children:'\"dependencies\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token atrule key\",children:'\"key\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"ffmpeg_5.1.5-0_amd64\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token atrule key\",children:'\"name\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"ffmpeg\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token atrule key\",children:'\"sha256\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"6cdb48bab871aacf48aa13e6da0f41e14c39b834763fdd72c346a1e0b0c865a5\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token atrule key\",children:'\"url\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"https://snapshot.debian.org/archive/debian/20240712T023630Z/pool/main/f/ffmpeg/ffmpeg_5.1.5-0+deb12u1_amd64.deb\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\t\",(0,n.jsx)(e.span,{className:\"token atrule key\",children:'\"version\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"5.1.5-0\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\\uC0DD\\uB7B5\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"...\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token atrule key\",children:'\"version\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.a,{href:\"https://tracker.debian.org/pkg/ffmpeg\",children:\"Debian package tracker \\uD398\\uC774\\uC9C0\"}),\"\\uB97C \\uBCF4\\uBA74 \\uC9C0\\uAE08 \\uC791\\uC131\\uD558\\uB294 \\uC2DC\\uC810\\uC5D0\\uC11C \",(0,n.jsx)(e.code,{children:\"5.1.5-0+deb12u1\"}),\"\\uC774 stable\\uD55C \\uBC84\\uC804\\uC774\\uC5C8\\uB2E4.\"]}),(0,n.jsx)(\"img\",{src:\"/static/images/distroless-image-debian-ffmpeg.png\",alt:\"stable version of ffmpeg package\"}),(0,n.jsxs)(e.p,{children:[\"\\uADF8\\uB9AC\\uACE0 \\uB2E4\\uB978 debian package\\uCC98\\uB7FC \",(0,n.jsx)(e.code,{children:\"snapshot\"}),\" \\uACBD\\uB85C\\uC5D0\\uC11C \\uD574\\uB2F9 \\uBC84\\uC804\\uC744 \\uCC3E\\uC558\\uB2E4.\"]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"language-bash code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`https://snapshot.debian.org/archive/debian/20240712T023630Z/pool/main/f/ffmpeg/\n`})})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.a,{href:\"https://packages.debian.org/bookworm/amd64/ffmpeg/download\",children:\"sha256 checksum hash\\uAC12\\uC740 debian package \\uB2E4\\uC6B4\\uB85C\\uB4DC \\uD398\\uC774\\uC9C0\"}),\"\\uC5D0\\uC11C \\uCC3E\\uC544\\uC11C \\uC0AC\\uC6A9\\uD588\\uB2E4.\"]}),(0,n.jsx)(e.p,{children:\"\\uC774\\uC81C \\uB2E4\\uC2DC bazel build \\uBA85\\uB839\\uC5B4\\uB97C \\uC2E4\\uD589\\uD558\\uBA74 \\uD574\\uB2F9 package\\uAC00 \\uCD94\\uAC00\\uB418\\uACE0, \\uCD5C\\uC885\\uC801\\uC73C\\uB85C \\uBE4C\\uB4DC\\uAC00 \\uC131\\uACF5\\uD55C\\uB2E4.\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"language-bash code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`$ bazel build //python3:python3_nonroot_amd64_debian12\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"INFO: Analyzed target //python3:python3_nonroot_amd64_debian12 \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"55\"}),\" packages loaded, \",(0,n.jsx)(e.span,{className:\"token number\",children:\"465\"}),\" targets configured\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`.\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"INFO: Found \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),\" target\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"..\"}),`.\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`INFO: From Writing: bazel-out/darwin_arm64-fastbuild/bin/external/bookworm_python/ffmpeg/amd64/data_statusd.tar:\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"/private/var/tmp/_bazel_user/64d7a1035bb5d33ddc81222bbb467eb5/sandbox/darwin-sandbox/230/execroot/distroless/bazel-out/darwin_arm64-opt-exec-2B5CBBC6/bin/external/rules_pkg/pkg/private/tar/build_tar.runfiles/rules_pkg/pkg/private/tar/build_tar.py:29: SyntaxWarning: invalid escape sequence \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'\\\\ '\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"\"'}),'\"Normalize a path to the ',(0,n.jsx)(e.span,{className:\"token function\",children:\"format\"}),` we need it.\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Target //python3:python3_nonroot_amd64_debian12 up-to-date:\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`  bazel-bin/python3/python3_nonroot_amd64_debian12\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"INFO: Elapsed time: \",(0,n.jsx)(e.span,{className:\"token number\",children:\"7\"}),\".040s, Critical Path: \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),`.32s\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"INFO: \",(0,n.jsx)(e.span,{className:\"token number\",children:\"5\"}),\" processes: \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),\" internal, \",(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),` darwin-sandbox.\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"INFO: Build completed successfully, \",(0,n.jsx)(e.span,{className:\"token number\",children:\"5\"}),` total actions\n`]})]})}),(0,n.jsxs)(e.h2,{id:\"oci-image\\uB97C-push\",children:[(0,n.jsx)(e.a,{href:\"#oci-image\\uB97C-push\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"OCI Image\\uB97C push\"]}),(0,n.jsx)(e.p,{children:\"bazel build\\uB97C \\uD574\\uC11C OCI Image \\uADDC\\uACA9\\uC758 \\uAD6C\\uC870\\uB85C \\uB9CC\\uB4E4\\uC5B4\\uC9C4 \\uAC83\\uC744 \\uD655\\uC778\\uD588\\uC5C8\\uB2E4.\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:\"blobs\"}),(0,n.jsx)(e.li,{children:\"oci-layout\"}),(0,n.jsx)(e.li,{children:\"index.json\"})]}),(0,n.jsxs)(e.p,{children:[\"\\uD574\\uB2F9 \\uAD6C\\uC870\\uC5D0\\uC11C image\\uB97C container registry\\uC5D0 push\\uAE30 \\uC704\\uD574\\uC11C \",(0,n.jsx)(e.a,{href:\"https://github.com/google/go-containerregistry/blob/main/cmd/crane/doc/crane.md\",children:\"crane\"}),\"\\uB97C \\uC0AC\\uC6A9\\uD55C\\uB2E4.\"]}),(0,n.jsx)(e.p,{children:\"crane push \\uBA85\\uB839\\uC5B4\\uB97C \\uD1B5\\uD574\\uC11C \\uBC14\\uB85C container registry\\uC5D0 image push\\uB97C \\uD55C\\uB2E4.\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"language-bash code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"brew \",(0,n.jsx)(e.span,{className:\"token function\",children:\"install\"}),` crane\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"crane push bazel-bin/python3/python3_nonroot_amd64_debian12 \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"\\uCEE8\\uD14C\\uC774\\uB108 \\uB808\\uC9C0\\uC2A4\\uD2F0 \\uACBD\\uB85C\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.h2,{id:\"\\uACB0\\uB860\",children:[(0,n.jsx)(e.a,{href:\"#\\uACB0\\uB860\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\uACB0\\uB860\"]}),(0,n.jsx)(e.p,{children:\"Distroless Image\\uB294 \\uAC01 Runtime\\uBCC4\\uB85C \\uCD5C\\uC18C\\uD55C\\uC73C\\uB85C \\uD544\\uC694\\uD55C Debian package\\uAC00 \\uC124\\uCE58\\uB418\\uC5B4 \\uC788\\uB2E4. \\uD558\\uC9C0\\uB9CC \\uC5B4\\uD50C\\uB9AC\\uCF00\\uC774\\uC158\\uC744 \\uAC1C\\uBC1C\\uD558\\uB2E4 \\uBCF4\\uBA74 \\uCD94\\uAC00\\uB85C \\uB2E4\\uB978 debian package\\uB97C \\uC124\\uCE58\\uD574\\uC57C \\uD560 \\uC218 \\uC788\\uB2E4. \\uAC10\\uC0AC\\uD558\\uAC8C\\uB3C4 Distroless Image Github Repository\\uC5D0 \\uC5B4\\uB5BB\\uAC8C bazel\\uB85C \\uC774\\uBBF8\\uC9C0\\uB97C \\uBE4C\\uB4DC\\uD560 \\uC218 \\uC788\\uB294\\uC9C0 \\uACF5\\uC720\\uD558\\uACE0 \\uC788\\uB2E4. \\uB530\\uB77C\\uC11C \\uBA87 \\uAC00\\uC9C0 \\uD30C\\uC77C\\uB4E4\\uB9CC \\uBCC0\\uACBD\\uD558\\uC5EC \\uC6D0\\uD558\\uB294 debian package\\uAC00 \\uCD94\\uAC00\\uB41C Distroless Image\\uB97C \\uB9CC\\uB4E4 \\uC218 \\uC788\\uC5C8\\uB2E4.\"})]})}}var f=y;return _;})();\n;return Component;","toc":[{"value":"Distroless Image Repo 확인","url":"#distroless-image-repo-확인","depth":2},{"value":"Bazel Build","url":"#bazel-build","depth":2},{"value":"Debian package 추가","url":"#debian-package-추가","depth":2},{"value":"OCI Image를 push","url":"#oci-image를-push","depth":2},{"value":"결론","url":"#결론","depth":2}],"frontMatter":{"readingTime":{"text":"8 min read","minutes":7.42,"time":445200,"words":1484},"slug":"20240713-add-package-to-distroless-image","fileName":"20240713-add-package-to-distroless-image.md","title":"Distroless Image에 Package 추가하기","date":"2024-07-13T00:00:00.000Z","tags":["kubernetes","distroless","devsecops"],"images":["/static/images/social-banner.png"],"summary":"컨테이너 이미지에 최소한으로 필요한 software만 포함하는 것이 보안적으로 모범사례이다. 이러한 모범사례를 따르는 가장 쉽고 합리적인 방법은 구글에서 제공하는 Distroless Image를 활용하는 것이다. Distroless Image는 nonroot, debug, debug-nonroot Tag를 가지고 있다. nonroot은 conatiner에게 root 권한을 주지않고, shell도 없어서 Terminal로 접속이 불가능하다. 그런데 Distroless Image에 추가로 필요한 debian package를 설치하면 어떻게 해야할까? 이번 글에서는 bazel로 빌드할 때 원하는 debian package를 추가하는 방법을 알아 본다."}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.15,"time":9000,"words":30},"slug":["default"],"fileName":"default.md","name":"Jay","avatar":"profile.png","occupation":"Software Engineer","date":null}],"prev":{"title":"Vault Audit Log를 남기기","date":"2024-07-13T00:00:00.000Z","tags":["vault","devsecops"],"images":["/static/images/social-banner.png"],"summary":"Vault에서 다양한 credentials를 보관하게 된다. 따라서 어떤 접근들이 있었는지 Audit Log들을 남겨서 관리하고 싶었다. Vault에서 Audit Device 기능을 제공하여서 file, syslog, socket등으로 Vault API 요청과 응답을 로그로 남길 수 있다. socket은 log 손실의 위험이 있고, syslog는 Vault Pod에서 추가적인 package설치와 설정이 필요하다. 따라서 Kubernetes에서 Vault를 운영하는 과정에서 file 방식으로 Audit log를 남겨보았다.","slug":"20240713-vault-audit"},"next":{"title":"구글 계정으로 Vault 로그인하기","date":"2024-07-14T00:00:00.000Z","tags":["vault","devsecops"],"images":["/static/images/social-banner.png"],"summary":"Vault를 구글 인증을 통해서 로그인하도록 설정해본다. Admin Directory API를 통해서 workspace의 user와 group의 정보를 가져올 수 있고, 해당 정보를 통해서 인증 조건을 추가할 수 있다. 예로 특정 workspace group에 속한 계정만 인증에 성공할 수 있도록 조건을 추가할 수 있다. Admin Directory API에 요청하기 위해서 필요한 권한을 설정할 수 있는데, Service Account의 key 파일을 생성하는 대신에, Application Default Credentials를 활용해보았다. Application Default Credentials를 사용하는 과정에서 삽질을 많이 했는데, 혹시나 동일한 작업을 하는 분들은 나처럼 시간을 허비하지 않기를 바라며 글을 작성한다.🥹","slug":"20240714-vault-oidc"}},"__N_SSG":true}